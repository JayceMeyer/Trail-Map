(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const h of l)if(h.type==="childList")for(const d of h.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function i(l){const h={};return l.integrity&&(h.integrity=l.integrity),l.referrerPolicy&&(h.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?h.credentials="include":l.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function s(l){if(l.ep)return;l.ep=!0;const h=i(l);fetch(l.href,h)}})();function Y4(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var c2={exports:{}},Rm={},u2={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bd=Symbol.for("react.element"),K4=Symbol.for("react.portal"),X4=Symbol.for("react.fragment"),J4=Symbol.for("react.strict_mode"),Q4=Symbol.for("react.profiler"),tk=Symbol.for("react.provider"),ek=Symbol.for("react.context"),ik=Symbol.for("react.forward_ref"),rk=Symbol.for("react.suspense"),nk=Symbol.for("react.memo"),sk=Symbol.for("react.lazy"),g1=Symbol.iterator;function ok(t){return t===null||typeof t!="object"?null:(t=g1&&t[g1]||t["@@iterator"],typeof t=="function"?t:null)}var h2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},d2=Object.assign,p2={};function du(t,e,i){this.props=t,this.context=e,this.refs=p2,this.updater=i||h2}du.prototype.isReactComponent={};du.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};du.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function f2(){}f2.prototype=du.prototype;function y_(t,e,i){this.props=t,this.context=e,this.refs=p2,this.updater=i||h2}var __=y_.prototype=new f2;__.constructor=y_;d2(__,du.prototype);__.isPureReactComponent=!0;var y1=Array.isArray,m2=Object.prototype.hasOwnProperty,v_={current:null},g2={key:!0,ref:!0,__self:!0,__source:!0};function y2(t,e,i){var s,l={},h=null,d=null;if(e!=null)for(s in e.ref!==void 0&&(d=e.ref),e.key!==void 0&&(h=""+e.key),e)m2.call(e,s)&&!g2.hasOwnProperty(s)&&(l[s]=e[s]);var c=arguments.length-2;if(c===1)l.children=i;else if(1<c){for(var b=Array(c),S=0;S<c;S++)b[S]=arguments[S+2];l.children=b}if(t&&t.defaultProps)for(s in c=t.defaultProps,c)l[s]===void 0&&(l[s]=c[s]);return{$$typeof:Bd,type:t,key:h,ref:d,props:l,_owner:v_.current}}function ak(t,e){return{$$typeof:Bd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function x_(t){return typeof t=="object"&&t!==null&&t.$$typeof===Bd}function lk(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(i){return e[i]})}var _1=/\/+/g;function h0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?lk(""+t.key):e.toString(36)}function Af(t,e,i,s,l){var h=typeof t;(h==="undefined"||h==="boolean")&&(t=null);var d=!1;if(t===null)d=!0;else switch(h){case"string":case"number":d=!0;break;case"object":switch(t.$$typeof){case Bd:case K4:d=!0}}if(d)return d=t,l=l(d),t=s===""?"."+h0(d,0):s,y1(l)?(i="",t!=null&&(i=t.replace(_1,"$&/")+"/"),Af(l,e,i,"",function(S){return S})):l!=null&&(x_(l)&&(l=ak(l,i+(!l.key||d&&d.key===l.key?"":(""+l.key).replace(_1,"$&/")+"/")+t)),e.push(l)),1;if(d=0,s=s===""?".":s+":",y1(t))for(var c=0;c<t.length;c++){h=t[c];var b=s+h0(h,c);d+=Af(h,e,i,b,l)}else if(b=ok(t),typeof b=="function")for(t=b.call(t),c=0;!(h=t.next()).done;)h=h.value,b=s+h0(h,c++),d+=Af(h,e,i,b,l);else if(h==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return d}function Jp(t,e,i){if(t==null)return t;var s=[],l=0;return Af(t,s,"","",function(h){return e.call(i,h,l++)}),s}function ck(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(i){(t._status===0||t._status===-1)&&(t._status=1,t._result=i)},function(i){(t._status===0||t._status===-1)&&(t._status=2,t._result=i)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Cn={current:null},zf={transition:null},uk={ReactCurrentDispatcher:Cn,ReactCurrentBatchConfig:zf,ReactCurrentOwner:v_};function _2(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:Jp,forEach:function(t,e,i){Jp(t,function(){e.apply(this,arguments)},i)},count:function(t){var e=0;return Jp(t,function(){e++}),e},toArray:function(t){return Jp(t,function(e){return e})||[]},only:function(t){if(!x_(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ye.Component=du;Ye.Fragment=X4;Ye.Profiler=Q4;Ye.PureComponent=y_;Ye.StrictMode=J4;Ye.Suspense=rk;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uk;Ye.act=_2;Ye.cloneElement=function(t,e,i){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=d2({},t.props),l=t.key,h=t.ref,d=t._owner;if(e!=null){if(e.ref!==void 0&&(h=e.ref,d=v_.current),e.key!==void 0&&(l=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(b in e)m2.call(e,b)&&!g2.hasOwnProperty(b)&&(s[b]=e[b]===void 0&&c!==void 0?c[b]:e[b])}var b=arguments.length-2;if(b===1)s.children=i;else if(1<b){c=Array(b);for(var S=0;S<b;S++)c[S]=arguments[S+2];s.children=c}return{$$typeof:Bd,type:t.type,key:l,ref:h,props:s,_owner:d}};Ye.createContext=function(t){return t={$$typeof:ek,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:tk,_context:t},t.Consumer=t};Ye.createElement=y2;Ye.createFactory=function(t){var e=y2.bind(null,t);return e.type=t,e};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(t){return{$$typeof:ik,render:t}};Ye.isValidElement=x_;Ye.lazy=function(t){return{$$typeof:sk,_payload:{_status:-1,_result:t},_init:ck}};Ye.memo=function(t,e){return{$$typeof:nk,type:t,compare:e===void 0?null:e}};Ye.startTransition=function(t){var e=zf.transition;zf.transition={};try{t()}finally{zf.transition=e}};Ye.unstable_act=_2;Ye.useCallback=function(t,e){return Cn.current.useCallback(t,e)};Ye.useContext=function(t){return Cn.current.useContext(t)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(t){return Cn.current.useDeferredValue(t)};Ye.useEffect=function(t,e){return Cn.current.useEffect(t,e)};Ye.useId=function(){return Cn.current.useId()};Ye.useImperativeHandle=function(t,e,i){return Cn.current.useImperativeHandle(t,e,i)};Ye.useInsertionEffect=function(t,e){return Cn.current.useInsertionEffect(t,e)};Ye.useLayoutEffect=function(t,e){return Cn.current.useLayoutEffect(t,e)};Ye.useMemo=function(t,e){return Cn.current.useMemo(t,e)};Ye.useReducer=function(t,e,i){return Cn.current.useReducer(t,e,i)};Ye.useRef=function(t){return Cn.current.useRef(t)};Ye.useState=function(t){return Cn.current.useState(t)};Ye.useSyncExternalStore=function(t,e,i){return Cn.current.useSyncExternalStore(t,e,i)};Ye.useTransition=function(){return Cn.current.useTransition()};Ye.version="18.3.1";u2.exports=Ye;var pu=u2.exports;const v2=Y4(pu);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hk=pu,dk=Symbol.for("react.element"),pk=Symbol.for("react.fragment"),fk=Object.prototype.hasOwnProperty,mk=hk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gk={key:!0,ref:!0,__self:!0,__source:!0};function x2(t,e,i){var s,l={},h=null,d=null;i!==void 0&&(h=""+i),e.key!==void 0&&(h=""+e.key),e.ref!==void 0&&(d=e.ref);for(s in e)fk.call(e,s)&&!gk.hasOwnProperty(s)&&(l[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)l[s]===void 0&&(l[s]=e[s]);return{$$typeof:dk,type:t,key:h,ref:d,props:l,_owner:mk.current}}Rm.Fragment=pk;Rm.jsx=x2;Rm.jsxs=x2;c2.exports=Rm;var Bs=c2.exports,b2={exports:{}},us={},w2={exports:{}},S2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Vt,re){var Kt=Vt.length;Vt.push(re);t:for(;0<Kt;){var we=Kt-1>>>1,Se=Vt[we];if(0<l(Se,re))Vt[we]=re,Vt[Kt]=Se,Kt=we;else break t}}function i(Vt){return Vt.length===0?null:Vt[0]}function s(Vt){if(Vt.length===0)return null;var re=Vt[0],Kt=Vt.pop();if(Kt!==re){Vt[0]=Kt;t:for(var we=0,Se=Vt.length,ai=Se>>>1;we<ai;){var Qe=2*(we+1)-1,fi=Vt[Qe],ni=Qe+1,Ue=Vt[ni];if(0>l(fi,Kt))ni<Se&&0>l(Ue,fi)?(Vt[we]=Ue,Vt[ni]=Kt,we=ni):(Vt[we]=fi,Vt[Qe]=Kt,we=Qe);else if(ni<Se&&0>l(Ue,Kt))Vt[we]=Ue,Vt[ni]=Kt,we=ni;else break t}}return re}function l(Vt,re){var Kt=Vt.sortIndex-re.sortIndex;return Kt!==0?Kt:Vt.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;t.unstable_now=function(){return h.now()}}else{var d=Date,c=d.now();t.unstable_now=function(){return d.now()-c}}var b=[],S=[],C=1,P=null,A=3,V=!1,W=!1,$=!1,nt=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,Y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function K(Vt){for(var re=i(S);re!==null;){if(re.callback===null)s(S);else if(re.startTime<=Vt)s(S),re.sortIndex=re.expirationTime,e(b,re);else break;re=i(S)}}function at(Vt){if($=!1,K(Vt),!W)if(i(b)!==null)W=!0,Ee(mt);else{var re=i(S);re!==null&&$e(at,re.startTime-Vt)}}function mt(Vt,re){W=!1,$&&($=!1,H(Mt),Mt=-1),V=!0;var Kt=A;try{for(K(re),P=i(b);P!==null&&(!(P.expirationTime>re)||Vt&&!Ot());){var we=P.callback;if(typeof we=="function"){P.callback=null,A=P.priorityLevel;var Se=we(P.expirationTime<=re);re=t.unstable_now(),typeof Se=="function"?P.callback=Se:P===i(b)&&s(b),K(re)}else s(b);P=i(b)}if(P!==null)var ai=!0;else{var Qe=i(S);Qe!==null&&$e(at,Qe.startTime-re),ai=!1}return ai}finally{P=null,A=Kt,V=!1}}var xt=!1,Tt=null,Mt=-1,$t=5,Ft=-1;function Ot(){return!(t.unstable_now()-Ft<$t)}function ge(){if(Tt!==null){var Vt=t.unstable_now();Ft=Vt;var re=!0;try{re=Tt(!0,Vt)}finally{re?_e():(xt=!1,Tt=null)}}else xt=!1}var _e;if(typeof Y=="function")_e=function(){Y(ge)};else if(typeof MessageChannel<"u"){var Ae=new MessageChannel,ve=Ae.port2;Ae.port1.onmessage=ge,_e=function(){ve.postMessage(null)}}else _e=function(){nt(ge,0)};function Ee(Vt){Tt=Vt,xt||(xt=!0,_e())}function $e(Vt,re){Mt=nt(function(){Vt(t.unstable_now())},re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Vt){Vt.callback=null},t.unstable_continueExecution=function(){W||V||(W=!0,Ee(mt))},t.unstable_forceFrameRate=function(Vt){0>Vt||125<Vt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$t=0<Vt?Math.floor(1e3/Vt):5},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return i(b)},t.unstable_next=function(Vt){switch(A){case 1:case 2:case 3:var re=3;break;default:re=A}var Kt=A;A=re;try{return Vt()}finally{A=Kt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Vt,re){switch(Vt){case 1:case 2:case 3:case 4:case 5:break;default:Vt=3}var Kt=A;A=Vt;try{return re()}finally{A=Kt}},t.unstable_scheduleCallback=function(Vt,re,Kt){var we=t.unstable_now();switch(typeof Kt=="object"&&Kt!==null?(Kt=Kt.delay,Kt=typeof Kt=="number"&&0<Kt?we+Kt:we):Kt=we,Vt){case 1:var Se=-1;break;case 2:Se=250;break;case 5:Se=1073741823;break;case 4:Se=1e4;break;default:Se=5e3}return Se=Kt+Se,Vt={id:C++,callback:re,priorityLevel:Vt,startTime:Kt,expirationTime:Se,sortIndex:-1},Kt>we?(Vt.sortIndex=Kt,e(S,Vt),i(b)===null&&Vt===i(S)&&($?(H(Mt),Mt=-1):$=!0,$e(at,Kt-we))):(Vt.sortIndex=Se,e(b,Vt),W||V||(W=!0,Ee(mt))),Vt},t.unstable_shouldYield=Ot,t.unstable_wrapCallback=function(Vt){var re=A;return function(){var Kt=A;A=re;try{return Vt.apply(this,arguments)}finally{A=Kt}}}})(S2);w2.exports=S2;var yk=w2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _k=pu,cs=yk;function Gt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var k2=new Set,ud={};function Ul(t,e){iu(t,e),iu(t+"Capture",e)}function iu(t,e){for(ud[t]=e,t=0;t<e.length;t++)k2.add(e[t])}var Wo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ty=Object.prototype.hasOwnProperty,vk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v1={},x1={};function xk(t){return ty.call(x1,t)?!0:ty.call(v1,t)?!1:vk.test(t)?x1[t]=!0:(v1[t]=!0,!1)}function bk(t,e,i,s){if(i!==null&&i.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:i!==null?!i.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function wk(t,e,i,s){if(e===null||typeof e>"u"||bk(t,e,i,s))return!0;if(s)return!1;if(i!==null)switch(i.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function En(t,e,i,s,l,h,d){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=l,this.mustUseProperty=i,this.propertyName=t,this.type=e,this.sanitizeURL=h,this.removeEmptyString=d}var rn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){rn[t]=new En(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];rn[e]=new En(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){rn[t]=new En(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){rn[t]=new En(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){rn[t]=new En(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){rn[t]=new En(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){rn[t]=new En(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){rn[t]=new En(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){rn[t]=new En(t,5,!1,t.toLowerCase(),null,!1,!1)});var b_=/[\-:]([a-z])/g;function w_(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(b_,w_);rn[e]=new En(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(b_,w_);rn[e]=new En(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(b_,w_);rn[e]=new En(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){rn[t]=new En(t,1,!1,t.toLowerCase(),null,!1,!1)});rn.xlinkHref=new En("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){rn[t]=new En(t,1,!1,t.toLowerCase(),null,!0,!0)});function S_(t,e,i,s){var l=rn.hasOwnProperty(e)?rn[e]:null;(l!==null?l.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(wk(e,i,l,s)&&(i=null),s||l===null?xk(e)&&(i===null?t.removeAttribute(e):t.setAttribute(e,""+i)):l.mustUseProperty?t[l.propertyName]=i===null?l.type===3?!1:"":i:(e=l.attributeName,s=l.attributeNamespace,i===null?t.removeAttribute(e):(l=l.type,i=l===3||l===4&&i===!0?"":""+i,s?t.setAttributeNS(s,e,i):t.setAttribute(e,i))))}var Jo=_k.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qp=Symbol.for("react.element"),Oc=Symbol.for("react.portal"),Bc=Symbol.for("react.fragment"),k_=Symbol.for("react.strict_mode"),ey=Symbol.for("react.profiler"),T2=Symbol.for("react.provider"),M2=Symbol.for("react.context"),T_=Symbol.for("react.forward_ref"),iy=Symbol.for("react.suspense"),ry=Symbol.for("react.suspense_list"),M_=Symbol.for("react.memo"),wa=Symbol.for("react.lazy"),C2=Symbol.for("react.offscreen"),b1=Symbol.iterator;function wh(t){return t===null||typeof t!="object"?null:(t=b1&&t[b1]||t["@@iterator"],typeof t=="function"?t:null)}var Ki=Object.assign,d0;function Fh(t){if(d0===void 0)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);d0=e&&e[1]||""}return`
`+d0+t}var p0=!1;function f0(t,e){if(!t||p0)return"";p0=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(S){var s=S}Reflect.construct(t,[],e)}else{try{e.call()}catch(S){s=S}t.call(e.prototype)}else{try{throw Error()}catch(S){s=S}t()}}catch(S){if(S&&s&&typeof S.stack=="string"){for(var l=S.stack.split(`
`),h=s.stack.split(`
`),d=l.length-1,c=h.length-1;1<=d&&0<=c&&l[d]!==h[c];)c--;for(;1<=d&&0<=c;d--,c--)if(l[d]!==h[c]){if(d!==1||c!==1)do if(d--,c--,0>c||l[d]!==h[c]){var b=`
`+l[d].replace(" at new "," at ");return t.displayName&&b.includes("<anonymous>")&&(b=b.replace("<anonymous>",t.displayName)),b}while(1<=d&&0<=c);break}}}finally{p0=!1,Error.prepareStackTrace=i}return(t=t?t.displayName||t.name:"")?Fh(t):""}function Sk(t){switch(t.tag){case 5:return Fh(t.type);case 16:return Fh("Lazy");case 13:return Fh("Suspense");case 19:return Fh("SuspenseList");case 0:case 2:case 15:return t=f0(t.type,!1),t;case 11:return t=f0(t.type.render,!1),t;case 1:return t=f0(t.type,!0),t;default:return""}}function ny(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Bc:return"Fragment";case Oc:return"Portal";case ey:return"Profiler";case k_:return"StrictMode";case iy:return"Suspense";case ry:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case M2:return(t.displayName||"Context")+".Consumer";case T2:return(t._context.displayName||"Context")+".Provider";case T_:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case M_:return e=t.displayName||null,e!==null?e:ny(t.type)||"Memo";case wa:e=t._payload,t=t._init;try{return ny(t(e))}catch{}}return null}function kk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ny(e);case 8:return e===k_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ja(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function E2(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Tk(t){var e=E2(t)?"checked":"value",i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var l=i.get,h=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return l.call(this)},set:function(d){s=""+d,h.call(this,d)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return s},setValue:function(d){s=""+d},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function tf(t){t._valueTracker||(t._valueTracker=Tk(t))}function P2(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var i=e.getValue(),s="";return t&&(s=E2(t)?t.checked?"true":"false":t.value),t=s,t!==i?(e.setValue(t),!0):!1}function Qf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function sy(t,e){var i=e.checked;return Ki({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??t._wrapperState.initialChecked})}function w1(t,e){var i=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;i=ja(e.value!=null?e.value:i),t._wrapperState={initialChecked:s,initialValue:i,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function I2(t,e){e=e.checked,e!=null&&S_(t,"checked",e,!1)}function oy(t,e){I2(t,e);var i=ja(e.value),s=e.type;if(i!=null)s==="number"?(i===0&&t.value===""||t.value!=i)&&(t.value=""+i):t.value!==""+i&&(t.value=""+i);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ay(t,e.type,i):e.hasOwnProperty("defaultValue")&&ay(t,e.type,ja(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function S1(t,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,i||e===t.value||(t.value=e),t.defaultValue=e}i=t.name,i!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,i!==""&&(t.name=i)}function ay(t,e,i){(e!=="number"||Qf(t.ownerDocument)!==t)&&(i==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+i&&(t.defaultValue=""+i))}var Oh=Array.isArray;function Yc(t,e,i,s){if(t=t.options,e){e={};for(var l=0;l<i.length;l++)e["$"+i[l]]=!0;for(i=0;i<t.length;i++)l=e.hasOwnProperty("$"+t[i].value),t[i].selected!==l&&(t[i].selected=l),l&&s&&(t[i].defaultSelected=!0)}else{for(i=""+ja(i),e=null,l=0;l<t.length;l++){if(t[l].value===i){t[l].selected=!0,s&&(t[l].defaultSelected=!0);return}e!==null||t[l].disabled||(e=t[l])}e!==null&&(e.selected=!0)}}function ly(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Gt(91));return Ki({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function k1(t,e){var i=e.value;if(i==null){if(i=e.children,e=e.defaultValue,i!=null){if(e!=null)throw Error(Gt(92));if(Oh(i)){if(1<i.length)throw Error(Gt(93));i=i[0]}e=i}e==null&&(e=""),i=e}t._wrapperState={initialValue:ja(i)}}function A2(t,e){var i=ja(e.value),s=ja(e.defaultValue);i!=null&&(i=""+i,i!==t.value&&(t.value=i),e.defaultValue==null&&t.defaultValue!==i&&(t.defaultValue=i)),s!=null&&(t.defaultValue=""+s)}function T1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function z2(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cy(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?z2(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ef,D2=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,i,s,l){MSApp.execUnsafeLocalFunction(function(){return t(e,i,s,l)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ef=ef||document.createElement("div"),ef.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ef.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function hd(t,e){if(e){var i=t.firstChild;if(i&&i===t.lastChild&&i.nodeType===3){i.nodeValue=e;return}}t.textContent=e}var qh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mk=["Webkit","ms","Moz","O"];Object.keys(qh).forEach(function(t){Mk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),qh[e]=qh[t]})});function L2(t,e,i){return e==null||typeof e=="boolean"||e===""?"":i||typeof e!="number"||e===0||qh.hasOwnProperty(t)&&qh[t]?(""+e).trim():e+"px"}function R2(t,e){t=t.style;for(var i in e)if(e.hasOwnProperty(i)){var s=i.indexOf("--")===0,l=L2(i,e[i],s);i==="float"&&(i="cssFloat"),s?t.setProperty(i,l):t[i]=l}}var Ck=Ki({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uy(t,e){if(e){if(Ck[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Gt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Gt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Gt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Gt(62))}}function hy(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dy=null;function C_(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var py=null,Kc=null,Xc=null;function M1(t){if(t=Nd(t)){if(typeof py!="function")throw Error(Gt(280));var e=t.stateNode;e&&(e=$m(e),py(t.stateNode,t.type,e))}}function F2(t){Kc?Xc?Xc.push(t):Xc=[t]:Kc=t}function O2(){if(Kc){var t=Kc,e=Xc;if(Xc=Kc=null,M1(t),e)for(t=0;t<e.length;t++)M1(e[t])}}function B2(t,e){return t(e)}function V2(){}var m0=!1;function $2(t,e,i){if(m0)return t(e,i);m0=!0;try{return B2(t,e,i)}finally{m0=!1,(Kc!==null||Xc!==null)&&(V2(),O2())}}function dd(t,e){var i=t.stateNode;if(i===null)return null;var s=$m(i);if(s===null)return null;i=s[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break t;default:t=!1}if(t)return null;if(i&&typeof i!="function")throw Error(Gt(231,e,typeof i));return i}var fy=!1;if(Wo)try{var Sh={};Object.defineProperty(Sh,"passive",{get:function(){fy=!0}}),window.addEventListener("test",Sh,Sh),window.removeEventListener("test",Sh,Sh)}catch{fy=!1}function Ek(t,e,i,s,l,h,d,c,b){var S=Array.prototype.slice.call(arguments,3);try{e.apply(i,S)}catch(C){this.onError(C)}}var Gh=!1,tm=null,em=!1,my=null,Pk={onError:function(t){Gh=!0,tm=t}};function Ik(t,e,i,s,l,h,d,c,b){Gh=!1,tm=null,Ek.apply(Pk,arguments)}function Ak(t,e,i,s,l,h,d,c,b){if(Ik.apply(this,arguments),Gh){if(Gh){var S=tm;Gh=!1,tm=null}else throw Error(Gt(198));em||(em=!0,my=S)}}function Hl(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(i=e.return),t=e.return;while(t)}return e.tag===3?i:null}function N2(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function C1(t){if(Hl(t)!==t)throw Error(Gt(188))}function zk(t){var e=t.alternate;if(!e){if(e=Hl(t),e===null)throw Error(Gt(188));return e!==t?null:t}for(var i=t,s=e;;){var l=i.return;if(l===null)break;var h=l.alternate;if(h===null){if(s=l.return,s!==null){i=s;continue}break}if(l.child===h.child){for(h=l.child;h;){if(h===i)return C1(l),t;if(h===s)return C1(l),e;h=h.sibling}throw Error(Gt(188))}if(i.return!==s.return)i=l,s=h;else{for(var d=!1,c=l.child;c;){if(c===i){d=!0,i=l,s=h;break}if(c===s){d=!0,s=l,i=h;break}c=c.sibling}if(!d){for(c=h.child;c;){if(c===i){d=!0,i=h,s=l;break}if(c===s){d=!0,s=h,i=l;break}c=c.sibling}if(!d)throw Error(Gt(189))}}if(i.alternate!==s)throw Error(Gt(190))}if(i.tag!==3)throw Error(Gt(188));return i.stateNode.current===i?t:e}function j2(t){return t=zk(t),t!==null?U2(t):null}function U2(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=U2(t);if(e!==null)return e;t=t.sibling}return null}var H2=cs.unstable_scheduleCallback,E1=cs.unstable_cancelCallback,Dk=cs.unstable_shouldYield,Lk=cs.unstable_requestPaint,ur=cs.unstable_now,Rk=cs.unstable_getCurrentPriorityLevel,E_=cs.unstable_ImmediatePriority,Z2=cs.unstable_UserBlockingPriority,im=cs.unstable_NormalPriority,Fk=cs.unstable_LowPriority,q2=cs.unstable_IdlePriority,Fm=null,yo=null;function Ok(t){if(yo&&typeof yo.onCommitFiberRoot=="function")try{yo.onCommitFiberRoot(Fm,t,void 0,(t.current.flags&128)===128)}catch{}}var Us=Math.clz32?Math.clz32:$k,Bk=Math.log,Vk=Math.LN2;function $k(t){return t>>>=0,t===0?32:31-(Bk(t)/Vk|0)|0}var rf=64,nf=4194304;function Bh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function rm(t,e){var i=t.pendingLanes;if(i===0)return 0;var s=0,l=t.suspendedLanes,h=t.pingedLanes,d=i&268435455;if(d!==0){var c=d&~l;c!==0?s=Bh(c):(h&=d,h!==0&&(s=Bh(h)))}else d=i&~l,d!==0?s=Bh(d):h!==0&&(s=Bh(h));if(s===0)return 0;if(e!==0&&e!==s&&!(e&l)&&(l=s&-s,h=e&-e,l>=h||l===16&&(h&4194240)!==0))return e;if(s&4&&(s|=i&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)i=31-Us(e),l=1<<i,s|=t[i],e&=~l;return s}function Nk(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jk(t,e){for(var i=t.suspendedLanes,s=t.pingedLanes,l=t.expirationTimes,h=t.pendingLanes;0<h;){var d=31-Us(h),c=1<<d,b=l[d];b===-1?(!(c&i)||c&s)&&(l[d]=Nk(c,e)):b<=e&&(t.expiredLanes|=c),h&=~c}}function gy(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function G2(){var t=rf;return rf<<=1,!(rf&4194240)&&(rf=64),t}function g0(t){for(var e=[],i=0;31>i;i++)e.push(t);return e}function Vd(t,e,i){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Us(e),t[e]=i}function Uk(t,e){var i=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<i;){var l=31-Us(i),h=1<<l;e[l]=0,s[l]=-1,t[l]=-1,i&=~h}}function P_(t,e){var i=t.entangledLanes|=e;for(t=t.entanglements;i;){var s=31-Us(i),l=1<<s;l&e|t[s]&e&&(t[s]|=e),i&=~l}}var gi=0;function W2(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Y2,I_,K2,X2,J2,yy=!1,sf=[],za=null,Da=null,La=null,pd=new Map,fd=new Map,ka=[],Hk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function P1(t,e){switch(t){case"focusin":case"focusout":za=null;break;case"dragenter":case"dragleave":Da=null;break;case"mouseover":case"mouseout":La=null;break;case"pointerover":case"pointerout":pd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fd.delete(e.pointerId)}}function kh(t,e,i,s,l,h){return t===null||t.nativeEvent!==h?(t={blockedOn:e,domEventName:i,eventSystemFlags:s,nativeEvent:h,targetContainers:[l]},e!==null&&(e=Nd(e),e!==null&&I_(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,l!==null&&e.indexOf(l)===-1&&e.push(l),t)}function Zk(t,e,i,s,l){switch(e){case"focusin":return za=kh(za,t,e,i,s,l),!0;case"dragenter":return Da=kh(Da,t,e,i,s,l),!0;case"mouseover":return La=kh(La,t,e,i,s,l),!0;case"pointerover":var h=l.pointerId;return pd.set(h,kh(pd.get(h)||null,t,e,i,s,l)),!0;case"gotpointercapture":return h=l.pointerId,fd.set(h,kh(fd.get(h)||null,t,e,i,s,l)),!0}return!1}function Q2(t){var e=El(t.target);if(e!==null){var i=Hl(e);if(i!==null){if(e=i.tag,e===13){if(e=N2(i),e!==null){t.blockedOn=e,J2(t.priority,function(){K2(i)});return}}else if(e===3&&i.stateNode.current.memoizedState.isDehydrated){t.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Df(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var i=_y(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(i===null){i=t.nativeEvent;var s=new i.constructor(i.type,i);dy=s,i.target.dispatchEvent(s),dy=null}else return e=Nd(i),e!==null&&I_(e),t.blockedOn=i,!1;e.shift()}return!0}function I1(t,e,i){Df(t)&&i.delete(e)}function qk(){yy=!1,za!==null&&Df(za)&&(za=null),Da!==null&&Df(Da)&&(Da=null),La!==null&&Df(La)&&(La=null),pd.forEach(I1),fd.forEach(I1)}function Th(t,e){t.blockedOn===e&&(t.blockedOn=null,yy||(yy=!0,cs.unstable_scheduleCallback(cs.unstable_NormalPriority,qk)))}function md(t){function e(l){return Th(l,t)}if(0<sf.length){Th(sf[0],t);for(var i=1;i<sf.length;i++){var s=sf[i];s.blockedOn===t&&(s.blockedOn=null)}}for(za!==null&&Th(za,t),Da!==null&&Th(Da,t),La!==null&&Th(La,t),pd.forEach(e),fd.forEach(e),i=0;i<ka.length;i++)s=ka[i],s.blockedOn===t&&(s.blockedOn=null);for(;0<ka.length&&(i=ka[0],i.blockedOn===null);)Q2(i),i.blockedOn===null&&ka.shift()}var Jc=Jo.ReactCurrentBatchConfig,nm=!0;function Gk(t,e,i,s){var l=gi,h=Jc.transition;Jc.transition=null;try{gi=1,A_(t,e,i,s)}finally{gi=l,Jc.transition=h}}function Wk(t,e,i,s){var l=gi,h=Jc.transition;Jc.transition=null;try{gi=4,A_(t,e,i,s)}finally{gi=l,Jc.transition=h}}function A_(t,e,i,s){if(nm){var l=_y(t,e,i,s);if(l===null)M0(t,e,s,sm,i),P1(t,s);else if(Zk(l,t,e,i,s))s.stopPropagation();else if(P1(t,s),e&4&&-1<Hk.indexOf(t)){for(;l!==null;){var h=Nd(l);if(h!==null&&Y2(h),h=_y(t,e,i,s),h===null&&M0(t,e,s,sm,i),h===l)break;l=h}l!==null&&s.stopPropagation()}else M0(t,e,s,null,i)}}var sm=null;function _y(t,e,i,s){if(sm=null,t=C_(s),t=El(t),t!==null)if(e=Hl(t),e===null)t=null;else if(i=e.tag,i===13){if(t=N2(e),t!==null)return t;t=null}else if(i===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return sm=t,null}function t5(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Rk()){case E_:return 1;case Z2:return 4;case im:case Fk:return 16;case q2:return 536870912;default:return 16}default:return 16}}var Ma=null,z_=null,Lf=null;function e5(){if(Lf)return Lf;var t,e=z_,i=e.length,s,l="value"in Ma?Ma.value:Ma.textContent,h=l.length;for(t=0;t<i&&e[t]===l[t];t++);var d=i-t;for(s=1;s<=d&&e[i-s]===l[h-s];s++);return Lf=l.slice(t,1<s?1-s:void 0)}function Rf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function of(){return!0}function A1(){return!1}function hs(t){function e(i,s,l,h,d){this._reactName=i,this._targetInst=l,this.type=s,this.nativeEvent=h,this.target=d,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(i=t[c],this[c]=i?i(h):h[c]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?of:A1,this.isPropagationStopped=A1,this}return Ki(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=of)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=of)},persist:function(){},isPersistent:of}),e}var fu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},D_=hs(fu),$d=Ki({},fu,{view:0,detail:0}),Yk=hs($d),y0,_0,Mh,Om=Ki({},$d,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:L_,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Mh&&(Mh&&t.type==="mousemove"?(y0=t.screenX-Mh.screenX,_0=t.screenY-Mh.screenY):_0=y0=0,Mh=t),y0)},movementY:function(t){return"movementY"in t?t.movementY:_0}}),z1=hs(Om),Kk=Ki({},Om,{dataTransfer:0}),Xk=hs(Kk),Jk=Ki({},$d,{relatedTarget:0}),v0=hs(Jk),Qk=Ki({},fu,{animationName:0,elapsedTime:0,pseudoElement:0}),tT=hs(Qk),eT=Ki({},fu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),iT=hs(eT),rT=Ki({},fu,{data:0}),D1=hs(rT),nT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function aT(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=oT[t])?!!e[t]:!1}function L_(){return aT}var lT=Ki({},$d,{key:function(t){if(t.key){var e=nT[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Rf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?sT[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:L_,charCode:function(t){return t.type==="keypress"?Rf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Rf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),cT=hs(lT),uT=Ki({},Om,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),L1=hs(uT),hT=Ki({},$d,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:L_}),dT=hs(hT),pT=Ki({},fu,{propertyName:0,elapsedTime:0,pseudoElement:0}),fT=hs(pT),mT=Ki({},Om,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),gT=hs(mT),yT=[9,13,27,32],R_=Wo&&"CompositionEvent"in window,Wh=null;Wo&&"documentMode"in document&&(Wh=document.documentMode);var _T=Wo&&"TextEvent"in window&&!Wh,i5=Wo&&(!R_||Wh&&8<Wh&&11>=Wh),R1=" ",F1=!1;function r5(t,e){switch(t){case"keyup":return yT.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function n5(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Vc=!1;function vT(t,e){switch(t){case"compositionend":return n5(e);case"keypress":return e.which!==32?null:(F1=!0,R1);case"textInput":return t=e.data,t===R1&&F1?null:t;default:return null}}function xT(t,e){if(Vc)return t==="compositionend"||!R_&&r5(t,e)?(t=e5(),Lf=z_=Ma=null,Vc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return i5&&e.locale!=="ko"?null:e.data;default:return null}}var bT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function O1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!bT[t.type]:e==="textarea"}function s5(t,e,i,s){F2(s),e=om(e,"onChange"),0<e.length&&(i=new D_("onChange","change",null,i,s),t.push({event:i,listeners:e}))}var Yh=null,gd=null;function wT(t){g5(t,0)}function Bm(t){var e=jc(t);if(P2(e))return t}function ST(t,e){if(t==="change")return e}var o5=!1;if(Wo){var x0;if(Wo){var b0="oninput"in document;if(!b0){var B1=document.createElement("div");B1.setAttribute("oninput","return;"),b0=typeof B1.oninput=="function"}x0=b0}else x0=!1;o5=x0&&(!document.documentMode||9<document.documentMode)}function V1(){Yh&&(Yh.detachEvent("onpropertychange",a5),gd=Yh=null)}function a5(t){if(t.propertyName==="value"&&Bm(gd)){var e=[];s5(e,gd,t,C_(t)),$2(wT,e)}}function kT(t,e,i){t==="focusin"?(V1(),Yh=e,gd=i,Yh.attachEvent("onpropertychange",a5)):t==="focusout"&&V1()}function TT(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Bm(gd)}function MT(t,e){if(t==="click")return Bm(e)}function CT(t,e){if(t==="input"||t==="change")return Bm(e)}function ET(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var qs=typeof Object.is=="function"?Object.is:ET;function yd(t,e){if(qs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var i=Object.keys(t),s=Object.keys(e);if(i.length!==s.length)return!1;for(s=0;s<i.length;s++){var l=i[s];if(!ty.call(e,l)||!qs(t[l],e[l]))return!1}return!0}function $1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function N1(t,e){var i=$1(t);t=0;for(var s;i;){if(i.nodeType===3){if(s=t+i.textContent.length,t<=e&&s>=e)return{node:i,offset:e-t};t=s}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=$1(i)}}function l5(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?l5(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function c5(){for(var t=window,e=Qf();e instanceof t.HTMLIFrameElement;){try{var i=typeof e.contentWindow.location.href=="string"}catch{i=!1}if(i)t=e.contentWindow;else break;e=Qf(t.document)}return e}function F_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function PT(t){var e=c5(),i=t.focusedElem,s=t.selectionRange;if(e!==i&&i&&i.ownerDocument&&l5(i.ownerDocument.documentElement,i)){if(s!==null&&F_(i)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in i)i.selectionStart=e,i.selectionEnd=Math.min(t,i.value.length);else if(t=(e=i.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var l=i.textContent.length,h=Math.min(s.start,l);s=s.end===void 0?h:Math.min(s.end,l),!t.extend&&h>s&&(l=s,s=h,h=l),l=N1(i,h);var d=N1(i,s);l&&d&&(t.rangeCount!==1||t.anchorNode!==l.node||t.anchorOffset!==l.offset||t.focusNode!==d.node||t.focusOffset!==d.offset)&&(e=e.createRange(),e.setStart(l.node,l.offset),t.removeAllRanges(),h>s?(t.addRange(e),t.extend(d.node,d.offset)):(e.setEnd(d.node,d.offset),t.addRange(e)))}}for(e=[],t=i;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<e.length;i++)t=e[i],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var IT=Wo&&"documentMode"in document&&11>=document.documentMode,$c=null,vy=null,Kh=null,xy=!1;function j1(t,e,i){var s=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;xy||$c==null||$c!==Qf(s)||(s=$c,"selectionStart"in s&&F_(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Kh&&yd(Kh,s)||(Kh=s,s=om(vy,"onSelect"),0<s.length&&(e=new D_("onSelect","select",null,e,i),t.push({event:e,listeners:s}),e.target=$c)))}function af(t,e){var i={};return i[t.toLowerCase()]=e.toLowerCase(),i["Webkit"+t]="webkit"+e,i["Moz"+t]="moz"+e,i}var Nc={animationend:af("Animation","AnimationEnd"),animationiteration:af("Animation","AnimationIteration"),animationstart:af("Animation","AnimationStart"),transitionend:af("Transition","TransitionEnd")},w0={},u5={};Wo&&(u5=document.createElement("div").style,"AnimationEvent"in window||(delete Nc.animationend.animation,delete Nc.animationiteration.animation,delete Nc.animationstart.animation),"TransitionEvent"in window||delete Nc.transitionend.transition);function Vm(t){if(w0[t])return w0[t];if(!Nc[t])return t;var e=Nc[t],i;for(i in e)if(e.hasOwnProperty(i)&&i in u5)return w0[t]=e[i];return t}var h5=Vm("animationend"),d5=Vm("animationiteration"),p5=Vm("animationstart"),f5=Vm("transitionend"),m5=new Map,U1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ga(t,e){m5.set(t,e),Ul(e,[t])}for(var S0=0;S0<U1.length;S0++){var k0=U1[S0],AT=k0.toLowerCase(),zT=k0[0].toUpperCase()+k0.slice(1);Ga(AT,"on"+zT)}Ga(h5,"onAnimationEnd");Ga(d5,"onAnimationIteration");Ga(p5,"onAnimationStart");Ga("dblclick","onDoubleClick");Ga("focusin","onFocus");Ga("focusout","onBlur");Ga(f5,"onTransitionEnd");iu("onMouseEnter",["mouseout","mouseover"]);iu("onMouseLeave",["mouseout","mouseover"]);iu("onPointerEnter",["pointerout","pointerover"]);iu("onPointerLeave",["pointerout","pointerover"]);Ul("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ul("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ul("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ul("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ul("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ul("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vh));function H1(t,e,i){var s=t.type||"unknown-event";t.currentTarget=i,Ak(s,e,void 0,t),t.currentTarget=null}function g5(t,e){e=(e&4)!==0;for(var i=0;i<t.length;i++){var s=t[i],l=s.event;s=s.listeners;t:{var h=void 0;if(e)for(var d=s.length-1;0<=d;d--){var c=s[d],b=c.instance,S=c.currentTarget;if(c=c.listener,b!==h&&l.isPropagationStopped())break t;H1(l,c,S),h=b}else for(d=0;d<s.length;d++){if(c=s[d],b=c.instance,S=c.currentTarget,c=c.listener,b!==h&&l.isPropagationStopped())break t;H1(l,c,S),h=b}}}if(em)throw t=my,em=!1,my=null,t}function Li(t,e){var i=e[Ty];i===void 0&&(i=e[Ty]=new Set);var s=t+"__bubble";i.has(s)||(y5(e,t,2,!1),i.add(s))}function T0(t,e,i){var s=0;e&&(s|=4),y5(i,t,s,e)}var lf="_reactListening"+Math.random().toString(36).slice(2);function _d(t){if(!t[lf]){t[lf]=!0,k2.forEach(function(i){i!=="selectionchange"&&(DT.has(i)||T0(i,!1,t),T0(i,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[lf]||(e[lf]=!0,T0("selectionchange",!1,e))}}function y5(t,e,i,s){switch(t5(e)){case 1:var l=Gk;break;case 4:l=Wk;break;default:l=A_}i=l.bind(null,e,i,t),l=void 0,!fy||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(l=!0),s?l!==void 0?t.addEventListener(e,i,{capture:!0,passive:l}):t.addEventListener(e,i,!0):l!==void 0?t.addEventListener(e,i,{passive:l}):t.addEventListener(e,i,!1)}function M0(t,e,i,s,l){var h=s;if(!(e&1)&&!(e&2)&&s!==null)t:for(;;){if(s===null)return;var d=s.tag;if(d===3||d===4){var c=s.stateNode.containerInfo;if(c===l||c.nodeType===8&&c.parentNode===l)break;if(d===4)for(d=s.return;d!==null;){var b=d.tag;if((b===3||b===4)&&(b=d.stateNode.containerInfo,b===l||b.nodeType===8&&b.parentNode===l))return;d=d.return}for(;c!==null;){if(d=El(c),d===null)return;if(b=d.tag,b===5||b===6){s=h=d;continue t}c=c.parentNode}}s=s.return}$2(function(){var S=h,C=C_(i),P=[];t:{var A=m5.get(t);if(A!==void 0){var V=D_,W=t;switch(t){case"keypress":if(Rf(i)===0)break t;case"keydown":case"keyup":V=cT;break;case"focusin":W="focus",V=v0;break;case"focusout":W="blur",V=v0;break;case"beforeblur":case"afterblur":V=v0;break;case"click":if(i.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":V=z1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":V=Xk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":V=dT;break;case h5:case d5:case p5:V=tT;break;case f5:V=fT;break;case"scroll":V=Yk;break;case"wheel":V=gT;break;case"copy":case"cut":case"paste":V=iT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":V=L1}var $=(e&4)!==0,nt=!$&&t==="scroll",H=$?A!==null?A+"Capture":null:A;$=[];for(var Y=S,K;Y!==null;){K=Y;var at=K.stateNode;if(K.tag===5&&at!==null&&(K=at,H!==null&&(at=dd(Y,H),at!=null&&$.push(vd(Y,at,K)))),nt)break;Y=Y.return}0<$.length&&(A=new V(A,W,null,i,C),P.push({event:A,listeners:$}))}}if(!(e&7)){t:{if(A=t==="mouseover"||t==="pointerover",V=t==="mouseout"||t==="pointerout",A&&i!==dy&&(W=i.relatedTarget||i.fromElement)&&(El(W)||W[Yo]))break t;if((V||A)&&(A=C.window===C?C:(A=C.ownerDocument)?A.defaultView||A.parentWindow:window,V?(W=i.relatedTarget||i.toElement,V=S,W=W?El(W):null,W!==null&&(nt=Hl(W),W!==nt||W.tag!==5&&W.tag!==6)&&(W=null)):(V=null,W=S),V!==W)){if($=z1,at="onMouseLeave",H="onMouseEnter",Y="mouse",(t==="pointerout"||t==="pointerover")&&($=L1,at="onPointerLeave",H="onPointerEnter",Y="pointer"),nt=V==null?A:jc(V),K=W==null?A:jc(W),A=new $(at,Y+"leave",V,i,C),A.target=nt,A.relatedTarget=K,at=null,El(C)===S&&($=new $(H,Y+"enter",W,i,C),$.target=K,$.relatedTarget=nt,at=$),nt=at,V&&W)e:{for($=V,H=W,Y=0,K=$;K;K=Lc(K))Y++;for(K=0,at=H;at;at=Lc(at))K++;for(;0<Y-K;)$=Lc($),Y--;for(;0<K-Y;)H=Lc(H),K--;for(;Y--;){if($===H||H!==null&&$===H.alternate)break e;$=Lc($),H=Lc(H)}$=null}else $=null;V!==null&&Z1(P,A,V,$,!1),W!==null&&nt!==null&&Z1(P,nt,W,$,!0)}}t:{if(A=S?jc(S):window,V=A.nodeName&&A.nodeName.toLowerCase(),V==="select"||V==="input"&&A.type==="file")var mt=ST;else if(O1(A))if(o5)mt=CT;else{mt=TT;var xt=kT}else(V=A.nodeName)&&V.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(mt=MT);if(mt&&(mt=mt(t,S))){s5(P,mt,i,C);break t}xt&&xt(t,A,S),t==="focusout"&&(xt=A._wrapperState)&&xt.controlled&&A.type==="number"&&ay(A,"number",A.value)}switch(xt=S?jc(S):window,t){case"focusin":(O1(xt)||xt.contentEditable==="true")&&($c=xt,vy=S,Kh=null);break;case"focusout":Kh=vy=$c=null;break;case"mousedown":xy=!0;break;case"contextmenu":case"mouseup":case"dragend":xy=!1,j1(P,i,C);break;case"selectionchange":if(IT)break;case"keydown":case"keyup":j1(P,i,C)}var Tt;if(R_)t:{switch(t){case"compositionstart":var Mt="onCompositionStart";break t;case"compositionend":Mt="onCompositionEnd";break t;case"compositionupdate":Mt="onCompositionUpdate";break t}Mt=void 0}else Vc?r5(t,i)&&(Mt="onCompositionEnd"):t==="keydown"&&i.keyCode===229&&(Mt="onCompositionStart");Mt&&(i5&&i.locale!=="ko"&&(Vc||Mt!=="onCompositionStart"?Mt==="onCompositionEnd"&&Vc&&(Tt=e5()):(Ma=C,z_="value"in Ma?Ma.value:Ma.textContent,Vc=!0)),xt=om(S,Mt),0<xt.length&&(Mt=new D1(Mt,t,null,i,C),P.push({event:Mt,listeners:xt}),Tt?Mt.data=Tt:(Tt=n5(i),Tt!==null&&(Mt.data=Tt)))),(Tt=_T?vT(t,i):xT(t,i))&&(S=om(S,"onBeforeInput"),0<S.length&&(C=new D1("onBeforeInput","beforeinput",null,i,C),P.push({event:C,listeners:S}),C.data=Tt))}g5(P,e)})}function vd(t,e,i){return{instance:t,listener:e,currentTarget:i}}function om(t,e){for(var i=e+"Capture",s=[];t!==null;){var l=t,h=l.stateNode;l.tag===5&&h!==null&&(l=h,h=dd(t,i),h!=null&&s.unshift(vd(t,h,l)),h=dd(t,e),h!=null&&s.push(vd(t,h,l))),t=t.return}return s}function Lc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Z1(t,e,i,s,l){for(var h=e._reactName,d=[];i!==null&&i!==s;){var c=i,b=c.alternate,S=c.stateNode;if(b!==null&&b===s)break;c.tag===5&&S!==null&&(c=S,l?(b=dd(i,h),b!=null&&d.unshift(vd(i,b,c))):l||(b=dd(i,h),b!=null&&d.push(vd(i,b,c)))),i=i.return}d.length!==0&&t.push({event:e,listeners:d})}var LT=/\r\n?/g,RT=/\u0000|\uFFFD/g;function q1(t){return(typeof t=="string"?t:""+t).replace(LT,`
`).replace(RT,"")}function cf(t,e,i){if(e=q1(e),q1(t)!==e&&i)throw Error(Gt(425))}function am(){}var by=null,wy=null;function Sy(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ky=typeof setTimeout=="function"?setTimeout:void 0,FT=typeof clearTimeout=="function"?clearTimeout:void 0,G1=typeof Promise=="function"?Promise:void 0,OT=typeof queueMicrotask=="function"?queueMicrotask:typeof G1<"u"?function(t){return G1.resolve(null).then(t).catch(BT)}:ky;function BT(t){setTimeout(function(){throw t})}function C0(t,e){var i=e,s=0;do{var l=i.nextSibling;if(t.removeChild(i),l&&l.nodeType===8)if(i=l.data,i==="/$"){if(s===0){t.removeChild(l),md(e);return}s--}else i!=="$"&&i!=="$?"&&i!=="$!"||s++;i=l}while(i);md(e)}function Ra(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function W1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var i=t.data;if(i==="$"||i==="$!"||i==="$?"){if(e===0)return t;e--}else i==="/$"&&e++}t=t.previousSibling}return null}var mu=Math.random().toString(36).slice(2),go="__reactFiber$"+mu,xd="__reactProps$"+mu,Yo="__reactContainer$"+mu,Ty="__reactEvents$"+mu,VT="__reactListeners$"+mu,$T="__reactHandles$"+mu;function El(t){var e=t[go];if(e)return e;for(var i=t.parentNode;i;){if(e=i[Yo]||i[go]){if(i=e.alternate,e.child!==null||i!==null&&i.child!==null)for(t=W1(t);t!==null;){if(i=t[go])return i;t=W1(t)}return e}t=i,i=t.parentNode}return null}function Nd(t){return t=t[go]||t[Yo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function jc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Gt(33))}function $m(t){return t[xd]||null}var My=[],Uc=-1;function Wa(t){return{current:t}}function Ri(t){0>Uc||(t.current=My[Uc],My[Uc]=null,Uc--)}function Ii(t,e){Uc++,My[Uc]=t.current,t.current=e}var Ua={},mn=Wa(Ua),Vn=Wa(!1),Fl=Ua;function ru(t,e){var i=t.type.contextTypes;if(!i)return Ua;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var l={},h;for(h in i)l[h]=e[h];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=l),l}function $n(t){return t=t.childContextTypes,t!=null}function lm(){Ri(Vn),Ri(mn)}function Y1(t,e,i){if(mn.current!==Ua)throw Error(Gt(168));Ii(mn,e),Ii(Vn,i)}function _5(t,e,i){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return i;s=s.getChildContext();for(var l in s)if(!(l in e))throw Error(Gt(108,kk(t)||"Unknown",l));return Ki({},i,s)}function cm(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ua,Fl=mn.current,Ii(mn,t),Ii(Vn,Vn.current),!0}function K1(t,e,i){var s=t.stateNode;if(!s)throw Error(Gt(169));i?(t=_5(t,e,Fl),s.__reactInternalMemoizedMergedChildContext=t,Ri(Vn),Ri(mn),Ii(mn,t)):Ri(Vn),Ii(Vn,i)}var Vo=null,Nm=!1,E0=!1;function v5(t){Vo===null?Vo=[t]:Vo.push(t)}function NT(t){Nm=!0,v5(t)}function Ya(){if(!E0&&Vo!==null){E0=!0;var t=0,e=gi;try{var i=Vo;for(gi=1;t<i.length;t++){var s=i[t];do s=s(!0);while(s!==null)}Vo=null,Nm=!1}catch(l){throw Vo!==null&&(Vo=Vo.slice(t+1)),H2(E_,Ya),l}finally{gi=e,E0=!1}}return null}var Hc=[],Zc=0,um=null,hm=0,_s=[],vs=0,Ol=null,jo=1,Uo="";function Tl(t,e){Hc[Zc++]=hm,Hc[Zc++]=um,um=t,hm=e}function x5(t,e,i){_s[vs++]=jo,_s[vs++]=Uo,_s[vs++]=Ol,Ol=t;var s=jo;t=Uo;var l=32-Us(s)-1;s&=~(1<<l),i+=1;var h=32-Us(e)+l;if(30<h){var d=l-l%5;h=(s&(1<<d)-1).toString(32),s>>=d,l-=d,jo=1<<32-Us(e)+l|i<<l|s,Uo=h+t}else jo=1<<h|i<<l|s,Uo=t}function O_(t){t.return!==null&&(Tl(t,1),x5(t,1,0))}function B_(t){for(;t===um;)um=Hc[--Zc],Hc[Zc]=null,hm=Hc[--Zc],Hc[Zc]=null;for(;t===Ol;)Ol=_s[--vs],_s[vs]=null,Uo=_s[--vs],_s[vs]=null,jo=_s[--vs],_s[vs]=null}var ls=null,as=null,Hi=!1,Ns=null;function b5(t,e){var i=bs(5,null,null,0);i.elementType="DELETED",i.stateNode=e,i.return=t,e=t.deletions,e===null?(t.deletions=[i],t.flags|=16):e.push(i)}function X1(t,e){switch(t.tag){case 5:var i=t.type;return e=e.nodeType!==1||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ls=t,as=Ra(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ls=t,as=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(i=Ol!==null?{id:jo,overflow:Uo}:null,t.memoizedState={dehydrated:e,treeContext:i,retryLane:1073741824},i=bs(18,null,null,0),i.stateNode=e,i.return=t,t.child=i,ls=t,as=null,!0):!1;default:return!1}}function Cy(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ey(t){if(Hi){var e=as;if(e){var i=e;if(!X1(t,e)){if(Cy(t))throw Error(Gt(418));e=Ra(i.nextSibling);var s=ls;e&&X1(t,e)?b5(s,i):(t.flags=t.flags&-4097|2,Hi=!1,ls=t)}}else{if(Cy(t))throw Error(Gt(418));t.flags=t.flags&-4097|2,Hi=!1,ls=t}}}function J1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ls=t}function uf(t){if(t!==ls)return!1;if(!Hi)return J1(t),Hi=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Sy(t.type,t.memoizedProps)),e&&(e=as)){if(Cy(t))throw w5(),Error(Gt(418));for(;e;)b5(t,e),e=Ra(e.nextSibling)}if(J1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Gt(317));t:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var i=t.data;if(i==="/$"){if(e===0){as=Ra(t.nextSibling);break t}e--}else i!=="$"&&i!=="$!"&&i!=="$?"||e++}t=t.nextSibling}as=null}}else as=ls?Ra(t.stateNode.nextSibling):null;return!0}function w5(){for(var t=as;t;)t=Ra(t.nextSibling)}function nu(){as=ls=null,Hi=!1}function V_(t){Ns===null?Ns=[t]:Ns.push(t)}var jT=Jo.ReactCurrentBatchConfig;function Ch(t,e,i){if(t=i.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(Gt(309));var s=i.stateNode}if(!s)throw Error(Gt(147,t));var l=s,h=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===h?e.ref:(e=function(d){var c=l.refs;d===null?delete c[h]:c[h]=d},e._stringRef=h,e)}if(typeof t!="string")throw Error(Gt(284));if(!i._owner)throw Error(Gt(290,t))}return t}function hf(t,e){throw t=Object.prototype.toString.call(e),Error(Gt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Q1(t){var e=t._init;return e(t._payload)}function S5(t){function e(H,Y){if(t){var K=H.deletions;K===null?(H.deletions=[Y],H.flags|=16):K.push(Y)}}function i(H,Y){if(!t)return null;for(;Y!==null;)e(H,Y),Y=Y.sibling;return null}function s(H,Y){for(H=new Map;Y!==null;)Y.key!==null?H.set(Y.key,Y):H.set(Y.index,Y),Y=Y.sibling;return H}function l(H,Y){return H=Va(H,Y),H.index=0,H.sibling=null,H}function h(H,Y,K){return H.index=K,t?(K=H.alternate,K!==null?(K=K.index,K<Y?(H.flags|=2,Y):K):(H.flags|=2,Y)):(H.flags|=1048576,Y)}function d(H){return t&&H.alternate===null&&(H.flags|=2),H}function c(H,Y,K,at){return Y===null||Y.tag!==6?(Y=R0(K,H.mode,at),Y.return=H,Y):(Y=l(Y,K),Y.return=H,Y)}function b(H,Y,K,at){var mt=K.type;return mt===Bc?C(H,Y,K.props.children,at,K.key):Y!==null&&(Y.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===wa&&Q1(mt)===Y.type)?(at=l(Y,K.props),at.ref=Ch(H,Y,K),at.return=H,at):(at=jf(K.type,K.key,K.props,null,H.mode,at),at.ref=Ch(H,Y,K),at.return=H,at)}function S(H,Y,K,at){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==K.containerInfo||Y.stateNode.implementation!==K.implementation?(Y=F0(K,H.mode,at),Y.return=H,Y):(Y=l(Y,K.children||[]),Y.return=H,Y)}function C(H,Y,K,at,mt){return Y===null||Y.tag!==7?(Y=Dl(K,H.mode,at,mt),Y.return=H,Y):(Y=l(Y,K),Y.return=H,Y)}function P(H,Y,K){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Y=R0(""+Y,H.mode,K),Y.return=H,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case Qp:return K=jf(Y.type,Y.key,Y.props,null,H.mode,K),K.ref=Ch(H,null,Y),K.return=H,K;case Oc:return Y=F0(Y,H.mode,K),Y.return=H,Y;case wa:var at=Y._init;return P(H,at(Y._payload),K)}if(Oh(Y)||wh(Y))return Y=Dl(Y,H.mode,K,null),Y.return=H,Y;hf(H,Y)}return null}function A(H,Y,K,at){var mt=Y!==null?Y.key:null;if(typeof K=="string"&&K!==""||typeof K=="number")return mt!==null?null:c(H,Y,""+K,at);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case Qp:return K.key===mt?b(H,Y,K,at):null;case Oc:return K.key===mt?S(H,Y,K,at):null;case wa:return mt=K._init,A(H,Y,mt(K._payload),at)}if(Oh(K)||wh(K))return mt!==null?null:C(H,Y,K,at,null);hf(H,K)}return null}function V(H,Y,K,at,mt){if(typeof at=="string"&&at!==""||typeof at=="number")return H=H.get(K)||null,c(Y,H,""+at,mt);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case Qp:return H=H.get(at.key===null?K:at.key)||null,b(Y,H,at,mt);case Oc:return H=H.get(at.key===null?K:at.key)||null,S(Y,H,at,mt);case wa:var xt=at._init;return V(H,Y,K,xt(at._payload),mt)}if(Oh(at)||wh(at))return H=H.get(K)||null,C(Y,H,at,mt,null);hf(Y,at)}return null}function W(H,Y,K,at){for(var mt=null,xt=null,Tt=Y,Mt=Y=0,$t=null;Tt!==null&&Mt<K.length;Mt++){Tt.index>Mt?($t=Tt,Tt=null):$t=Tt.sibling;var Ft=A(H,Tt,K[Mt],at);if(Ft===null){Tt===null&&(Tt=$t);break}t&&Tt&&Ft.alternate===null&&e(H,Tt),Y=h(Ft,Y,Mt),xt===null?mt=Ft:xt.sibling=Ft,xt=Ft,Tt=$t}if(Mt===K.length)return i(H,Tt),Hi&&Tl(H,Mt),mt;if(Tt===null){for(;Mt<K.length;Mt++)Tt=P(H,K[Mt],at),Tt!==null&&(Y=h(Tt,Y,Mt),xt===null?mt=Tt:xt.sibling=Tt,xt=Tt);return Hi&&Tl(H,Mt),mt}for(Tt=s(H,Tt);Mt<K.length;Mt++)$t=V(Tt,H,Mt,K[Mt],at),$t!==null&&(t&&$t.alternate!==null&&Tt.delete($t.key===null?Mt:$t.key),Y=h($t,Y,Mt),xt===null?mt=$t:xt.sibling=$t,xt=$t);return t&&Tt.forEach(function(Ot){return e(H,Ot)}),Hi&&Tl(H,Mt),mt}function $(H,Y,K,at){var mt=wh(K);if(typeof mt!="function")throw Error(Gt(150));if(K=mt.call(K),K==null)throw Error(Gt(151));for(var xt=mt=null,Tt=Y,Mt=Y=0,$t=null,Ft=K.next();Tt!==null&&!Ft.done;Mt++,Ft=K.next()){Tt.index>Mt?($t=Tt,Tt=null):$t=Tt.sibling;var Ot=A(H,Tt,Ft.value,at);if(Ot===null){Tt===null&&(Tt=$t);break}t&&Tt&&Ot.alternate===null&&e(H,Tt),Y=h(Ot,Y,Mt),xt===null?mt=Ot:xt.sibling=Ot,xt=Ot,Tt=$t}if(Ft.done)return i(H,Tt),Hi&&Tl(H,Mt),mt;if(Tt===null){for(;!Ft.done;Mt++,Ft=K.next())Ft=P(H,Ft.value,at),Ft!==null&&(Y=h(Ft,Y,Mt),xt===null?mt=Ft:xt.sibling=Ft,xt=Ft);return Hi&&Tl(H,Mt),mt}for(Tt=s(H,Tt);!Ft.done;Mt++,Ft=K.next())Ft=V(Tt,H,Mt,Ft.value,at),Ft!==null&&(t&&Ft.alternate!==null&&Tt.delete(Ft.key===null?Mt:Ft.key),Y=h(Ft,Y,Mt),xt===null?mt=Ft:xt.sibling=Ft,xt=Ft);return t&&Tt.forEach(function(ge){return e(H,ge)}),Hi&&Tl(H,Mt),mt}function nt(H,Y,K,at){if(typeof K=="object"&&K!==null&&K.type===Bc&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case Qp:t:{for(var mt=K.key,xt=Y;xt!==null;){if(xt.key===mt){if(mt=K.type,mt===Bc){if(xt.tag===7){i(H,xt.sibling),Y=l(xt,K.props.children),Y.return=H,H=Y;break t}}else if(xt.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===wa&&Q1(mt)===xt.type){i(H,xt.sibling),Y=l(xt,K.props),Y.ref=Ch(H,xt,K),Y.return=H,H=Y;break t}i(H,xt);break}else e(H,xt);xt=xt.sibling}K.type===Bc?(Y=Dl(K.props.children,H.mode,at,K.key),Y.return=H,H=Y):(at=jf(K.type,K.key,K.props,null,H.mode,at),at.ref=Ch(H,Y,K),at.return=H,H=at)}return d(H);case Oc:t:{for(xt=K.key;Y!==null;){if(Y.key===xt)if(Y.tag===4&&Y.stateNode.containerInfo===K.containerInfo&&Y.stateNode.implementation===K.implementation){i(H,Y.sibling),Y=l(Y,K.children||[]),Y.return=H,H=Y;break t}else{i(H,Y);break}else e(H,Y);Y=Y.sibling}Y=F0(K,H.mode,at),Y.return=H,H=Y}return d(H);case wa:return xt=K._init,nt(H,Y,xt(K._payload),at)}if(Oh(K))return W(H,Y,K,at);if(wh(K))return $(H,Y,K,at);hf(H,K)}return typeof K=="string"&&K!==""||typeof K=="number"?(K=""+K,Y!==null&&Y.tag===6?(i(H,Y.sibling),Y=l(Y,K),Y.return=H,H=Y):(i(H,Y),Y=R0(K,H.mode,at),Y.return=H,H=Y),d(H)):i(H,Y)}return nt}var su=S5(!0),k5=S5(!1),dm=Wa(null),pm=null,qc=null,$_=null;function N_(){$_=qc=pm=null}function j_(t){var e=dm.current;Ri(dm),t._currentValue=e}function Py(t,e,i){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===i)break;t=t.return}}function Qc(t,e){pm=t,$_=qc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Bn=!0),t.firstContext=null)}function ks(t){var e=t._currentValue;if($_!==t)if(t={context:t,memoizedValue:e,next:null},qc===null){if(pm===null)throw Error(Gt(308));qc=t,pm.dependencies={lanes:0,firstContext:t}}else qc=qc.next=t;return e}var Pl=null;function U_(t){Pl===null?Pl=[t]:Pl.push(t)}function T5(t,e,i,s){var l=e.interleaved;return l===null?(i.next=i,U_(e)):(i.next=l.next,l.next=i),e.interleaved=i,Ko(t,s)}function Ko(t,e){t.lanes|=e;var i=t.alternate;for(i!==null&&(i.lanes|=e),i=t,t=t.return;t!==null;)t.childLanes|=e,i=t.alternate,i!==null&&(i.childLanes|=e),i=t,t=t.return;return i.tag===3?i.stateNode:null}var Sa=!1;function H_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function M5(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Go(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Fa(t,e,i){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,si&2){var l=s.pending;return l===null?e.next=e:(e.next=l.next,l.next=e),s.pending=e,Ko(t,i)}return l=s.interleaved,l===null?(e.next=e,U_(s)):(e.next=l.next,l.next=e),s.interleaved=e,Ko(t,i)}function Ff(t,e,i){if(e=e.updateQueue,e!==null&&(e=e.shared,(i&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,i|=s,e.lanes=i,P_(t,i)}}function tb(t,e){var i=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,i===s)){var l=null,h=null;if(i=i.firstBaseUpdate,i!==null){do{var d={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};h===null?l=h=d:h=h.next=d,i=i.next}while(i!==null);h===null?l=h=e:h=h.next=e}else l=h=e;i={baseState:s.baseState,firstBaseUpdate:l,lastBaseUpdate:h,shared:s.shared,effects:s.effects},t.updateQueue=i;return}t=i.lastBaseUpdate,t===null?i.firstBaseUpdate=e:t.next=e,i.lastBaseUpdate=e}function fm(t,e,i,s){var l=t.updateQueue;Sa=!1;var h=l.firstBaseUpdate,d=l.lastBaseUpdate,c=l.shared.pending;if(c!==null){l.shared.pending=null;var b=c,S=b.next;b.next=null,d===null?h=S:d.next=S,d=b;var C=t.alternate;C!==null&&(C=C.updateQueue,c=C.lastBaseUpdate,c!==d&&(c===null?C.firstBaseUpdate=S:c.next=S,C.lastBaseUpdate=b))}if(h!==null){var P=l.baseState;d=0,C=S=b=null,c=h;do{var A=c.lane,V=c.eventTime;if((s&A)===A){C!==null&&(C=C.next={eventTime:V,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});t:{var W=t,$=c;switch(A=e,V=i,$.tag){case 1:if(W=$.payload,typeof W=="function"){P=W.call(V,P,A);break t}P=W;break t;case 3:W.flags=W.flags&-65537|128;case 0:if(W=$.payload,A=typeof W=="function"?W.call(V,P,A):W,A==null)break t;P=Ki({},P,A);break t;case 2:Sa=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,A=l.effects,A===null?l.effects=[c]:A.push(c))}else V={eventTime:V,lane:A,tag:c.tag,payload:c.payload,callback:c.callback,next:null},C===null?(S=C=V,b=P):C=C.next=V,d|=A;if(c=c.next,c===null){if(c=l.shared.pending,c===null)break;A=c,c=A.next,A.next=null,l.lastBaseUpdate=A,l.shared.pending=null}}while(!0);if(C===null&&(b=P),l.baseState=b,l.firstBaseUpdate=S,l.lastBaseUpdate=C,e=l.shared.interleaved,e!==null){l=e;do d|=l.lane,l=l.next;while(l!==e)}else h===null&&(l.shared.lanes=0);Vl|=d,t.lanes=d,t.memoizedState=P}}function eb(t,e,i){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],l=s.callback;if(l!==null){if(s.callback=null,s=i,typeof l!="function")throw Error(Gt(191,l));l.call(s)}}}var jd={},_o=Wa(jd),bd=Wa(jd),wd=Wa(jd);function Il(t){if(t===jd)throw Error(Gt(174));return t}function Z_(t,e){switch(Ii(wd,e),Ii(bd,t),Ii(_o,jd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:cy(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=cy(e,t)}Ri(_o),Ii(_o,e)}function ou(){Ri(_o),Ri(bd),Ri(wd)}function C5(t){Il(wd.current);var e=Il(_o.current),i=cy(e,t.type);e!==i&&(Ii(bd,t),Ii(_o,i))}function q_(t){bd.current===t&&(Ri(_o),Ri(bd))}var Wi=Wa(0);function mm(t){for(var e=t;e!==null;){if(e.tag===13){var i=e.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var P0=[];function G_(){for(var t=0;t<P0.length;t++)P0[t]._workInProgressVersionPrimary=null;P0.length=0}var Of=Jo.ReactCurrentDispatcher,I0=Jo.ReactCurrentBatchConfig,Bl=0,Yi=null,Cr=null,Nr=null,gm=!1,Xh=!1,Sd=0,UT=0;function un(){throw Error(Gt(321))}function W_(t,e){if(e===null)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!qs(t[i],e[i]))return!1;return!0}function Y_(t,e,i,s,l,h){if(Bl=h,Yi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Of.current=t===null||t.memoizedState===null?GT:WT,t=i(s,l),Xh){h=0;do{if(Xh=!1,Sd=0,25<=h)throw Error(Gt(301));h+=1,Nr=Cr=null,e.updateQueue=null,Of.current=YT,t=i(s,l)}while(Xh)}if(Of.current=ym,e=Cr!==null&&Cr.next!==null,Bl=0,Nr=Cr=Yi=null,gm=!1,e)throw Error(Gt(300));return t}function K_(){var t=Sd!==0;return Sd=0,t}function po(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nr===null?Yi.memoizedState=Nr=t:Nr=Nr.next=t,Nr}function Ts(){if(Cr===null){var t=Yi.alternate;t=t!==null?t.memoizedState:null}else t=Cr.next;var e=Nr===null?Yi.memoizedState:Nr.next;if(e!==null)Nr=e,Cr=t;else{if(t===null)throw Error(Gt(310));Cr=t,t={memoizedState:Cr.memoizedState,baseState:Cr.baseState,baseQueue:Cr.baseQueue,queue:Cr.queue,next:null},Nr===null?Yi.memoizedState=Nr=t:Nr=Nr.next=t}return Nr}function kd(t,e){return typeof e=="function"?e(t):e}function A0(t){var e=Ts(),i=e.queue;if(i===null)throw Error(Gt(311));i.lastRenderedReducer=t;var s=Cr,l=s.baseQueue,h=i.pending;if(h!==null){if(l!==null){var d=l.next;l.next=h.next,h.next=d}s.baseQueue=l=h,i.pending=null}if(l!==null){h=l.next,s=s.baseState;var c=d=null,b=null,S=h;do{var C=S.lane;if((Bl&C)===C)b!==null&&(b=b.next={lane:0,action:S.action,hasEagerState:S.hasEagerState,eagerState:S.eagerState,next:null}),s=S.hasEagerState?S.eagerState:t(s,S.action);else{var P={lane:C,action:S.action,hasEagerState:S.hasEagerState,eagerState:S.eagerState,next:null};b===null?(c=b=P,d=s):b=b.next=P,Yi.lanes|=C,Vl|=C}S=S.next}while(S!==null&&S!==h);b===null?d=s:b.next=c,qs(s,e.memoizedState)||(Bn=!0),e.memoizedState=s,e.baseState=d,e.baseQueue=b,i.lastRenderedState=s}if(t=i.interleaved,t!==null){l=t;do h=l.lane,Yi.lanes|=h,Vl|=h,l=l.next;while(l!==t)}else l===null&&(i.lanes=0);return[e.memoizedState,i.dispatch]}function z0(t){var e=Ts(),i=e.queue;if(i===null)throw Error(Gt(311));i.lastRenderedReducer=t;var s=i.dispatch,l=i.pending,h=e.memoizedState;if(l!==null){i.pending=null;var d=l=l.next;do h=t(h,d.action),d=d.next;while(d!==l);qs(h,e.memoizedState)||(Bn=!0),e.memoizedState=h,e.baseQueue===null&&(e.baseState=h),i.lastRenderedState=h}return[h,s]}function E5(){}function P5(t,e){var i=Yi,s=Ts(),l=e(),h=!qs(s.memoizedState,l);if(h&&(s.memoizedState=l,Bn=!0),s=s.queue,X_(z5.bind(null,i,s,t),[t]),s.getSnapshot!==e||h||Nr!==null&&Nr.memoizedState.tag&1){if(i.flags|=2048,Td(9,A5.bind(null,i,s,l,e),void 0,null),Ur===null)throw Error(Gt(349));Bl&30||I5(i,e,l)}return l}function I5(t,e,i){t.flags|=16384,t={getSnapshot:e,value:i},e=Yi.updateQueue,e===null?(e={lastEffect:null,stores:null},Yi.updateQueue=e,e.stores=[t]):(i=e.stores,i===null?e.stores=[t]:i.push(t))}function A5(t,e,i,s){e.value=i,e.getSnapshot=s,D5(e)&&L5(t)}function z5(t,e,i){return i(function(){D5(e)&&L5(t)})}function D5(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!qs(t,i)}catch{return!0}}function L5(t){var e=Ko(t,1);e!==null&&Hs(e,t,1,-1)}function ib(t){var e=po();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kd,lastRenderedState:t},e.queue=t,t=t.dispatch=qT.bind(null,Yi,t),[e.memoizedState,t]}function Td(t,e,i,s){return t={tag:t,create:e,destroy:i,deps:s,next:null},e=Yi.updateQueue,e===null?(e={lastEffect:null,stores:null},Yi.updateQueue=e,e.lastEffect=t.next=t):(i=e.lastEffect,i===null?e.lastEffect=t.next=t:(s=i.next,i.next=t,t.next=s,e.lastEffect=t)),t}function R5(){return Ts().memoizedState}function Bf(t,e,i,s){var l=po();Yi.flags|=t,l.memoizedState=Td(1|e,i,void 0,s===void 0?null:s)}function jm(t,e,i,s){var l=Ts();s=s===void 0?null:s;var h=void 0;if(Cr!==null){var d=Cr.memoizedState;if(h=d.destroy,s!==null&&W_(s,d.deps)){l.memoizedState=Td(e,i,h,s);return}}Yi.flags|=t,l.memoizedState=Td(1|e,i,h,s)}function rb(t,e){return Bf(8390656,8,t,e)}function X_(t,e){return jm(2048,8,t,e)}function F5(t,e){return jm(4,2,t,e)}function O5(t,e){return jm(4,4,t,e)}function B5(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function V5(t,e,i){return i=i!=null?i.concat([t]):null,jm(4,4,B5.bind(null,e,t),i)}function J_(){}function $5(t,e){var i=Ts();e=e===void 0?null:e;var s=i.memoizedState;return s!==null&&e!==null&&W_(e,s[1])?s[0]:(i.memoizedState=[t,e],t)}function N5(t,e){var i=Ts();e=e===void 0?null:e;var s=i.memoizedState;return s!==null&&e!==null&&W_(e,s[1])?s[0]:(t=t(),i.memoizedState=[t,e],t)}function j5(t,e,i){return Bl&21?(qs(i,e)||(i=G2(),Yi.lanes|=i,Vl|=i,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Bn=!0),t.memoizedState=i)}function HT(t,e){var i=gi;gi=i!==0&&4>i?i:4,t(!0);var s=I0.transition;I0.transition={};try{t(!1),e()}finally{gi=i,I0.transition=s}}function U5(){return Ts().memoizedState}function ZT(t,e,i){var s=Ba(t);if(i={lane:s,action:i,hasEagerState:!1,eagerState:null,next:null},H5(t))Z5(e,i);else if(i=T5(t,e,i,s),i!==null){var l=Mn();Hs(i,t,s,l),q5(i,e,s)}}function qT(t,e,i){var s=Ba(t),l={lane:s,action:i,hasEagerState:!1,eagerState:null,next:null};if(H5(t))Z5(e,l);else{var h=t.alternate;if(t.lanes===0&&(h===null||h.lanes===0)&&(h=e.lastRenderedReducer,h!==null))try{var d=e.lastRenderedState,c=h(d,i);if(l.hasEagerState=!0,l.eagerState=c,qs(c,d)){var b=e.interleaved;b===null?(l.next=l,U_(e)):(l.next=b.next,b.next=l),e.interleaved=l;return}}catch{}finally{}i=T5(t,e,l,s),i!==null&&(l=Mn(),Hs(i,t,s,l),q5(i,e,s))}}function H5(t){var e=t.alternate;return t===Yi||e!==null&&e===Yi}function Z5(t,e){Xh=gm=!0;var i=t.pending;i===null?e.next=e:(e.next=i.next,i.next=e),t.pending=e}function q5(t,e,i){if(i&4194240){var s=e.lanes;s&=t.pendingLanes,i|=s,e.lanes=i,P_(t,i)}}var ym={readContext:ks,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},GT={readContext:ks,useCallback:function(t,e){return po().memoizedState=[t,e===void 0?null:e],t},useContext:ks,useEffect:rb,useImperativeHandle:function(t,e,i){return i=i!=null?i.concat([t]):null,Bf(4194308,4,B5.bind(null,e,t),i)},useLayoutEffect:function(t,e){return Bf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Bf(4,2,t,e)},useMemo:function(t,e){var i=po();return e=e===void 0?null:e,t=t(),i.memoizedState=[t,e],t},useReducer:function(t,e,i){var s=po();return e=i!==void 0?i(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=ZT.bind(null,Yi,t),[s.memoizedState,t]},useRef:function(t){var e=po();return t={current:t},e.memoizedState=t},useState:ib,useDebugValue:J_,useDeferredValue:function(t){return po().memoizedState=t},useTransition:function(){var t=ib(!1),e=t[0];return t=HT.bind(null,t[1]),po().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,i){var s=Yi,l=po();if(Hi){if(i===void 0)throw Error(Gt(407));i=i()}else{if(i=e(),Ur===null)throw Error(Gt(349));Bl&30||I5(s,e,i)}l.memoizedState=i;var h={value:i,getSnapshot:e};return l.queue=h,rb(z5.bind(null,s,h,t),[t]),s.flags|=2048,Td(9,A5.bind(null,s,h,i,e),void 0,null),i},useId:function(){var t=po(),e=Ur.identifierPrefix;if(Hi){var i=Uo,s=jo;i=(s&~(1<<32-Us(s)-1)).toString(32)+i,e=":"+e+"R"+i,i=Sd++,0<i&&(e+="H"+i.toString(32)),e+=":"}else i=UT++,e=":"+e+"r"+i.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},WT={readContext:ks,useCallback:$5,useContext:ks,useEffect:X_,useImperativeHandle:V5,useInsertionEffect:F5,useLayoutEffect:O5,useMemo:N5,useReducer:A0,useRef:R5,useState:function(){return A0(kd)},useDebugValue:J_,useDeferredValue:function(t){var e=Ts();return j5(e,Cr.memoizedState,t)},useTransition:function(){var t=A0(kd)[0],e=Ts().memoizedState;return[t,e]},useMutableSource:E5,useSyncExternalStore:P5,useId:U5,unstable_isNewReconciler:!1},YT={readContext:ks,useCallback:$5,useContext:ks,useEffect:X_,useImperativeHandle:V5,useInsertionEffect:F5,useLayoutEffect:O5,useMemo:N5,useReducer:z0,useRef:R5,useState:function(){return z0(kd)},useDebugValue:J_,useDeferredValue:function(t){var e=Ts();return Cr===null?e.memoizedState=t:j5(e,Cr.memoizedState,t)},useTransition:function(){var t=z0(kd)[0],e=Ts().memoizedState;return[t,e]},useMutableSource:E5,useSyncExternalStore:P5,useId:U5,unstable_isNewReconciler:!1};function Vs(t,e){if(t&&t.defaultProps){e=Ki({},e),t=t.defaultProps;for(var i in t)e[i]===void 0&&(e[i]=t[i]);return e}return e}function Iy(t,e,i,s){e=t.memoizedState,i=i(s,e),i=i==null?e:Ki({},e,i),t.memoizedState=i,t.lanes===0&&(t.updateQueue.baseState=i)}var Um={isMounted:function(t){return(t=t._reactInternals)?Hl(t)===t:!1},enqueueSetState:function(t,e,i){t=t._reactInternals;var s=Mn(),l=Ba(t),h=Go(s,l);h.payload=e,i!=null&&(h.callback=i),e=Fa(t,h,l),e!==null&&(Hs(e,t,l,s),Ff(e,t,l))},enqueueReplaceState:function(t,e,i){t=t._reactInternals;var s=Mn(),l=Ba(t),h=Go(s,l);h.tag=1,h.payload=e,i!=null&&(h.callback=i),e=Fa(t,h,l),e!==null&&(Hs(e,t,l,s),Ff(e,t,l))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var i=Mn(),s=Ba(t),l=Go(i,s);l.tag=2,e!=null&&(l.callback=e),e=Fa(t,l,s),e!==null&&(Hs(e,t,s,i),Ff(e,t,s))}};function nb(t,e,i,s,l,h,d){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,h,d):e.prototype&&e.prototype.isPureReactComponent?!yd(i,s)||!yd(l,h):!0}function G5(t,e,i){var s=!1,l=Ua,h=e.contextType;return typeof h=="object"&&h!==null?h=ks(h):(l=$n(e)?Fl:mn.current,s=e.contextTypes,h=(s=s!=null)?ru(t,l):Ua),e=new e(i,h),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Um,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=l,t.__reactInternalMemoizedMaskedChildContext=h),e}function sb(t,e,i,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(i,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(i,s),e.state!==t&&Um.enqueueReplaceState(e,e.state,null)}function Ay(t,e,i,s){var l=t.stateNode;l.props=i,l.state=t.memoizedState,l.refs={},H_(t);var h=e.contextType;typeof h=="object"&&h!==null?l.context=ks(h):(h=$n(e)?Fl:mn.current,l.context=ru(t,h)),l.state=t.memoizedState,h=e.getDerivedStateFromProps,typeof h=="function"&&(Iy(t,e,h,i),l.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(e=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),e!==l.state&&Um.enqueueReplaceState(l,l.state,null),fm(t,i,l,s),l.state=t.memoizedState),typeof l.componentDidMount=="function"&&(t.flags|=4194308)}function au(t,e){try{var i="",s=e;do i+=Sk(s),s=s.return;while(s);var l=i}catch(h){l=`
Error generating stack: `+h.message+`
`+h.stack}return{value:t,source:e,stack:l,digest:null}}function D0(t,e,i){return{value:t,source:null,stack:i??null,digest:e??null}}function zy(t,e){try{console.error(e.value)}catch(i){setTimeout(function(){throw i})}}var KT=typeof WeakMap=="function"?WeakMap:Map;function W5(t,e,i){i=Go(-1,i),i.tag=3,i.payload={element:null};var s=e.value;return i.callback=function(){vm||(vm=!0,jy=s),zy(t,e)},i}function Y5(t,e,i){i=Go(-1,i),i.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var l=e.value;i.payload=function(){return s(l)},i.callback=function(){zy(t,e)}}var h=t.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(i.callback=function(){zy(t,e),typeof s!="function"&&(Oa===null?Oa=new Set([this]):Oa.add(this));var d=e.stack;this.componentDidCatch(e.value,{componentStack:d!==null?d:""})}),i}function ob(t,e,i){var s=t.pingCache;if(s===null){s=t.pingCache=new KT;var l=new Set;s.set(e,l)}else l=s.get(e),l===void 0&&(l=new Set,s.set(e,l));l.has(i)||(l.add(i),t=uM.bind(null,t,e,i),e.then(t,t))}function ab(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function lb(t,e,i,s,l){return t.mode&1?(t.flags|=65536,t.lanes=l,t):(t===e?t.flags|=65536:(t.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(e=Go(-1,1),e.tag=2,Fa(i,e,1))),i.lanes|=1),t)}var XT=Jo.ReactCurrentOwner,Bn=!1;function Tn(t,e,i,s){e.child=t===null?k5(e,null,i,s):su(e,t.child,i,s)}function cb(t,e,i,s,l){i=i.render;var h=e.ref;return Qc(e,l),s=Y_(t,e,i,s,h,l),i=K_(),t!==null&&!Bn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~l,Xo(t,e,l)):(Hi&&i&&O_(e),e.flags|=1,Tn(t,e,s,l),e.child)}function ub(t,e,i,s,l){if(t===null){var h=i.type;return typeof h=="function"&&!ov(h)&&h.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(e.tag=15,e.type=h,K5(t,e,h,s,l)):(t=jf(i.type,null,s,e,e.mode,l),t.ref=e.ref,t.return=e,e.child=t)}if(h=t.child,!(t.lanes&l)){var d=h.memoizedProps;if(i=i.compare,i=i!==null?i:yd,i(d,s)&&t.ref===e.ref)return Xo(t,e,l)}return e.flags|=1,t=Va(h,s),t.ref=e.ref,t.return=e,e.child=t}function K5(t,e,i,s,l){if(t!==null){var h=t.memoizedProps;if(yd(h,s)&&t.ref===e.ref)if(Bn=!1,e.pendingProps=s=h,(t.lanes&l)!==0)t.flags&131072&&(Bn=!0);else return e.lanes=t.lanes,Xo(t,e,l)}return Dy(t,e,i,s,l)}function X5(t,e,i){var s=e.pendingProps,l=s.children,h=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ii(Wc,ss),ss|=i;else{if(!(i&1073741824))return t=h!==null?h.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ii(Wc,ss),ss|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=h!==null?h.baseLanes:i,Ii(Wc,ss),ss|=s}else h!==null?(s=h.baseLanes|i,e.memoizedState=null):s=i,Ii(Wc,ss),ss|=s;return Tn(t,e,l,i),e.child}function J5(t,e){var i=e.ref;(t===null&&i!==null||t!==null&&t.ref!==i)&&(e.flags|=512,e.flags|=2097152)}function Dy(t,e,i,s,l){var h=$n(i)?Fl:mn.current;return h=ru(e,h),Qc(e,l),i=Y_(t,e,i,s,h,l),s=K_(),t!==null&&!Bn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~l,Xo(t,e,l)):(Hi&&s&&O_(e),e.flags|=1,Tn(t,e,i,l),e.child)}function hb(t,e,i,s,l){if($n(i)){var h=!0;cm(e)}else h=!1;if(Qc(e,l),e.stateNode===null)Vf(t,e),G5(e,i,s),Ay(e,i,s,l),s=!0;else if(t===null){var d=e.stateNode,c=e.memoizedProps;d.props=c;var b=d.context,S=i.contextType;typeof S=="object"&&S!==null?S=ks(S):(S=$n(i)?Fl:mn.current,S=ru(e,S));var C=i.getDerivedStateFromProps,P=typeof C=="function"||typeof d.getSnapshotBeforeUpdate=="function";P||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(c!==s||b!==S)&&sb(e,d,s,S),Sa=!1;var A=e.memoizedState;d.state=A,fm(e,s,d,l),b=e.memoizedState,c!==s||A!==b||Vn.current||Sa?(typeof C=="function"&&(Iy(e,i,C,s),b=e.memoizedState),(c=Sa||nb(e,i,c,s,A,b,S))?(P||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(e.flags|=4194308)):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=b),d.props=s,d.state=b,d.context=S,s=c):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{d=e.stateNode,M5(t,e),c=e.memoizedProps,S=e.type===e.elementType?c:Vs(e.type,c),d.props=S,P=e.pendingProps,A=d.context,b=i.contextType,typeof b=="object"&&b!==null?b=ks(b):(b=$n(i)?Fl:mn.current,b=ru(e,b));var V=i.getDerivedStateFromProps;(C=typeof V=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(c!==P||A!==b)&&sb(e,d,s,b),Sa=!1,A=e.memoizedState,d.state=A,fm(e,s,d,l);var W=e.memoizedState;c!==P||A!==W||Vn.current||Sa?(typeof V=="function"&&(Iy(e,i,V,s),W=e.memoizedState),(S=Sa||nb(e,i,S,s,A,W,b)||!1)?(C||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(s,W,b),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(s,W,b)),typeof d.componentDidUpdate=="function"&&(e.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof d.componentDidUpdate!="function"||c===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=W),d.props=s,d.state=W,d.context=b,s=S):(typeof d.componentDidUpdate!="function"||c===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),s=!1)}return Ly(t,e,i,s,h,l)}function Ly(t,e,i,s,l,h){J5(t,e);var d=(e.flags&128)!==0;if(!s&&!d)return l&&K1(e,i,!1),Xo(t,e,h);s=e.stateNode,XT.current=e;var c=d&&typeof i.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&d?(e.child=su(e,t.child,null,h),e.child=su(e,null,c,h)):Tn(t,e,c,h),e.memoizedState=s.state,l&&K1(e,i,!0),e.child}function Q5(t){var e=t.stateNode;e.pendingContext?Y1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Y1(t,e.context,!1),Z_(t,e.containerInfo)}function db(t,e,i,s,l){return nu(),V_(l),e.flags|=256,Tn(t,e,i,s),e.child}var Ry={dehydrated:null,treeContext:null,retryLane:0};function Fy(t){return{baseLanes:t,cachePool:null,transitions:null}}function tS(t,e,i){var s=e.pendingProps,l=Wi.current,h=!1,d=(e.flags&128)!==0,c;if((c=d)||(c=t!==null&&t.memoizedState===null?!1:(l&2)!==0),c?(h=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(l|=1),Ii(Wi,l&1),t===null)return Ey(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(d=s.children,t=s.fallback,h?(s=e.mode,h=e.child,d={mode:"hidden",children:d},!(s&1)&&h!==null?(h.childLanes=0,h.pendingProps=d):h=qm(d,s,0,null),t=Dl(t,s,i,null),h.return=e,t.return=e,h.sibling=t,e.child=h,e.child.memoizedState=Fy(i),e.memoizedState=Ry,t):Q_(e,d));if(l=t.memoizedState,l!==null&&(c=l.dehydrated,c!==null))return JT(t,e,d,s,c,l,i);if(h){h=s.fallback,d=e.mode,l=t.child,c=l.sibling;var b={mode:"hidden",children:s.children};return!(d&1)&&e.child!==l?(s=e.child,s.childLanes=0,s.pendingProps=b,e.deletions=null):(s=Va(l,b),s.subtreeFlags=l.subtreeFlags&14680064),c!==null?h=Va(c,h):(h=Dl(h,d,i,null),h.flags|=2),h.return=e,s.return=e,s.sibling=h,e.child=s,s=h,h=e.child,d=t.child.memoizedState,d=d===null?Fy(i):{baseLanes:d.baseLanes|i,cachePool:null,transitions:d.transitions},h.memoizedState=d,h.childLanes=t.childLanes&~i,e.memoizedState=Ry,s}return h=t.child,t=h.sibling,s=Va(h,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=i),s.return=e,s.sibling=null,t!==null&&(i=e.deletions,i===null?(e.deletions=[t],e.flags|=16):i.push(t)),e.child=s,e.memoizedState=null,s}function Q_(t,e){return e=qm({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function df(t,e,i,s){return s!==null&&V_(s),su(e,t.child,null,i),t=Q_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function JT(t,e,i,s,l,h,d){if(i)return e.flags&256?(e.flags&=-257,s=D0(Error(Gt(422))),df(t,e,d,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(h=s.fallback,l=e.mode,s=qm({mode:"visible",children:s.children},l,0,null),h=Dl(h,l,d,null),h.flags|=2,s.return=e,h.return=e,s.sibling=h,e.child=s,e.mode&1&&su(e,t.child,null,d),e.child.memoizedState=Fy(d),e.memoizedState=Ry,h);if(!(e.mode&1))return df(t,e,d,null);if(l.data==="$!"){if(s=l.nextSibling&&l.nextSibling.dataset,s)var c=s.dgst;return s=c,h=Error(Gt(419)),s=D0(h,s,void 0),df(t,e,d,s)}if(c=(d&t.childLanes)!==0,Bn||c){if(s=Ur,s!==null){switch(d&-d){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(s.suspendedLanes|d)?0:l,l!==0&&l!==h.retryLane&&(h.retryLane=l,Ko(t,l),Hs(s,t,l,-1))}return sv(),s=D0(Error(Gt(421))),df(t,e,d,s)}return l.data==="$?"?(e.flags|=128,e.child=t.child,e=hM.bind(null,t),l._reactRetry=e,null):(t=h.treeContext,as=Ra(l.nextSibling),ls=e,Hi=!0,Ns=null,t!==null&&(_s[vs++]=jo,_s[vs++]=Uo,_s[vs++]=Ol,jo=t.id,Uo=t.overflow,Ol=e),e=Q_(e,s.children),e.flags|=4096,e)}function pb(t,e,i){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),Py(t.return,e,i)}function L0(t,e,i,s,l){var h=t.memoizedState;h===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:i,tailMode:l}:(h.isBackwards=e,h.rendering=null,h.renderingStartTime=0,h.last=s,h.tail=i,h.tailMode=l)}function eS(t,e,i){var s=e.pendingProps,l=s.revealOrder,h=s.tail;if(Tn(t,e,s.children,i),s=Wi.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)t:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&pb(t,i,e);else if(t.tag===19)pb(t,i,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;t.sibling===null;){if(t.return===null||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(Ii(Wi,s),!(e.mode&1))e.memoizedState=null;else switch(l){case"forwards":for(i=e.child,l=null;i!==null;)t=i.alternate,t!==null&&mm(t)===null&&(l=i),i=i.sibling;i=l,i===null?(l=e.child,e.child=null):(l=i.sibling,i.sibling=null),L0(e,!1,l,i,h);break;case"backwards":for(i=null,l=e.child,e.child=null;l!==null;){if(t=l.alternate,t!==null&&mm(t)===null){e.child=l;break}t=l.sibling,l.sibling=i,i=l,l=t}L0(e,!0,i,null,h);break;case"together":L0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Vf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Xo(t,e,i){if(t!==null&&(e.dependencies=t.dependencies),Vl|=e.lanes,!(i&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Gt(153));if(e.child!==null){for(t=e.child,i=Va(t,t.pendingProps),e.child=i,i.return=e;t.sibling!==null;)t=t.sibling,i=i.sibling=Va(t,t.pendingProps),i.return=e;i.sibling=null}return e.child}function QT(t,e,i){switch(e.tag){case 3:Q5(e),nu();break;case 5:C5(e);break;case 1:$n(e.type)&&cm(e);break;case 4:Z_(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,l=e.memoizedProps.value;Ii(dm,s._currentValue),s._currentValue=l;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Ii(Wi,Wi.current&1),e.flags|=128,null):i&e.child.childLanes?tS(t,e,i):(Ii(Wi,Wi.current&1),t=Xo(t,e,i),t!==null?t.sibling:null);Ii(Wi,Wi.current&1);break;case 19:if(s=(i&e.childLanes)!==0,t.flags&128){if(s)return eS(t,e,i);e.flags|=128}if(l=e.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),Ii(Wi,Wi.current),s)break;return null;case 22:case 23:return e.lanes=0,X5(t,e,i)}return Xo(t,e,i)}var iS,Oy,rS,nS;iS=function(t,e){for(var i=e.child;i!==null;){if(i.tag===5||i.tag===6)t.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};Oy=function(){};rS=function(t,e,i,s){var l=t.memoizedProps;if(l!==s){t=e.stateNode,Il(_o.current);var h=null;switch(i){case"input":l=sy(t,l),s=sy(t,s),h=[];break;case"select":l=Ki({},l,{value:void 0}),s=Ki({},s,{value:void 0}),h=[];break;case"textarea":l=ly(t,l),s=ly(t,s),h=[];break;default:typeof l.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=am)}uy(i,s);var d;i=null;for(S in l)if(!s.hasOwnProperty(S)&&l.hasOwnProperty(S)&&l[S]!=null)if(S==="style"){var c=l[S];for(d in c)c.hasOwnProperty(d)&&(i||(i={}),i[d]="")}else S!=="dangerouslySetInnerHTML"&&S!=="children"&&S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(ud.hasOwnProperty(S)?h||(h=[]):(h=h||[]).push(S,null));for(S in s){var b=s[S];if(c=l!=null?l[S]:void 0,s.hasOwnProperty(S)&&b!==c&&(b!=null||c!=null))if(S==="style")if(c){for(d in c)!c.hasOwnProperty(d)||b&&b.hasOwnProperty(d)||(i||(i={}),i[d]="");for(d in b)b.hasOwnProperty(d)&&c[d]!==b[d]&&(i||(i={}),i[d]=b[d])}else i||(h||(h=[]),h.push(S,i)),i=b;else S==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,c=c?c.__html:void 0,b!=null&&c!==b&&(h=h||[]).push(S,b)):S==="children"?typeof b!="string"&&typeof b!="number"||(h=h||[]).push(S,""+b):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&(ud.hasOwnProperty(S)?(b!=null&&S==="onScroll"&&Li("scroll",t),h||c===b||(h=[])):(h=h||[]).push(S,b))}i&&(h=h||[]).push("style",i);var S=h;(e.updateQueue=S)&&(e.flags|=4)}};nS=function(t,e,i,s){i!==s&&(e.flags|=4)};function Eh(t,e){if(!Hi)switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;e!==null;)e.alternate!==null&&(i=e),e=e.sibling;i===null?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var s=null;i!==null;)i.alternate!==null&&(s=i),i=i.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function hn(t){var e=t.alternate!==null&&t.alternate.child===t.child,i=0,s=0;if(e)for(var l=t.child;l!==null;)i|=l.lanes|l.childLanes,s|=l.subtreeFlags&14680064,s|=l.flags&14680064,l.return=t,l=l.sibling;else for(l=t.child;l!==null;)i|=l.lanes|l.childLanes,s|=l.subtreeFlags,s|=l.flags,l.return=t,l=l.sibling;return t.subtreeFlags|=s,t.childLanes=i,e}function tM(t,e,i){var s=e.pendingProps;switch(B_(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hn(e),null;case 1:return $n(e.type)&&lm(),hn(e),null;case 3:return s=e.stateNode,ou(),Ri(Vn),Ri(mn),G_(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(uf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ns!==null&&(Zy(Ns),Ns=null))),Oy(t,e),hn(e),null;case 5:q_(e);var l=Il(wd.current);if(i=e.type,t!==null&&e.stateNode!=null)rS(t,e,i,s,l),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(Gt(166));return hn(e),null}if(t=Il(_o.current),uf(e)){s=e.stateNode,i=e.type;var h=e.memoizedProps;switch(s[go]=e,s[xd]=h,t=(e.mode&1)!==0,i){case"dialog":Li("cancel",s),Li("close",s);break;case"iframe":case"object":case"embed":Li("load",s);break;case"video":case"audio":for(l=0;l<Vh.length;l++)Li(Vh[l],s);break;case"source":Li("error",s);break;case"img":case"image":case"link":Li("error",s),Li("load",s);break;case"details":Li("toggle",s);break;case"input":w1(s,h),Li("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!h.multiple},Li("invalid",s);break;case"textarea":k1(s,h),Li("invalid",s)}uy(i,h),l=null;for(var d in h)if(h.hasOwnProperty(d)){var c=h[d];d==="children"?typeof c=="string"?s.textContent!==c&&(h.suppressHydrationWarning!==!0&&cf(s.textContent,c,t),l=["children",c]):typeof c=="number"&&s.textContent!==""+c&&(h.suppressHydrationWarning!==!0&&cf(s.textContent,c,t),l=["children",""+c]):ud.hasOwnProperty(d)&&c!=null&&d==="onScroll"&&Li("scroll",s)}switch(i){case"input":tf(s),S1(s,h,!0);break;case"textarea":tf(s),T1(s);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(s.onclick=am)}s=l,e.updateQueue=s,s!==null&&(e.flags|=4)}else{d=l.nodeType===9?l:l.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=z2(i)),t==="http://www.w3.org/1999/xhtml"?i==="script"?(t=d.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=d.createElement(i,{is:s.is}):(t=d.createElement(i),i==="select"&&(d=t,s.multiple?d.multiple=!0:s.size&&(d.size=s.size))):t=d.createElementNS(t,i),t[go]=e,t[xd]=s,iS(t,e,!1,!1),e.stateNode=t;t:{switch(d=hy(i,s),i){case"dialog":Li("cancel",t),Li("close",t),l=s;break;case"iframe":case"object":case"embed":Li("load",t),l=s;break;case"video":case"audio":for(l=0;l<Vh.length;l++)Li(Vh[l],t);l=s;break;case"source":Li("error",t),l=s;break;case"img":case"image":case"link":Li("error",t),Li("load",t),l=s;break;case"details":Li("toggle",t),l=s;break;case"input":w1(t,s),l=sy(t,s),Li("invalid",t);break;case"option":l=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},l=Ki({},s,{value:void 0}),Li("invalid",t);break;case"textarea":k1(t,s),l=ly(t,s),Li("invalid",t);break;default:l=s}uy(i,l),c=l;for(h in c)if(c.hasOwnProperty(h)){var b=c[h];h==="style"?R2(t,b):h==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,b!=null&&D2(t,b)):h==="children"?typeof b=="string"?(i!=="textarea"||b!=="")&&hd(t,b):typeof b=="number"&&hd(t,""+b):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(ud.hasOwnProperty(h)?b!=null&&h==="onScroll"&&Li("scroll",t):b!=null&&S_(t,h,b,d))}switch(i){case"input":tf(t),S1(t,s,!1);break;case"textarea":tf(t),T1(t);break;case"option":s.value!=null&&t.setAttribute("value",""+ja(s.value));break;case"select":t.multiple=!!s.multiple,h=s.value,h!=null?Yc(t,!!s.multiple,h,!1):s.defaultValue!=null&&Yc(t,!!s.multiple,s.defaultValue,!0);break;default:typeof l.onClick=="function"&&(t.onclick=am)}switch(i){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break t;case"img":s=!0;break t;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return hn(e),null;case 6:if(t&&e.stateNode!=null)nS(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(Gt(166));if(i=Il(wd.current),Il(_o.current),uf(e)){if(s=e.stateNode,i=e.memoizedProps,s[go]=e,(h=s.nodeValue!==i)&&(t=ls,t!==null))switch(t.tag){case 3:cf(s.nodeValue,i,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&cf(s.nodeValue,i,(t.mode&1)!==0)}h&&(e.flags|=4)}else s=(i.nodeType===9?i:i.ownerDocument).createTextNode(s),s[go]=e,e.stateNode=s}return hn(e),null;case 13:if(Ri(Wi),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Hi&&as!==null&&e.mode&1&&!(e.flags&128))w5(),nu(),e.flags|=98560,h=!1;else if(h=uf(e),s!==null&&s.dehydrated!==null){if(t===null){if(!h)throw Error(Gt(318));if(h=e.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(Gt(317));h[go]=e}else nu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;hn(e),h=!1}else Ns!==null&&(Zy(Ns),Ns=null),h=!0;if(!h)return e.flags&65536?e:null}return e.flags&128?(e.lanes=i,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Wi.current&1?Er===0&&(Er=3):sv())),e.updateQueue!==null&&(e.flags|=4),hn(e),null);case 4:return ou(),Oy(t,e),t===null&&_d(e.stateNode.containerInfo),hn(e),null;case 10:return j_(e.type._context),hn(e),null;case 17:return $n(e.type)&&lm(),hn(e),null;case 19:if(Ri(Wi),h=e.memoizedState,h===null)return hn(e),null;if(s=(e.flags&128)!==0,d=h.rendering,d===null)if(s)Eh(h,!1);else{if(Er!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(d=mm(t),d!==null){for(e.flags|=128,Eh(h,!1),s=d.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=i,i=e.child;i!==null;)h=i,t=s,h.flags&=14680066,d=h.alternate,d===null?(h.childLanes=0,h.lanes=t,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=d.childLanes,h.lanes=d.lanes,h.child=d.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=d.memoizedProps,h.memoizedState=d.memoizedState,h.updateQueue=d.updateQueue,h.type=d.type,t=d.dependencies,h.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),i=i.sibling;return Ii(Wi,Wi.current&1|2),e.child}t=t.sibling}h.tail!==null&&ur()>lu&&(e.flags|=128,s=!0,Eh(h,!1),e.lanes=4194304)}else{if(!s)if(t=mm(d),t!==null){if(e.flags|=128,s=!0,i=t.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),Eh(h,!0),h.tail===null&&h.tailMode==="hidden"&&!d.alternate&&!Hi)return hn(e),null}else 2*ur()-h.renderingStartTime>lu&&i!==1073741824&&(e.flags|=128,s=!0,Eh(h,!1),e.lanes=4194304);h.isBackwards?(d.sibling=e.child,e.child=d):(i=h.last,i!==null?i.sibling=d:e.child=d,h.last=d)}return h.tail!==null?(e=h.tail,h.rendering=e,h.tail=e.sibling,h.renderingStartTime=ur(),e.sibling=null,i=Wi.current,Ii(Wi,s?i&1|2:i&1),e):(hn(e),null);case 22:case 23:return nv(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?ss&1073741824&&(hn(e),e.subtreeFlags&6&&(e.flags|=8192)):hn(e),null;case 24:return null;case 25:return null}throw Error(Gt(156,e.tag))}function eM(t,e){switch(B_(e),e.tag){case 1:return $n(e.type)&&lm(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ou(),Ri(Vn),Ri(mn),G_(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return q_(e),null;case 13:if(Ri(Wi),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Gt(340));nu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ri(Wi),null;case 4:return ou(),null;case 10:return j_(e.type._context),null;case 22:case 23:return nv(),null;case 24:return null;default:return null}}var pf=!1,pn=!1,iM=typeof WeakSet=="function"?WeakSet:Set,ye=null;function Gc(t,e){var i=t.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(s){ir(t,e,s)}else i.current=null}function By(t,e,i){try{i()}catch(s){ir(t,e,s)}}var fb=!1;function rM(t,e){if(by=nm,t=c5(),F_(t)){if("selectionStart"in t)var i={start:t.selectionStart,end:t.selectionEnd};else t:{i=(i=t.ownerDocument)&&i.defaultView||window;var s=i.getSelection&&i.getSelection();if(s&&s.rangeCount!==0){i=s.anchorNode;var l=s.anchorOffset,h=s.focusNode;s=s.focusOffset;try{i.nodeType,h.nodeType}catch{i=null;break t}var d=0,c=-1,b=-1,S=0,C=0,P=t,A=null;e:for(;;){for(var V;P!==i||l!==0&&P.nodeType!==3||(c=d+l),P!==h||s!==0&&P.nodeType!==3||(b=d+s),P.nodeType===3&&(d+=P.nodeValue.length),(V=P.firstChild)!==null;)A=P,P=V;for(;;){if(P===t)break e;if(A===i&&++S===l&&(c=d),A===h&&++C===s&&(b=d),(V=P.nextSibling)!==null)break;P=A,A=P.parentNode}P=V}i=c===-1||b===-1?null:{start:c,end:b}}else i=null}i=i||{start:0,end:0}}else i=null;for(wy={focusedElem:t,selectionRange:i},nm=!1,ye=e;ye!==null;)if(e=ye,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ye=t;else for(;ye!==null;){e=ye;try{var W=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(W!==null){var $=W.memoizedProps,nt=W.memoizedState,H=e.stateNode,Y=H.getSnapshotBeforeUpdate(e.elementType===e.type?$:Vs(e.type,$),nt);H.__reactInternalSnapshotBeforeUpdate=Y}break;case 3:var K=e.stateNode.containerInfo;K.nodeType===1?K.textContent="":K.nodeType===9&&K.documentElement&&K.removeChild(K.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Gt(163))}}catch(at){ir(e,e.return,at)}if(t=e.sibling,t!==null){t.return=e.return,ye=t;break}ye=e.return}return W=fb,fb=!1,W}function Jh(t,e,i){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var l=s=s.next;do{if((l.tag&t)===t){var h=l.destroy;l.destroy=void 0,h!==void 0&&By(e,i,h)}l=l.next}while(l!==s)}}function Hm(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var i=e=e.next;do{if((i.tag&t)===t){var s=i.create;i.destroy=s()}i=i.next}while(i!==e)}}function Vy(t){var e=t.ref;if(e!==null){var i=t.stateNode;switch(t.tag){case 5:t=i;break;default:t=i}typeof e=="function"?e(t):e.current=t}}function sS(t){var e=t.alternate;e!==null&&(t.alternate=null,sS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[go],delete e[xd],delete e[Ty],delete e[VT],delete e[$T])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function oS(t){return t.tag===5||t.tag===3||t.tag===4}function mb(t){t:for(;;){for(;t.sibling===null;){if(t.return===null||oS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue t;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function $y(t,e,i){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?i.nodeType===8?i.parentNode.insertBefore(t,e):i.insertBefore(t,e):(i.nodeType===8?(e=i.parentNode,e.insertBefore(t,i)):(e=i,e.appendChild(t)),i=i._reactRootContainer,i!=null||e.onclick!==null||(e.onclick=am));else if(s!==4&&(t=t.child,t!==null))for($y(t,e,i),t=t.sibling;t!==null;)$y(t,e,i),t=t.sibling}function Ny(t,e,i){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?i.insertBefore(t,e):i.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Ny(t,e,i),t=t.sibling;t!==null;)Ny(t,e,i),t=t.sibling}var tn=null,$s=!1;function ba(t,e,i){for(i=i.child;i!==null;)aS(t,e,i),i=i.sibling}function aS(t,e,i){if(yo&&typeof yo.onCommitFiberUnmount=="function")try{yo.onCommitFiberUnmount(Fm,i)}catch{}switch(i.tag){case 5:pn||Gc(i,e);case 6:var s=tn,l=$s;tn=null,ba(t,e,i),tn=s,$s=l,tn!==null&&($s?(t=tn,i=i.stateNode,t.nodeType===8?t.parentNode.removeChild(i):t.removeChild(i)):tn.removeChild(i.stateNode));break;case 18:tn!==null&&($s?(t=tn,i=i.stateNode,t.nodeType===8?C0(t.parentNode,i):t.nodeType===1&&C0(t,i),md(t)):C0(tn,i.stateNode));break;case 4:s=tn,l=$s,tn=i.stateNode.containerInfo,$s=!0,ba(t,e,i),tn=s,$s=l;break;case 0:case 11:case 14:case 15:if(!pn&&(s=i.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){l=s=s.next;do{var h=l,d=h.destroy;h=h.tag,d!==void 0&&(h&2||h&4)&&By(i,e,d),l=l.next}while(l!==s)}ba(t,e,i);break;case 1:if(!pn&&(Gc(i,e),s=i.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=i.memoizedProps,s.state=i.memoizedState,s.componentWillUnmount()}catch(c){ir(i,e,c)}ba(t,e,i);break;case 21:ba(t,e,i);break;case 22:i.mode&1?(pn=(s=pn)||i.memoizedState!==null,ba(t,e,i),pn=s):ba(t,e,i);break;default:ba(t,e,i)}}function gb(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var i=t.stateNode;i===null&&(i=t.stateNode=new iM),e.forEach(function(s){var l=dM.bind(null,t,s);i.has(s)||(i.add(s),s.then(l,l))})}}function Fs(t,e){var i=e.deletions;if(i!==null)for(var s=0;s<i.length;s++){var l=i[s];try{var h=t,d=e,c=d;t:for(;c!==null;){switch(c.tag){case 5:tn=c.stateNode,$s=!1;break t;case 3:tn=c.stateNode.containerInfo,$s=!0;break t;case 4:tn=c.stateNode.containerInfo,$s=!0;break t}c=c.return}if(tn===null)throw Error(Gt(160));aS(h,d,l),tn=null,$s=!1;var b=l.alternate;b!==null&&(b.return=null),l.return=null}catch(S){ir(l,e,S)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)lS(e,t),e=e.sibling}function lS(t,e){var i=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Fs(e,t),uo(t),s&4){try{Jh(3,t,t.return),Hm(3,t)}catch($){ir(t,t.return,$)}try{Jh(5,t,t.return)}catch($){ir(t,t.return,$)}}break;case 1:Fs(e,t),uo(t),s&512&&i!==null&&Gc(i,i.return);break;case 5:if(Fs(e,t),uo(t),s&512&&i!==null&&Gc(i,i.return),t.flags&32){var l=t.stateNode;try{hd(l,"")}catch($){ir(t,t.return,$)}}if(s&4&&(l=t.stateNode,l!=null)){var h=t.memoizedProps,d=i!==null?i.memoizedProps:h,c=t.type,b=t.updateQueue;if(t.updateQueue=null,b!==null)try{c==="input"&&h.type==="radio"&&h.name!=null&&I2(l,h),hy(c,d);var S=hy(c,h);for(d=0;d<b.length;d+=2){var C=b[d],P=b[d+1];C==="style"?R2(l,P):C==="dangerouslySetInnerHTML"?D2(l,P):C==="children"?hd(l,P):S_(l,C,P,S)}switch(c){case"input":oy(l,h);break;case"textarea":A2(l,h);break;case"select":var A=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!h.multiple;var V=h.value;V!=null?Yc(l,!!h.multiple,V,!1):A!==!!h.multiple&&(h.defaultValue!=null?Yc(l,!!h.multiple,h.defaultValue,!0):Yc(l,!!h.multiple,h.multiple?[]:"",!1))}l[xd]=h}catch($){ir(t,t.return,$)}}break;case 6:if(Fs(e,t),uo(t),s&4){if(t.stateNode===null)throw Error(Gt(162));l=t.stateNode,h=t.memoizedProps;try{l.nodeValue=h}catch($){ir(t,t.return,$)}}break;case 3:if(Fs(e,t),uo(t),s&4&&i!==null&&i.memoizedState.isDehydrated)try{md(e.containerInfo)}catch($){ir(t,t.return,$)}break;case 4:Fs(e,t),uo(t);break;case 13:Fs(e,t),uo(t),l=t.child,l.flags&8192&&(h=l.memoizedState!==null,l.stateNode.isHidden=h,!h||l.alternate!==null&&l.alternate.memoizedState!==null||(iv=ur())),s&4&&gb(t);break;case 22:if(C=i!==null&&i.memoizedState!==null,t.mode&1?(pn=(S=pn)||C,Fs(e,t),pn=S):Fs(e,t),uo(t),s&8192){if(S=t.memoizedState!==null,(t.stateNode.isHidden=S)&&!C&&t.mode&1)for(ye=t,C=t.child;C!==null;){for(P=ye=C;ye!==null;){switch(A=ye,V=A.child,A.tag){case 0:case 11:case 14:case 15:Jh(4,A,A.return);break;case 1:Gc(A,A.return);var W=A.stateNode;if(typeof W.componentWillUnmount=="function"){s=A,i=A.return;try{e=s,W.props=e.memoizedProps,W.state=e.memoizedState,W.componentWillUnmount()}catch($){ir(s,i,$)}}break;case 5:Gc(A,A.return);break;case 22:if(A.memoizedState!==null){_b(P);continue}}V!==null?(V.return=A,ye=V):_b(P)}C=C.sibling}t:for(C=null,P=t;;){if(P.tag===5){if(C===null){C=P;try{l=P.stateNode,S?(h=l.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(c=P.stateNode,b=P.memoizedProps.style,d=b!=null&&b.hasOwnProperty("display")?b.display:null,c.style.display=L2("display",d))}catch($){ir(t,t.return,$)}}}else if(P.tag===6){if(C===null)try{P.stateNode.nodeValue=S?"":P.memoizedProps}catch($){ir(t,t.return,$)}}else if((P.tag!==22&&P.tag!==23||P.memoizedState===null||P===t)&&P.child!==null){P.child.return=P,P=P.child;continue}if(P===t)break t;for(;P.sibling===null;){if(P.return===null||P.return===t)break t;C===P&&(C=null),P=P.return}C===P&&(C=null),P.sibling.return=P.return,P=P.sibling}}break;case 19:Fs(e,t),uo(t),s&4&&gb(t);break;case 21:break;default:Fs(e,t),uo(t)}}function uo(t){var e=t.flags;if(e&2){try{t:{for(var i=t.return;i!==null;){if(oS(i)){var s=i;break t}i=i.return}throw Error(Gt(160))}switch(s.tag){case 5:var l=s.stateNode;s.flags&32&&(hd(l,""),s.flags&=-33);var h=mb(t);Ny(t,h,l);break;case 3:case 4:var d=s.stateNode.containerInfo,c=mb(t);$y(t,c,d);break;default:throw Error(Gt(161))}}catch(b){ir(t,t.return,b)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function nM(t,e,i){ye=t,cS(t)}function cS(t,e,i){for(var s=(t.mode&1)!==0;ye!==null;){var l=ye,h=l.child;if(l.tag===22&&s){var d=l.memoizedState!==null||pf;if(!d){var c=l.alternate,b=c!==null&&c.memoizedState!==null||pn;c=pf;var S=pn;if(pf=d,(pn=b)&&!S)for(ye=l;ye!==null;)d=ye,b=d.child,d.tag===22&&d.memoizedState!==null?vb(l):b!==null?(b.return=d,ye=b):vb(l);for(;h!==null;)ye=h,cS(h),h=h.sibling;ye=l,pf=c,pn=S}yb(t)}else l.subtreeFlags&8772&&h!==null?(h.return=l,ye=h):yb(t)}}function yb(t){for(;ye!==null;){var e=ye;if(e.flags&8772){var i=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:pn||Hm(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!pn)if(i===null)s.componentDidMount();else{var l=e.elementType===e.type?i.memoizedProps:Vs(e.type,i.memoizedProps);s.componentDidUpdate(l,i.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var h=e.updateQueue;h!==null&&eb(e,h,s);break;case 3:var d=e.updateQueue;if(d!==null){if(i=null,e.child!==null)switch(e.child.tag){case 5:i=e.child.stateNode;break;case 1:i=e.child.stateNode}eb(e,d,i)}break;case 5:var c=e.stateNode;if(i===null&&e.flags&4){i=c;var b=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":b.autoFocus&&i.focus();break;case"img":b.src&&(i.src=b.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var S=e.alternate;if(S!==null){var C=S.memoizedState;if(C!==null){var P=C.dehydrated;P!==null&&md(P)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Gt(163))}pn||e.flags&512&&Vy(e)}catch(A){ir(e,e.return,A)}}if(e===t){ye=null;break}if(i=e.sibling,i!==null){i.return=e.return,ye=i;break}ye=e.return}}function _b(t){for(;ye!==null;){var e=ye;if(e===t){ye=null;break}var i=e.sibling;if(i!==null){i.return=e.return,ye=i;break}ye=e.return}}function vb(t){for(;ye!==null;){var e=ye;try{switch(e.tag){case 0:case 11:case 15:var i=e.return;try{Hm(4,e)}catch(b){ir(e,i,b)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var l=e.return;try{s.componentDidMount()}catch(b){ir(e,l,b)}}var h=e.return;try{Vy(e)}catch(b){ir(e,h,b)}break;case 5:var d=e.return;try{Vy(e)}catch(b){ir(e,d,b)}}}catch(b){ir(e,e.return,b)}if(e===t){ye=null;break}var c=e.sibling;if(c!==null){c.return=e.return,ye=c;break}ye=e.return}}var sM=Math.ceil,_m=Jo.ReactCurrentDispatcher,tv=Jo.ReactCurrentOwner,ws=Jo.ReactCurrentBatchConfig,si=0,Ur=null,yr=null,en=0,ss=0,Wc=Wa(0),Er=0,Md=null,Vl=0,Zm=0,ev=0,Qh=null,Rn=null,iv=0,lu=1/0,Bo=null,vm=!1,jy=null,Oa=null,ff=!1,Ca=null,xm=0,td=0,Uy=null,$f=-1,Nf=0;function Mn(){return si&6?ur():$f!==-1?$f:$f=ur()}function Ba(t){return t.mode&1?si&2&&en!==0?en&-en:jT.transition!==null?(Nf===0&&(Nf=G2()),Nf):(t=gi,t!==0||(t=window.event,t=t===void 0?16:t5(t.type)),t):1}function Hs(t,e,i,s){if(50<td)throw td=0,Uy=null,Error(Gt(185));Vd(t,i,s),(!(si&2)||t!==Ur)&&(t===Ur&&(!(si&2)&&(Zm|=i),Er===4&&Ta(t,en)),Nn(t,s),i===1&&si===0&&!(e.mode&1)&&(lu=ur()+500,Nm&&Ya()))}function Nn(t,e){var i=t.callbackNode;jk(t,e);var s=rm(t,t===Ur?en:0);if(s===0)i!==null&&E1(i),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(i!=null&&E1(i),e===1)t.tag===0?NT(xb.bind(null,t)):v5(xb.bind(null,t)),OT(function(){!(si&6)&&Ya()}),i=null;else{switch(W2(s)){case 1:i=E_;break;case 4:i=Z2;break;case 16:i=im;break;case 536870912:i=q2;break;default:i=im}i=yS(i,uS.bind(null,t))}t.callbackPriority=e,t.callbackNode=i}}function uS(t,e){if($f=-1,Nf=0,si&6)throw Error(Gt(327));var i=t.callbackNode;if(tu()&&t.callbackNode!==i)return null;var s=rm(t,t===Ur?en:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=bm(t,s);else{e=s;var l=si;si|=2;var h=dS();(Ur!==t||en!==e)&&(Bo=null,lu=ur()+500,zl(t,e));do try{lM();break}catch(c){hS(t,c)}while(!0);N_(),_m.current=h,si=l,yr!==null?e=0:(Ur=null,en=0,e=Er)}if(e!==0){if(e===2&&(l=gy(t),l!==0&&(s=l,e=Hy(t,l))),e===1)throw i=Md,zl(t,0),Ta(t,s),Nn(t,ur()),i;if(e===6)Ta(t,s);else{if(l=t.current.alternate,!(s&30)&&!oM(l)&&(e=bm(t,s),e===2&&(h=gy(t),h!==0&&(s=h,e=Hy(t,h))),e===1))throw i=Md,zl(t,0),Ta(t,s),Nn(t,ur()),i;switch(t.finishedWork=l,t.finishedLanes=s,e){case 0:case 1:throw Error(Gt(345));case 2:Ml(t,Rn,Bo);break;case 3:if(Ta(t,s),(s&130023424)===s&&(e=iv+500-ur(),10<e)){if(rm(t,0)!==0)break;if(l=t.suspendedLanes,(l&s)!==s){Mn(),t.pingedLanes|=t.suspendedLanes&l;break}t.timeoutHandle=ky(Ml.bind(null,t,Rn,Bo),e);break}Ml(t,Rn,Bo);break;case 4:if(Ta(t,s),(s&4194240)===s)break;for(e=t.eventTimes,l=-1;0<s;){var d=31-Us(s);h=1<<d,d=e[d],d>l&&(l=d),s&=~h}if(s=l,s=ur()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*sM(s/1960))-s,10<s){t.timeoutHandle=ky(Ml.bind(null,t,Rn,Bo),s);break}Ml(t,Rn,Bo);break;case 5:Ml(t,Rn,Bo);break;default:throw Error(Gt(329))}}}return Nn(t,ur()),t.callbackNode===i?uS.bind(null,t):null}function Hy(t,e){var i=Qh;return t.current.memoizedState.isDehydrated&&(zl(t,e).flags|=256),t=bm(t,e),t!==2&&(e=Rn,Rn=i,e!==null&&Zy(e)),t}function Zy(t){Rn===null?Rn=t:Rn.push.apply(Rn,t)}function oM(t){for(var e=t;;){if(e.flags&16384){var i=e.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var s=0;s<i.length;s++){var l=i[s],h=l.getSnapshot;l=l.value;try{if(!qs(h(),l))return!1}catch{return!1}}}if(i=e.child,e.subtreeFlags&16384&&i!==null)i.return=e,e=i;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ta(t,e){for(e&=~ev,e&=~Zm,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var i=31-Us(e),s=1<<i;t[i]=-1,e&=~s}}function xb(t){if(si&6)throw Error(Gt(327));tu();var e=rm(t,0);if(!(e&1))return Nn(t,ur()),null;var i=bm(t,e);if(t.tag!==0&&i===2){var s=gy(t);s!==0&&(e=s,i=Hy(t,s))}if(i===1)throw i=Md,zl(t,0),Ta(t,e),Nn(t,ur()),i;if(i===6)throw Error(Gt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ml(t,Rn,Bo),Nn(t,ur()),null}function rv(t,e){var i=si;si|=1;try{return t(e)}finally{si=i,si===0&&(lu=ur()+500,Nm&&Ya())}}function $l(t){Ca!==null&&Ca.tag===0&&!(si&6)&&tu();var e=si;si|=1;var i=ws.transition,s=gi;try{if(ws.transition=null,gi=1,t)return t()}finally{gi=s,ws.transition=i,si=e,!(si&6)&&Ya()}}function nv(){ss=Wc.current,Ri(Wc)}function zl(t,e){t.finishedWork=null,t.finishedLanes=0;var i=t.timeoutHandle;if(i!==-1&&(t.timeoutHandle=-1,FT(i)),yr!==null)for(i=yr.return;i!==null;){var s=i;switch(B_(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&lm();break;case 3:ou(),Ri(Vn),Ri(mn),G_();break;case 5:q_(s);break;case 4:ou();break;case 13:Ri(Wi);break;case 19:Ri(Wi);break;case 10:j_(s.type._context);break;case 22:case 23:nv()}i=i.return}if(Ur=t,yr=t=Va(t.current,null),en=ss=e,Er=0,Md=null,ev=Zm=Vl=0,Rn=Qh=null,Pl!==null){for(e=0;e<Pl.length;e++)if(i=Pl[e],s=i.interleaved,s!==null){i.interleaved=null;var l=s.next,h=i.pending;if(h!==null){var d=h.next;h.next=l,s.next=d}i.pending=s}Pl=null}return t}function hS(t,e){do{var i=yr;try{if(N_(),Of.current=ym,gm){for(var s=Yi.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}gm=!1}if(Bl=0,Nr=Cr=Yi=null,Xh=!1,Sd=0,tv.current=null,i===null||i.return===null){Er=1,Md=e,yr=null;break}t:{var h=t,d=i.return,c=i,b=e;if(e=en,c.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){var S=b,C=c,P=C.tag;if(!(C.mode&1)&&(P===0||P===11||P===15)){var A=C.alternate;A?(C.updateQueue=A.updateQueue,C.memoizedState=A.memoizedState,C.lanes=A.lanes):(C.updateQueue=null,C.memoizedState=null)}var V=ab(d);if(V!==null){V.flags&=-257,lb(V,d,c,h,e),V.mode&1&&ob(h,S,e),e=V,b=S;var W=e.updateQueue;if(W===null){var $=new Set;$.add(b),e.updateQueue=$}else W.add(b);break t}else{if(!(e&1)){ob(h,S,e),sv();break t}b=Error(Gt(426))}}else if(Hi&&c.mode&1){var nt=ab(d);if(nt!==null){!(nt.flags&65536)&&(nt.flags|=256),lb(nt,d,c,h,e),V_(au(b,c));break t}}h=b=au(b,c),Er!==4&&(Er=2),Qh===null?Qh=[h]:Qh.push(h),h=d;do{switch(h.tag){case 3:h.flags|=65536,e&=-e,h.lanes|=e;var H=W5(h,b,e);tb(h,H);break t;case 1:c=b;var Y=h.type,K=h.stateNode;if(!(h.flags&128)&&(typeof Y.getDerivedStateFromError=="function"||K!==null&&typeof K.componentDidCatch=="function"&&(Oa===null||!Oa.has(K)))){h.flags|=65536,e&=-e,h.lanes|=e;var at=Y5(h,c,e);tb(h,at);break t}}h=h.return}while(h!==null)}fS(i)}catch(mt){e=mt,yr===i&&i!==null&&(yr=i=i.return);continue}break}while(!0)}function dS(){var t=_m.current;return _m.current=ym,t===null?ym:t}function sv(){(Er===0||Er===3||Er===2)&&(Er=4),Ur===null||!(Vl&268435455)&&!(Zm&268435455)||Ta(Ur,en)}function bm(t,e){var i=si;si|=2;var s=dS();(Ur!==t||en!==e)&&(Bo=null,zl(t,e));do try{aM();break}catch(l){hS(t,l)}while(!0);if(N_(),si=i,_m.current=s,yr!==null)throw Error(Gt(261));return Ur=null,en=0,Er}function aM(){for(;yr!==null;)pS(yr)}function lM(){for(;yr!==null&&!Dk();)pS(yr)}function pS(t){var e=gS(t.alternate,t,ss);t.memoizedProps=t.pendingProps,e===null?fS(t):yr=e,tv.current=null}function fS(t){var e=t;do{var i=e.alternate;if(t=e.return,e.flags&32768){if(i=eM(i,e),i!==null){i.flags&=32767,yr=i;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Er=6,yr=null;return}}else if(i=tM(i,e,ss),i!==null){yr=i;return}if(e=e.sibling,e!==null){yr=e;return}yr=e=t}while(e!==null);Er===0&&(Er=5)}function Ml(t,e,i){var s=gi,l=ws.transition;try{ws.transition=null,gi=1,cM(t,e,i,s)}finally{ws.transition=l,gi=s}return null}function cM(t,e,i,s){do tu();while(Ca!==null);if(si&6)throw Error(Gt(327));i=t.finishedWork;var l=t.finishedLanes;if(i===null)return null;if(t.finishedWork=null,t.finishedLanes=0,i===t.current)throw Error(Gt(177));t.callbackNode=null,t.callbackPriority=0;var h=i.lanes|i.childLanes;if(Uk(t,h),t===Ur&&(yr=Ur=null,en=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||ff||(ff=!0,yS(im,function(){return tu(),null})),h=(i.flags&15990)!==0,i.subtreeFlags&15990||h){h=ws.transition,ws.transition=null;var d=gi;gi=1;var c=si;si|=4,tv.current=null,rM(t,i),lS(i,t),PT(wy),nm=!!by,wy=by=null,t.current=i,nM(i),Lk(),si=c,gi=d,ws.transition=h}else t.current=i;if(ff&&(ff=!1,Ca=t,xm=l),h=t.pendingLanes,h===0&&(Oa=null),Ok(i.stateNode),Nn(t,ur()),e!==null)for(s=t.onRecoverableError,i=0;i<e.length;i++)l=e[i],s(l.value,{componentStack:l.stack,digest:l.digest});if(vm)throw vm=!1,t=jy,jy=null,t;return xm&1&&t.tag!==0&&tu(),h=t.pendingLanes,h&1?t===Uy?td++:(td=0,Uy=t):td=0,Ya(),null}function tu(){if(Ca!==null){var t=W2(xm),e=ws.transition,i=gi;try{if(ws.transition=null,gi=16>t?16:t,Ca===null)var s=!1;else{if(t=Ca,Ca=null,xm=0,si&6)throw Error(Gt(331));var l=si;for(si|=4,ye=t.current;ye!==null;){var h=ye,d=h.child;if(ye.flags&16){var c=h.deletions;if(c!==null){for(var b=0;b<c.length;b++){var S=c[b];for(ye=S;ye!==null;){var C=ye;switch(C.tag){case 0:case 11:case 15:Jh(8,C,h)}var P=C.child;if(P!==null)P.return=C,ye=P;else for(;ye!==null;){C=ye;var A=C.sibling,V=C.return;if(sS(C),C===S){ye=null;break}if(A!==null){A.return=V,ye=A;break}ye=V}}}var W=h.alternate;if(W!==null){var $=W.child;if($!==null){W.child=null;do{var nt=$.sibling;$.sibling=null,$=nt}while($!==null)}}ye=h}}if(h.subtreeFlags&2064&&d!==null)d.return=h,ye=d;else t:for(;ye!==null;){if(h=ye,h.flags&2048)switch(h.tag){case 0:case 11:case 15:Jh(9,h,h.return)}var H=h.sibling;if(H!==null){H.return=h.return,ye=H;break t}ye=h.return}}var Y=t.current;for(ye=Y;ye!==null;){d=ye;var K=d.child;if(d.subtreeFlags&2064&&K!==null)K.return=d,ye=K;else t:for(d=Y;ye!==null;){if(c=ye,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Hm(9,c)}}catch(mt){ir(c,c.return,mt)}if(c===d){ye=null;break t}var at=c.sibling;if(at!==null){at.return=c.return,ye=at;break t}ye=c.return}}if(si=l,Ya(),yo&&typeof yo.onPostCommitFiberRoot=="function")try{yo.onPostCommitFiberRoot(Fm,t)}catch{}s=!0}return s}finally{gi=i,ws.transition=e}}return!1}function bb(t,e,i){e=au(i,e),e=W5(t,e,1),t=Fa(t,e,1),e=Mn(),t!==null&&(Vd(t,1,e),Nn(t,e))}function ir(t,e,i){if(t.tag===3)bb(t,t,i);else for(;e!==null;){if(e.tag===3){bb(e,t,i);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Oa===null||!Oa.has(s))){t=au(i,t),t=Y5(e,t,1),e=Fa(e,t,1),t=Mn(),e!==null&&(Vd(e,1,t),Nn(e,t));break}}e=e.return}}function uM(t,e,i){var s=t.pingCache;s!==null&&s.delete(e),e=Mn(),t.pingedLanes|=t.suspendedLanes&i,Ur===t&&(en&i)===i&&(Er===4||Er===3&&(en&130023424)===en&&500>ur()-iv?zl(t,0):ev|=i),Nn(t,e)}function mS(t,e){e===0&&(t.mode&1?(e=nf,nf<<=1,!(nf&130023424)&&(nf=4194304)):e=1);var i=Mn();t=Ko(t,e),t!==null&&(Vd(t,e,i),Nn(t,i))}function hM(t){var e=t.memoizedState,i=0;e!==null&&(i=e.retryLane),mS(t,i)}function dM(t,e){var i=0;switch(t.tag){case 13:var s=t.stateNode,l=t.memoizedState;l!==null&&(i=l.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(Gt(314))}s!==null&&s.delete(e),mS(t,i)}var gS;gS=function(t,e,i){if(t!==null)if(t.memoizedProps!==e.pendingProps||Vn.current)Bn=!0;else{if(!(t.lanes&i)&&!(e.flags&128))return Bn=!1,QT(t,e,i);Bn=!!(t.flags&131072)}else Bn=!1,Hi&&e.flags&1048576&&x5(e,hm,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Vf(t,e),t=e.pendingProps;var l=ru(e,mn.current);Qc(e,i),l=Y_(null,e,s,t,l,i);var h=K_();return e.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,$n(s)?(h=!0,cm(e)):h=!1,e.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,H_(e),l.updater=Um,e.stateNode=l,l._reactInternals=e,Ay(e,s,t,i),e=Ly(null,e,s,!0,h,i)):(e.tag=0,Hi&&h&&O_(e),Tn(null,e,l,i),e=e.child),e;case 16:s=e.elementType;t:{switch(Vf(t,e),t=e.pendingProps,l=s._init,s=l(s._payload),e.type=s,l=e.tag=fM(s),t=Vs(s,t),l){case 0:e=Dy(null,e,s,t,i);break t;case 1:e=hb(null,e,s,t,i);break t;case 11:e=cb(null,e,s,t,i);break t;case 14:e=ub(null,e,s,Vs(s.type,t),i);break t}throw Error(Gt(306,s,""))}return e;case 0:return s=e.type,l=e.pendingProps,l=e.elementType===s?l:Vs(s,l),Dy(t,e,s,l,i);case 1:return s=e.type,l=e.pendingProps,l=e.elementType===s?l:Vs(s,l),hb(t,e,s,l,i);case 3:t:{if(Q5(e),t===null)throw Error(Gt(387));s=e.pendingProps,h=e.memoizedState,l=h.element,M5(t,e),fm(e,s,null,i);var d=e.memoizedState;if(s=d.element,h.isDehydrated)if(h={element:s,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},e.updateQueue.baseState=h,e.memoizedState=h,e.flags&256){l=au(Error(Gt(423)),e),e=db(t,e,s,i,l);break t}else if(s!==l){l=au(Error(Gt(424)),e),e=db(t,e,s,i,l);break t}else for(as=Ra(e.stateNode.containerInfo.firstChild),ls=e,Hi=!0,Ns=null,i=k5(e,null,s,i),e.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(nu(),s===l){e=Xo(t,e,i);break t}Tn(t,e,s,i)}e=e.child}return e;case 5:return C5(e),t===null&&Ey(e),s=e.type,l=e.pendingProps,h=t!==null?t.memoizedProps:null,d=l.children,Sy(s,l)?d=null:h!==null&&Sy(s,h)&&(e.flags|=32),J5(t,e),Tn(t,e,d,i),e.child;case 6:return t===null&&Ey(e),null;case 13:return tS(t,e,i);case 4:return Z_(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=su(e,null,s,i):Tn(t,e,s,i),e.child;case 11:return s=e.type,l=e.pendingProps,l=e.elementType===s?l:Vs(s,l),cb(t,e,s,l,i);case 7:return Tn(t,e,e.pendingProps,i),e.child;case 8:return Tn(t,e,e.pendingProps.children,i),e.child;case 12:return Tn(t,e,e.pendingProps.children,i),e.child;case 10:t:{if(s=e.type._context,l=e.pendingProps,h=e.memoizedProps,d=l.value,Ii(dm,s._currentValue),s._currentValue=d,h!==null)if(qs(h.value,d)){if(h.children===l.children&&!Vn.current){e=Xo(t,e,i);break t}}else for(h=e.child,h!==null&&(h.return=e);h!==null;){var c=h.dependencies;if(c!==null){d=h.child;for(var b=c.firstContext;b!==null;){if(b.context===s){if(h.tag===1){b=Go(-1,i&-i),b.tag=2;var S=h.updateQueue;if(S!==null){S=S.shared;var C=S.pending;C===null?b.next=b:(b.next=C.next,C.next=b),S.pending=b}}h.lanes|=i,b=h.alternate,b!==null&&(b.lanes|=i),Py(h.return,i,e),c.lanes|=i;break}b=b.next}}else if(h.tag===10)d=h.type===e.type?null:h.child;else if(h.tag===18){if(d=h.return,d===null)throw Error(Gt(341));d.lanes|=i,c=d.alternate,c!==null&&(c.lanes|=i),Py(d,i,e),d=h.sibling}else d=h.child;if(d!==null)d.return=h;else for(d=h;d!==null;){if(d===e){d=null;break}if(h=d.sibling,h!==null){h.return=d.return,d=h;break}d=d.return}h=d}Tn(t,e,l.children,i),e=e.child}return e;case 9:return l=e.type,s=e.pendingProps.children,Qc(e,i),l=ks(l),s=s(l),e.flags|=1,Tn(t,e,s,i),e.child;case 14:return s=e.type,l=Vs(s,e.pendingProps),l=Vs(s.type,l),ub(t,e,s,l,i);case 15:return K5(t,e,e.type,e.pendingProps,i);case 17:return s=e.type,l=e.pendingProps,l=e.elementType===s?l:Vs(s,l),Vf(t,e),e.tag=1,$n(s)?(t=!0,cm(e)):t=!1,Qc(e,i),G5(e,s,l),Ay(e,s,l,i),Ly(null,e,s,!0,t,i);case 19:return eS(t,e,i);case 22:return X5(t,e,i)}throw Error(Gt(156,e.tag))};function yS(t,e){return H2(t,e)}function pM(t,e,i,s){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bs(t,e,i,s){return new pM(t,e,i,s)}function ov(t){return t=t.prototype,!(!t||!t.isReactComponent)}function fM(t){if(typeof t=="function")return ov(t)?1:0;if(t!=null){if(t=t.$$typeof,t===T_)return 11;if(t===M_)return 14}return 2}function Va(t,e){var i=t.alternate;return i===null?(i=bs(t.tag,e,t.key,t.mode),i.elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=t.flags&14680064,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function jf(t,e,i,s,l,h){var d=2;if(s=t,typeof t=="function")ov(t)&&(d=1);else if(typeof t=="string")d=5;else t:switch(t){case Bc:return Dl(i.children,l,h,e);case k_:d=8,l|=8;break;case ey:return t=bs(12,i,e,l|2),t.elementType=ey,t.lanes=h,t;case iy:return t=bs(13,i,e,l),t.elementType=iy,t.lanes=h,t;case ry:return t=bs(19,i,e,l),t.elementType=ry,t.lanes=h,t;case C2:return qm(i,l,h,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case T2:d=10;break t;case M2:d=9;break t;case T_:d=11;break t;case M_:d=14;break t;case wa:d=16,s=null;break t}throw Error(Gt(130,t==null?t:typeof t,""))}return e=bs(d,i,e,l),e.elementType=t,e.type=s,e.lanes=h,e}function Dl(t,e,i,s){return t=bs(7,t,s,e),t.lanes=i,t}function qm(t,e,i,s){return t=bs(22,t,s,e),t.elementType=C2,t.lanes=i,t.stateNode={isHidden:!1},t}function R0(t,e,i){return t=bs(6,t,null,e),t.lanes=i,t}function F0(t,e,i){return e=bs(4,t.children!==null?t.children:[],t.key,e),e.lanes=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function mM(t,e,i,s,l){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=g0(0),this.expirationTimes=g0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=g0(0),this.identifierPrefix=s,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function av(t,e,i,s,l,h,d,c,b){return t=new mM(t,e,i,c,b),e===1?(e=1,h===!0&&(e|=8)):e=0,h=bs(3,null,null,e),t.current=h,h.stateNode=t,h.memoizedState={element:s,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},H_(h),t}function gM(t,e,i){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Oc,key:s==null?null:""+s,children:t,containerInfo:e,implementation:i}}function _S(t){if(!t)return Ua;t=t._reactInternals;t:{if(Hl(t)!==t||t.tag!==1)throw Error(Gt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if($n(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(e!==null);throw Error(Gt(171))}if(t.tag===1){var i=t.type;if($n(i))return _5(t,i,e)}return e}function vS(t,e,i,s,l,h,d,c,b){return t=av(i,s,!0,t,l,h,d,c,b),t.context=_S(null),i=t.current,s=Mn(),l=Ba(i),h=Go(s,l),h.callback=e??null,Fa(i,h,l),t.current.lanes=l,Vd(t,l,s),Nn(t,s),t}function Gm(t,e,i,s){var l=e.current,h=Mn(),d=Ba(l);return i=_S(i),e.context===null?e.context=i:e.pendingContext=i,e=Go(h,d),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Fa(l,e,d),t!==null&&(Hs(t,l,d,h),Ff(t,l,d)),d}function wm(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function wb(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var i=t.retryLane;t.retryLane=i!==0&&i<e?i:e}}function lv(t,e){wb(t,e),(t=t.alternate)&&wb(t,e)}function yM(){return null}var xS=typeof reportError=="function"?reportError:function(t){console.error(t)};function cv(t){this._internalRoot=t}Wm.prototype.render=cv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Gt(409));Gm(t,e,null,null)};Wm.prototype.unmount=cv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;$l(function(){Gm(null,t,null,null)}),e[Yo]=null}};function Wm(t){this._internalRoot=t}Wm.prototype.unstable_scheduleHydration=function(t){if(t){var e=X2();t={blockedOn:null,target:t,priority:e};for(var i=0;i<ka.length&&e!==0&&e<ka[i].priority;i++);ka.splice(i,0,t),i===0&&Q2(t)}};function uv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ym(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Sb(){}function _M(t,e,i,s,l){if(l){if(typeof s=="function"){var h=s;s=function(){var S=wm(d);h.call(S)}}var d=vS(e,s,t,0,null,!1,!1,"",Sb);return t._reactRootContainer=d,t[Yo]=d.current,_d(t.nodeType===8?t.parentNode:t),$l(),d}for(;l=t.lastChild;)t.removeChild(l);if(typeof s=="function"){var c=s;s=function(){var S=wm(b);c.call(S)}}var b=av(t,0,!1,null,null,!1,!1,"",Sb);return t._reactRootContainer=b,t[Yo]=b.current,_d(t.nodeType===8?t.parentNode:t),$l(function(){Gm(e,b,i,s)}),b}function Km(t,e,i,s,l){var h=i._reactRootContainer;if(h){var d=h;if(typeof l=="function"){var c=l;l=function(){var b=wm(d);c.call(b)}}Gm(e,d,t,l)}else d=_M(i,e,t,l,s);return wm(d)}Y2=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var i=Bh(e.pendingLanes);i!==0&&(P_(e,i|1),Nn(e,ur()),!(si&6)&&(lu=ur()+500,Ya()))}break;case 13:$l(function(){var s=Ko(t,1);if(s!==null){var l=Mn();Hs(s,t,1,l)}}),lv(t,1)}};I_=function(t){if(t.tag===13){var e=Ko(t,134217728);if(e!==null){var i=Mn();Hs(e,t,134217728,i)}lv(t,134217728)}};K2=function(t){if(t.tag===13){var e=Ba(t),i=Ko(t,e);if(i!==null){var s=Mn();Hs(i,t,e,s)}lv(t,e)}};X2=function(){return gi};J2=function(t,e){var i=gi;try{return gi=t,e()}finally{gi=i}};py=function(t,e,i){switch(e){case"input":if(oy(t,i),e=i.name,i.type==="radio"&&e!=null){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var s=i[e];if(s!==t&&s.form===t.form){var l=$m(s);if(!l)throw Error(Gt(90));P2(s),oy(s,l)}}}break;case"textarea":A2(t,i);break;case"select":e=i.value,e!=null&&Yc(t,!!i.multiple,e,!1)}};B2=rv;V2=$l;var vM={usingClientEntryPoint:!1,Events:[Nd,jc,$m,F2,O2,rv]},Ph={findFiberByHostInstance:El,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},xM={bundleType:Ph.bundleType,version:Ph.version,rendererPackageName:Ph.rendererPackageName,rendererConfig:Ph.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=j2(t),t===null?null:t.stateNode},findFiberByHostInstance:Ph.findFiberByHostInstance||yM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mf.isDisabled&&mf.supportsFiber)try{Fm=mf.inject(xM),yo=mf}catch{}}us.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vM;us.createPortal=function(t,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!uv(e))throw Error(Gt(200));return gM(t,e,null,i)};us.createRoot=function(t,e){if(!uv(t))throw Error(Gt(299));var i=!1,s="",l=xS;return e!=null&&(e.unstable_strictMode===!0&&(i=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(l=e.onRecoverableError)),e=av(t,1,!1,null,null,i,!1,s,l),t[Yo]=e.current,_d(t.nodeType===8?t.parentNode:t),new cv(e)};us.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Gt(188)):(t=Object.keys(t).join(","),Error(Gt(268,t)));return t=j2(e),t=t===null?null:t.stateNode,t};us.flushSync=function(t){return $l(t)};us.hydrate=function(t,e,i){if(!Ym(e))throw Error(Gt(200));return Km(null,t,e,!0,i)};us.hydrateRoot=function(t,e,i){if(!uv(t))throw Error(Gt(405));var s=i!=null&&i.hydratedSources||null,l=!1,h="",d=xS;if(i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(d=i.onRecoverableError)),e=vS(e,null,t,1,i??null,l,!1,h,d),t[Yo]=e.current,_d(t),s)for(t=0;t<s.length;t++)i=s[t],l=i._getVersion,l=l(i._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[i,l]:e.mutableSourceEagerHydrationData.push(i,l);return new Wm(e)};us.render=function(t,e,i){if(!Ym(e))throw Error(Gt(200));return Km(null,t,e,!1,i)};us.unmountComponentAtNode=function(t){if(!Ym(t))throw Error(Gt(40));return t._reactRootContainer?($l(function(){Km(null,null,t,!1,function(){t._reactRootContainer=null,t[Yo]=null})}),!0):!1};us.unstable_batchedUpdates=rv;us.unstable_renderSubtreeIntoContainer=function(t,e,i,s){if(!Ym(i))throw Error(Gt(200));if(t==null||t._reactInternals===void 0)throw Error(Gt(38));return Km(t,e,i,!1,s)};us.version="18.3.1-next-f1338f8080-20240426";function bS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bS)}catch(t){console.error(t)}}bS(),b2.exports=us;var bM=b2.exports,wS,kb=bM;wS=kb.createRoot,kb.hydrateRoot;const wM="/Trail-Map/vite.svg";var SM=Object.defineProperty,kM=(t,e,i)=>e in t?SM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,se=(t,e,i)=>kM(t,typeof e!="symbol"?e+"":e,i),SS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var TS={exports:{}},Ih={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tb;function TM(){if(Tb)return Ih;Tb=1;var t=v2,e=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,l=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h={key:!0,ref:!0,__self:!0,__source:!0};function d(c,b,S){var C,P={},A=null,V=null;S!==void 0&&(A=""+S),b.key!==void 0&&(A=""+b.key),b.ref!==void 0&&(V=b.ref);for(C in b)s.call(b,C)&&!h.hasOwnProperty(C)&&(P[C]=b[C]);if(c&&c.defaultProps)for(C in b=c.defaultProps,b)P[C]===void 0&&(P[C]=b[C]);return{$$typeof:e,type:c,key:A,ref:V,props:P,_owner:l.current}}return Ih.Fragment=i,Ih.jsx=d,Ih.jsxs=d,Ih}TS.exports=TM();var O0=TS.exports,qy={exports:{}};(function(t,e){(function(i,s){s(e,v2)})(SS,function(i,s){var l={exports:{}},h={};/**
* @license React
* react-jsx-runtime.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var d;function c(){if(d)return h;d=1;var K=s,at=Symbol.for("react.element"),mt=Symbol.for("react.fragment"),xt=Object.prototype.hasOwnProperty,Tt=K.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Mt={key:!0,ref:!0,__self:!0,__source:!0};function $t(Ft,Ot,ge){var _e,Ae={},ve=null,Ee=null;ge!==void 0&&(ve=""+ge),Ot.key!==void 0&&(ve=""+Ot.key),Ot.ref!==void 0&&(Ee=Ot.ref);for(_e in Ot)xt.call(Ot,_e)&&!Mt.hasOwnProperty(_e)&&(Ae[_e]=Ot[_e]);if(Ft&&Ft.defaultProps)for(_e in Ot=Ft.defaultProps,Ot)Ae[_e]===void 0&&(Ae[_e]=Ot[_e]);return{$$typeof:at,type:Ft,key:ve,ref:Ee,props:Ae,_owner:Tt.current}}return h.Fragment=mt,h.jsx=$t,h.jsxs=$t,h}l.exports=c();var b=l.exports;const S=K=>{if(typeof K!="string")throw new Error("Invalid map library version");return new URL(`https://www.nps.gov/lib/npmap.js/${K}/dist/npmap5-base.min.js`)};async function C(K,at=Y){if(typeof at!="string")return window.NPMap=at,at;const mt=S(at);let xt=document.getElementById(K);return xt||window.NPMap?window.NPMap.Map:(xt=document.createElement("script"),xt.id=K,xt.src=mt.href,xt.async=!0,document.body.appendChild(xt),new Promise((Tt,Mt)=>{xt.onerror=$t=>Mt($t),xt.onload=()=>{Tt(window.NPMap.Map)}}))}function P(K,at){let mt=document.getElementById(K);mt||(mt=document.createElement("style"),mt.id=K,mt.innerHTML=`
      .${at} img,
      .${at} svg,
      .${at} video,
      .${at} canvas,
      .${at} audio,
      .${at} iframe,
      .${at} embed,
      .${at} object {
        display: initial;
      }

      .${at} *,
      .${at} *::before,
      .${at} *::after {
        box-sizing: initial;
        border-width: initial;
        border-style: initial;
        border-color: initial;
      }`,document.body.appendChild(mt))}function A(K){const at=document.getElementById(K);at&&document.body.removeChild(at)}function V(K,at,mt){at.forEach(xt=>{"layer"in xt?K[mt](xt.type,xt.layer,xt.listener):K[mt](xt.type,xt.listener)})}function W(K,at=[],mt=[]){const xt=($t,Ft)=>$t.type!==Ft.type||$t.listener!==Ft.listener?!1:"layer"in $t?"layer"in Ft&&$t.layer===Ft.layer:!0,Tt=mt.filter($t=>!at.some(Ft=>xt($t,Ft))),Mt=at.filter($t=>!mt.some(Ft=>xt($t,Ft)));V(K,Tt,"off"),V(K,Mt,"on")}function $(K){if(K===null||typeof K!="object")return K;if(typeof K=="function")return K.bind(this);if(Array.isArray(K))return K.map(at=>$.call(this,at));if(K instanceof Object){const at={};for(let mt in K)Object.prototype.hasOwnProperty.call(K,mt)&&(at[mt]=$.call(this,K[mt]));return at}throw new Error(`Unable to clone object: Unsupported object type - ${typeof K}.`)}const nt={version:"NPMap5",basemap:["mapbox://styles/atlas-user/ck58pyquo009v01p99xebegr9"]},H=K=>{const at=Math.random().toString(36).substring(2),mt="npmap5-container-"+at,xt="npmap5-script-"+at,Tt="npmap5-style-"+at,Mt=s.useRef(),[$t,Ft]=s.useState();let Ot=!1;const ge=s.useRef(null);s.useEffect(()=>(ge.current&&!$t&&!Ot&&(Ot=!0,Ae(ge.current).then(()=>{Ot=!1})),()=>{A(xt),A(Tt),$t&&ge.current&&($t.remove(),Ft(void 0),Mt.current=void 0)}),[]),s.useEffect(()=>{ve(K)},[K]);const _e=Ee=>{const{height:$e,width:Vt,onEvents:re,mapLibrary:Kt,callback:we,...Se}=Ee;return Se},Ae=async Ee=>{Mt.current=K,P(Tt,mt);const $e=await C(xt,K.mapLibrary),Vt=new $e({..._e(K),container:Ee,style:K.style||nt});V(Vt,K.onEvents||[],"on"),Ft(Vt)},ve=Ee=>{const $e=Mt.current&&$(Mt.current);Mt.current=$(K),!($t===void 0||$e===void 0)&&(W($t,Ee.onEvents,$e.onEvents),$t.updateOptions(_e(Ee),_e($e),{defaultStyle:nt}))};return b.jsx("div",{ref:ge,className:mt+" maplibregl-map",style:{height:K.height,width:K.width}})},Y="5.0.3";i.DEFAULT_NPMAP_VERSION=Y,i.NPMap=H,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})})})(qy,qy.exports);var MM=qy.exports;const CM=kS(MM),EM="trail-map",PM="trail-map-controls",MS="trail-elevation-profile",CS="trail-elevation-map-marker",IM="controls-top-left",AM="controls-top-right",zM="controls-bottom-left",DM="controls-bottom-right",Gy="popup-header-image-container",LM="Selected Trails",ES="Selected Trail Alerts",RM="Selected Points of Interest",Wy="top-right",FM="bottom-right",B0="More Info",OM="Less Info",PS="trailInfo",$a="core_details",BM="trail_names",Mb="trail_status",VM="asset",$h="name",IS="description",$M="images",NM="amenities",Cd=".",Cb="geojson",Eb="Feature",Sm="FeatureCollection",Xm="LineString",hv="MultiLineString",jM=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],UM=["Jan.","Feb.","Mar.","Apr.","May","Jun.","Jul.","Aug.","Sep.","Oct.","Nov.","Dec."],HM=63710088e-1,Pb=3.28084,ZM=621371e-9,qM={home:{position:Wy,order:0},navigation:{position:Wy,order:1,showCompass:!0,showZoom:!0,visualizePitch:!1},scale:{position:FM,order:-1}},GM={linear:!0,padding:60,curve:1.42,speed:.5},AS="115px",zS="130px",DS="25px",Ib="linear-gradient(transparent, 95%, silver)",WM="M128 896 128 737.706667 459.946667 546.133333 620.8 640 896 480 896 896 128 896M896 381.44 620.8 540.586667 459.946667 448 128 640 128 545.706667 459.946667 354.133333 620.8 448 896 288 896 381.44Z",YM="maplibregl-control-container",LS="maplibregl-ctrl",RS="maplibregl-ctrl-group",KM="maplibregl-ctrl-top-left",XM="maplibregl-ctrl-top-right",dv="maplibregl-ctrl-bottom-left",pv="maplibregl-ctrl-bottom-right",FS="default-font-style",OS="trail-alerts-toggle",BS="trail-alerts-toggle-label",VS="trail-elevation-profile-chart",$S="trail-elevation-map-marker",JM=`.maplibregl-popup-content {
    color: black;
    display: flex;
    justify-content: flex-start;
    align-items: center;
    width: 100%;
}

.maplibregl-popup-content-multipopup {
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: center;
}

.maplibregl-popup-content ul {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: center;
}

.maplibregl-ctrl .switch {
    position: relative;
    display: inline-block;
    width: 30px;
    height: 17px;
}

/* The slider itself */
.maplibregl-ctrl .switch input { 
    opacity: 0;
    width: 0;
    height: 0;
}

.maplibregl-ctrl .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #999999;
    transition: .4s;
}

.maplibregl-ctrl .slider:before {
    position: absolute;
    content: "";
    height: 13px;
    width: 13px;
    left: 2px;
    bottom: 2px;
    background-color: white;
    transition: .4s;
}

.maplibregl-ctrl input:checked + .slider {
    background-color: #cb9733;
}

input:checked + .slider:before {
    transform: translateX(13px);
}

/* Rounded sliders */
.slider.round {
    border-radius: 17px;
}

.slider.round:before {
    border-radius: 50%;
}

.${FS} {
    font-size: 12px;
    font-weight: 700;
    font-family: inherit;
}
    
.${OS} {
    width: auto;
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    justify-content: left;
    align-items: center;
    padding: 8px;
    background-color: white;
    color: black;
    border-radius: 4px;
    z-index: -1;
}
    
.${BS} {
    display: block;
    padding-left: 5px;
}
    
.${VS} {
    height: 25vh;
    display: flex;
    justify-content: space-evenly;
    align-items: center;
    color: black;
    background-color: white;
    position: absolute;
    left: 1vw;
    bottom: 0px;
    right: 1vw;
    margin: 1vh;
    border-radius: 4px;
    box-shadow: black 0px 0px 10px 0px;
}

.${$S} {
    background-color: #A4693A;
    height: 15px;
    width: 15px;
    border-radius: 50%;
    border-style: solid;
    border-width: 2px;
    border-color: white;
    box-shadow: black 0px 0px 3px 1px;
}`;let km=!0;function QM(t){km=t??!1}let No=!0;function tC(t){No=t??!1}function Tm(t,e){if(e!=null&&e.length){const i=document.getElementsByClassName(e);if(i!=null&&i.length)for(let s=0;s<i.length;s++)i[s].setAttribute("style",t?"display: inherit":"display: none")}}function eC(t){for(let e in t)if(t!=null&&t.hasOwnProperty(e)){let i=t[e];typeof i=="string"&&(i!=null&&i.startsWith('{"')||i!=null&&i.startsWith('[{"')||i==="[{}]")&&(t[e]=JSON.parse(i))}return t}function Ab(t){try{JSON.parse(t)}catch{return!1}return!0}function ed(t,e){return t!=null&&t.includes(Cd)?t.split(Cd).reduce((i,s)=>i[s],e):e[t]}function iC(t,e){var i,s,l,h,d,c,b,S,C,P,A,V;let W=!1,$;return e!==$a&&(i=t==null?void 0:t.properties[e])!=null&&i.length&&typeof t.properties[e]=="string"?($=JSON.parse(t.properties[e]),W=!0):(s=t==null?void 0:t.properties)!=null&&s.length&&typeof t.properties=="string"?($=JSON.parse(t.properties),W=!0):$=(t==null?void 0:t.properties)??t,W||($=eC($)),(h=(l=t==null?void 0:t.properties)==null?void 0:l.name)!=null&&h.length&&!((d=$==null?void 0:$.name)!=null&&d.length)?$.name=t.properties.name:(c=t==null?void 0:t.name)!=null&&c.length&&!((b=$==null?void 0:$.name)!=null&&b.length)&&($.name=t.name),(C=(S=t==null?void 0:t.properties)==null?void 0:S.description)!=null&&C.length&&!((P=$==null?void 0:$.description)!=null&&P.length)?$.description=t.properties.description:(A=t==null?void 0:t.description)!=null&&A.length&&!((V=$==null?void 0:$.description)!=null&&V.length)&&($.description=t.description),$}function zb(t){return(t==null?void 0:t.type)===Sm?t:{type:Sm,features:[t]}}async function rC(t,e,i){let s;return typeof t=="string"&&t!=null&&t.startsWith("http")?await fetch(t).then(l=>l.json()).then(l=>{s=zb(l),e.fitBounds(s,i)}):(s=zb(t),e.fitBounds(s,i)),s}function Db(t){const e=new Date(t);return`${jM[e.getDay()]}, ${UM[e.getMonth()]} ${e.getDate()}, ${e.getFullYear()}`}function nC(t){return t.endsWith(".")&&(t=t.slice(0,-1)),sC(t)}function sC(t){return t.charAt(0).toUpperCase()+t.slice(1)}function oC(t,e){var i,s,l,h;if(e)try{const d=JSON.parse(e),c=((i=d==null?void 0:d._geometry)==null?void 0:i.coordinates)??((s=d==null?void 0:d.geometry)==null?void 0:s.coordinates);t&&(t==null||t.fire("click",{lngLat:c,point:t.project(c),originalEvent:{}}))}catch{try{const d=((l=e==null?void 0:e._geometry)==null?void 0:l.coordinates)??((h=e==null?void 0:e.geometry)==null?void 0:h.coordinates);t&&(t==null||t.fire("click",{lngLat:d,point:t.project(d),originalEvent:{}}))}catch(d){console.log("ERROR: Click feature failed. ",d)}}}function aC(){var t;const e=document.getElementsByClassName("maplibregl-popup");e!=null&&e.length&&((t=e[0])==null||t.remove())}function lC(t){const e=document.createElement("style");e.textContent=t,document.head.append(e)}function cC(t,e="0 0 1024 1024",i="80%",s="80%"){const l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttribute("viewBox",`${e}`),l.setAttribute("vertical-align","middle"),l.setAttribute("fill","#333"),l.setAttribute("stroke","currentColor"),l.setAttribute("stroke-width","2"),l.setAttribute("stroke-linecap","round"),l.setAttribute("stroke-linejoin","round"),l.setAttribute("class","feather feather-home"),l.setAttribute("height",`${i}`),l.setAttribute("width",`${s}`);const h=document.createElementNS("http://www.w3.org/2000/svg","path");return h.setAttribute("d",`${t}`),l.appendChild(h),l}function uC(){var t,e,i,s,l;const h=document.getElementsByClassName(YM),d=document.getElementsByClassName(KM),c=document.getElementsByClassName(XM),b=document.getElementsByClassName(dv),S=document.getElementsByClassName(pv);h!=null&&h.length&&((t=h[(h==null?void 0:h.length)-1])==null||t.setAttribute("id",PM)),d!=null&&d.length&&((e=d[(d==null?void 0:d.length)-1])==null||e.setAttribute("id",IM)),c!=null&&c.length&&((i=c[(c==null?void 0:c.length)-1])==null||i.setAttribute("id",AM)),b!=null&&b.length&&((s=b[(b==null?void 0:b.length)-1])==null||s.setAttribute("id",zM)),S!=null&&S.length&&((l=S[(S==null?void 0:S.length)-1])==null||l.setAttribute("id",DM)),Od==null||Od.setAttribute("id",EM)}function Uf(t){t.addEventListener("contextmenu",function(e){e.stopPropagation(),e.preventDefault()}),t.addEventListener("dblclick",function(e){e.stopPropagation(),e.preventDefault()}),t.addEventListener("mousedown",function(e){e.stopPropagation(),e.preventDefault()})}function Lb(){tC(!No);const t=document.getElementById(CS),e=document.getElementById(MS);t&&(t.style.visibility=No?"visible":"hidden"),e&&(e.style.visibility=No?"visible":"hidden",Tm(!No,dv),Tm(!No,pv))}function hC(t){const e=[];function i(h){(h.type===Xm||h.type===hv)&&e.push(h)}function s(h){h.geometry&&i(h.geometry)}function l(h){for(const d of h.features)d.type===Eb?s(d):d.type===Sm&&l(d)}return t.type===Eb?s(t):t.type===Sm?l(t):i(t),e}function dC(t){const e=hC(t),i=[];for(let s=0;s<e.length;s+=1){const l=e[s];l.type===Xm?i.push(l.coordinates):l.type===hv&&i.push(l.coordinates.flat())}return i.flat()}function pC(t,e){const i=Math.PI/180,s=t[1]*i,l=e[1]*i,h=Math.sin(s)*Math.sin(l)+Math.cos(s)*Math.cos(l)*Math.cos((e[0]-t[0])*i);return HM*Math.acos(Math.min(h,1))}function fC(t){const e=Array(t.length);e[0]=0;const i=e.length;for(let s=1;s<i;s++)e[s]=pC(t[s-1],t[s])+e[s-1];return e}const V0=(t,e,i,s,l,h)=>{const d=iC(t,i),c=document.createElement("div");c.style.maxHeight="225px",c.style.height="100%",c.style.width="100%",c.style.overflow="auto",c.style.color="black",c.style.colorScheme="auto",c.style.textAlign="left";const b=mC(d,void 0,s,l),S=b[0];let C=b[1];c.appendChild(S);const P=gC(d,i===PS,i===$a,h),A=P[0];let V=P[1],W=!1;const $=()=>{if(W){if(C){const H=document.getElementById(Gy);H&&(H.style.height=AS),A.style.maxHeight=zS}A.style.paddingBottom="5px",A.style.height=DS,A.style.overflow="hidden",A.style.background=Ib}else{if(C){const H=document.getElementById(Gy);H&&(H.style.height="50px"),A.style.maxHeight="100px"}A.style.paddingBottom="0px",A.style.height="100%",A.style.overflow="auto",A.style.background="transparent"}W=!W};V?(A.style.marginTop="10px",A.style.background=Ib):A.style.height="100%",c.appendChild(A);const nt=yC(e,d,V,$,NM);return c.appendChild(nt),c};function mC(t,e=$M,i=$h,s="",l="url"){var h;const d=document.createElement("div"),c=ed(e,t),b=ed(i,t),S=ed(s,t)??"";let C=!1,P=0;const A=()=>{const W=document.getElementById("prevArrow"),$=document.getElementById("nextArrow");if(P>0){const nt=P-1,H=document.getElementById(`image${P}`),Y=document.getElementById(`image${nt}`);H&&(H.style.display="none"),Y&&(Y.style.display="block"),$&&($.style.display="block"),W&&nt===0&&(W.style.display="none"),P=nt}},V=()=>{const W=document.getElementById("prevArrow"),$=document.getElementById("nextArrow");if(P<(c==null?void 0:c.length)-1){const nt=P+1,H=document.getElementById(`image${P}`),Y=document.getElementById(`image${nt}`);H&&(H.style.display="none"),Y&&(Y.style.display="block"),W&&(W.style.display="block"),$&&nt>=c.length-1&&($.style.display="none"),P=nt}};if(c!=null&&c.length){C=!0;const W=document.createElement("div");if(W.setAttribute("id",Gy),W.style.height=AS,W.style.maxHeight="100%",W.style.maxWidth="100%",W.style.display="flex",W.style.flexDirection="row",W.style.flexWrap="nowrap",W.style.justifyContent="center",W.style.alignItems="center",c==null||c.forEach(($,nt)=>{const H=document.createElement("img");H.addEventListener("click",()=>{window.open($==null?void 0:$.url,"_blank")}),H.id=`image${nt}`,H.src=($==null?void 0:$.url)??"",H.alt=($==null?void 0:$.altText)??"",H.title=($==null?void 0:$.caption)??"",H.style.maxHeight="100%",H.style.maxWidth="100%",H.style.cursor="zoom-in",H.style.display=nt===0?"block":"none",W.appendChild(H)}),(c==null?void 0:c.length)>1){const $=document.createElement("a"),nt=document.createElement("a");$.addEventListener("click",A),nt.addEventListener("click",V),$.id="prevArrow",$.innerText="<",$.style.display="none",$.style.cursor="pointer",$.style.position="absolute",$.style.left="1px",$.style.padding="5px",$.style.color="white",$.style.backgroundColor="goldenrod",$.style.fontWeight="bold",$.style.fontSize="18px",$.style.borderRadius="5px",nt.id="nextArrow",nt.innerText=">",nt.style.cursor="pointer",nt.style.position="absolute",nt.style.right="1px",nt.style.padding="5px",nt.style.color="white",nt.style.backgroundColor="goldenrod",nt.style.fontWeight="bold",nt.style.fontSize="18px",nt.style.borderRadius="5px",W.appendChild($),W.appendChild(nt)}d.appendChild(W)}if(b!=null&&b.length){const W=Object.prototype.toString.call(b)==="[object Array]",$=document.createElement("strong");$.textContent="",$.style.fontSize="medium",S!=null&&S.length&&($.textContent=`${S==null?void 0:S.toUpperCase()} - `),$.textContent+=W?b.join(", "):b,(h=t[l])!=null&&h.length&&($.textContent+="  ",$.style.textDecoration="underline",$.style.color="black",$.style.cursor="pointer",$.addEventListener("click",()=>{window.open(t[l])})),d.appendChild($)}return[d,C]}function gC(t,e=!1,i=!1,s=IS){var l,h,d,c,b,S,C,P,A,V,W,$,nt,H,Y,K,at,mt,xt,Tt,Mt,$t,Ft,Ot,ge,_e,Ae,ve,Ee,$e;const Vt=document.createElement("article"),re=ed(s,t);Vt.style.paddingBottom="5px",Vt.style.height=DS,Vt.style.maxHeight=zS,Vt.style.wordBreak="break-word",Vt.style.overflow="hidden",Vt.style.textOverflow="clip";let Kt=!1;if(e){const we=document.createElement("p"),Se=document.createElement("p"),ai=document.createElement("p"),Qe=document.createElement("p"),fi=document.createElement("p"),ni=document.createElement("p"),Ue=document.createElement("p"),Mi=document.createElement("p"),Ze=document.createElement("p"),ti=document.createElement("p"),_r=document.createElement("p"),sr=document.createElement("p"),vr=document.createElement("p"),ci=document.createElement("p"),Hr=document.createElement("p"),Et=document.createElement("p");(l=t==null?void 0:t.routeType)!=null&&l.length&&(we.innerHTML=`<b>Type:</b> ${t.routeType+((h=t==null?void 0:t.surface)!=null&&h.length?" - "+t.surface:"")}`,Vt.appendChild(we),Kt=!0),(d=t==null?void 0:t.difficulty)!=null&&d.length&&(Se.innerHTML=`<b>Difficulty:</b> ${t.difficulty}`,Vt.appendChild(Se),Kt=!0),(c=t==null?void 0:t.lengthInMiles)!=null&&c.length&&(ai.innerHTML=`<b>Length:</b> ${t.lengthInMiles} miles`,Vt.appendChild(ai),Kt=!0),(b=t==null?void 0:t.hikeTime)!=null&&b.length&&(Qe.innerHTML=`<b>Hike Time:</b> ${t.hikeTime}`,Vt.appendChild(Qe),Kt=!0),(S=t==null?void 0:t.elevationGain)!=null&&S.length&&(fi.innerHTML=`<b>Elevation Gain:</b> ${t.elevationGain}`,Vt.appendChild(fi),Kt=!0),(C=t==null?void 0:t.usage)!=null&&C.length&&(ni.innerHTML=`<b>Usage:</b> ${t.usage}`,Vt.appendChild(ni),Kt=!0),(P=t==null?void 0:t.accessibility)!=null&&P.length&&(Ue.innerHTML=`<b>Accessibility:</b> ${t.accessibility}`,Vt.appendChild(Ue),Kt=!0),(A=t==null?void 0:t.kid)!=null&&A.length&&(Mi.innerHTML=`<b>Kids:</b> ${t.kid}`,Vt.appendChild(Mi),Kt=!0),(V=t==null?void 0:t.dogs)!=null&&V.length&&(Ze.innerHTML=`<b>Dogs:</b> ${t.dogs}`,Vt.appendChild(Ze),Kt=!0),(W=t==null?void 0:t.activities)!=null&&W.length&&(ti.innerHTML=`<b>Activities:</b> ${(nt=($=t.activities)==null?void 0:$.sort((Bi,nn)=>Bi>nn?1:-1))==null?void 0:nt.join(", ")}`,Vt.appendChild(ti),Kt=!0),(H=t==null?void 0:t.features)!=null&&H.length&&(_r.innerHTML=`<b>Features:</b> ${(K=(Y=t.features)==null?void 0:Y.sort((Bi,nn)=>Bi>nn?1:-1))==null?void 0:K.join(", ")}`,Vt.appendChild(_r),Kt=!0),(at=t==null?void 0:t.obstacles)!=null&&at.length&&(sr.innerHTML=`<b>Obstacles:</b> ${(xt=(mt=t.obstacles)==null?void 0:mt.sort((Bi,nn)=>Bi>nn?1:-1))==null?void 0:xt.join(", ")}`,Vt.appendChild(sr),Kt=!0),vr.innerHTML=`<b>Reservation Required:</b> ${(t==null?void 0:t.reservationRequired)===!0?"Yes":"No"}`,Vt.appendChild(vr),Kt=!0,(t==null?void 0:t.reservationFee)>0&&(ci.innerHTML=`<b>Reservation Fee:</b> $${t.reservationFee}`,Vt.appendChild(ci),Kt=!0),(Tt=t==null?void 0:t.reservationUrl)!=null&&Tt.length&&(Hr.innerHTML=`<b>Reservation URL:</b> <a target="_blank" href="${t.reservationUrl}">Click here</a>`,Vt.appendChild(Hr),Kt=!0),re!=null&&re.length&&(Et.innerHTML=`<b>Description:</b> ${re}`,Vt.appendChild(Et),Kt=!0)}else if(i){const we=document.createElement("p"),Se=document.createElement("p"),ai=document.createElement("p"),Qe=document.createElement("p"),fi=document.createElement("p"),ni=document.createElement("p"),Ue=document.createElement("p"),Mi=ed(`${$a+Cd+BM}`,t);if((Mt=t[Mb])!=null&&Mt.length&&(we.innerHTML=`<b>Status:</b> ${($t=t[Mb])==null?void 0:$t.toUpperCase()}`,Vt.appendChild(we),Kt=!0),(Mi==null?void 0:Mi.length)>=1&&(Se.innerHTML=`<b>Impacted Trails:</b> ${Mi.join(", ")}`,Vt.appendChild(Se),Kt=!0),(Ot=(Ft=t[$a])==null?void 0:Ft.eventType)!=null&&Ot.length&&(ai.innerHTML=`<b>Type:</b> ${t[$a].eventType}`,Vt.appendChild(ai),Kt=!0),((ge=t==null?void 0:t.type_of_incidents)==null?void 0:ge.length)>=1){const Ze=(Ae=(_e=t.type_of_incidents)==null?void 0:_e.filter(ti=>{var _r;return(_r=ti==null?void 0:ti.incident_type)==null?void 0:_r.length}))==null?void 0:Ae.map(ti=>nC(ti==null?void 0:ti.incident_type));Ze!=null&&Ze.length&&(ni.innerHTML=`<b>Incident Types:</b> ${(ve=Ze==null?void 0:Ze.sort((ti,_r)=>ti>_r?1:-1))==null?void 0:ve.join(", ")}`),Vt.appendChild(ni),Kt=!0}(Ee=t==null?void 0:t.start_date)!=null&&Ee.length&&(Qe.innerHTML=`<b>Start Date:</b> ${Db(t.start_date)}`,Vt.appendChild(Qe),Kt=!0),($e=t==null?void 0:t.end_date)!=null&&$e.length&&(fi.innerHTML=`<b>End Date:</b> ${Db(t.end_date)}`,Vt.appendChild(fi),Kt=!0),re!=null&&re.length&&(Ue.innerHTML=`<b>Description:</b> ${re}`,Vt.appendChild(Ue),Kt=!0)}else if(re!=null&&re.length){const we=document.createElement("p");we.textContent=re,we.style.marginBottom="5px",Vt.appendChild(we),Kt=!0}return[Vt,Kt]}function yC(t,e,i,s,l=""){var h,d,c;const b=document.createElement("div"),S=document.createElement("p"),C=document.createElement("div");if(b.style.display="flex",b.style.flexDirection="row",b.style.flexWrap="nowrap",S.textContent=B0,S.style.textDecoration="underline",S.style.color="goldenrod",S.style.cursor="pointer",S.style.marginTop="7px",S.style.marginBottom="10px",S.style.display="flex",S.style.alignItems="flex-start",S.style.width="auto",S.addEventListener("click",()=>{S.textContent=S.textContent===B0?OM:B0,s()}),C.style.display="flex",C.style.flexDirection="row",C.style.justifyContent="flex-end",C.style.alignItems="flex-end",C.style.flexWrap="wrap",C.style.marginLeft="auto",C.style.maxWidth="79%",C.style.maxHeight="40px",C.style.overflow="hidden",i&&b.appendChild(S),(h=e[l])!=null&&h.length&&t){const P=((d=e[l])==null?void 0:d.sort(($,nt)=>($==null?void 0:$.name)>(nt==null?void 0:nt.name)?1:-1))??e[l];let A=0;const V=document.createElement("div");let W="";P.forEach(($,nt)=>{var H,Y,K,at;if((H=$==null?void 0:$.icon)!=null&&H.length||(Y=$==null?void 0:$.name)!=null&&Y.length){const mt=t.style.getImage(($==null?void 0:$.icon)||"things-to-do"),{data:xt}=mt||{};if(xt){if(A>=9)C.style.marginTop="3px",V.style.cursor="default",V.innerText=`+ ${A} more...`,W+=`${A===9?"":", "}${(K=$==null?void 0:$.name)==null?void 0:K.toString()}`,V.title=W;else{const Tt=document.createElement("div"),Mt=document.createElement("img"),$t=new ImageData(Uint8ClampedArray.from(xt.data),xt.width,xt.height),Ft=document.createElement("canvas"),Ot=Ft.getContext("2d");Ft.height=$t.height,Ft.width=$t.width,Ot==null||Ot.putImageData($t,0,0),Tt.style.paddingLeft="4px",Tt.style.display="flex",Tt.style.justifyContent="center",Tt.style.alignItems="flex-end",Mt.id=`amenity${nt}`,Mt.src=Ft.toDataURL(),Mt.classList.add("maplibre-icon"),Mt.title=Mt.alt=(at=$==null?void 0:$.name)==null?void 0:at.toString(),Mt.style.height="18px",Mt.style.width="18px",Mt.style.padding="2px",Mt.style.borderRadius="3px",Tt.appendChild(Mt),C.appendChild(Tt)}A++}}}),(c=V==null?void 0:V.innerText)!=null&&c.length&&C.appendChild(V),b.appendChild(C)}else S.style.marginBottom="1px";return b}/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function Ud(t){return t+.5|0}const Ea=(t,e,i)=>Math.max(Math.min(t,i),e);function Nh(t){return Ea(Ud(t*2.55),0,255)}function Na(t){return Ea(Ud(t*255),0,255)}function $o(t){return Ea(Ud(t/2.55)/100,0,1)}function Rb(t){return Ea(Ud(t*100),0,100)}const ys={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Yy=[..."0123456789ABCDEF"],_C=t=>Yy[t&15],vC=t=>Yy[(t&240)>>4]+Yy[t&15],gf=t=>(t&240)>>4===(t&15),xC=t=>gf(t.r)&&gf(t.g)&&gf(t.b)&&gf(t.a);function bC(t){var e=t.length,i;return t[0]==="#"&&(e===4||e===5?i={r:255&ys[t[1]]*17,g:255&ys[t[2]]*17,b:255&ys[t[3]]*17,a:e===5?ys[t[4]]*17:255}:(e===7||e===9)&&(i={r:ys[t[1]]<<4|ys[t[2]],g:ys[t[3]]<<4|ys[t[4]],b:ys[t[5]]<<4|ys[t[6]],a:e===9?ys[t[7]]<<4|ys[t[8]]:255})),i}const wC=(t,e)=>t<255?e(t):"";function SC(t){var e=xC(t)?_C:vC;return t?"#"+e(t.r)+e(t.g)+e(t.b)+wC(t.a,e):void 0}const kC=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function NS(t,e,i){const s=e*Math.min(i,1-i),l=(h,d=(h+t/30)%12)=>i-s*Math.max(Math.min(d-3,9-d,1),-1);return[l(0),l(8),l(4)]}function TC(t,e,i){const s=(l,h=(l+t/60)%6)=>i-i*e*Math.max(Math.min(h,4-h,1),0);return[s(5),s(3),s(1)]}function MC(t,e,i){const s=NS(t,1,.5);let l;for(e+i>1&&(l=1/(e+i),e*=l,i*=l),l=0;l<3;l++)s[l]*=1-e-i,s[l]+=e;return s}function CC(t,e,i,s,l){return t===l?(e-i)/s+(e<i?6:0):e===l?(i-t)/s+2:(t-e)/s+4}function fv(t){const e=t.r/255,i=t.g/255,s=t.b/255,l=Math.max(e,i,s),h=Math.min(e,i,s),d=(l+h)/2;let c,b,S;return l!==h&&(S=l-h,b=d>.5?S/(2-l-h):S/(l+h),c=CC(e,i,s,S,l),c=c*60+.5),[c|0,b||0,d]}function mv(t,e,i,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,i,s)).map(Na)}function gv(t,e,i){return mv(NS,t,e,i)}function EC(t,e,i){return mv(MC,t,e,i)}function PC(t,e,i){return mv(TC,t,e,i)}function jS(t){return(t%360+360)%360}function IC(t){const e=kC.exec(t);let i=255,s;if(!e)return;e[5]!==s&&(i=e[6]?Nh(+e[5]):Na(+e[5]));const l=jS(+e[2]),h=+e[3]/100,d=+e[4]/100;return e[1]==="hwb"?s=EC(l,h,d):e[1]==="hsv"?s=PC(l,h,d):s=gv(l,h,d),{r:s[0],g:s[1],b:s[2],a:i}}function AC(t,e){var i=fv(t);i[0]=jS(i[0]+e),i=gv(i),t.r=i[0],t.g=i[1],t.b=i[2]}function zC(t){if(!t)return;const e=fv(t),i=e[0],s=Rb(e[1]),l=Rb(e[2]);return t.a<255?`hsla(${i}, ${s}%, ${l}%, ${$o(t.a)})`:`hsl(${i}, ${s}%, ${l}%)`}const Fb={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Ob={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function DC(){const t={},e=Object.keys(Ob),i=Object.keys(Fb);let s,l,h,d,c;for(s=0;s<e.length;s++){for(d=c=e[s],l=0;l<i.length;l++)h=i[l],c=c.replace(h,Fb[h]);h=parseInt(Ob[d],16),t[c]=[h>>16&255,h>>8&255,h&255]}return t}let yf;function LC(t){yf||(yf=DC(),yf.transparent=[0,0,0,0]);const e=yf[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const RC=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function FC(t){const e=RC.exec(t);let i=255,s,l,h;if(e){if(e[7]!==s){const d=+e[7];i=e[8]?Nh(d):Ea(d*255,0,255)}return s=+e[1],l=+e[3],h=+e[5],s=255&(e[2]?Nh(s):Ea(s,0,255)),l=255&(e[4]?Nh(l):Ea(l,0,255)),h=255&(e[6]?Nh(h):Ea(h,0,255)),{r:s,g:l,b:h,a:i}}}function OC(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${$o(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const $0=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Rc=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function BC(t,e,i){const s=Rc($o(t.r)),l=Rc($o(t.g)),h=Rc($o(t.b));return{r:Na($0(s+i*(Rc($o(e.r))-s))),g:Na($0(l+i*(Rc($o(e.g))-l))),b:Na($0(h+i*(Rc($o(e.b))-h))),a:t.a+i*(e.a-t.a)}}function _f(t,e,i){if(t){let s=fv(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*i,e===0?360:1)),s=gv(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function US(t,e){return t&&Object.assign(e||{},t)}function Bb(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Na(t[3]))):(e=US(t,{r:0,g:0,b:0,a:1}),e.a=Na(e.a)),e}function VC(t){return t.charAt(0)==="r"?FC(t):IC(t)}class Ed{constructor(e){if(e instanceof Ed)return e;const i=typeof e;let s;i==="object"?s=Bb(e):i==="string"&&(s=bC(e)||LC(e)||VC(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=US(this._rgb);return e&&(e.a=$o(e.a)),e}set rgb(e){this._rgb=Bb(e)}rgbString(){return this._valid?OC(this._rgb):void 0}hexString(){return this._valid?SC(this._rgb):void 0}hslString(){return this._valid?zC(this._rgb):void 0}mix(e,i){if(e){const s=this.rgb,l=e.rgb;let h;const d=i===h?.5:i,c=2*d-1,b=s.a-l.a,S=((c*b===-1?c:(c+b)/(1+c*b))+1)/2;h=1-S,s.r=255&S*s.r+h*l.r+.5,s.g=255&S*s.g+h*l.g+.5,s.b=255&S*s.b+h*l.b+.5,s.a=d*s.a+(1-d)*l.a,this.rgb=s}return this}interpolate(e,i){return e&&(this._rgb=BC(this._rgb,e._rgb,i)),this}clone(){return new Ed(this.rgb)}alpha(e){return this._rgb.a=Na(e),this}clearer(e){const i=this._rgb;return i.a*=1-e,this}greyscale(){const e=this._rgb,i=Ud(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=i,this}opaquer(e){const i=this._rgb;return i.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return _f(this._rgb,2,e),this}darken(e){return _f(this._rgb,2,-e),this}saturate(e){return _f(this._rgb,1,e),this}desaturate(e){return _f(this._rgb,1,-e),this}rotate(e){return AC(this._rgb,e),this}}/*!
 * Chart.js v4.4.4
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */function Ro(){}const $C=(()=>{let t=0;return()=>t++})();function oi(t){return t===null||typeof t>"u"}function Zi(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Xe(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function rr(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function ns(t,e){return rr(t)?t:e}function Le(t,e){return typeof t>"u"?e:t}const NC=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,HS=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Ve(t,e,i){if(t&&typeof t.call=="function")return t.apply(i,e)}function We(t,e,i,s){let l,h,d;if(Zi(t))for(h=t.length,l=0;l<h;l++)e.call(i,t[l],l);else if(Xe(t))for(d=Object.keys(t),h=d.length,l=0;l<h;l++)e.call(i,t[d[l]],d[l])}function Mm(t,e){let i,s,l,h;if(!t||!e||t.length!==e.length)return!1;for(i=0,s=t.length;i<s;++i)if(l=t[i],h=e[i],l.datasetIndex!==h.datasetIndex||l.index!==h.index)return!1;return!0}function Cm(t){if(Zi(t))return t.map(Cm);if(Xe(t)){const e=Object.create(null),i=Object.keys(t),s=i.length;let l=0;for(;l<s;++l)e[i[l]]=Cm(t[i[l]]);return e}return t}function ZS(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function jC(t,e,i,s){if(!ZS(t))return;const l=e[t],h=i[t];Xe(l)&&Xe(h)?Pd(l,h,s):e[t]=Cm(h)}function Pd(t,e,i){const s=Zi(e)?e:[e],l=s.length;if(!Xe(t))return t;i=i||{};const h=i.merger||jC;let d;for(let c=0;c<l;++c){if(d=s[c],!Xe(d))continue;const b=Object.keys(d);for(let S=0,C=b.length;S<C;++S)h(b[S],t,d,i)}return t}function id(t,e){return Pd(t,e,{merger:UC})}function UC(t,e,i){if(!ZS(t))return;const s=e[t],l=i[t];Xe(s)&&Xe(l)?id(s,l):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Cm(l))}const Vb={"":t=>t,x:t=>t.x,y:t=>t.y};function HC(t){const e=t.split("."),i=[];let s="";for(const l of e)s+=l,s.endsWith("\\")?s=s.slice(0,-1)+".":(i.push(s),s="");return i}function ZC(t){const e=HC(t);return i=>{for(const s of e){if(s==="")break;i=i&&i[s]}return i}}function Ha(t,e){return(Vb[e]||(Vb[e]=ZC(e)))(t)}function yv(t){return t.charAt(0).toUpperCase()+t.slice(1)}const Id=t=>typeof t<"u",Za=t=>typeof t=="function",$b=(t,e)=>{if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0};function qC(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const Oi=Math.PI,Fi=2*Oi,GC=Fi+Oi,Em=Number.POSITIVE_INFINITY,WC=Oi/180,hr=Oi/2,bl=Oi/4,Nb=Oi*2/3,Pa=Math.log10,Ss=Math.sign;function rd(t,e,i){return Math.abs(t-e)<i}function jb(t){const e=Math.round(t);t=rd(t,e,t/1e3)?e:t;const i=Math.pow(10,Math.floor(Pa(t))),s=t/i;return(s<=1?1:s<=2?2:s<=5?5:10)*i}function YC(t){const e=[],i=Math.sqrt(t);let s;for(s=1;s<i;s++)t%s===0&&(e.push(s),e.push(t/s));return i===(i|0)&&e.push(i),e.sort((l,h)=>l-h).pop(),e}function cu(t){return!isNaN(parseFloat(t))&&isFinite(t)}function KC(t,e){const i=Math.round(t);return i-e<=t&&i+e>=t}function qS(t,e,i){let s,l,h;for(s=0,l=t.length;s<l;s++)h=t[s][i],isNaN(h)||(e.min=Math.min(e.min,h),e.max=Math.max(e.max,h))}function js(t){return t*(Oi/180)}function _v(t){return t*(180/Oi)}function Ub(t){if(!rr(t))return;let e=1,i=0;for(;Math.round(t*e)/e!==t;)e*=10,i++;return i}function GS(t,e){const i=e.x-t.x,s=e.y-t.y,l=Math.sqrt(i*i+s*s);let h=Math.atan2(s,i);return h<-.5*Oi&&(h+=Fi),{angle:h,distance:l}}function Ky(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function XC(t,e){return(t-e+GC)%Fi-Oi}function os(t){return(t%Fi+Fi)%Fi}function Ad(t,e,i,s){const l=os(t),h=os(e),d=os(i),c=os(h-l),b=os(d-l),S=os(l-h),C=os(l-d);return l===h||l===d||s&&h===d||c>b&&S<C}function jr(t,e,i){return Math.max(e,Math.min(i,t))}function JC(t){return jr(t,-32768,32767)}function Ho(t,e,i,s=1e-6){return t>=Math.min(e,i)-s&&t<=Math.max(e,i)+s}function vv(t,e,i){i=i||(d=>t[d]<e);let s=t.length-1,l=0,h;for(;s-l>1;)h=l+s>>1,i(h)?l=h:s=h;return{lo:l,hi:s}}const Zo=(t,e,i,s)=>vv(t,i,s?l=>{const h=t[l][e];return h<i||h===i&&t[l+1][e]===i}:l=>t[l][e]<i),QC=(t,e,i)=>vv(t,i,s=>t[s][e]>=i);function tE(t,e,i){let s=0,l=t.length;for(;s<l&&t[s]<e;)s++;for(;l>s&&t[l-1]>i;)l--;return s>0||l<t.length?t.slice(s,l):t}const WS=["push","pop","shift","splice","unshift"];function eE(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),WS.forEach(i=>{const s="_onData"+yv(i),l=t[i];Object.defineProperty(t,i,{configurable:!0,enumerable:!1,value(...h){const d=l.apply(this,h);return t._chartjs.listeners.forEach(c=>{typeof c[s]=="function"&&c[s](...h)}),d}})})}function Hb(t,e){const i=t._chartjs;if(!i)return;const s=i.listeners,l=s.indexOf(e);l!==-1&&s.splice(l,1),!(s.length>0)&&(WS.forEach(h=>{delete t[h]}),delete t._chartjs)}function YS(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const KS=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function XS(t,e){let i=[],s=!1;return function(...l){i=l,s||(s=!0,KS.call(window,()=>{s=!1,t.apply(e,i)}))}}function iE(t,e){let i;return function(...s){return e?(clearTimeout(i),i=setTimeout(t,e,s)):t.apply(this,s),e}}const xv=t=>t==="start"?"left":t==="end"?"right":"center",dn=(t,e,i)=>t==="start"?e:t==="end"?i:(e+i)/2,rE=(t,e,i,s)=>t===(s?"left":"right")?i:t==="center"?(e+i)/2:e;function JS(t,e,i){const s=e.length;let l=0,h=s;if(t._sorted){const{iScale:d,_parsed:c}=t,b=d.axis,{min:S,max:C,minDefined:P,maxDefined:A}=d.getUserBounds();P&&(l=jr(Math.min(Zo(c,b,S).lo,i?s:Zo(e,b,d.getPixelForValue(S)).lo),0,s-1)),A?h=jr(Math.max(Zo(c,d.axis,C,!0).hi+1,i?0:Zo(e,b,d.getPixelForValue(C),!0).hi+1),l,s)-l:h=s-l}return{start:l,count:h}}function QS(t){const{xScale:e,yScale:i,_scaleRanges:s}=t,l={xmin:e.min,xmax:e.max,ymin:i.min,ymax:i.max};if(!s)return t._scaleRanges=l,!0;const h=s.xmin!==e.min||s.xmax!==e.max||s.ymin!==i.min||s.ymax!==i.max;return Object.assign(s,l),h}const vf=t=>t===0||t===1,Zb=(t,e,i)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Fi/i)),qb=(t,e,i)=>Math.pow(2,-10*t)*Math.sin((t-e)*Fi/i)+1,nd={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*hr)+1,easeOutSine:t=>Math.sin(t*hr),easeInOutSine:t=>-.5*(Math.cos(Oi*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>vf(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>vf(t)?t:Zb(t,.075,.3),easeOutElastic:t=>vf(t)?t:qb(t,.075,.3),easeInOutElastic(t){return vf(t)?t:t<.5?.5*Zb(t*2,.1125,.45):.5+.5*qb(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-nd.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?nd.easeInBounce(t*2)*.5:nd.easeOutBounce(t*2-1)*.5+.5};function bv(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function Gb(t){return bv(t)?t:new Ed(t)}function N0(t){return bv(t)?t:new Ed(t).saturate(.5).darken(.1).hexString()}const nE=["x","y","borderWidth","radius","tension"],sE=["color","borderColor","backgroundColor"];function oE(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:sE},numbers:{type:"number",properties:nE}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function aE(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Wb=new Map;function lE(t,e){e=e||{};const i=t+JSON.stringify(e);let s=Wb.get(i);return s||(s=new Intl.NumberFormat(t,e),Wb.set(i,s)),s}function Hd(t,e,i){return lE(e,i).format(t)}const t9={values(t){return Zi(t)?t:""+t},numeric(t,e,i){if(t===0)return"0";const s=this.chart.options.locale;let l,h=t;if(i.length>1){const S=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(S<1e-4||S>1e15)&&(l="scientific"),h=cE(t,i)}const d=Pa(Math.abs(h)),c=isNaN(d)?1:Math.max(Math.min(-1*Math.floor(d),20),0),b={notation:l,minimumFractionDigits:c,maximumFractionDigits:c};return Object.assign(b,this.options.ticks.format),Hd(t,s,b)},logarithmic(t,e,i){if(t===0)return"0";const s=i[e].significand||t/Math.pow(10,Math.floor(Pa(t)));return[1,2,3,5,10,15].includes(s)||e>.8*i.length?t9.numeric.call(this,t,e,i):""}};function cE(t,e){let i=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(i)>=1&&t!==Math.floor(t)&&(i=t-Math.floor(t)),i}var Jm={formatters:t9};function uE(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,i)=>i.lineWidth,tickColor:(e,i)=>i.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Jm.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Nl=Object.create(null),Xy=Object.create(null);function sd(t,e){if(!e)return t;const i=e.split(".");for(let s=0,l=i.length;s<l;++s){const h=i[s];t=t[h]||(t[h]=Object.create(null))}return t}function j0(t,e,i){return typeof e=="string"?Pd(sd(t,e),i):Pd(sd(t,""),e)}class hE{constructor(e,i){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,l)=>N0(l.backgroundColor),this.hoverBorderColor=(s,l)=>N0(l.borderColor),this.hoverColor=(s,l)=>N0(l.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(i)}set(e,i){return j0(this,e,i)}get(e){return sd(this,e)}describe(e,i){return j0(Xy,e,i)}override(e,i){return j0(Nl,e,i)}route(e,i,s,l){const h=sd(this,e),d=sd(this,s),c="_"+i;Object.defineProperties(h,{[c]:{value:h[i],writable:!0},[i]:{enumerable:!0,get(){const b=this[c],S=d[l];return Xe(b)?Object.assign({},S,b):Le(b,S)},set(b){this[c]=b}}})}apply(e){e.forEach(i=>i(this))}}var nr=new hE({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[oE,aE,uE]);function dE(t){return!t||oi(t.size)||oi(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Pm(t,e,i,s,l){let h=e[l];return h||(h=e[l]=t.measureText(l).width,i.push(l)),h>s&&(s=h),s}function pE(t,e,i,s){s=s||{};let l=s.data=s.data||{},h=s.garbageCollect=s.garbageCollect||[];s.font!==e&&(l=s.data={},h=s.garbageCollect=[],s.font=e),t.save(),t.font=e;let d=0;const c=i.length;let b,S,C,P,A;for(b=0;b<c;b++)if(P=i[b],P!=null&&!Zi(P))d=Pm(t,l,h,d,P);else if(Zi(P))for(S=0,C=P.length;S<C;S++)A=P[S],A!=null&&!Zi(A)&&(d=Pm(t,l,h,d,A));t.restore();const V=h.length/2;if(V>i.length){for(b=0;b<V;b++)delete l[h[b]];h.splice(0,V)}return d}function wl(t,e,i){const s=t.currentDevicePixelRatio,l=i!==0?Math.max(i/2,.5):0;return Math.round((e-l)*s)/s+l}function Yb(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function Jy(t,e,i,s){e9(t,e,i,s,null)}function e9(t,e,i,s,l){let h,d,c,b,S,C,P,A;const V=e.pointStyle,W=e.rotation,$=e.radius;let nt=(W||0)*WC;if(V&&typeof V=="object"&&(h=V.toString(),h==="[object HTMLImageElement]"||h==="[object HTMLCanvasElement]")){t.save(),t.translate(i,s),t.rotate(nt),t.drawImage(V,-V.width/2,-V.height/2,V.width,V.height),t.restore();return}if(!(isNaN($)||$<=0)){switch(t.beginPath(),V){default:l?t.ellipse(i,s,l/2,$,0,0,Fi):t.arc(i,s,$,0,Fi),t.closePath();break;case"triangle":C=l?l/2:$,t.moveTo(i+Math.sin(nt)*C,s-Math.cos(nt)*$),nt+=Nb,t.lineTo(i+Math.sin(nt)*C,s-Math.cos(nt)*$),nt+=Nb,t.lineTo(i+Math.sin(nt)*C,s-Math.cos(nt)*$),t.closePath();break;case"rectRounded":S=$*.516,b=$-S,d=Math.cos(nt+bl)*b,P=Math.cos(nt+bl)*(l?l/2-S:b),c=Math.sin(nt+bl)*b,A=Math.sin(nt+bl)*(l?l/2-S:b),t.arc(i-P,s-c,S,nt-Oi,nt-hr),t.arc(i+A,s-d,S,nt-hr,nt),t.arc(i+P,s+c,S,nt,nt+hr),t.arc(i-A,s+d,S,nt+hr,nt+Oi),t.closePath();break;case"rect":if(!W){b=Math.SQRT1_2*$,C=l?l/2:b,t.rect(i-C,s-b,2*C,2*b);break}nt+=bl;case"rectRot":P=Math.cos(nt)*(l?l/2:$),d=Math.cos(nt)*$,c=Math.sin(nt)*$,A=Math.sin(nt)*(l?l/2:$),t.moveTo(i-P,s-c),t.lineTo(i+A,s-d),t.lineTo(i+P,s+c),t.lineTo(i-A,s+d),t.closePath();break;case"crossRot":nt+=bl;case"cross":P=Math.cos(nt)*(l?l/2:$),d=Math.cos(nt)*$,c=Math.sin(nt)*$,A=Math.sin(nt)*(l?l/2:$),t.moveTo(i-P,s-c),t.lineTo(i+P,s+c),t.moveTo(i+A,s-d),t.lineTo(i-A,s+d);break;case"star":P=Math.cos(nt)*(l?l/2:$),d=Math.cos(nt)*$,c=Math.sin(nt)*$,A=Math.sin(nt)*(l?l/2:$),t.moveTo(i-P,s-c),t.lineTo(i+P,s+c),t.moveTo(i+A,s-d),t.lineTo(i-A,s+d),nt+=bl,P=Math.cos(nt)*(l?l/2:$),d=Math.cos(nt)*$,c=Math.sin(nt)*$,A=Math.sin(nt)*(l?l/2:$),t.moveTo(i-P,s-c),t.lineTo(i+P,s+c),t.moveTo(i+A,s-d),t.lineTo(i-A,s+d);break;case"line":d=l?l/2:Math.cos(nt)*$,c=Math.sin(nt)*$,t.moveTo(i-d,s-c),t.lineTo(i+d,s+c);break;case"dash":t.moveTo(i,s),t.lineTo(i+Math.cos(nt)*(l?l/2:$),s+Math.sin(nt)*$);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function qo(t,e,i){return i=i||.5,!e||t&&t.x>e.left-i&&t.x<e.right+i&&t.y>e.top-i&&t.y<e.bottom+i}function Qm(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function tg(t){t.restore()}function fE(t,e,i,s,l){if(!e)return t.lineTo(i.x,i.y);if(l==="middle"){const h=(e.x+i.x)/2;t.lineTo(h,e.y),t.lineTo(h,i.y)}else l==="after"!=!!s?t.lineTo(e.x,i.y):t.lineTo(i.x,e.y);t.lineTo(i.x,i.y)}function mE(t,e,i,s){if(!e)return t.lineTo(i.x,i.y);t.bezierCurveTo(s?e.cp1x:e.cp2x,s?e.cp1y:e.cp2y,s?i.cp2x:i.cp1x,s?i.cp2y:i.cp1y,i.x,i.y)}function gE(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),oi(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function yE(t,e,i,s,l){if(l.strikethrough||l.underline){const h=t.measureText(s),d=e-h.actualBoundingBoxLeft,c=e+h.actualBoundingBoxRight,b=i-h.actualBoundingBoxAscent,S=i+h.actualBoundingBoxDescent,C=l.strikethrough?(b+S)/2:S;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=l.decorationWidth||2,t.moveTo(d,C),t.lineTo(c,C),t.stroke()}}function _E(t,e){const i=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=i}function jl(t,e,i,s,l,h={}){const d=Zi(e)?e:[e],c=h.strokeWidth>0&&h.strokeColor!=="";let b,S;for(t.save(),t.font=l.string,gE(t,h),b=0;b<d.length;++b)S=d[b],h.backdrop&&_E(t,h.backdrop),c&&(h.strokeColor&&(t.strokeStyle=h.strokeColor),oi(h.strokeWidth)||(t.lineWidth=h.strokeWidth),t.strokeText(S,i,s,h.maxWidth)),t.fillText(S,i,s,h.maxWidth),yE(t,i,s,S,h),s+=Number(l.lineHeight);t.restore()}function zd(t,e){const{x:i,y:s,w:l,h,radius:d}=e;t.arc(i+d.topLeft,s+d.topLeft,d.topLeft,1.5*Oi,Oi,!0),t.lineTo(i,s+h-d.bottomLeft),t.arc(i+d.bottomLeft,s+h-d.bottomLeft,d.bottomLeft,Oi,hr,!0),t.lineTo(i+l-d.bottomRight,s+h),t.arc(i+l-d.bottomRight,s+h-d.bottomRight,d.bottomRight,hr,0,!0),t.lineTo(i+l,s+d.topRight),t.arc(i+l-d.topRight,s+d.topRight,d.topRight,0,-hr,!0),t.lineTo(i+d.topLeft,s)}const vE=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,xE=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function bE(t,e){const i=(""+t).match(vE);if(!i||i[1]==="normal")return e*1.2;switch(t=+i[2],i[3]){case"px":return t;case"%":t/=100;break}return e*t}const wE=t=>+t||0;function wv(t,e){const i={},s=Xe(e),l=s?Object.keys(e):e,h=Xe(t)?s?d=>Le(t[d],t[e[d]]):d=>t[d]:()=>t;for(const d of l)i[d]=wE(h(d));return i}function i9(t){return wv(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Ll(t){return wv(t,["topLeft","topRight","bottomLeft","bottomRight"])}function gn(t){const e=i9(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Pr(t,e){t=t||{},e=e||nr.font;let i=Le(t.size,e.size);typeof i=="string"&&(i=parseInt(i,10));let s=Le(t.style,e.style);s&&!(""+s).match(xE)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const l={family:Le(t.family,e.family),lineHeight:bE(Le(t.lineHeight,e.lineHeight),i),size:i,style:s,weight:Le(t.weight,e.weight),string:""};return l.string=dE(l),l}function jh(t,e,i,s){let l,h,d;for(l=0,h=t.length;l<h;++l)if(d=t[l],d!==void 0&&d!==void 0)return d}function SE(t,e,i){const{min:s,max:l}=t,h=HS(e,(l-s)/2),d=(c,b)=>i&&c===0?0:c+b;return{min:d(s,-Math.abs(h)),max:d(l,h)}}function Ka(t,e){return Object.assign(Object.create(t),e)}function Sv(t,e=[""],i,s,l=()=>t[0]){const h=i||t;typeof s>"u"&&(s=o9("_fallback",t));const d={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:h,_fallback:s,_getTarget:l,override:c=>Sv([c,...t],e,h,s)};return new Proxy(d,{deleteProperty(c,b){return delete c[b],delete c._keys,delete t[0][b],!0},get(c,b){return n9(c,b,()=>AE(b,e,t,c))},getOwnPropertyDescriptor(c,b){return Reflect.getOwnPropertyDescriptor(c._scopes[0],b)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(c,b){return Xb(c).includes(b)},ownKeys(c){return Xb(c)},set(c,b,S){const C=c._storage||(c._storage=l());return c[b]=C[b]=S,delete c._keys,!0}})}function uu(t,e,i,s){const l={_cacheable:!1,_proxy:t,_context:e,_subProxy:i,_stack:new Set,_descriptors:r9(t,s),setContext:h=>uu(t,h,i,s),override:h=>uu(t.override(h),e,i,s)};return new Proxy(l,{deleteProperty(h,d){return delete h[d],delete t[d],!0},get(h,d,c){return n9(h,d,()=>TE(h,d,c))},getOwnPropertyDescriptor(h,d){return h._descriptors.allKeys?Reflect.has(t,d)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,d)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(h,d){return Reflect.has(t,d)},ownKeys(){return Reflect.ownKeys(t)},set(h,d,c){return t[d]=c,delete h[d],!0}})}function r9(t,e={scriptable:!0,indexable:!0}){const{_scriptable:i=e.scriptable,_indexable:s=e.indexable,_allKeys:l=e.allKeys}=t;return{allKeys:l,scriptable:i,indexable:s,isScriptable:Za(i)?i:()=>i,isIndexable:Za(s)?s:()=>s}}const kE=(t,e)=>t?t+yv(e):e,kv=(t,e)=>Xe(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function n9(t,e,i){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=i();return t[e]=s,s}function TE(t,e,i){const{_proxy:s,_context:l,_subProxy:h,_descriptors:d}=t;let c=s[e];return Za(c)&&d.isScriptable(e)&&(c=ME(e,c,t,i)),Zi(c)&&c.length&&(c=CE(e,c,t,d.isIndexable)),kv(e,c)&&(c=uu(c,l,h&&h[e],d)),c}function ME(t,e,i,s){const{_proxy:l,_context:h,_subProxy:d,_stack:c}=i;if(c.has(t))throw new Error("Recursion detected: "+Array.from(c).join("->")+"->"+t);c.add(t);let b=e(h,d||s);return c.delete(t),kv(t,b)&&(b=Tv(l._scopes,l,t,b)),b}function CE(t,e,i,s){const{_proxy:l,_context:h,_subProxy:d,_descriptors:c}=i;if(typeof h.index<"u"&&s(t))return e[h.index%e.length];if(Xe(e[0])){const b=e,S=l._scopes.filter(C=>C!==b);e=[];for(const C of b){const P=Tv(S,l,t,C);e.push(uu(P,h,d&&d[t],c))}}return e}function s9(t,e,i){return Za(t)?t(e,i):t}const EE=(t,e)=>t===!0?e:typeof t=="string"?Ha(e,t):void 0;function PE(t,e,i,s,l){for(const h of e){const d=EE(i,h);if(d){t.add(d);const c=s9(d._fallback,i,l);if(typeof c<"u"&&c!==i&&c!==s)return c}else if(d===!1&&typeof s<"u"&&i!==s)return null}return!1}function Tv(t,e,i,s){const l=e._rootScopes,h=s9(e._fallback,i,s),d=[...t,...l],c=new Set;c.add(s);let b=Kb(c,d,i,h||i,s);return b===null||typeof h<"u"&&h!==i&&(b=Kb(c,d,h,b,s),b===null)?!1:Sv(Array.from(c),[""],l,h,()=>IE(e,i,s))}function Kb(t,e,i,s,l){for(;i;)i=PE(t,e,i,s,l);return i}function IE(t,e,i){const s=t._getTarget();e in s||(s[e]={});const l=s[e];return Zi(l)&&Xe(i)?i:l||{}}function AE(t,e,i,s){let l;for(const h of e)if(l=o9(kE(h,t),i),typeof l<"u")return kv(t,l)?Tv(i,s,t,l):l}function o9(t,e){for(const i of e){if(!i)continue;const s=i[t];if(typeof s<"u")return s}}function Xb(t){let e=t._keys;return e||(e=t._keys=zE(t._scopes)),e}function zE(t){const e=new Set;for(const i of t)for(const s of Object.keys(i).filter(l=>!l.startsWith("_")))e.add(s);return Array.from(e)}function a9(t,e,i,s){const{iScale:l}=t,{key:h="r"}=this._parsing,d=new Array(s);let c,b,S,C;for(c=0,b=s;c<b;++c)S=c+i,C=e[S],d[c]={r:l.parse(Ha(C,h),S)};return d}const DE=Number.EPSILON||1e-14,hu=(t,e)=>e<t.length&&!t[e].skip&&t[e],l9=t=>t==="x"?"y":"x";function LE(t,e,i,s){const l=t.skip?e:t,h=e,d=i.skip?e:i,c=Ky(h,l),b=Ky(d,h);let S=c/(c+b),C=b/(c+b);S=isNaN(S)?0:S,C=isNaN(C)?0:C;const P=s*S,A=s*C;return{previous:{x:h.x-P*(d.x-l.x),y:h.y-P*(d.y-l.y)},next:{x:h.x+A*(d.x-l.x),y:h.y+A*(d.y-l.y)}}}function RE(t,e,i){const s=t.length;let l,h,d,c,b,S=hu(t,0);for(let C=0;C<s-1;++C)if(b=S,S=hu(t,C+1),!(!b||!S)){if(rd(e[C],0,DE)){i[C]=i[C+1]=0;continue}l=i[C]/e[C],h=i[C+1]/e[C],c=Math.pow(l,2)+Math.pow(h,2),!(c<=9)&&(d=3/Math.sqrt(c),i[C]=l*d*e[C],i[C+1]=h*d*e[C])}}function FE(t,e,i="x"){const s=l9(i),l=t.length;let h,d,c,b=hu(t,0);for(let S=0;S<l;++S){if(d=c,c=b,b=hu(t,S+1),!c)continue;const C=c[i],P=c[s];d&&(h=(C-d[i])/3,c[`cp1${i}`]=C-h,c[`cp1${s}`]=P-h*e[S]),b&&(h=(b[i]-C)/3,c[`cp2${i}`]=C+h,c[`cp2${s}`]=P+h*e[S])}}function OE(t,e="x"){const i=l9(e),s=t.length,l=Array(s).fill(0),h=Array(s);let d,c,b,S=hu(t,0);for(d=0;d<s;++d)if(c=b,b=S,S=hu(t,d+1),!!b){if(S){const C=S[e]-b[e];l[d]=C!==0?(S[i]-b[i])/C:0}h[d]=c?S?Ss(l[d-1])!==Ss(l[d])?0:(l[d-1]+l[d])/2:l[d-1]:l[d]}RE(t,l,h),FE(t,h,e)}function xf(t,e,i){return Math.max(Math.min(t,i),e)}function BE(t,e){let i,s,l,h,d,c=qo(t[0],e);for(i=0,s=t.length;i<s;++i)d=h,h=c,c=i<s-1&&qo(t[i+1],e),h&&(l=t[i],d&&(l.cp1x=xf(l.cp1x,e.left,e.right),l.cp1y=xf(l.cp1y,e.top,e.bottom)),c&&(l.cp2x=xf(l.cp2x,e.left,e.right),l.cp2y=xf(l.cp2y,e.top,e.bottom)))}function VE(t,e,i,s,l){let h,d,c,b;if(e.spanGaps&&(t=t.filter(S=>!S.skip)),e.cubicInterpolationMode==="monotone")OE(t,l);else{let S=s?t[t.length-1]:t[0];for(h=0,d=t.length;h<d;++h)c=t[h],b=LE(S,c,t[Math.min(h+1,d-(s?0:1))%d],e.tension),c.cp1x=b.previous.x,c.cp1y=b.previous.y,c.cp2x=b.next.x,c.cp2y=b.next.y,S=c}e.capBezierPoints&&BE(t,i)}function Mv(){return typeof window<"u"&&typeof document<"u"}function Cv(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Im(t,e,i){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[i])):s=t,s}const eg=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function $E(t,e){return eg(t).getPropertyValue(e)}const NE=["top","right","bottom","left"];function Rl(t,e,i){const s={};i=i?"-"+i:"";for(let l=0;l<4;l++){const h=NE[l];s[h]=parseFloat(t[e+"-"+h+i])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const jE=(t,e,i)=>(t>0||e>0)&&(!i||!i.shadowRoot);function UE(t,e){const i=t.touches,s=i&&i.length?i[0]:t,{offsetX:l,offsetY:h}=s;let d=!1,c,b;if(jE(l,h,t.target))c=l,b=h;else{const S=e.getBoundingClientRect();c=s.clientX-S.left,b=s.clientY-S.top,d=!0}return{x:c,y:b,box:d}}function mo(t,e){if("native"in t)return t;const{canvas:i,currentDevicePixelRatio:s}=e,l=eg(i),h=l.boxSizing==="border-box",d=Rl(l,"padding"),c=Rl(l,"border","width"),{x:b,y:S,box:C}=UE(t,i),P=d.left+(C&&c.left),A=d.top+(C&&c.top);let{width:V,height:W}=e;return h&&(V-=d.width+c.width,W-=d.height+c.height),{x:Math.round((b-P)/V*i.width/s),y:Math.round((S-A)/W*i.height/s)}}function HE(t,e,i){let s,l;if(e===void 0||i===void 0){const h=t&&Cv(t);if(!h)e=t.clientWidth,i=t.clientHeight;else{const d=h.getBoundingClientRect(),c=eg(h),b=Rl(c,"border","width"),S=Rl(c,"padding");e=d.width-S.width-b.width,i=d.height-S.height-b.height,s=Im(c.maxWidth,h,"clientWidth"),l=Im(c.maxHeight,h,"clientHeight")}}return{width:e,height:i,maxWidth:s||Em,maxHeight:l||Em}}const bf=t=>Math.round(t*10)/10;function ZE(t,e,i,s){const l=eg(t),h=Rl(l,"margin"),d=Im(l.maxWidth,t,"clientWidth")||Em,c=Im(l.maxHeight,t,"clientHeight")||Em,b=HE(t,e,i);let{width:S,height:C}=b;if(l.boxSizing==="content-box"){const P=Rl(l,"border","width"),A=Rl(l,"padding");S-=A.width+P.width,C-=A.height+P.height}return S=Math.max(0,S-h.width),C=Math.max(0,s?S/s:C-h.height),S=bf(Math.min(S,d,b.maxWidth)),C=bf(Math.min(C,c,b.maxHeight)),S&&!C&&(C=bf(S/2)),(e!==void 0||i!==void 0)&&s&&b.height&&C>b.height&&(C=b.height,S=bf(Math.floor(C*s))),{width:S,height:C}}function Jb(t,e,i){const s=e||1,l=Math.floor(t.height*s),h=Math.floor(t.width*s);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const d=t.canvas;return d.style&&(i||!d.style.height&&!d.style.width)&&(d.style.height=`${t.height}px`,d.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||d.height!==l||d.width!==h?(t.currentDevicePixelRatio=s,d.height=l,d.width=h,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const qE=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};Mv()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function Qb(t,e){const i=$E(t,e),s=i&&i.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function Cl(t,e,i,s){return{x:t.x+i*(e.x-t.x),y:t.y+i*(e.y-t.y)}}function GE(t,e,i,s){return{x:t.x+i*(e.x-t.x),y:s==="middle"?i<.5?t.y:e.y:s==="after"?i<1?t.y:e.y:i>0?e.y:t.y}}function WE(t,e,i,s){const l={x:t.cp2x,y:t.cp2y},h={x:e.cp1x,y:e.cp1y},d=Cl(t,l,i),c=Cl(l,h,i),b=Cl(h,e,i),S=Cl(d,c,i),C=Cl(c,b,i);return Cl(S,C,i)}const YE=function(t,e){return{x(i){return t+t+e-i},setWidth(i){e=i},textAlign(i){return i==="center"?i:i==="right"?"left":"right"},xPlus(i,s){return i-s},leftForLtr(i,s){return i-s}}},KE=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function eu(t,e,i){return t?YE(e,i):KE()}function c9(t,e){let i,s;(e==="ltr"||e==="rtl")&&(i=t.canvas.style,s=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",e,"important"),t.prevTextDirection=s)}function u9(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function h9(t){return t==="angle"?{between:Ad,compare:XC,normalize:os}:{between:Ho,compare:(e,i)=>e-i,normalize:e=>e}}function tw({start:t,end:e,count:i,loop:s,style:l}){return{start:t%i,end:e%i,loop:s&&(e-t+1)%i===0,style:l}}function XE(t,e,i){const{property:s,start:l,end:h}=i,{between:d,normalize:c}=h9(s),b=e.length;let{start:S,end:C,loop:P}=t,A,V;if(P){for(S+=b,C+=b,A=0,V=b;A<V&&d(c(e[S%b][s]),l,h);++A)S--,C--;S%=b,C%=b}return C<S&&(C+=b),{start:S,end:C,loop:P,style:t.style}}function d9(t,e,i){if(!i)return[t];const{property:s,start:l,end:h}=i,d=e.length,{compare:c,between:b,normalize:S}=h9(s),{start:C,end:P,loop:A,style:V}=XE(t,e,i),W=[];let $=!1,nt=null,H,Y,K;const at=()=>b(l,K,H)&&c(l,K)!==0,mt=()=>c(h,H)===0||b(h,K,H),xt=()=>$||at(),Tt=()=>!$||mt();for(let Mt=C,$t=C;Mt<=P;++Mt)Y=e[Mt%d],!Y.skip&&(H=S(Y[s]),H!==K&&($=b(H,l,h),nt===null&&xt()&&(nt=c(H,l)===0?Mt:$t),nt!==null&&Tt()&&(W.push(tw({start:nt,end:Mt,loop:A,count:d,style:V})),nt=null),$t=Mt,K=H));return nt!==null&&W.push(tw({start:nt,end:P,loop:A,count:d,style:V})),W}function p9(t,e){const i=[],s=t.segments;for(let l=0;l<s.length;l++){const h=d9(s[l],t.points,e);h.length&&i.push(...h)}return i}function JE(t,e,i,s){let l=0,h=e-1;if(i&&!s)for(;l<e&&!t[l].skip;)l++;for(;l<e&&t[l].skip;)l++;for(l%=e,i&&(h+=l);h>l&&t[h%e].skip;)h--;return h%=e,{start:l,end:h}}function QE(t,e,i,s){const l=t.length,h=[];let d=e,c=t[e],b;for(b=e+1;b<=i;++b){const S=t[b%l];S.skip||S.stop?c.skip||(s=!1,h.push({start:e%l,end:(b-1)%l,loop:s}),e=d=S.stop?b:null):(d=b,c.skip&&(e=b)),c=S}return d!==null&&h.push({start:e%l,end:d%l,loop:s}),h}function tP(t,e){const i=t.points,s=t.options.spanGaps,l=i.length;if(!l)return[];const h=!!t._loop,{start:d,end:c}=JE(i,l,h,s);if(s===!0)return ew(t,[{start:d,end:c,loop:h}],i,e);const b=c<d?c+l:c,S=!!t._fullLoop&&d===0&&c===l-1;return ew(t,QE(i,d,b,S),i,e)}function ew(t,e,i,s){return!s||!s.setContext||!i?e:eP(t,e,i,s)}function eP(t,e,i,s){const l=t._chart.getContext(),h=iw(t.options),{_datasetIndex:d,options:{spanGaps:c}}=t,b=i.length,S=[];let C=h,P=e[0].start,A=P;function V(W,$,nt,H){const Y=c?-1:1;if(W!==$){for(W+=b;i[W%b].skip;)W-=Y;for(;i[$%b].skip;)$+=Y;W%b!==$%b&&(S.push({start:W%b,end:$%b,loop:nt,style:H}),C=H,P=$%b)}}for(const W of e){P=c?P:W.start;let $=i[P%b],nt;for(A=P+1;A<=W.end;A++){const H=i[A%b];nt=iw(s.setContext(Ka(l,{type:"segment",p0:$,p1:H,p0DataIndex:(A-1)%b,p1DataIndex:A%b,datasetIndex:d}))),iP(nt,C)&&V(P,A-1,W.loop,C),$=H,C=nt}P<A-1&&V(P,A-1,W.loop,C)}return S}function iw(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function iP(t,e){if(!e)return!1;const i=[],s=function(l,h){return bv(h)?(i.includes(h)||i.push(h),i.indexOf(h)):h};return JSON.stringify(t,s)!==JSON.stringify(e,s)}/*!
 * Chart.js v4.4.4
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */class rP{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,i,s,l){const h=i.listeners[l],d=i.duration;h.forEach(c=>c({chart:e,initial:i.initial,numSteps:d,currentStep:Math.min(s-i.start,d)}))}_refresh(){this._request||(this._running=!0,this._request=KS.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let i=0;this._charts.forEach((s,l)=>{if(!s.running||!s.items.length)return;const h=s.items;let d=h.length-1,c=!1,b;for(;d>=0;--d)b=h[d],b._active?(b._total>s.duration&&(s.duration=b._total),b.tick(e),c=!0):(h[d]=h[h.length-1],h.pop());c&&(l.draw(),this._notify(l,s,e,"progress")),h.length||(s.running=!1,this._notify(l,s,e,"complete"),s.initial=!1),i+=h.length}),this._lastDate=e,i===0&&(this._running=!1)}_getAnims(e){const i=this._charts;let s=i.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},i.set(e,s)),s}listen(e,i,s){this._getAnims(e).listeners[i].push(s)}add(e,i){!i||!i.length||this._getAnims(e).items.push(...i)}has(e){return this._getAnims(e).items.length>0}start(e){const i=this._charts.get(e);i&&(i.running=!0,i.start=Date.now(),i.duration=i.items.reduce((s,l)=>Math.max(s,l._duration),0),this._refresh())}running(e){if(!this._running)return!1;const i=this._charts.get(e);return!(!i||!i.running||!i.items.length)}stop(e){const i=this._charts.get(e);if(!i||!i.items.length)return;const s=i.items;let l=s.length-1;for(;l>=0;--l)s[l].cancel();i.items=[],this._notify(e,i,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Fo=new rP;const rw="transparent",nP={boolean(t,e,i){return i>.5?e:t},color(t,e,i){const s=Gb(t||rw),l=s.valid&&Gb(e||rw);return l&&l.valid?l.mix(s,i).hexString():e},number(t,e,i){return t+(e-t)*i}};class sP{constructor(e,i,s,l){const h=i[s];l=jh([e.to,l,h,e.from]);const d=jh([e.from,h,l]);this._active=!0,this._fn=e.fn||nP[e.type||typeof d],this._easing=nd[e.easing]||nd.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=i,this._prop=s,this._from=d,this._to=l,this._promises=void 0}active(){return this._active}update(e,i,s){if(this._active){this._notify(!1);const l=this._target[this._prop],h=s-this._start,d=this._duration-h;this._start=s,this._duration=Math.floor(Math.max(d,e.duration)),this._total+=h,this._loop=!!e.loop,this._to=jh([e.to,i,l,e.from]),this._from=jh([e.from,l,i])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const i=e-this._start,s=this._duration,l=this._prop,h=this._from,d=this._loop,c=this._to;let b;if(this._active=h!==c&&(d||i<s),!this._active){this._target[l]=c,this._notify(!0);return}if(i<0){this._target[l]=h;return}b=i/s%2,b=d&&b>1?2-b:b,b=this._easing(Math.min(1,Math.max(0,b))),this._target[l]=this._fn(h,c,b)}wait(){const e=this._promises||(this._promises=[]);return new Promise((i,s)=>{e.push({res:i,rej:s})})}_notify(e){const i=e?"res":"rej",s=this._promises||[];for(let l=0;l<s.length;l++)s[l][i]()}}class f9{constructor(e,i){this._chart=e,this._properties=new Map,this.configure(i)}configure(e){if(!Xe(e))return;const i=Object.keys(nr.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(l=>{const h=e[l];if(!Xe(h))return;const d={};for(const c of i)d[c]=h[c];(Zi(h.properties)&&h.properties||[l]).forEach(c=>{(c===l||!s.has(c))&&s.set(c,d)})})}_animateOptions(e,i){const s=i.options,l=aP(e,s);if(!l)return[];const h=this._createAnimations(l,s);return s.$shared&&oP(e.options.$animations,s).then(()=>{e.options=s},()=>{}),h}_createAnimations(e,i){const s=this._properties,l=[],h=e.$animations||(e.$animations={}),d=Object.keys(i),c=Date.now();let b;for(b=d.length-1;b>=0;--b){const S=d[b];if(S.charAt(0)==="$")continue;if(S==="options"){l.push(...this._animateOptions(e,i));continue}const C=i[S];let P=h[S];const A=s.get(S);if(P)if(A&&P.active()){P.update(A,C,c);continue}else P.cancel();if(!A||!A.duration){e[S]=C;continue}h[S]=P=new sP(A,e,S,C),l.push(P)}return l}update(e,i){if(this._properties.size===0){Object.assign(e,i);return}const s=this._createAnimations(e,i);if(s.length)return Fo.add(this._chart,s),!0}}function oP(t,e){const i=[],s=Object.keys(e);for(let l=0;l<s.length;l++){const h=t[s[l]];h&&h.active()&&i.push(h.wait())}return Promise.all(i)}function aP(t,e){if(!e)return;let i=t.options;if(!i){t.options=e;return}return i.$shared&&(t.options=i=Object.assign({},i,{$shared:!1,$animations:{}})),i}function nw(t,e){const i=t&&t.options||{},s=i.reverse,l=i.min===void 0?e:0,h=i.max===void 0?e:0;return{start:s?h:l,end:s?l:h}}function lP(t,e,i){if(i===!1)return!1;const s=nw(t,i),l=nw(e,i);return{top:l.end,right:s.end,bottom:l.start,left:s.start}}function cP(t){let e,i,s,l;return Xe(t)?(e=t.top,i=t.right,s=t.bottom,l=t.left):e=i=s=l=t,{top:e,right:i,bottom:s,left:l,disabled:t===!1}}function m9(t,e){const i=[],s=t._getSortedDatasetMetas(e);let l,h;for(l=0,h=s.length;l<h;++l)i.push(s[l].index);return i}function sw(t,e,i,s={}){const l=t.keys,h=s.mode==="single";let d,c,b,S;if(e!==null){for(d=0,c=l.length;d<c;++d){if(b=+l[d],b===i){if(s.all)continue;break}S=t.values[b],rr(S)&&(h||e===0||Ss(e)===Ss(S))&&(e+=S)}return e}}function uP(t,e){const{iScale:i,vScale:s}=e,l=i.axis==="x"?"x":"y",h=s.axis==="x"?"x":"y",d=Object.keys(t),c=new Array(d.length);let b,S,C;for(b=0,S=d.length;b<S;++b)C=d[b],c[b]={[l]:C,[h]:t[C]};return c}function ow(t,e){const i=t&&t.options.stacked;return i||i===void 0&&e.stack!==void 0}function hP(t,e,i){return`${t.id}.${e.id}.${i.stack||i.type}`}function dP(t){const{min:e,max:i,minDefined:s,maxDefined:l}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:l?i:Number.POSITIVE_INFINITY}}function pP(t,e,i){const s=t[e]||(t[e]={});return s[i]||(s[i]={})}function aw(t,e,i,s){for(const l of e.getMatchingVisibleMetas(s).reverse()){const h=t[l.index];if(i&&h>0||!i&&h<0)return l.index}return null}function lw(t,e){const{chart:i,_cachedMeta:s}=t,l=i._stacks||(i._stacks={}),{iScale:h,vScale:d,index:c}=s,b=h.axis,S=d.axis,C=hP(h,d,s),P=e.length;let A;for(let V=0;V<P;++V){const W=e[V],{[b]:$,[S]:nt}=W,H=W._stacks||(W._stacks={});A=H[S]=pP(l,C,$),A[c]=nt,A._top=aw(A,d,!0,s.type),A._bottom=aw(A,d,!1,s.type);const Y=A._visualValues||(A._visualValues={});Y[c]=nt}}function U0(t,e){const i=t.scales;return Object.keys(i).filter(s=>i[s].axis===e).shift()}function fP(t,e){return Ka(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function mP(t,e,i){return Ka(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:i,index:e,mode:"default",type:"data"})}function Ah(t,e){const i=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const l of e){const h=l._stacks;if(!h||h[s]===void 0||h[s][i]===void 0)return;delete h[s][i],h[s]._visualValues!==void 0&&h[s]._visualValues[i]!==void 0&&delete h[s]._visualValues[i]}}}const H0=t=>t==="reset"||t==="none",cw=(t,e)=>e?t:Object.assign({},t),gP=(t,e,i)=>t&&!e.hidden&&e._stacked&&{keys:m9(i,!0),values:null};class Zs{constructor(e,i){this.chart=e,this._ctx=e.ctx,this.index=i,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=ow(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Ah(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,i=this._cachedMeta,s=this.getDataset(),l=(P,A,V,W)=>P==="x"?A:P==="r"?W:V,h=i.xAxisID=Le(s.xAxisID,U0(e,"x")),d=i.yAxisID=Le(s.yAxisID,U0(e,"y")),c=i.rAxisID=Le(s.rAxisID,U0(e,"r")),b=i.indexAxis,S=i.iAxisID=l(b,h,d,c),C=i.vAxisID=l(b,d,h,c);i.xScale=this.getScaleForId(h),i.yScale=this.getScaleForId(d),i.rScale=this.getScaleForId(c),i.iScale=this.getScaleForId(S),i.vScale=this.getScaleForId(C)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const i=this._cachedMeta;return e===i.iScale?i.vScale:i.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Hb(this._data,this),e._stacked&&Ah(e)}_dataCheck(){const e=this.getDataset(),i=e.data||(e.data=[]),s=this._data;if(Xe(i)){const l=this._cachedMeta;this._data=uP(i,l)}else if(s!==i){if(s){Hb(s,this);const l=this._cachedMeta;Ah(l),l._parsed=[]}i&&Object.isExtensible(i)&&eE(i,this),this._syncList=[],this._data=i}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const i=this._cachedMeta,s=this.getDataset();let l=!1;this._dataCheck();const h=i._stacked;i._stacked=ow(i.vScale,i),i.stack!==s.stack&&(l=!0,Ah(i),i.stack=s.stack),this._resyncElements(e),(l||h!==i._stacked)&&lw(this,i._parsed)}configure(){const e=this.chart.config,i=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),i,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,i){const{_cachedMeta:s,_data:l}=this,{iScale:h,_stacked:d}=s,c=h.axis;let b=e===0&&i===l.length?!0:s._sorted,S=e>0&&s._parsed[e-1],C,P,A;if(this._parsing===!1)s._parsed=l,s._sorted=!0,A=l;else{Zi(l[e])?A=this.parseArrayData(s,l,e,i):Xe(l[e])?A=this.parseObjectData(s,l,e,i):A=this.parsePrimitiveData(s,l,e,i);const V=()=>P[c]===null||S&&P[c]<S[c];for(C=0;C<i;++C)s._parsed[C+e]=P=A[C],b&&(V()&&(b=!1),S=P);s._sorted=b}d&&lw(this,A)}parsePrimitiveData(e,i,s,l){const{iScale:h,vScale:d}=e,c=h.axis,b=d.axis,S=h.getLabels(),C=h===d,P=new Array(l);let A,V,W;for(A=0,V=l;A<V;++A)W=A+s,P[A]={[c]:C||h.parse(S[W],W),[b]:d.parse(i[W],W)};return P}parseArrayData(e,i,s,l){const{xScale:h,yScale:d}=e,c=new Array(l);let b,S,C,P;for(b=0,S=l;b<S;++b)C=b+s,P=i[C],c[b]={x:h.parse(P[0],C),y:d.parse(P[1],C)};return c}parseObjectData(e,i,s,l){const{xScale:h,yScale:d}=e,{xAxisKey:c="x",yAxisKey:b="y"}=this._parsing,S=new Array(l);let C,P,A,V;for(C=0,P=l;C<P;++C)A=C+s,V=i[A],S[C]={x:h.parse(Ha(V,c),A),y:d.parse(Ha(V,b),A)};return S}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,i,s){const l=this.chart,h=this._cachedMeta,d=i[e.axis],c={keys:m9(l,!0),values:i._stacks[e.axis]._visualValues};return sw(c,d,h.index,{mode:s})}updateRangeFromParsed(e,i,s,l){const h=s[i.axis];let d=h===null?NaN:h;const c=l&&s._stacks[i.axis];l&&c&&(l.values=c,d=sw(l,h,this._cachedMeta.index)),e.min=Math.min(e.min,d),e.max=Math.max(e.max,d)}getMinMax(e,i){const s=this._cachedMeta,l=s._parsed,h=s._sorted&&e===s.iScale,d=l.length,c=this._getOtherScale(e),b=gP(i,s,this.chart),S={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:C,max:P}=dP(c);let A,V;function W(){V=l[A];const $=V[c.axis];return!rr(V[e.axis])||C>$||P<$}for(A=0;A<d&&!(!W()&&(this.updateRangeFromParsed(S,e,V,b),h));++A);if(h){for(A=d-1;A>=0;--A)if(!W()){this.updateRangeFromParsed(S,e,V,b);break}}return S}getAllParsedValues(e){const i=this._cachedMeta._parsed,s=[];let l,h,d;for(l=0,h=i.length;l<h;++l)d=i[l][e.axis],rr(d)&&s.push(d);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const i=this._cachedMeta,s=i.iScale,l=i.vScale,h=this.getParsed(e);return{label:s?""+s.getLabelForValue(h[s.axis]):"",value:l?""+l.getLabelForValue(h[l.axis]):""}}_update(e){const i=this._cachedMeta;this.update(e||"default"),i._clip=cP(Le(this.options.clip,lP(i.xScale,i.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,i=this.chart,s=this._cachedMeta,l=s.data||[],h=i.chartArea,d=[],c=this._drawStart||0,b=this._drawCount||l.length-c,S=this.options.drawActiveElementsOnTop;let C;for(s.dataset&&s.dataset.draw(e,h,c,b),C=c;C<c+b;++C){const P=l[C];P.hidden||(P.active&&S?d.push(P):P.draw(e,h))}for(C=0;C<d.length;++C)d[C].draw(e,h)}getStyle(e,i){const s=i?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,i,s){const l=this.getDataset();let h;if(e>=0&&e<this._cachedMeta.data.length){const d=this._cachedMeta.data[e];h=d.$context||(d.$context=mP(this.getContext(),e,d)),h.parsed=this.getParsed(e),h.raw=l.data[e],h.index=h.dataIndex=e}else h=this.$context||(this.$context=fP(this.chart.getContext(),this.index)),h.dataset=l,h.index=h.datasetIndex=this.index;return h.active=!!i,h.mode=s,h}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,i){return this._resolveElementOptions(this.dataElementType.id,i,e)}_resolveElementOptions(e,i="default",s){const l=i==="active",h=this._cachedDataOpts,d=e+"-"+i,c=h[d],b=this.enableOptionSharing&&Id(s);if(c)return cw(c,b);const S=this.chart.config,C=S.datasetElementScopeKeys(this._type,e),P=l?[`${e}Hover`,"hover",e,""]:[e,""],A=S.getOptionScopes(this.getDataset(),C),V=Object.keys(nr.elements[e]),W=()=>this.getContext(s,l,i),$=S.resolveNamedOptions(A,V,W,P);return $.$shared&&($.$shared=b,h[d]=Object.freeze(cw($,b))),$}_resolveAnimations(e,i,s){const l=this.chart,h=this._cachedDataOpts,d=`animation-${i}`,c=h[d];if(c)return c;let b;if(l.options.animation!==!1){const C=this.chart.config,P=C.datasetAnimationScopeKeys(this._type,i),A=C.getOptionScopes(this.getDataset(),P);b=C.createResolver(A,this.getContext(e,s,i))}const S=new f9(l,b&&b.animations);return b&&b._cacheable&&(h[d]=Object.freeze(S)),S}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,i){return!i||H0(e)||this.chart._animationsDisabled}_getSharedOptions(e,i){const s=this.resolveDataElementOptions(e,i),l=this._sharedOptions,h=this.getSharedOptions(s),d=this.includeOptions(i,h)||h!==l;return this.updateSharedOptions(h,i,s),{sharedOptions:h,includeOptions:d}}updateElement(e,i,s,l){H0(l)?Object.assign(e,s):this._resolveAnimations(i,l).update(e,s)}updateSharedOptions(e,i,s){e&&!H0(i)&&this._resolveAnimations(void 0,i).update(e,s)}_setStyle(e,i,s,l){e.active=l;const h=this.getStyle(i,l);this._resolveAnimations(i,s,l).update(e,{options:!l&&this.getSharedOptions(h)||h})}removeHoverStyle(e,i,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,i,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const i=this._data,s=this._cachedMeta.data;for(const[c,b,S]of this._syncList)this[c](b,S);this._syncList=[];const l=s.length,h=i.length,d=Math.min(h,l);d&&this.parse(0,d),h>l?this._insertElements(l,h-l,e):h<l&&this._removeElements(h,l-h)}_insertElements(e,i,s=!0){const l=this._cachedMeta,h=l.data,d=e+i;let c;const b=S=>{for(S.length+=i,c=S.length-1;c>=d;c--)S[c]=S[c-i]};for(b(h),c=e;c<d;++c)h[c]=new this.dataElementType;this._parsing&&b(l._parsed),this.parse(e,i),s&&this.updateElements(h,e,i,"reset")}updateElements(e,i,s,l){}_removeElements(e,i){const s=this._cachedMeta;if(this._parsing){const l=s._parsed.splice(e,i);s._stacked&&Ah(s,l)}s.data.splice(e,i)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[i,s,l]=e;this[i](s,l)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,i){i&&this._sync(["_removeElements",e,i]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}se(Zs,"defaults",{}),se(Zs,"datasetElementType",null),se(Zs,"dataElementType",null);function yP(t,e){if(!t._cache.$bar){const i=t.getMatchingVisibleMetas(e);let s=[];for(let l=0,h=i.length;l<h;l++)s=s.concat(i[l].controller.getAllParsedValues(t));t._cache.$bar=YS(s.sort((l,h)=>l-h))}return t._cache.$bar}function _P(t){const e=t.iScale,i=yP(e,t.type);let s=e._length,l,h,d,c;const b=()=>{d===32767||d===-32768||(Id(c)&&(s=Math.min(s,Math.abs(d-c)||s)),c=d)};for(l=0,h=i.length;l<h;++l)d=e.getPixelForValue(i[l]),b();for(c=void 0,l=0,h=e.ticks.length;l<h;++l)d=e.getPixelForTick(l),b();return s}function vP(t,e,i,s){const l=i.barThickness;let h,d;return oi(l)?(h=e.min*i.categoryPercentage,d=i.barPercentage):(h=l*s,d=1),{chunk:h/s,ratio:d,start:e.pixels[t]-h/2}}function xP(t,e,i,s){const l=e.pixels,h=l[t];let d=t>0?l[t-1]:null,c=t<l.length-1?l[t+1]:null;const b=i.categoryPercentage;d===null&&(d=h-(c===null?e.end-e.start:c-h)),c===null&&(c=h+h-d);const S=h-(h-Math.min(d,c))/2*b;return{chunk:Math.abs(c-d)/2*b/s,ratio:i.barPercentage,start:S}}function bP(t,e,i,s){const l=i.parse(t[0],s),h=i.parse(t[1],s),d=Math.min(l,h),c=Math.max(l,h);let b=d,S=c;Math.abs(d)>Math.abs(c)&&(b=c,S=d),e[i.axis]=S,e._custom={barStart:b,barEnd:S,start:l,end:h,min:d,max:c}}function g9(t,e,i,s){return Zi(t)?bP(t,e,i,s):e[i.axis]=i.parse(t,s),e}function uw(t,e,i,s){const l=t.iScale,h=t.vScale,d=l.getLabels(),c=l===h,b=[];let S,C,P,A;for(S=i,C=i+s;S<C;++S)A=e[S],P={},P[l.axis]=c||l.parse(d[S],S),b.push(g9(A,P,h,S));return b}function Z0(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function wP(t,e,i){return t!==0?Ss(t):(e.isHorizontal()?1:-1)*(e.min>=i?1:-1)}function SP(t){let e,i,s,l,h;return t.horizontal?(e=t.base>t.x,i="left",s="right"):(e=t.base<t.y,i="bottom",s="top"),e?(l="end",h="start"):(l="start",h="end"),{start:i,end:s,reverse:e,top:l,bottom:h}}function kP(t,e,i,s){let l=e.borderSkipped;const h={};if(!l){t.borderSkipped=h;return}if(l===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:d,end:c,reverse:b,top:S,bottom:C}=SP(t);l==="middle"&&i&&(t.enableBorderRadius=!0,(i._top||0)===s?l=S:(i._bottom||0)===s?l=C:(h[hw(C,d,c,b)]=!0,l=S)),h[hw(l,d,c,b)]=!0,t.borderSkipped=h}function hw(t,e,i,s){return s?(t=TP(t,e,i),t=dw(t,i,e)):t=dw(t,e,i),t}function TP(t,e,i){return t===e?i:t===i?e:t}function dw(t,e,i){return t==="start"?e:t==="end"?i:t}function MP(t,{inflateAmount:e},i){t.inflateAmount=e==="auto"?i===1?.33:0:e}class Hf extends Zs{parsePrimitiveData(e,i,s,l){return uw(e,i,s,l)}parseArrayData(e,i,s,l){return uw(e,i,s,l)}parseObjectData(e,i,s,l){const{iScale:h,vScale:d}=e,{xAxisKey:c="x",yAxisKey:b="y"}=this._parsing,S=h.axis==="x"?c:b,C=d.axis==="x"?c:b,P=[];let A,V,W,$;for(A=s,V=s+l;A<V;++A)$=i[A],W={},W[h.axis]=h.parse(Ha($,S),A),P.push(g9(Ha($,C),W,d,A));return P}updateRangeFromParsed(e,i,s,l){super.updateRangeFromParsed(e,i,s,l);const h=s._custom;h&&i===this._cachedMeta.vScale&&(e.min=Math.min(e.min,h.min),e.max=Math.max(e.max,h.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const i=this._cachedMeta,{iScale:s,vScale:l}=i,h=this.getParsed(e),d=h._custom,c=Z0(d)?"["+d.start+", "+d.end+"]":""+l.getLabelForValue(h[l.axis]);return{label:""+s.getLabelForValue(h[s.axis]),value:c}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const i=this._cachedMeta;this.updateElements(i.data,0,i.data.length,e)}updateElements(e,i,s,l){const h=l==="reset",{index:d,_cachedMeta:{vScale:c}}=this,b=c.getBasePixel(),S=c.isHorizontal(),C=this._getRuler(),{sharedOptions:P,includeOptions:A}=this._getSharedOptions(i,l);for(let V=i;V<i+s;V++){const W=this.getParsed(V),$=h||oi(W[c.axis])?{base:b,head:b}:this._calculateBarValuePixels(V),nt=this._calculateBarIndexPixels(V,C),H=(W._stacks||{})[c.axis],Y={horizontal:S,base:$.base,enableBorderRadius:!H||Z0(W._custom)||d===H._top||d===H._bottom,x:S?$.head:nt.center,y:S?nt.center:$.head,height:S?nt.size:Math.abs($.size),width:S?Math.abs($.size):nt.size};A&&(Y.options=P||this.resolveDataElementOptions(V,e[V].active?"active":l));const K=Y.options||e[V].options;kP(Y,K,H,d),MP(Y,K,C.ratio),this.updateElement(e[V],V,Y,l)}}_getStacks(e,i){const{iScale:s}=this._cachedMeta,l=s.getMatchingVisibleMetas(this._type).filter(C=>C.controller.options.grouped),h=s.options.stacked,d=[],c=this._cachedMeta.controller.getParsed(i),b=c&&c[s.axis],S=C=>{const P=C._parsed.find(V=>V[s.axis]===b),A=P&&P[C.vScale.axis];if(oi(A)||isNaN(A))return!0};for(const C of l)if(!(i!==void 0&&S(C))&&((h===!1||d.indexOf(C.stack)===-1||h===void 0&&C.stack===void 0)&&d.push(C.stack),C.index===e))break;return d.length||d.push(void 0),d}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,i,s){const l=this._getStacks(e,s),h=i!==void 0?l.indexOf(i):-1;return h===-1?l.length-1:h}_getRuler(){const e=this.options,i=this._cachedMeta,s=i.iScale,l=[];let h,d;for(h=0,d=i.data.length;h<d;++h)l.push(s.getPixelForValue(this.getParsed(h)[s.axis],h));const c=e.barThickness;return{min:c||_P(i),pixels:l,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:c?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:i,_stacked:s,index:l},options:{base:h,minBarLength:d}}=this,c=h||0,b=this.getParsed(e),S=b._custom,C=Z0(S);let P=b[i.axis],A=0,V=s?this.applyStack(i,b,s):P,W,$;V!==P&&(A=V-P,V=P),C&&(P=S.barStart,V=S.barEnd-S.barStart,P!==0&&Ss(P)!==Ss(S.barEnd)&&(A=0),A+=P);const nt=!oi(h)&&!C?h:A;let H=i.getPixelForValue(nt);if(this.chart.getDataVisibility(e)?W=i.getPixelForValue(A+V):W=H,$=W-H,Math.abs($)<d){$=wP($,i,c)*d,P===c&&(H-=$/2);const Y=i.getPixelForDecimal(0),K=i.getPixelForDecimal(1),at=Math.min(Y,K),mt=Math.max(Y,K);H=Math.max(Math.min(H,mt),at),W=H+$,s&&!C&&(b._stacks[i.axis]._visualValues[l]=i.getValueForPixel(W)-i.getValueForPixel(H))}if(H===i.getPixelForValue(c)){const Y=Ss($)*i.getLineWidthForValue(c)/2;H+=Y,$-=Y}return{size:$,base:H,head:W,center:W+$/2}}_calculateBarIndexPixels(e,i){const s=i.scale,l=this.options,h=l.skipNull,d=Le(l.maxBarThickness,1/0);let c,b;if(i.grouped){const S=h?this._getStackCount(e):i.stackCount,C=l.barThickness==="flex"?xP(e,i,l,S):vP(e,i,l,S),P=this._getStackIndex(this.index,this._cachedMeta.stack,h?e:void 0);c=C.start+C.chunk*P+C.chunk/2,b=Math.min(d,C.chunk*C.ratio)}else c=s.getPixelForValue(this.getParsed(e)[s.axis],e),b=Math.min(d,i.min*i.ratio);return{base:c-b/2,head:c+b/2,center:c,size:b}}draw(){const e=this._cachedMeta,i=e.vScale,s=e.data,l=s.length;let h=0;for(;h<l;++h)this.getParsed(h)[i.axis]!==null&&!s[h].hidden&&s[h].draw(this._ctx)}}se(Hf,"id","bar"),se(Hf,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),se(Hf,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class Zf extends Zs{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,i,s,l){const h=super.parsePrimitiveData(e,i,s,l);for(let d=0;d<h.length;d++)h[d]._custom=this.resolveDataElementOptions(d+s).radius;return h}parseArrayData(e,i,s,l){const h=super.parseArrayData(e,i,s,l);for(let d=0;d<h.length;d++){const c=i[s+d];h[d]._custom=Le(c[2],this.resolveDataElementOptions(d+s).radius)}return h}parseObjectData(e,i,s,l){const h=super.parseObjectData(e,i,s,l);for(let d=0;d<h.length;d++){const c=i[s+d];h[d]._custom=Le(c&&c.r&&+c.r,this.resolveDataElementOptions(d+s).radius)}return h}getMaxOverflow(){const e=this._cachedMeta.data;let i=0;for(let s=e.length-1;s>=0;--s)i=Math.max(i,e[s].size(this.resolveDataElementOptions(s))/2);return i>0&&i}getLabelAndValue(e){const i=this._cachedMeta,s=this.chart.data.labels||[],{xScale:l,yScale:h}=i,d=this.getParsed(e),c=l.getLabelForValue(d.x),b=h.getLabelForValue(d.y),S=d._custom;return{label:s[e]||"",value:"("+c+", "+b+(S?", "+S:"")+")"}}update(e){const i=this._cachedMeta.data;this.updateElements(i,0,i.length,e)}updateElements(e,i,s,l){const h=l==="reset",{iScale:d,vScale:c}=this._cachedMeta,{sharedOptions:b,includeOptions:S}=this._getSharedOptions(i,l),C=d.axis,P=c.axis;for(let A=i;A<i+s;A++){const V=e[A],W=!h&&this.getParsed(A),$={},nt=$[C]=h?d.getPixelForDecimal(.5):d.getPixelForValue(W[C]),H=$[P]=h?c.getBasePixel():c.getPixelForValue(W[P]);$.skip=isNaN(nt)||isNaN(H),S&&($.options=b||this.resolveDataElementOptions(A,V.active?"active":l),h&&($.options.radius=0)),this.updateElement(V,A,$,l)}}resolveDataElementOptions(e,i){const s=this.getParsed(e);let l=super.resolveDataElementOptions(e,i);l.$shared&&(l=Object.assign({},l,{$shared:!1}));const h=l.radius;return i!=="active"&&(l.radius=0),l.radius+=Le(s&&s._custom,h),l}}se(Zf,"id","bubble"),se(Zf,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),se(Zf,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function CP(t,e,i){let s=1,l=1,h=0,d=0;if(e<Fi){const c=t,b=c+e,S=Math.cos(c),C=Math.sin(c),P=Math.cos(b),A=Math.sin(b),V=(K,at,mt)=>Ad(K,c,b,!0)?1:Math.max(at,at*i,mt,mt*i),W=(K,at,mt)=>Ad(K,c,b,!0)?-1:Math.min(at,at*i,mt,mt*i),$=V(0,S,P),nt=V(hr,C,A),H=W(Oi,S,P),Y=W(Oi+hr,C,A);s=($-H)/2,l=(nt-Y)/2,h=-($+H)/2,d=-(nt+Y)/2}return{ratioX:s,ratioY:l,offsetX:h,offsetY:d}}class Al extends Zs{constructor(e,i){super(e,i),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,i){const s=this.getDataset().data,l=this._cachedMeta;if(this._parsing===!1)l._parsed=s;else{let h=b=>+s[b];if(Xe(s[e])){const{key:b="value"}=this._parsing;h=S=>+Ha(s[S],b)}let d,c;for(d=e,c=e+i;d<c;++d)l._parsed[d]=h(d)}}_getRotation(){return js(this.options.rotation-90)}_getCircumference(){return js(this.options.circumference)}_getRotationExtents(){let e=Fi,i=-Fi;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const l=this.chart.getDatasetMeta(s).controller,h=l._getRotation(),d=l._getCircumference();e=Math.min(e,h),i=Math.max(i,h+d)}return{rotation:e,circumference:i-e}}update(e){const i=this.chart,{chartArea:s}=i,l=this._cachedMeta,h=l.data,d=this.getMaxBorderWidth()+this.getMaxOffset(h)+this.options.spacing,c=Math.max((Math.min(s.width,s.height)-d)/2,0),b=Math.min(NC(this.options.cutout,c),1),S=this._getRingWeight(this.index),{circumference:C,rotation:P}=this._getRotationExtents(),{ratioX:A,ratioY:V,offsetX:W,offsetY:$}=CP(P,C,b),nt=(s.width-d)/A,H=(s.height-d)/V,Y=Math.max(Math.min(nt,H)/2,0),K=HS(this.options.radius,Y),at=Math.max(K*b,0),mt=(K-at)/this._getVisibleDatasetWeightTotal();this.offsetX=W*K,this.offsetY=$*K,l.total=this.calculateTotal(),this.outerRadius=K-mt*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-mt*S,0),this.updateElements(h,0,h.length,e)}_circumference(e,i){const s=this.options,l=this._cachedMeta,h=this._getCircumference();return i&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||l._parsed[e]===null||l.data[e].hidden?0:this.calculateCircumference(l._parsed[e]*h/Fi)}updateElements(e,i,s,l){const h=l==="reset",d=this.chart,c=d.chartArea,b=d.options.animation,S=(c.left+c.right)/2,C=(c.top+c.bottom)/2,P=h&&b.animateScale,A=P?0:this.innerRadius,V=P?0:this.outerRadius,{sharedOptions:W,includeOptions:$}=this._getSharedOptions(i,l);let nt=this._getRotation(),H;for(H=0;H<i;++H)nt+=this._circumference(H,h);for(H=i;H<i+s;++H){const Y=this._circumference(H,h),K=e[H],at={x:S+this.offsetX,y:C+this.offsetY,startAngle:nt,endAngle:nt+Y,circumference:Y,outerRadius:V,innerRadius:A};$&&(at.options=W||this.resolveDataElementOptions(H,K.active?"active":l)),nt+=Y,this.updateElement(K,H,at,l)}}calculateTotal(){const e=this._cachedMeta,i=e.data;let s=0,l;for(l=0;l<i.length;l++){const h=e._parsed[l];h!==null&&!isNaN(h)&&this.chart.getDataVisibility(l)&&!i[l].hidden&&(s+=Math.abs(h))}return s}calculateCircumference(e){const i=this._cachedMeta.total;return i>0&&!isNaN(e)?Fi*(Math.abs(e)/i):0}getLabelAndValue(e){const i=this._cachedMeta,s=this.chart,l=s.data.labels||[],h=Hd(i._parsed[e],s.options.locale);return{label:l[e]||"",value:h}}getMaxBorderWidth(e){let i=0;const s=this.chart;let l,h,d,c,b;if(!e){for(l=0,h=s.data.datasets.length;l<h;++l)if(s.isDatasetVisible(l)){d=s.getDatasetMeta(l),e=d.data,c=d.controller;break}}if(!e)return 0;for(l=0,h=e.length;l<h;++l)b=c.resolveDataElementOptions(l),b.borderAlign!=="inner"&&(i=Math.max(i,b.borderWidth||0,b.hoverBorderWidth||0));return i}getMaxOffset(e){let i=0;for(let s=0,l=e.length;s<l;++s){const h=this.resolveDataElementOptions(s);i=Math.max(i,h.offset||0,h.hoverOffset||0)}return i}_getRingWeightOffset(e){let i=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(i+=this._getRingWeight(s));return i}_getRingWeight(e){return Math.max(Le(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}se(Al,"id","doughnut"),se(Al,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),se(Al,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),se(Al,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:i,color:s}}=t.legend.options;return e.labels.map((l,h)=>{const d=t.getDatasetMeta(0).controller.getStyle(h);return{text:l,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,fontColor:s,lineWidth:d.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(h),index:h}})}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}}});class qf extends Zs{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const i=this._cachedMeta,{dataset:s,data:l=[],_dataset:h}=i,d=this.chart._animationsDisabled;let{start:c,count:b}=JS(i,l,d);this._drawStart=c,this._drawCount=b,QS(i)&&(c=0,b=l.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!h._decimated,s.points=l;const S=this.resolveDatasetElementOptions(e);this.options.showLine||(S.borderWidth=0),S.segment=this.options.segment,this.updateElement(s,void 0,{animated:!d,options:S},e),this.updateElements(l,c,b,e)}updateElements(e,i,s,l){const h=l==="reset",{iScale:d,vScale:c,_stacked:b,_dataset:S}=this._cachedMeta,{sharedOptions:C,includeOptions:P}=this._getSharedOptions(i,l),A=d.axis,V=c.axis,{spanGaps:W,segment:$}=this.options,nt=cu(W)?W:Number.POSITIVE_INFINITY,H=this.chart._animationsDisabled||h||l==="none",Y=i+s,K=e.length;let at=i>0&&this.getParsed(i-1);for(let mt=0;mt<K;++mt){const xt=e[mt],Tt=H?xt:{};if(mt<i||mt>=Y){Tt.skip=!0;continue}const Mt=this.getParsed(mt),$t=oi(Mt[V]),Ft=Tt[A]=d.getPixelForValue(Mt[A],mt),Ot=Tt[V]=h||$t?c.getBasePixel():c.getPixelForValue(b?this.applyStack(c,Mt,b):Mt[V],mt);Tt.skip=isNaN(Ft)||isNaN(Ot)||$t,Tt.stop=mt>0&&Math.abs(Mt[A]-at[A])>nt,$&&(Tt.parsed=Mt,Tt.raw=S.data[mt]),P&&(Tt.options=C||this.resolveDataElementOptions(mt,xt.active?"active":l)),H||this.updateElement(xt,mt,Tt,l),at=Mt}}getMaxOverflow(){const e=this._cachedMeta,i=e.dataset,s=i.options&&i.options.borderWidth||0,l=e.data||[];if(!l.length)return s;const h=l[0].size(this.resolveDataElementOptions(0)),d=l[l.length-1].size(this.resolveDataElementOptions(l.length-1));return Math.max(s,h,d)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}se(qf,"id","line"),se(qf,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),se(qf,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class od extends Zs{constructor(e,i){super(e,i),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const i=this._cachedMeta,s=this.chart,l=s.data.labels||[],h=Hd(i._parsed[e].r,s.options.locale);return{label:l[e]||"",value:h}}parseObjectData(e,i,s,l){return a9.bind(this)(e,i,s,l)}update(e){const i=this._cachedMeta.data;this._updateRadius(),this.updateElements(i,0,i.length,e)}getMinMax(){const e=this._cachedMeta,i={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((s,l)=>{const h=this.getParsed(l).r;!isNaN(h)&&this.chart.getDataVisibility(l)&&(h<i.min&&(i.min=h),h>i.max&&(i.max=h))}),i}_updateRadius(){const e=this.chart,i=e.chartArea,s=e.options,l=Math.min(i.right-i.left,i.bottom-i.top),h=Math.max(l/2,0),d=Math.max(s.cutoutPercentage?h/100*s.cutoutPercentage:1,0),c=(h-d)/e.getVisibleDatasetCount();this.outerRadius=h-c*this.index,this.innerRadius=this.outerRadius-c}updateElements(e,i,s,l){const h=l==="reset",d=this.chart,c=d.options.animation,b=this._cachedMeta.rScale,S=b.xCenter,C=b.yCenter,P=b.getIndexAngle(0)-.5*Oi;let A=P,V;const W=360/this.countVisibleElements();for(V=0;V<i;++V)A+=this._computeAngle(V,l,W);for(V=i;V<i+s;V++){const $=e[V];let nt=A,H=A+this._computeAngle(V,l,W),Y=d.getDataVisibility(V)?b.getDistanceFromCenterForValue(this.getParsed(V).r):0;A=H,h&&(c.animateScale&&(Y=0),c.animateRotate&&(nt=H=P));const K={x:S,y:C,innerRadius:0,outerRadius:Y,startAngle:nt,endAngle:H,options:this.resolveDataElementOptions(V,$.active?"active":l)};this.updateElement($,V,K,l)}}countVisibleElements(){const e=this._cachedMeta;let i=0;return e.data.forEach((s,l)=>{!isNaN(this.getParsed(l).r)&&this.chart.getDataVisibility(l)&&i++}),i}_computeAngle(e,i,s){return this.chart.getDataVisibility(e)?js(this.resolveDataElementOptions(e,i).angle||s):0}}se(od,"id","polarArea"),se(od,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),se(od,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:i,color:s}}=t.legend.options;return e.labels.map((l,h)=>{const d=t.getDatasetMeta(0).controller.getStyle(h);return{text:l,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,fontColor:s,lineWidth:d.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(h),index:h}})}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class Qy extends Al{}se(Qy,"id","pie"),se(Qy,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class Gf extends Zs{getLabelAndValue(e){const i=this._cachedMeta.vScale,s=this.getParsed(e);return{label:i.getLabels()[e],value:""+i.getLabelForValue(s[i.axis])}}parseObjectData(e,i,s,l){return a9.bind(this)(e,i,s,l)}update(e){const i=this._cachedMeta,s=i.dataset,l=i.data||[],h=i.iScale.getLabels();if(s.points=l,e!=="resize"){const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0);const c={_loop:!0,_fullLoop:h.length===l.length,options:d};this.updateElement(s,void 0,c,e)}this.updateElements(l,0,l.length,e)}updateElements(e,i,s,l){const h=this._cachedMeta.rScale,d=l==="reset";for(let c=i;c<i+s;c++){const b=e[c],S=this.resolveDataElementOptions(c,b.active?"active":l),C=h.getPointPositionForValue(c,this.getParsed(c).r),P=d?h.xCenter:C.x,A=d?h.yCenter:C.y,V={x:P,y:A,angle:C.angle,skip:isNaN(P)||isNaN(A),options:S};this.updateElement(b,c,V,l)}}}se(Gf,"id","radar"),se(Gf,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),se(Gf,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class Wf extends Zs{getLabelAndValue(e){const i=this._cachedMeta,s=this.chart.data.labels||[],{xScale:l,yScale:h}=i,d=this.getParsed(e),c=l.getLabelForValue(d.x),b=h.getLabelForValue(d.y);return{label:s[e]||"",value:"("+c+", "+b+")"}}update(e){const i=this._cachedMeta,{data:s=[]}=i,l=this.chart._animationsDisabled;let{start:h,count:d}=JS(i,s,l);if(this._drawStart=h,this._drawCount=d,QS(i)&&(h=0,d=s.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:c,_dataset:b}=i;c._chart=this.chart,c._datasetIndex=this.index,c._decimated=!!b._decimated,c.points=s;const S=this.resolveDatasetElementOptions(e);S.segment=this.options.segment,this.updateElement(c,void 0,{animated:!l,options:S},e)}else this.datasetElementType&&(delete i.dataset,this.datasetElementType=!1);this.updateElements(s,h,d,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,i,s,l){const h=l==="reset",{iScale:d,vScale:c,_stacked:b,_dataset:S}=this._cachedMeta,C=this.resolveDataElementOptions(i,l),P=this.getSharedOptions(C),A=this.includeOptions(l,P),V=d.axis,W=c.axis,{spanGaps:$,segment:nt}=this.options,H=cu($)?$:Number.POSITIVE_INFINITY,Y=this.chart._animationsDisabled||h||l==="none";let K=i>0&&this.getParsed(i-1);for(let at=i;at<i+s;++at){const mt=e[at],xt=this.getParsed(at),Tt=Y?mt:{},Mt=oi(xt[W]),$t=Tt[V]=d.getPixelForValue(xt[V],at),Ft=Tt[W]=h||Mt?c.getBasePixel():c.getPixelForValue(b?this.applyStack(c,xt,b):xt[W],at);Tt.skip=isNaN($t)||isNaN(Ft)||Mt,Tt.stop=at>0&&Math.abs(xt[V]-K[V])>H,nt&&(Tt.parsed=xt,Tt.raw=S.data[at]),A&&(Tt.options=P||this.resolveDataElementOptions(at,mt.active?"active":l)),Y||this.updateElement(mt,at,Tt,l),K=xt}this.updateSharedOptions(P,l,C)}getMaxOverflow(){const e=this._cachedMeta,i=e.data||[];if(!this.options.showLine){let c=0;for(let b=i.length-1;b>=0;--b)c=Math.max(c,i[b].size(this.resolveDataElementOptions(b))/2);return c>0&&c}const s=e.dataset,l=s.options&&s.options.borderWidth||0;if(!i.length)return l;const h=i[0].size(this.resolveDataElementOptions(0)),d=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(l,h,d)/2}}se(Wf,"id","scatter"),se(Wf,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),se(Wf,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var EP=Object.freeze({__proto__:null,BarController:Hf,BubbleController:Zf,DoughnutController:Al,LineController:qf,PieController:Qy,PolarAreaController:od,RadarController:Gf,ScatterController:Wf});function Sl(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Ev{constructor(e){se(this,"options"),this.options=e||{}}static override(e){Object.assign(Ev.prototype,e)}init(){}formats(){return Sl()}parse(){return Sl()}format(){return Sl()}add(){return Sl()}diff(){return Sl()}startOf(){return Sl()}endOf(){return Sl()}}var PP={_date:Ev};function IP(t,e,i,s){const{controller:l,data:h,_sorted:d}=t,c=l._cachedMeta.iScale;if(c&&e===c.axis&&e!=="r"&&d&&h.length){const b=c._reversePixels?QC:Zo;if(s){if(l._sharedOptions){const S=h[0],C=typeof S.getRange=="function"&&S.getRange(e);if(C){const P=b(h,e,i-C),A=b(h,e,i+C);return{lo:P.lo,hi:A.hi}}}}else return b(h,e,i)}return{lo:0,hi:h.length-1}}function Zd(t,e,i,s,l){const h=t.getSortedVisibleDatasetMetas(),d=i[e];for(let c=0,b=h.length;c<b;++c){const{index:S,data:C}=h[c],{lo:P,hi:A}=IP(h[c],e,d,l);for(let V=P;V<=A;++V){const W=C[V];W.skip||s(W,S,V)}}}function AP(t){const e=t.indexOf("x")!==-1,i=t.indexOf("y")!==-1;return function(s,l){const h=e?Math.abs(s.x-l.x):0,d=i?Math.abs(s.y-l.y):0;return Math.sqrt(Math.pow(h,2)+Math.pow(d,2))}}function q0(t,e,i,s,l){const h=[];return!l&&!t.isPointInArea(e)||Zd(t,i,e,function(d,c,b){!l&&!qo(d,t.chartArea,0)||d.inRange(e.x,e.y,s)&&h.push({element:d,datasetIndex:c,index:b})},!0),h}function zP(t,e,i,s){let l=[];function h(d,c,b){const{startAngle:S,endAngle:C}=d.getProps(["startAngle","endAngle"],s),{angle:P}=GS(d,{x:e.x,y:e.y});Ad(P,S,C)&&l.push({element:d,datasetIndex:c,index:b})}return Zd(t,i,e,h),l}function DP(t,e,i,s,l,h){let d=[];const c=AP(i);let b=Number.POSITIVE_INFINITY;function S(C,P,A){const V=C.inRange(e.x,e.y,l);if(s&&!V)return;const W=C.getCenterPoint(l);if(!(h||t.isPointInArea(W))&&!V)return;const $=c(e,W);$<b?(d=[{element:C,datasetIndex:P,index:A}],b=$):$===b&&d.push({element:C,datasetIndex:P,index:A})}return Zd(t,i,e,S),d}function G0(t,e,i,s,l,h){return!h&&!t.isPointInArea(e)?[]:i==="r"&&!s?zP(t,e,i,l):DP(t,e,i,s,l,h)}function pw(t,e,i,s,l){const h=[],d=i==="x"?"inXRange":"inYRange";let c=!1;return Zd(t,i,e,(b,S,C)=>{b[d]&&b[d](e[i],l)&&(h.push({element:b,datasetIndex:S,index:C}),c=c||b.inRange(e.x,e.y,l))}),s&&!c?[]:h}var LP={evaluateInteractionItems:Zd,modes:{index(t,e,i,s){const l=mo(e,t),h=i.axis||"x",d=i.includeInvisible||!1,c=i.intersect?q0(t,l,h,s,d):G0(t,l,h,!1,s,d),b=[];return c.length?(t.getSortedVisibleDatasetMetas().forEach(S=>{const C=c[0].index,P=S.data[C];P&&!P.skip&&b.push({element:P,datasetIndex:S.index,index:C})}),b):[]},dataset(t,e,i,s){const l=mo(e,t),h=i.axis||"xy",d=i.includeInvisible||!1;let c=i.intersect?q0(t,l,h,s,d):G0(t,l,h,!1,s,d);if(c.length>0){const b=c[0].datasetIndex,S=t.getDatasetMeta(b).data;c=[];for(let C=0;C<S.length;++C)c.push({element:S[C],datasetIndex:b,index:C})}return c},point(t,e,i,s){const l=mo(e,t),h=i.axis||"xy",d=i.includeInvisible||!1;return q0(t,l,h,s,d)},nearest(t,e,i,s){const l=mo(e,t),h=i.axis||"xy",d=i.includeInvisible||!1;return G0(t,l,h,i.intersect,s,d)},x(t,e,i,s){const l=mo(e,t);return pw(t,l,"x",i.intersect,s)},y(t,e,i,s){const l=mo(e,t);return pw(t,l,"y",i.intersect,s)}}};const y9=["left","top","right","bottom"];function zh(t,e){return t.filter(i=>i.pos===e)}function fw(t,e){return t.filter(i=>y9.indexOf(i.pos)===-1&&i.box.axis===e)}function Dh(t,e){return t.sort((i,s)=>{const l=e?s:i,h=e?i:s;return l.weight===h.weight?l.index-h.index:l.weight-h.weight})}function RP(t){const e=[];let i,s,l,h,d,c;for(i=0,s=(t||[]).length;i<s;++i)l=t[i],{position:h,options:{stack:d,stackWeight:c=1}}=l,e.push({index:i,box:l,pos:h,horizontal:l.isHorizontal(),weight:l.weight,stack:d&&h+d,stackWeight:c});return e}function FP(t){const e={};for(const i of t){const{stack:s,pos:l,stackWeight:h}=i;if(!s||!y9.includes(l))continue;const d=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});d.count++,d.weight+=h}return e}function OP(t,e){const i=FP(t),{vBoxMaxWidth:s,hBoxMaxHeight:l}=e;let h,d,c;for(h=0,d=t.length;h<d;++h){c=t[h];const{fullSize:b}=c.box,S=i[c.stack],C=S&&c.stackWeight/S.weight;c.horizontal?(c.width=C?C*s:b&&e.availableWidth,c.height=l):(c.width=s,c.height=C?C*l:b&&e.availableHeight)}return i}function BP(t){const e=RP(t),i=Dh(e.filter(S=>S.box.fullSize),!0),s=Dh(zh(e,"left"),!0),l=Dh(zh(e,"right")),h=Dh(zh(e,"top"),!0),d=Dh(zh(e,"bottom")),c=fw(e,"x"),b=fw(e,"y");return{fullSize:i,leftAndTop:s.concat(h),rightAndBottom:l.concat(b).concat(d).concat(c),chartArea:zh(e,"chartArea"),vertical:s.concat(l).concat(b),horizontal:h.concat(d).concat(c)}}function mw(t,e,i,s){return Math.max(t[i],e[i])+Math.max(t[s],e[s])}function _9(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function VP(t,e,i,s){const{pos:l,box:h}=i,d=t.maxPadding;if(!Xe(l)){i.size&&(t[l]-=i.size);const P=s[i.stack]||{size:0,count:1};P.size=Math.max(P.size,i.horizontal?h.height:h.width),i.size=P.size/P.count,t[l]+=i.size}h.getPadding&&_9(d,h.getPadding());const c=Math.max(0,e.outerWidth-mw(d,t,"left","right")),b=Math.max(0,e.outerHeight-mw(d,t,"top","bottom")),S=c!==t.w,C=b!==t.h;return t.w=c,t.h=b,i.horizontal?{same:S,other:C}:{same:C,other:S}}function $P(t){const e=t.maxPadding;function i(s){const l=Math.max(e[s]-t[s],0);return t[s]+=l,l}t.y+=i("top"),t.x+=i("left"),i("right"),i("bottom")}function NP(t,e){const i=e.maxPadding;function s(l){const h={left:0,top:0,right:0,bottom:0};return l.forEach(d=>{h[d]=Math.max(e[d],i[d])}),h}return s(t?["left","right"]:["top","bottom"])}function Uh(t,e,i,s){const l=[];let h,d,c,b,S,C;for(h=0,d=t.length,S=0;h<d;++h){c=t[h],b=c.box,b.update(c.width||e.w,c.height||e.h,NP(c.horizontal,e));const{same:P,other:A}=VP(e,i,c,s);S|=P&&l.length,C=C||A,b.fullSize||l.push(c)}return S&&Uh(l,e,i,s)||C}function wf(t,e,i,s,l){t.top=i,t.left=e,t.right=e+s,t.bottom=i+l,t.width=s,t.height=l}function gw(t,e,i,s){const l=i.padding;let{x:h,y:d}=e;for(const c of t){const b=c.box,S=s[c.stack]||{count:1,placed:0,weight:1},C=c.stackWeight/S.weight||1;if(c.horizontal){const P=e.w*C,A=S.size||b.height;Id(S.start)&&(d=S.start),b.fullSize?wf(b,l.left,d,i.outerWidth-l.right-l.left,A):wf(b,e.left+S.placed,d,P,A),S.start=d,S.placed+=P,d=b.bottom}else{const P=e.h*C,A=S.size||b.width;Id(S.start)&&(h=S.start),b.fullSize?wf(b,h,l.top,A,i.outerHeight-l.bottom-l.top):wf(b,h,e.top+S.placed,A,P),S.start=h,S.placed+=P,h=b.right}}e.x=h,e.y=d}var fn={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(i){e.draw(i)}}]},t.boxes.push(e)},removeBox(t,e){const i=t.boxes?t.boxes.indexOf(e):-1;i!==-1&&t.boxes.splice(i,1)},configure(t,e,i){e.fullSize=i.fullSize,e.position=i.position,e.weight=i.weight},update(t,e,i,s){if(!t)return;const l=gn(t.options.layout.padding),h=Math.max(e-l.width,0),d=Math.max(i-l.height,0),c=BP(t.boxes),b=c.vertical,S=c.horizontal;We(t.boxes,$=>{typeof $.beforeLayout=="function"&&$.beforeLayout()});const C=b.reduce(($,nt)=>nt.box.options&&nt.box.options.display===!1?$:$+1,0)||1,P=Object.freeze({outerWidth:e,outerHeight:i,padding:l,availableWidth:h,availableHeight:d,vBoxMaxWidth:h/2/C,hBoxMaxHeight:d/2}),A=Object.assign({},l);_9(A,gn(s));const V=Object.assign({maxPadding:A,w:h,h:d,x:l.left,y:l.top},l),W=OP(b.concat(S),P);Uh(c.fullSize,V,P,W),Uh(b,V,P,W),Uh(S,V,P,W)&&Uh(b,V,P,W),$P(V),gw(c.leftAndTop,V,P,W),V.x+=V.w,V.y+=V.h,gw(c.rightAndBottom,V,P,W),t.chartArea={left:V.left,top:V.top,right:V.left+V.w,bottom:V.top+V.h,height:V.h,width:V.w},We(c.chartArea,$=>{const nt=$.box;Object.assign(nt,t.chartArea),nt.update(V.w,V.h,{left:0,top:0,right:0,bottom:0})})}};class v9{acquireContext(e,i){}releaseContext(e){return!1}addEventListener(e,i,s){}removeEventListener(e,i,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,i,s,l){return i=Math.max(0,i||e.width),s=s||e.height,{width:i,height:Math.max(0,l?Math.floor(i/l):s)}}isAttached(e){return!0}updateConfig(e){}}class jP extends v9{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Yf="$chartjs",UP={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},yw=t=>t===null||t==="";function HP(t,e){const i=t.style,s=t.getAttribute("height"),l=t.getAttribute("width");if(t[Yf]={initial:{height:s,width:l,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",yw(l)){const h=Qb(t,"width");h!==void 0&&(t.width=h)}if(yw(s))if(t.style.height==="")t.height=t.width/(e||2);else{const h=Qb(t,"height");h!==void 0&&(t.height=h)}return t}const x9=qE?{passive:!0}:!1;function ZP(t,e,i){t&&t.addEventListener(e,i,x9)}function qP(t,e,i){t&&t.canvas&&t.canvas.removeEventListener(e,i,x9)}function GP(t,e){const i=UP[t.type]||t.type,{x:s,y:l}=mo(t,e);return{type:i,chart:e,native:t,x:s!==void 0?s:null,y:l!==void 0?l:null}}function Am(t,e){for(const i of t)if(i===e||i.contains(e))return!0}function WP(t,e,i){const s=t.canvas,l=new MutationObserver(h=>{let d=!1;for(const c of h)d=d||Am(c.addedNodes,s),d=d&&!Am(c.removedNodes,s);d&&i()});return l.observe(document,{childList:!0,subtree:!0}),l}function YP(t,e,i){const s=t.canvas,l=new MutationObserver(h=>{let d=!1;for(const c of h)d=d||Am(c.removedNodes,s),d=d&&!Am(c.addedNodes,s);d&&i()});return l.observe(document,{childList:!0,subtree:!0}),l}const Dd=new Map;let _w=0;function b9(){const t=window.devicePixelRatio;t!==_w&&(_w=t,Dd.forEach((e,i)=>{i.currentDevicePixelRatio!==t&&e()}))}function KP(t,e){Dd.size||window.addEventListener("resize",b9),Dd.set(t,e)}function XP(t){Dd.delete(t),Dd.size||window.removeEventListener("resize",b9)}function JP(t,e,i){const s=t.canvas,l=s&&Cv(s);if(!l)return;const h=XS((c,b)=>{const S=l.clientWidth;i(c,b),S<l.clientWidth&&i()},window),d=new ResizeObserver(c=>{const b=c[0],S=b.contentRect.width,C=b.contentRect.height;S===0&&C===0||h(S,C)});return d.observe(l),KP(t,h),d}function W0(t,e,i){i&&i.disconnect(),e==="resize"&&XP(t)}function QP(t,e,i){const s=t.canvas,l=XS(h=>{t.ctx!==null&&i(GP(h,t))},t);return ZP(s,e,l),l}class tI extends v9{acquireContext(e,i){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(HP(e,i),s):null}releaseContext(e){const i=e.canvas;if(!i[Yf])return!1;const s=i[Yf].initial;["height","width"].forEach(h=>{const d=s[h];oi(d)?i.removeAttribute(h):i.setAttribute(h,d)});const l=s.style||{};return Object.keys(l).forEach(h=>{i.style[h]=l[h]}),i.width=i.width,delete i[Yf],!0}addEventListener(e,i,s){this.removeEventListener(e,i);const l=e.$proxies||(e.$proxies={}),h={attach:WP,detach:YP,resize:JP}[i]||QP;l[i]=h(e,i,s)}removeEventListener(e,i){const s=e.$proxies||(e.$proxies={}),l=s[i];l&&(({attach:W0,detach:W0,resize:W0}[i]||qP)(e,i,l),s[i]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,i,s,l){return ZE(e,i,s,l)}isAttached(e){const i=e&&Cv(e);return!!(i&&i.isConnected)}}function eI(t){return!Mv()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?jP:tI}class Gs{constructor(){se(this,"x"),se(this,"y"),se(this,"active",!1),se(this,"options"),se(this,"$animations")}tooltipPosition(e){const{x:i,y:s}=this.getProps(["x","y"],e);return{x:i,y:s}}hasValue(){return cu(this.x)&&cu(this.y)}getProps(e,i){const s=this.$animations;if(!i||!s)return this;const l={};return e.forEach(h=>{l[h]=s[h]&&s[h].active()?s[h]._to:this[h]}),l}}se(Gs,"defaults",{}),se(Gs,"defaultRoutes");function iI(t,e){const i=t.options.ticks,s=rI(t),l=Math.min(i.maxTicksLimit||s,s),h=i.major.enabled?sI(e):[],d=h.length,c=h[0],b=h[d-1],S=[];if(d>l)return oI(e,S,h,d/l),S;const C=nI(h,e,l);if(d>0){let P,A;const V=d>1?Math.round((b-c)/(d-1)):null;for(Sf(e,S,C,oi(V)?0:c-V,c),P=0,A=d-1;P<A;P++)Sf(e,S,C,h[P],h[P+1]);return Sf(e,S,C,b,oi(V)?e.length:b+V),S}return Sf(e,S,C),S}function rI(t){const e=t.options.offset,i=t._tickSize(),s=t._length/i+(e?0:1),l=t._maxLength/i;return Math.floor(Math.min(s,l))}function nI(t,e,i){const s=aI(t),l=e.length/i;if(!s)return Math.max(l,1);const h=YC(s);for(let d=0,c=h.length-1;d<c;d++){const b=h[d];if(b>l)return b}return Math.max(l,1)}function sI(t){const e=[];let i,s;for(i=0,s=t.length;i<s;i++)t[i].major&&e.push(i);return e}function oI(t,e,i,s){let l=0,h=i[0],d;for(s=Math.ceil(s),d=0;d<t.length;d++)d===h&&(e.push(t[d]),l++,h=i[l*s])}function Sf(t,e,i,s,l){const h=Le(s,0),d=Math.min(Le(l,t.length),t.length);let c=0,b,S,C;for(i=Math.ceil(i),l&&(b=l-s,i=b/Math.floor(b/i)),C=h;C<0;)c++,C=Math.round(h+c*i);for(S=Math.max(h,0);S<d;S++)S===C&&(e.push(t[S]),c++,C=Math.round(h+c*i))}function aI(t){const e=t.length;let i,s;if(e<2)return!1;for(s=t[0],i=1;i<e;++i)if(t[i]-t[i-1]!==s)return!1;return s}const lI=t=>t==="left"?"right":t==="right"?"left":t,vw=(t,e,i)=>e==="top"||e==="left"?t[e]+i:t[e]-i,xw=(t,e)=>Math.min(e||t,t);function bw(t,e){const i=[],s=t.length/e,l=t.length;let h=0;for(;h<l;h+=s)i.push(t[Math.floor(h)]);return i}function cI(t,e,i){const s=t.ticks.length,l=Math.min(e,s-1),h=t._startPixel,d=t._endPixel,c=1e-6;let b=t.getPixelForTick(l),S;if(!(i&&(s===1?S=Math.max(b-h,d-b):e===0?S=(t.getPixelForTick(1)-b)/2:S=(b-t.getPixelForTick(l-1))/2,b+=l<e?S:-S,b<h-c||b>d+c)))return b}function uI(t,e){We(t,i=>{const s=i.gc,l=s.length/2;let h;if(l>e){for(h=0;h<l;++h)delete i.data[s[h]];s.splice(0,l)}})}function Lh(t){return t.drawTicks?t.tickLength:0}function ww(t,e){if(!t.display)return 0;const i=Pr(t.font,e),s=gn(t.padding);return(Zi(t.text)?t.text.length:1)*i.lineHeight+s.height}function hI(t,e){return Ka(t,{scale:e,type:"scale"})}function dI(t,e,i){return Ka(t,{tick:i,index:e,type:"tick"})}function pI(t,e,i){let s=xv(t);return(i&&e!=="right"||!i&&e==="right")&&(s=lI(s)),s}function fI(t,e,i,s){const{top:l,left:h,bottom:d,right:c,chart:b}=t,{chartArea:S,scales:C}=b;let P=0,A,V,W;const $=d-l,nt=c-h;if(t.isHorizontal()){if(V=dn(s,h,c),Xe(i)){const H=Object.keys(i)[0],Y=i[H];W=C[H].getPixelForValue(Y)+$-e}else i==="center"?W=(S.bottom+S.top)/2+$-e:W=vw(t,i,e);A=c-h}else{if(Xe(i)){const H=Object.keys(i)[0],Y=i[H];V=C[H].getPixelForValue(Y)-nt+e}else i==="center"?V=(S.left+S.right)/2-nt+e:V=vw(t,i,e);W=dn(s,d,l),P=i==="left"?-hr:hr}return{titleX:V,titleY:W,maxWidth:A,rotation:P}}class Zl extends Gs{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,i){return e}getUserBounds(){let{_userMin:e,_userMax:i,_suggestedMin:s,_suggestedMax:l}=this;return e=ns(e,Number.POSITIVE_INFINITY),i=ns(i,Number.NEGATIVE_INFINITY),s=ns(s,Number.POSITIVE_INFINITY),l=ns(l,Number.NEGATIVE_INFINITY),{min:ns(e,s),max:ns(i,l),minDefined:rr(e),maxDefined:rr(i)}}getMinMax(e){let{min:i,max:s,minDefined:l,maxDefined:h}=this.getUserBounds(),d;if(l&&h)return{min:i,max:s};const c=this.getMatchingVisibleMetas();for(let b=0,S=c.length;b<S;++b)d=c[b].controller.getMinMax(this,e),l||(i=Math.min(i,d.min)),h||(s=Math.max(s,d.max));return i=h&&i>s?s:i,s=l&&i>s?i:s,{min:ns(i,ns(s,i)),max:ns(s,ns(i,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Ve(this.options.beforeUpdate,[this])}update(e,i,s){const{beginAtZero:l,grace:h,ticks:d}=this.options,c=d.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=i,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=SE(this,h,l),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const b=c<this.ticks.length;this._convertTicksToLabels(b?bw(this.ticks,c):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),d.display&&(d.autoSkip||d.source==="auto")&&(this.ticks=iI(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),b&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,i,s;this.isHorizontal()?(i=this.left,s=this.right):(i=this.top,s=this.bottom,e=!e),this._startPixel=i,this._endPixel=s,this._reversePixels=e,this._length=s-i,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Ve(this.options.afterUpdate,[this])}beforeSetDimensions(){Ve(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Ve(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Ve(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Ve(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const i=this.options.ticks;let s,l,h;for(s=0,l=e.length;s<l;s++)h=e[s],h.label=Ve(i.callback,[h.value,s,e],this)}afterTickToLabelConversion(){Ve(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Ve(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,i=e.ticks,s=xw(this.ticks.length,e.ticks.maxTicksLimit),l=i.minRotation||0,h=i.maxRotation;let d=l,c,b,S;if(!this._isVisible()||!i.display||l>=h||s<=1||!this.isHorizontal()){this.labelRotation=l;return}const C=this._getLabelSizes(),P=C.widest.width,A=C.highest.height,V=jr(this.chart.width-P,0,this.maxWidth);c=e.offset?this.maxWidth/s:V/(s-1),P+6>c&&(c=V/(s-(e.offset?.5:1)),b=this.maxHeight-Lh(e.grid)-i.padding-ww(e.title,this.chart.options.font),S=Math.sqrt(P*P+A*A),d=_v(Math.min(Math.asin(jr((C.highest.height+6)/c,-1,1)),Math.asin(jr(b/S,-1,1))-Math.asin(jr(A/S,-1,1)))),d=Math.max(l,Math.min(h,d))),this.labelRotation=d}afterCalculateLabelRotation(){Ve(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Ve(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:i,options:{ticks:s,title:l,grid:h}}=this,d=this._isVisible(),c=this.isHorizontal();if(d){const b=ww(l,i.options.font);if(c?(e.width=this.maxWidth,e.height=Lh(h)+b):(e.height=this.maxHeight,e.width=Lh(h)+b),s.display&&this.ticks.length){const{first:S,last:C,widest:P,highest:A}=this._getLabelSizes(),V=s.padding*2,W=js(this.labelRotation),$=Math.cos(W),nt=Math.sin(W);if(c){const H=s.mirror?0:nt*P.width+$*A.height;e.height=Math.min(this.maxHeight,e.height+H+V)}else{const H=s.mirror?0:$*P.width+nt*A.height;e.width=Math.min(this.maxWidth,e.width+H+V)}this._calculatePadding(S,C,nt,$)}}this._handleMargins(),c?(this.width=this._length=i.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=i.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,i,s,l){const{ticks:{align:h,padding:d},position:c}=this.options,b=this.labelRotation!==0,S=c!=="top"&&this.axis==="x";if(this.isHorizontal()){const C=this.getPixelForTick(0)-this.left,P=this.right-this.getPixelForTick(this.ticks.length-1);let A=0,V=0;b?S?(A=l*e.width,V=s*i.height):(A=s*e.height,V=l*i.width):h==="start"?V=i.width:h==="end"?A=e.width:h!=="inner"&&(A=e.width/2,V=i.width/2),this.paddingLeft=Math.max((A-C+d)*this.width/(this.width-C),0),this.paddingRight=Math.max((V-P+d)*this.width/(this.width-P),0)}else{let C=i.height/2,P=e.height/2;h==="start"?(C=0,P=e.height):h==="end"&&(C=i.height,P=0),this.paddingTop=C+d,this.paddingBottom=P+d}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Ve(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:i}=this.options;return i==="top"||i==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let i,s;for(i=0,s=e.length;i<s;i++)oi(e[i].label)&&(e.splice(i,1),s--,i--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const i=this.options.ticks.sampleSize;let s=this.ticks;i<s.length&&(s=bw(s,i)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,i,s){const{ctx:l,_longestTextCache:h}=this,d=[],c=[],b=Math.floor(i/xw(i,s));let S=0,C=0,P,A,V,W,$,nt,H,Y,K,at,mt;for(P=0;P<i;P+=b){if(W=e[P].label,$=this._resolveTickFontOptions(P),l.font=nt=$.string,H=h[nt]=h[nt]||{data:{},gc:[]},Y=$.lineHeight,K=at=0,!oi(W)&&!Zi(W))K=Pm(l,H.data,H.gc,K,W),at=Y;else if(Zi(W))for(A=0,V=W.length;A<V;++A)mt=W[A],!oi(mt)&&!Zi(mt)&&(K=Pm(l,H.data,H.gc,K,mt),at+=Y);d.push(K),c.push(at),S=Math.max(K,S),C=Math.max(at,C)}uI(h,i);const xt=d.indexOf(S),Tt=c.indexOf(C),Mt=$t=>({width:d[$t]||0,height:c[$t]||0});return{first:Mt(0),last:Mt(i-1),widest:Mt(xt),highest:Mt(Tt),widths:d,heights:c}}getLabelForValue(e){return e}getPixelForValue(e,i){return NaN}getValueForPixel(e){}getPixelForTick(e){const i=this.ticks;return e<0||e>i.length-1?null:this.getPixelForValue(i[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const i=this._startPixel+e*this._length;return JC(this._alignToPixels?wl(this.chart,i,0):i)}getDecimalForPixel(e){const i=(e-this._startPixel)/this._length;return this._reversePixels?1-i:i}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:i}=this;return e<0&&i<0?i:e>0&&i>0?e:0}getContext(e){const i=this.ticks||[];if(e>=0&&e<i.length){const s=i[e];return s.$context||(s.$context=dI(this.getContext(),e,s))}return this.$context||(this.$context=hI(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,i=js(this.labelRotation),s=Math.abs(Math.cos(i)),l=Math.abs(Math.sin(i)),h=this._getLabelSizes(),d=e.autoSkipPadding||0,c=h?h.widest.width+d:0,b=h?h.highest.height+d:0;return this.isHorizontal()?b*s>c*l?c/s:b/l:b*l<c*s?b/s:c/l}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const i=this.axis,s=this.chart,l=this.options,{grid:h,position:d,border:c}=l,b=h.offset,S=this.isHorizontal(),C=this.ticks.length+(b?1:0),P=Lh(h),A=[],V=c.setContext(this.getContext()),W=V.display?V.width:0,$=W/2,nt=function(ve){return wl(s,ve,W)};let H,Y,K,at,mt,xt,Tt,Mt,$t,Ft,Ot,ge;if(d==="top")H=nt(this.bottom),xt=this.bottom-P,Mt=H-$,Ft=nt(e.top)+$,ge=e.bottom;else if(d==="bottom")H=nt(this.top),Ft=e.top,ge=nt(e.bottom)-$,xt=H+$,Mt=this.top+P;else if(d==="left")H=nt(this.right),mt=this.right-P,Tt=H-$,$t=nt(e.left)+$,Ot=e.right;else if(d==="right")H=nt(this.left),$t=e.left,Ot=nt(e.right)-$,mt=H+$,Tt=this.left+P;else if(i==="x"){if(d==="center")H=nt((e.top+e.bottom)/2+.5);else if(Xe(d)){const ve=Object.keys(d)[0],Ee=d[ve];H=nt(this.chart.scales[ve].getPixelForValue(Ee))}Ft=e.top,ge=e.bottom,xt=H+$,Mt=xt+P}else if(i==="y"){if(d==="center")H=nt((e.left+e.right)/2);else if(Xe(d)){const ve=Object.keys(d)[0],Ee=d[ve];H=nt(this.chart.scales[ve].getPixelForValue(Ee))}mt=H-$,Tt=mt-P,$t=e.left,Ot=e.right}const _e=Le(l.ticks.maxTicksLimit,C),Ae=Math.max(1,Math.ceil(C/_e));for(Y=0;Y<C;Y+=Ae){const ve=this.getContext(Y),Ee=h.setContext(ve),$e=c.setContext(ve),Vt=Ee.lineWidth,re=Ee.color,Kt=$e.dash||[],we=$e.dashOffset,Se=Ee.tickWidth,ai=Ee.tickColor,Qe=Ee.tickBorderDash||[],fi=Ee.tickBorderDashOffset;K=cI(this,Y,b),K!==void 0&&(at=wl(s,K,Vt),S?mt=Tt=$t=Ot=at:xt=Mt=Ft=ge=at,A.push({tx1:mt,ty1:xt,tx2:Tt,ty2:Mt,x1:$t,y1:Ft,x2:Ot,y2:ge,width:Vt,color:re,borderDash:Kt,borderDashOffset:we,tickWidth:Se,tickColor:ai,tickBorderDash:Qe,tickBorderDashOffset:fi}))}return this._ticksLength=C,this._borderValue=H,A}_computeLabelItems(e){const i=this.axis,s=this.options,{position:l,ticks:h}=s,d=this.isHorizontal(),c=this.ticks,{align:b,crossAlign:S,padding:C,mirror:P}=h,A=Lh(s.grid),V=A+C,W=P?-C:V,$=-js(this.labelRotation),nt=[];let H,Y,K,at,mt,xt,Tt,Mt,$t,Ft,Ot,ge,_e="middle";if(l==="top")xt=this.bottom-W,Tt=this._getXAxisLabelAlignment();else if(l==="bottom")xt=this.top+W,Tt=this._getXAxisLabelAlignment();else if(l==="left"){const ve=this._getYAxisLabelAlignment(A);Tt=ve.textAlign,mt=ve.x}else if(l==="right"){const ve=this._getYAxisLabelAlignment(A);Tt=ve.textAlign,mt=ve.x}else if(i==="x"){if(l==="center")xt=(e.top+e.bottom)/2+V;else if(Xe(l)){const ve=Object.keys(l)[0],Ee=l[ve];xt=this.chart.scales[ve].getPixelForValue(Ee)+V}Tt=this._getXAxisLabelAlignment()}else if(i==="y"){if(l==="center")mt=(e.left+e.right)/2-V;else if(Xe(l)){const ve=Object.keys(l)[0],Ee=l[ve];mt=this.chart.scales[ve].getPixelForValue(Ee)}Tt=this._getYAxisLabelAlignment(A).textAlign}i==="y"&&(b==="start"?_e="top":b==="end"&&(_e="bottom"));const Ae=this._getLabelSizes();for(H=0,Y=c.length;H<Y;++H){K=c[H],at=K.label;const ve=h.setContext(this.getContext(H));Mt=this.getPixelForTick(H)+h.labelOffset,$t=this._resolveTickFontOptions(H),Ft=$t.lineHeight,Ot=Zi(at)?at.length:1;const Ee=Ot/2,$e=ve.color,Vt=ve.textStrokeColor,re=ve.textStrokeWidth;let Kt=Tt;d?(mt=Mt,Tt==="inner"&&(H===Y-1?Kt=this.options.reverse?"left":"right":H===0?Kt=this.options.reverse?"right":"left":Kt="center"),l==="top"?S==="near"||$!==0?ge=-Ot*Ft+Ft/2:S==="center"?ge=-Ae.highest.height/2-Ee*Ft+Ft:ge=-Ae.highest.height+Ft/2:S==="near"||$!==0?ge=Ft/2:S==="center"?ge=Ae.highest.height/2-Ee*Ft:ge=Ae.highest.height-Ot*Ft,P&&(ge*=-1),$!==0&&!ve.showLabelBackdrop&&(mt+=Ft/2*Math.sin($))):(xt=Mt,ge=(1-Ot)*Ft/2);let we;if(ve.showLabelBackdrop){const Se=gn(ve.backdropPadding),ai=Ae.heights[H],Qe=Ae.widths[H];let fi=ge-Se.top,ni=0-Se.left;switch(_e){case"middle":fi-=ai/2;break;case"bottom":fi-=ai;break}switch(Tt){case"center":ni-=Qe/2;break;case"right":ni-=Qe;break;case"inner":H===Y-1?ni-=Qe:H>0&&(ni-=Qe/2);break}we={left:ni,top:fi,width:Qe+Se.width,height:ai+Se.height,color:ve.backdropColor}}nt.push({label:at,font:$t,textOffset:ge,options:{rotation:$,color:$e,strokeColor:Vt,strokeWidth:re,textAlign:Kt,textBaseline:_e,translation:[mt,xt],backdrop:we}})}return nt}_getXAxisLabelAlignment(){const{position:e,ticks:i}=this.options;if(-js(this.labelRotation))return e==="top"?"left":"right";let s="center";return i.align==="start"?s="left":i.align==="end"?s="right":i.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:i,ticks:{crossAlign:s,mirror:l,padding:h}}=this.options,d=this._getLabelSizes(),c=e+h,b=d.widest.width;let S,C;return i==="left"?l?(C=this.right+h,s==="near"?S="left":s==="center"?(S="center",C+=b/2):(S="right",C+=b)):(C=this.right-c,s==="near"?S="right":s==="center"?(S="center",C-=b/2):(S="left",C=this.left)):i==="right"?l?(C=this.left+h,s==="near"?S="right":s==="center"?(S="center",C-=b/2):(S="left",C-=b)):(C=this.left+c,s==="near"?S="left":s==="center"?(S="center",C+=b/2):(S="right",C=this.right)):S="right",{textAlign:S,x:C}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,i=this.options.position;if(i==="left"||i==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(i==="top"||i==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:i},left:s,top:l,width:h,height:d}=this;i&&(e.save(),e.fillStyle=i,e.fillRect(s,l,h,d),e.restore())}getLineWidthForValue(e){const i=this.options.grid;if(!this._isVisible()||!i.display)return 0;const s=this.ticks.findIndex(l=>l.value===e);return s>=0?i.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const i=this.options.grid,s=this.ctx,l=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let h,d;const c=(b,S,C)=>{!C.width||!C.color||(s.save(),s.lineWidth=C.width,s.strokeStyle=C.color,s.setLineDash(C.borderDash||[]),s.lineDashOffset=C.borderDashOffset,s.beginPath(),s.moveTo(b.x,b.y),s.lineTo(S.x,S.y),s.stroke(),s.restore())};if(i.display)for(h=0,d=l.length;h<d;++h){const b=l[h];i.drawOnChartArea&&c({x:b.x1,y:b.y1},{x:b.x2,y:b.y2},b),i.drawTicks&&c({x:b.tx1,y:b.ty1},{x:b.tx2,y:b.ty2},{color:b.tickColor,width:b.tickWidth,borderDash:b.tickBorderDash,borderDashOffset:b.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:i,options:{border:s,grid:l}}=this,h=s.setContext(this.getContext()),d=s.display?h.width:0;if(!d)return;const c=l.setContext(this.getContext(0)).lineWidth,b=this._borderValue;let S,C,P,A;this.isHorizontal()?(S=wl(e,this.left,d)-d/2,C=wl(e,this.right,c)+c/2,P=A=b):(P=wl(e,this.top,d)-d/2,A=wl(e,this.bottom,c)+c/2,S=C=b),i.save(),i.lineWidth=h.width,i.strokeStyle=h.color,i.beginPath(),i.moveTo(S,P),i.lineTo(C,A),i.stroke(),i.restore()}drawLabels(e){if(!this.options.ticks.display)return;const i=this.ctx,s=this._computeLabelArea();s&&Qm(i,s);const l=this.getLabelItems(e);for(const h of l){const d=h.options,c=h.font,b=h.label,S=h.textOffset;jl(i,b,0,S,c,d)}s&&tg(i)}drawTitle(){const{ctx:e,options:{position:i,title:s,reverse:l}}=this;if(!s.display)return;const h=Pr(s.font),d=gn(s.padding),c=s.align;let b=h.lineHeight/2;i==="bottom"||i==="center"||Xe(i)?(b+=d.bottom,Zi(s.text)&&(b+=h.lineHeight*(s.text.length-1))):b+=d.top;const{titleX:S,titleY:C,maxWidth:P,rotation:A}=fI(this,b,i,c);jl(e,s.text,0,0,h,{color:s.color,maxWidth:P,rotation:A,textAlign:pI(c,i,l),textBaseline:"middle",translation:[S,C]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,i=e.ticks&&e.ticks.z||0,s=Le(e.grid&&e.grid.z,-1),l=Le(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Zl.prototype.draw?[{z:i,draw:h=>{this.draw(h)}}]:[{z:s,draw:h=>{this.drawBackground(),this.drawGrid(h),this.drawTitle()}},{z:l,draw:()=>{this.drawBorder()}},{z:i,draw:h=>{this.drawLabels(h)}}]}getMatchingVisibleMetas(e){const i=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",l=[];let h,d;for(h=0,d=i.length;h<d;++h){const c=i[h];c[s]===this.id&&(!e||c.type===e)&&l.push(c)}return l}_resolveTickFontOptions(e){const i=this.options.ticks.setContext(this.getContext(e));return Pr(i.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class kf{constructor(e,i,s){this.type=e,this.scope=i,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const i=Object.getPrototypeOf(e);let s;yI(i)&&(s=this.register(i));const l=this.items,h=e.id,d=this.scope+"."+h;if(!h)throw new Error("class does not have id: "+e);return h in l||(l[h]=e,mI(e,d,s),this.override&&nr.override(e.id,e.overrides)),d}get(e){return this.items[e]}unregister(e){const i=this.items,s=e.id,l=this.scope;s in i&&delete i[s],l&&s in nr[l]&&(delete nr[l][s],this.override&&delete Nl[s])}}function mI(t,e,i){const s=Pd(Object.create(null),[i?nr.get(i):{},nr.get(e),t.defaults]);nr.set(e,s),t.defaultRoutes&&gI(e,t.defaultRoutes),t.descriptors&&nr.describe(e,t.descriptors)}function gI(t,e){Object.keys(e).forEach(i=>{const s=i.split("."),l=s.pop(),h=[t].concat(s).join("."),d=e[i].split("."),c=d.pop(),b=d.join(".");nr.route(h,l,b,c)})}function yI(t){return"id"in t&&"defaults"in t}class _I{constructor(){this.controllers=new kf(Zs,"datasets",!0),this.elements=new kf(Gs,"elements"),this.plugins=new kf(Object,"plugins"),this.scales=new kf(Zl,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,i,s){[...i].forEach(l=>{const h=s||this._getRegistryForType(l);s||h.isForType(l)||h===this.plugins&&l.id?this._exec(e,h,l):We(l,d=>{const c=s||this._getRegistryForType(d);this._exec(e,c,d)})})}_exec(e,i,s){const l=yv(e);Ve(s["before"+l],[],s),i[e](s),Ve(s["after"+l],[],s)}_getRegistryForType(e){for(let i=0;i<this._typedRegistries.length;i++){const s=this._typedRegistries[i];if(s.isForType(e))return s}return this.plugins}_get(e,i,s){const l=i.get(e);if(l===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return l}}var fo=new _I;class vI{constructor(){this._init=[]}notify(e,i,s,l){i==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const h=l?this._descriptors(e).filter(l):this._descriptors(e),d=this._notify(h,e,i,s);return i==="afterDestroy"&&(this._notify(h,e,"stop"),this._notify(this._init,e,"uninstall")),d}_notify(e,i,s,l){l=l||{};for(const h of e){const d=h.plugin,c=d[s],b=[i,l,h.options];if(Ve(c,b,d)===!1&&l.cancelable)return!1}return!0}invalidate(){oi(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const i=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),i}_createDescriptors(e,i){const s=e&&e.config,l=Le(s.options&&s.options.plugins,{}),h=xI(s);return l===!1&&!i?[]:wI(e,h,l,i)}_notifyStateChanges(e){const i=this._oldCache||[],s=this._cache,l=(h,d)=>h.filter(c=>!d.some(b=>c.plugin.id===b.plugin.id));this._notify(l(i,s),e,"stop"),this._notify(l(s,i),e,"start")}}function xI(t){const e={},i=[],s=Object.keys(fo.plugins.items);for(let h=0;h<s.length;h++)i.push(fo.getPlugin(s[h]));const l=t.plugins||[];for(let h=0;h<l.length;h++){const d=l[h];i.indexOf(d)===-1&&(i.push(d),e[d.id]=!0)}return{plugins:i,localIds:e}}function bI(t,e){return!e&&t===!1?null:t===!0?{}:t}function wI(t,{plugins:e,localIds:i},s,l){const h=[],d=t.getContext();for(const c of e){const b=c.id,S=bI(s[b],l);S!==null&&h.push({plugin:c,options:SI(t.config,{plugin:c,local:i[b]},S,d)})}return h}function SI(t,{plugin:e,local:i},s,l){const h=t.pluginScopeKeys(e),d=t.getOptionScopes(s,h);return i&&e.defaults&&d.push(e.defaults),t.createResolver(d,l,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function t_(t,e){const i=nr.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||i.indexAxis||"x"}function kI(t,e){let i=t;return t==="_index_"?i=e:t==="_value_"&&(i=e==="x"?"y":"x"),i}function TI(t,e){return t===e?"_index_":"_value_"}function Sw(t){if(t==="x"||t==="y"||t==="r")return t}function MI(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function e_(t,...e){if(Sw(t))return t;for(const i of e){const s=i.axis||MI(i.position)||t.length>1&&Sw(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function kw(t,e,i){if(i[e+"AxisID"]===t)return{axis:e}}function CI(t,e){if(e.data&&e.data.datasets){const i=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(i.length)return kw(t,"x",i[0])||kw(t,"y",i[0])}return{}}function EI(t,e){const i=Nl[t.type]||{scales:{}},s=e.scales||{},l=t_(t.type,e),h=Object.create(null);return Object.keys(s).forEach(d=>{const c=s[d];if(!Xe(c))return console.error(`Invalid scale configuration for scale: ${d}`);if(c._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${d}`);const b=e_(d,c,CI(d,t),nr.scales[c.type]),S=TI(b,l),C=i.scales||{};h[d]=id(Object.create(null),[{axis:b},c,C[b],C[S]])}),t.data.datasets.forEach(d=>{const c=d.type||t.type,b=d.indexAxis||t_(c,e),S=(Nl[c]||{}).scales||{};Object.keys(S).forEach(C=>{const P=kI(C,b),A=d[P+"AxisID"]||P;h[A]=h[A]||Object.create(null),id(h[A],[{axis:P},s[A],S[C]])})}),Object.keys(h).forEach(d=>{const c=h[d];id(c,[nr.scales[c.type],nr.scale])}),h}function w9(t){const e=t.options||(t.options={});e.plugins=Le(e.plugins,{}),e.scales=EI(t,e)}function S9(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function PI(t){return t=t||{},t.data=S9(t.data),w9(t),t}const Tw=new Map,k9=new Set;function Tf(t,e){let i=Tw.get(t);return i||(i=e(),Tw.set(t,i),k9.add(i)),i}const Rh=(t,e,i)=>{const s=Ha(e,i);s!==void 0&&t.add(s)};class II{constructor(e){this._config=PI(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=S9(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),w9(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Tf(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,i){return Tf(`${e}.transition.${i}`,()=>[[`datasets.${e}.transitions.${i}`,`transitions.${i}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,i){return Tf(`${e}-${i}`,()=>[[`datasets.${e}.elements.${i}`,`datasets.${e}`,`elements.${i}`,""]])}pluginScopeKeys(e){const i=e.id,s=this.type;return Tf(`${s}-plugin-${i}`,()=>[[`plugins.${i}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,i){const s=this._scopeCache;let l=s.get(e);return(!l||i)&&(l=new Map,s.set(e,l)),l}getOptionScopes(e,i,s){const{options:l,type:h}=this,d=this._cachedScopes(e,s),c=d.get(i);if(c)return c;const b=new Set;i.forEach(C=>{e&&(b.add(e),C.forEach(P=>Rh(b,e,P))),C.forEach(P=>Rh(b,l,P)),C.forEach(P=>Rh(b,Nl[h]||{},P)),C.forEach(P=>Rh(b,nr,P)),C.forEach(P=>Rh(b,Xy,P))});const S=Array.from(b);return S.length===0&&S.push(Object.create(null)),k9.has(i)&&d.set(i,S),S}chartOptionScopes(){const{options:e,type:i}=this;return[e,Nl[i]||{},nr.datasets[i]||{},{type:i},nr,Xy]}resolveNamedOptions(e,i,s,l=[""]){const h={$shared:!0},{resolver:d,subPrefixes:c}=Mw(this._resolverCache,e,l);let b=d;if(zI(d,i)){h.$shared=!1,s=Za(s)?s():s;const S=this.createResolver(e,s,c);b=uu(d,s,S)}for(const S of i)h[S]=b[S];return h}createResolver(e,i,s=[""],l){const{resolver:h}=Mw(this._resolverCache,e,s);return Xe(i)?uu(h,i,void 0,l):h}}function Mw(t,e,i){let s=t.get(e);s||(s=new Map,t.set(e,s));const l=i.join();let h=s.get(l);return h||(h={resolver:Sv(e,i),subPrefixes:i.filter(d=>!d.toLowerCase().includes("hover"))},s.set(l,h)),h}const AI=t=>Xe(t)&&Object.getOwnPropertyNames(t).some(e=>Za(t[e]));function zI(t,e){const{isScriptable:i,isIndexable:s}=r9(t);for(const l of e){const h=i(l),d=s(l),c=(d||h)&&t[l];if(h&&(Za(c)||AI(c))||d&&Zi(c))return!0}return!1}var DI="4.4.4";const LI=["top","bottom","left","right","chartArea"];function Cw(t,e){return t==="top"||t==="bottom"||LI.indexOf(t)===-1&&e==="x"}function Ew(t,e){return function(i,s){return i[t]===s[t]?i[e]-s[e]:i[t]-s[t]}}function Pw(t){const e=t.chart,i=e.options.animation;e.notifyPlugins("afterRender"),Ve(i&&i.onComplete,[t],e)}function RI(t){const e=t.chart,i=e.options.animation;Ve(i&&i.onProgress,[t],e)}function T9(t){return Mv()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const zm={},M9=t=>{const e=T9(t);return Object.values(zm).filter(i=>i.canvas===e).pop()};function FI(t,e,i){const s=Object.keys(t);for(const l of s){const h=+l;if(h>=e){const d=t[l];delete t[l],(i>0||h>e)&&(t[h+i]=d)}}}function OI(t,e,i,s){return!i||t.type==="mouseout"?null:s?e:t}function Mf(t,e,i){return t.options.clip?t[i]:e[i]}function BI(t,e){const{xScale:i,yScale:s}=t;return i&&s?{left:Mf(i,e,"left"),right:Mf(i,e,"right"),top:Mf(s,e,"top"),bottom:Mf(s,e,"bottom")}:e}class xs{static register(...e){fo.add(...e),Iw()}static unregister(...e){fo.remove(...e),Iw()}constructor(e,i){const s=this.config=new II(i),l=T9(e),h=M9(l);if(h)throw new Error("Canvas is already in use. Chart with ID '"+h.id+"' must be destroyed before the canvas with ID '"+h.canvas.id+"' can be reused.");const d=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||eI(l)),this.platform.updateConfig(s);const c=this.platform.acquireContext(l,d.aspectRatio),b=c&&c.canvas,S=b&&b.height,C=b&&b.width;if(this.id=$C(),this.ctx=c,this.canvas=b,this.width=C,this.height=S,this._options=d,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new vI,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=iE(P=>this.update(P),d.resizeDelay||0),this._dataChanges=[],zm[this.id]=this,!c||!b){console.error("Failed to create chart: can't acquire context from the given item");return}Fo.listen(this,"complete",Pw),Fo.listen(this,"progress",RI),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:i},width:s,height:l,_aspectRatio:h}=this;return oi(e)?i&&h?h:l?s/l:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return fo}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Jb(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Yb(this.canvas,this.ctx),this}stop(){return Fo.stop(this),this}resize(e,i){Fo.running(this)?this._resizeBeforeDraw={width:e,height:i}:this._resize(e,i)}_resize(e,i){const s=this.options,l=this.canvas,h=s.maintainAspectRatio&&this.aspectRatio,d=this.platform.getMaximumSize(l,e,i,h),c=s.devicePixelRatio||this.platform.getDevicePixelRatio(),b=this.width?"resize":"attach";this.width=d.width,this.height=d.height,this._aspectRatio=this.aspectRatio,Jb(this,c,!0)&&(this.notifyPlugins("resize",{size:d}),Ve(s.onResize,[this,d],this),this.attached&&this._doResize(b)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};We(e,(i,s)=>{i.id=s})}buildOrUpdateScales(){const e=this.options,i=e.scales,s=this.scales,l=Object.keys(s).reduce((d,c)=>(d[c]=!1,d),{});let h=[];i&&(h=h.concat(Object.keys(i).map(d=>{const c=i[d],b=e_(d,c),S=b==="r",C=b==="x";return{options:c,dposition:S?"chartArea":C?"bottom":"left",dtype:S?"radialLinear":C?"category":"linear"}}))),We(h,d=>{const c=d.options,b=c.id,S=e_(b,c),C=Le(c.type,d.dtype);(c.position===void 0||Cw(c.position,S)!==Cw(d.dposition))&&(c.position=d.dposition),l[b]=!0;let P=null;if(b in s&&s[b].type===C)P=s[b];else{const A=fo.getScale(C);P=new A({id:b,type:C,ctx:this.ctx,chart:this}),s[P.id]=P}P.init(c,e)}),We(l,(d,c)=>{d||delete s[c]}),We(s,d=>{fn.configure(this,d,d.options),fn.addBox(this,d)})}_updateMetasets(){const e=this._metasets,i=this.data.datasets.length,s=e.length;if(e.sort((l,h)=>l.index-h.index),s>i){for(let l=i;l<s;++l)this._destroyDatasetMeta(l);e.splice(i,s-i)}this._sortedMetasets=e.slice(0).sort(Ew("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:i}}=this;e.length>i.length&&delete this._stacks,e.forEach((s,l)=>{i.filter(h=>h===s._dataset).length===0&&this._destroyDatasetMeta(l)})}buildOrUpdateControllers(){const e=[],i=this.data.datasets;let s,l;for(this._removeUnreferencedMetasets(),s=0,l=i.length;s<l;s++){const h=i[s];let d=this.getDatasetMeta(s);const c=h.type||this.config.type;if(d.type&&d.type!==c&&(this._destroyDatasetMeta(s),d=this.getDatasetMeta(s)),d.type=c,d.indexAxis=h.indexAxis||t_(c,this.options),d.order=h.order||0,d.index=s,d.label=""+h.label,d.visible=this.isDatasetVisible(s),d.controller)d.controller.updateIndex(s),d.controller.linkScales();else{const b=fo.getController(c),{datasetElementType:S,dataElementType:C}=nr.datasets[c];Object.assign(b,{dataElementType:fo.getElement(C),datasetElementType:S&&fo.getElement(S)}),d.controller=new b(this,s),e.push(d.controller)}}return this._updateMetasets(),e}_resetElements(){We(this.data.datasets,(e,i)=>{this.getDatasetMeta(i).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const i=this.config;i.update();const s=this._options=i.createResolver(i.chartOptionScopes(),this.getContext()),l=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const h=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let d=0;for(let S=0,C=this.data.datasets.length;S<C;S++){const{controller:P}=this.getDatasetMeta(S),A=!l&&h.indexOf(P)===-1;P.buildOrUpdateElements(A),d=Math.max(+P.getMaxOverflow(),d)}d=this._minPadding=s.layout.autoPadding?d:0,this._updateLayout(d),l||We(h,S=>{S.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Ew("z","_idx"));const{_active:c,_lastEvent:b}=this;b?this._eventHandler(b,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}_updateScales(){We(this.scales,e=>{fn.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,i=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!$b(i,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,i=this._getUniformDataChanges()||[];for(const{method:s,start:l,count:h}of i){const d=s==="_removeElements"?-h:h;FI(e,l,d)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const i=this.data.datasets.length,s=h=>new Set(e.filter(d=>d[0]===h).map((d,c)=>c+","+d.splice(1).join(","))),l=s(0);for(let h=1;h<i;h++)if(!$b(l,s(h)))return;return Array.from(l).map(h=>h.split(",")).map(h=>({method:h[1],start:+h[2],count:+h[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;fn.update(this,this.width,this.height,e);const i=this.chartArea,s=i.width<=0||i.height<=0;this._layers=[],We(this.boxes,l=>{s&&l.position==="chartArea"||(l.configure&&l.configure(),this._layers.push(...l._layers()))},this),this._layers.forEach((l,h)=>{l._idx=h}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let i=0,s=this.data.datasets.length;i<s;++i)this.getDatasetMeta(i).controller.configure();for(let i=0,s=this.data.datasets.length;i<s;++i)this._updateDataset(i,Za(e)?e({datasetIndex:i}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,i){const s=this.getDatasetMeta(e),l={meta:s,index:e,mode:i,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",l)!==!1&&(s.controller._update(i),l.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",l))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Fo.has(this)?this.attached&&!Fo.running(this)&&Fo.start(this):(this.draw(),Pw({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:l}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,l)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const i=this._layers;for(e=0;e<i.length&&i[e].z<=0;++e)i[e].draw(this.chartArea);for(this._drawDatasets();e<i.length;++e)i[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const i=this._sortedMetasets,s=[];let l,h;for(l=0,h=i.length;l<h;++l){const d=i[l];(!e||d.visible)&&s.push(d)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let i=e.length-1;i>=0;--i)this._drawDataset(e[i]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const i=this.ctx,s=e._clip,l=!s.disabled,h=BI(e,this.chartArea),d={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",d)!==!1&&(l&&Qm(i,{left:s.left===!1?0:h.left-s.left,right:s.right===!1?this.width:h.right+s.right,top:s.top===!1?0:h.top-s.top,bottom:s.bottom===!1?this.height:h.bottom+s.bottom}),e.controller.draw(),l&&tg(i),d.cancelable=!1,this.notifyPlugins("afterDatasetDraw",d))}isPointInArea(e){return qo(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,i,s,l){const h=LP.modes[i];return typeof h=="function"?h(this,e,s,l):[]}getDatasetMeta(e){const i=this.data.datasets[e],s=this._metasets;let l=s.filter(h=>h&&h._dataset===i).pop();return l||(l={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:i&&i.order||0,index:e,_dataset:i,_parsed:[],_sorted:!1},s.push(l)),l}getContext(){return this.$context||(this.$context=Ka(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const i=this.data.datasets[e];if(!i)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!i.hidden}setDatasetVisibility(e,i){const s=this.getDatasetMeta(e);s.hidden=!i}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,i,s){const l=s?"show":"hide",h=this.getDatasetMeta(e),d=h.controller._resolveAnimations(void 0,l);Id(i)?(h.data[i].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),d.update(h,{visible:s}),this.update(c=>c.datasetIndex===e?l:void 0))}hide(e,i){this._updateVisibility(e,i,!1)}show(e,i){this._updateVisibility(e,i,!0)}_destroyDatasetMeta(e){const i=this._metasets[e];i&&i.controller&&i.controller._destroy(),delete this._metasets[e]}_stop(){let e,i;for(this.stop(),Fo.remove(this),e=0,i=this.data.datasets.length;e<i;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:i}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Yb(e,i),this.platform.releaseContext(i),this.canvas=null,this.ctx=null),delete zm[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,i=this.platform,s=(h,d)=>{i.addEventListener(this,h,d),e[h]=d},l=(h,d,c)=>{h.offsetX=d,h.offsetY=c,this._eventHandler(h)};We(this.options.events,h=>s(h,l))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,i=this.platform,s=(b,S)=>{i.addEventListener(this,b,S),e[b]=S},l=(b,S)=>{e[b]&&(i.removeEventListener(this,b,S),delete e[b])},h=(b,S)=>{this.canvas&&this.resize(b,S)};let d;const c=()=>{l("attach",c),this.attached=!0,this.resize(),s("resize",h),s("detach",d)};d=()=>{this.attached=!1,l("resize",h),this._stop(),this._resize(0,0),s("attach",c)},i.isAttached(this.canvas)?c():d()}unbindEvents(){We(this._listeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._listeners={},We(this._responsiveListeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,i,s){const l=s?"set":"remove";let h,d,c,b;for(i==="dataset"&&(h=this.getDatasetMeta(e[0].datasetIndex),h.controller["_"+l+"DatasetHoverStyle"]()),c=0,b=e.length;c<b;++c){d=e[c];const S=d&&this.getDatasetMeta(d.datasetIndex).controller;S&&S[l+"HoverStyle"](d.element,d.datasetIndex,d.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const i=this._active||[],s=e.map(({datasetIndex:l,index:h})=>{const d=this.getDatasetMeta(l);if(!d)throw new Error("No dataset found at index "+l);return{datasetIndex:l,element:d.data[h],index:h}});!Mm(s,i)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,i))}notifyPlugins(e,i,s){return this._plugins.notify(this,e,i,s)}isPluginEnabled(e){return this._plugins._cache.filter(i=>i.plugin.id===e).length===1}_updateHoverStyles(e,i,s){const l=this.options.hover,h=(b,S)=>b.filter(C=>!S.some(P=>C.datasetIndex===P.datasetIndex&&C.index===P.index)),d=h(i,e),c=s?e:h(e,i);d.length&&this.updateHoverStyle(d,l.mode,!1),c.length&&l.mode&&this.updateHoverStyle(c,l.mode,!0)}_eventHandler(e,i){const s={event:e,replay:i,cancelable:!0,inChartArea:this.isPointInArea(e)},l=d=>(d.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,l)===!1)return;const h=this._handleEvent(e,i,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,l),(h||s.changed)&&this.render(),this}_handleEvent(e,i,s){const{_active:l=[],options:h}=this,d=i,c=this._getActiveElements(e,l,s,d),b=qC(e),S=OI(e,this._lastEvent,s,b);s&&(this._lastEvent=null,Ve(h.onHover,[e,c,this],this),b&&Ve(h.onClick,[e,c,this],this));const C=!Mm(c,l);return(C||i)&&(this._active=c,this._updateHoverStyles(c,l,i)),this._lastEvent=S,C}_getActiveElements(e,i,s,l){if(e.type==="mouseout")return[];if(!s)return i;const h=this.options.hover;return this.getElementsAtEventForMode(e,h.mode,h,l)}}se(xs,"defaults",nr),se(xs,"instances",zm),se(xs,"overrides",Nl),se(xs,"registry",fo),se(xs,"version",DI),se(xs,"getChart",M9);function Iw(){return We(xs.instances,t=>t._plugins.invalidate())}function VI(t,e,i){const{startAngle:s,pixelMargin:l,x:h,y:d,outerRadius:c,innerRadius:b}=e;let S=l/c;t.beginPath(),t.arc(h,d,c,s-S,i+S),b>l?(S=l/b,t.arc(h,d,b,i+S,s-S,!0)):t.arc(h,d,l,i+hr,s-hr),t.closePath(),t.clip()}function $I(t){return wv(t,["outerStart","outerEnd","innerStart","innerEnd"])}function NI(t,e,i,s){const l=$I(t.options.borderRadius),h=(i-e)/2,d=Math.min(h,s*e/2),c=b=>{const S=(i-Math.min(h,b))*s/2;return jr(b,0,Math.min(h,S))};return{outerStart:c(l.outerStart),outerEnd:c(l.outerEnd),innerStart:jr(l.innerStart,0,d),innerEnd:jr(l.innerEnd,0,d)}}function Fc(t,e,i,s){return{x:i+t*Math.cos(e),y:s+t*Math.sin(e)}}function Dm(t,e,i,s,l,h){const{x:d,y:c,startAngle:b,pixelMargin:S,innerRadius:C}=e,P=Math.max(e.outerRadius+s+i-S,0),A=C>0?C+s+i+S:0;let V=0;const W=l-b;if(s){const ve=C>0?C-s:0,Ee=P>0?P-s:0,$e=(ve+Ee)/2,Vt=$e!==0?W*$e/($e+s):W;V=(W-Vt)/2}const $=Math.max(.001,W*P-i/Oi)/P,nt=(W-$)/2,H=b+nt+V,Y=l-nt-V,{outerStart:K,outerEnd:at,innerStart:mt,innerEnd:xt}=NI(e,A,P,Y-H),Tt=P-K,Mt=P-at,$t=H+K/Tt,Ft=Y-at/Mt,Ot=A+mt,ge=A+xt,_e=H+mt/Ot,Ae=Y-xt/ge;if(t.beginPath(),h){const ve=($t+Ft)/2;if(t.arc(d,c,P,$t,ve),t.arc(d,c,P,ve,Ft),at>0){const re=Fc(Mt,Ft,d,c);t.arc(re.x,re.y,at,Ft,Y+hr)}const Ee=Fc(ge,Y,d,c);if(t.lineTo(Ee.x,Ee.y),xt>0){const re=Fc(ge,Ae,d,c);t.arc(re.x,re.y,xt,Y+hr,Ae+Math.PI)}const $e=(Y-xt/A+(H+mt/A))/2;if(t.arc(d,c,A,Y-xt/A,$e,!0),t.arc(d,c,A,$e,H+mt/A,!0),mt>0){const re=Fc(Ot,_e,d,c);t.arc(re.x,re.y,mt,_e+Math.PI,H-hr)}const Vt=Fc(Tt,H,d,c);if(t.lineTo(Vt.x,Vt.y),K>0){const re=Fc(Tt,$t,d,c);t.arc(re.x,re.y,K,H-hr,$t)}}else{t.moveTo(d,c);const ve=Math.cos($t)*P+d,Ee=Math.sin($t)*P+c;t.lineTo(ve,Ee);const $e=Math.cos(Ft)*P+d,Vt=Math.sin(Ft)*P+c;t.lineTo($e,Vt)}t.closePath()}function jI(t,e,i,s,l){const{fullCircles:h,startAngle:d,circumference:c}=e;let b=e.endAngle;if(h){Dm(t,e,i,s,b,l);for(let S=0;S<h;++S)t.fill();isNaN(c)||(b=d+(c%Fi||Fi))}return Dm(t,e,i,s,b,l),t.fill(),b}function UI(t,e,i,s,l){const{fullCircles:h,startAngle:d,circumference:c,options:b}=e,{borderWidth:S,borderJoinStyle:C,borderDash:P,borderDashOffset:A}=b,V=b.borderAlign==="inner";if(!S)return;t.setLineDash(P||[]),t.lineDashOffset=A,V?(t.lineWidth=S*2,t.lineJoin=C||"round"):(t.lineWidth=S,t.lineJoin=C||"bevel");let W=e.endAngle;if(h){Dm(t,e,i,s,W,l);for(let $=0;$<h;++$)t.stroke();isNaN(c)||(W=d+(c%Fi||Fi))}V&&VI(t,e,W),h||(Dm(t,e,i,s,W,l),t.stroke())}class Hh extends Gs{constructor(e){super(),se(this,"circumference"),se(this,"endAngle"),se(this,"fullCircles"),se(this,"innerRadius"),se(this,"outerRadius"),se(this,"pixelMargin"),se(this,"startAngle"),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,i,s){const l=this.getProps(["x","y"],s),{angle:h,distance:d}=GS(l,{x:e,y:i}),{startAngle:c,endAngle:b,innerRadius:S,outerRadius:C,circumference:P}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),A=(this.options.spacing+this.options.borderWidth)/2,V=Le(P,b-c),W=Ad(h,c,b)&&c!==b,$=V>=Fi||W,nt=Ho(d,S+A,C+A);return $&&nt}getCenterPoint(e){const{x:i,y:s,startAngle:l,endAngle:h,innerRadius:d,outerRadius:c}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:b,spacing:S}=this.options,C=(l+h)/2,P=(d+c+S+b)/2;return{x:i+Math.cos(C)*P,y:s+Math.sin(C)*P}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:i,circumference:s}=this,l=(i.offset||0)/4,h=(i.spacing||0)/2,d=i.circular;if(this.pixelMargin=i.borderAlign==="inner"?.33:0,this.fullCircles=s>Fi?Math.floor(s/Fi):0,s===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const c=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(c)*l,Math.sin(c)*l);const b=1-Math.sin(Math.min(Oi,s||0)),S=l*b;e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,jI(e,this,S,h,d),UI(e,this,S,h,d),e.restore()}}se(Hh,"id","arc"),se(Hh,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),se(Hh,"defaultRoutes",{backgroundColor:"backgroundColor"}),se(Hh,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});function C9(t,e,i=e){t.lineCap=Le(i.borderCapStyle,e.borderCapStyle),t.setLineDash(Le(i.borderDash,e.borderDash)),t.lineDashOffset=Le(i.borderDashOffset,e.borderDashOffset),t.lineJoin=Le(i.borderJoinStyle,e.borderJoinStyle),t.lineWidth=Le(i.borderWidth,e.borderWidth),t.strokeStyle=Le(i.borderColor,e.borderColor)}function HI(t,e,i){t.lineTo(i.x,i.y)}function ZI(t){return t.stepped?fE:t.tension||t.cubicInterpolationMode==="monotone"?mE:HI}function E9(t,e,i={}){const s=t.length,{start:l=0,end:h=s-1}=i,{start:d,end:c}=e,b=Math.max(l,d),S=Math.min(h,c),C=l<d&&h<d||l>c&&h>c;return{count:s,start:b,loop:e.loop,ilen:S<b&&!C?s+S-b:S-b}}function qI(t,e,i,s){const{points:l,options:h}=e,{count:d,start:c,loop:b,ilen:S}=E9(l,i,s),C=ZI(h);let{move:P=!0,reverse:A}=s||{},V,W,$;for(V=0;V<=S;++V)W=l[(c+(A?S-V:V))%d],!W.skip&&(P?(t.moveTo(W.x,W.y),P=!1):C(t,$,W,A,h.stepped),$=W);return b&&(W=l[(c+(A?S:0))%d],C(t,$,W,A,h.stepped)),!!b}function GI(t,e,i,s){const l=e.points,{count:h,start:d,ilen:c}=E9(l,i,s),{move:b=!0,reverse:S}=s||{};let C=0,P=0,A,V,W,$,nt,H;const Y=at=>(d+(S?c-at:at))%h,K=()=>{$!==nt&&(t.lineTo(C,nt),t.lineTo(C,$),t.lineTo(C,H))};for(b&&(V=l[Y(0)],t.moveTo(V.x,V.y)),A=0;A<=c;++A){if(V=l[Y(A)],V.skip)continue;const at=V.x,mt=V.y,xt=at|0;xt===W?(mt<$?$=mt:mt>nt&&(nt=mt),C=(P*C+at)/++P):(K(),t.lineTo(at,mt),W=xt,P=0,$=nt=mt),H=mt}K()}function i_(t){const e=t.options,i=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!i?GI:qI}function WI(t){return t.stepped?GE:t.tension||t.cubicInterpolationMode==="monotone"?WE:Cl}function YI(t,e,i,s){let l=e._path;l||(l=e._path=new Path2D,e.path(l,i,s)&&l.closePath()),C9(t,e.options),t.stroke(l)}function KI(t,e,i,s){const{segments:l,options:h}=e,d=i_(e);for(const c of l)C9(t,h,c.style),t.beginPath(),d(t,e,c,{start:i,end:i+s-1})&&t.closePath(),t.stroke()}const XI=typeof Path2D=="function";function JI(t,e,i,s){XI&&!e.options.segment?YI(t,e,i,s):KI(t,e,i,s)}class Ia extends Gs{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,i){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const l=s.spanGaps?this._loop:this._fullLoop;VE(this._points,s,e,l,i),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=tP(this,this.options.segment))}first(){const e=this.segments,i=this.points;return e.length&&i[e[0].start]}last(){const e=this.segments,i=this.points,s=e.length;return s&&i[e[s-1].end]}interpolate(e,i){const s=this.options,l=e[i],h=this.points,d=p9(this,{property:i,start:l,end:l});if(!d.length)return;const c=[],b=WI(s);let S,C;for(S=0,C=d.length;S<C;++S){const{start:P,end:A}=d[S],V=h[P],W=h[A];if(V===W){c.push(V);continue}const $=Math.abs((l-V[i])/(W[i]-V[i])),nt=b(V,W,$,s.stepped);nt[i]=e[i],c.push(nt)}return c.length===1?c[0]:c}pathSegment(e,i,s){return i_(this)(e,this,i,s)}path(e,i,s){const l=this.segments,h=i_(this);let d=this._loop;i=i||0,s=s||this.points.length-i;for(const c of l)d&=h(e,this,c,{start:i,end:i+s-1});return!!d}draw(e,i,s,l){const h=this.options||{};(this.points||[]).length&&h.borderWidth&&(e.save(),JI(e,this,s,l),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}se(Ia,"id","line"),se(Ia,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),se(Ia,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),se(Ia,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function Aw(t,e,i,s){const l=t.options,{[i]:h}=t.getProps([i],s);return Math.abs(e-h)<l.radius+l.hitRadius}class Kf extends Gs{constructor(e){super(),se(this,"parsed"),se(this,"skip"),se(this,"stop"),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,i,s){const l=this.options,{x:h,y:d}=this.getProps(["x","y"],s);return Math.pow(e-h,2)+Math.pow(i-d,2)<Math.pow(l.hitRadius+l.radius,2)}inXRange(e,i){return Aw(this,e,"x",i)}inYRange(e,i){return Aw(this,e,"y",i)}getCenterPoint(e){const{x:i,y:s}=this.getProps(["x","y"],e);return{x:i,y:s}}size(e){e=e||this.options||{};let i=e.radius||0;i=Math.max(i,i&&e.hoverRadius||0);const s=i&&e.borderWidth||0;return(i+s)*2}draw(e,i){const s=this.options;this.skip||s.radius<.1||!qo(this,i,this.size(s)/2)||(e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.fillStyle=s.backgroundColor,Jy(e,s,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}se(Kf,"id","point"),se(Kf,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),se(Kf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function P9(t,e){const{x:i,y:s,base:l,width:h,height:d}=t.getProps(["x","y","base","width","height"],e);let c,b,S,C,P;return t.horizontal?(P=d/2,c=Math.min(i,l),b=Math.max(i,l),S=s-P,C=s+P):(P=h/2,c=i-P,b=i+P,S=Math.min(s,l),C=Math.max(s,l)),{left:c,top:S,right:b,bottom:C}}function Aa(t,e,i,s){return t?0:jr(e,i,s)}function QI(t,e,i){const s=t.options.borderWidth,l=t.borderSkipped,h=i9(s);return{t:Aa(l.top,h.top,0,i),r:Aa(l.right,h.right,0,e),b:Aa(l.bottom,h.bottom,0,i),l:Aa(l.left,h.left,0,e)}}function t6(t,e,i){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),l=t.options.borderRadius,h=Ll(l),d=Math.min(e,i),c=t.borderSkipped,b=s||Xe(l);return{topLeft:Aa(!b||c.top||c.left,h.topLeft,0,d),topRight:Aa(!b||c.top||c.right,h.topRight,0,d),bottomLeft:Aa(!b||c.bottom||c.left,h.bottomLeft,0,d),bottomRight:Aa(!b||c.bottom||c.right,h.bottomRight,0,d)}}function e6(t){const e=P9(t),i=e.right-e.left,s=e.bottom-e.top,l=QI(t,i/2,s/2),h=t6(t,i/2,s/2);return{outer:{x:e.left,y:e.top,w:i,h:s,radius:h},inner:{x:e.left+l.l,y:e.top+l.t,w:i-l.l-l.r,h:s-l.t-l.b,radius:{topLeft:Math.max(0,h.topLeft-Math.max(l.t,l.l)),topRight:Math.max(0,h.topRight-Math.max(l.t,l.r)),bottomLeft:Math.max(0,h.bottomLeft-Math.max(l.b,l.l)),bottomRight:Math.max(0,h.bottomRight-Math.max(l.b,l.r))}}}}function Y0(t,e,i,s){const l=e===null,h=i===null,d=t&&!(l&&h)&&P9(t,s);return d&&(l||Ho(e,d.left,d.right))&&(h||Ho(i,d.top,d.bottom))}function i6(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function r6(t,e){t.rect(e.x,e.y,e.w,e.h)}function K0(t,e,i={}){const s=t.x!==i.x?-e:0,l=t.y!==i.y?-e:0,h=(t.x+t.w!==i.x+i.w?e:0)-s,d=(t.y+t.h!==i.y+i.h?e:0)-l;return{x:t.x+s,y:t.y+l,w:t.w+h,h:t.h+d,radius:t.radius}}class Xf extends Gs{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:i,options:{borderColor:s,backgroundColor:l}}=this,{inner:h,outer:d}=e6(this),c=i6(d.radius)?zd:r6;e.save(),(d.w!==h.w||d.h!==h.h)&&(e.beginPath(),c(e,K0(d,i,h)),e.clip(),c(e,K0(h,-i,d)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),c(e,K0(h,i)),e.fillStyle=l,e.fill(),e.restore()}inRange(e,i,s){return Y0(this,e,i,s)}inXRange(e,i){return Y0(this,e,null,i)}inYRange(e,i){return Y0(this,null,e,i)}getCenterPoint(e){const{x:i,y:s,base:l,horizontal:h}=this.getProps(["x","y","base","horizontal"],e);return{x:h?(i+l)/2:i,y:h?s:(s+l)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}se(Xf,"id","bar"),se(Xf,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),se(Xf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var n6=Object.freeze({__proto__:null,ArcElement:Hh,BarElement:Xf,LineElement:Ia,PointElement:Kf});const r_=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],zw=r_.map(t=>t.replace("rgb(","rgba(").replace(")",", 0.5)"));function I9(t){return r_[t%r_.length]}function A9(t){return zw[t%zw.length]}function s6(t,e){return t.borderColor=I9(e),t.backgroundColor=A9(e),++e}function o6(t,e){return t.backgroundColor=t.data.map(()=>I9(e++)),e}function a6(t,e){return t.backgroundColor=t.data.map(()=>A9(e++)),e}function l6(t){let e=0;return(i,s)=>{const l=t.getDatasetMeta(s).controller;l instanceof Al?e=o6(i,e):l instanceof od?e=a6(i,e):l&&(e=s6(i,e))}}function Dw(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}function c6(t){return t&&(t.borderColor||t.backgroundColor)}var u6={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,e,i){if(!i.enabled)return;const{data:{datasets:s},options:l}=t.config,{elements:h}=l;if(!i.forceOverride&&(Dw(s)||c6(l)||h&&Dw(h)))return;const d=l6(t);s.forEach(d)}};function h6(t,e,i,s,l){const h=l.samples||s;if(h>=i)return t.slice(e,e+i);const d=[],c=(i-2)/(h-2);let b=0;const S=e+i-1;let C=e,P,A,V,W,$;for(d[b++]=t[C],P=0;P<h-2;P++){let nt=0,H=0,Y;const K=Math.floor((P+1)*c)+1+e,at=Math.min(Math.floor((P+2)*c)+1,i)+e,mt=at-K;for(Y=K;Y<at;Y++)nt+=t[Y].x,H+=t[Y].y;nt/=mt,H/=mt;const xt=Math.floor(P*c)+1+e,Tt=Math.min(Math.floor((P+1)*c)+1,i)+e,{x:Mt,y:$t}=t[C];for(V=W=-1,Y=xt;Y<Tt;Y++)W=.5*Math.abs((Mt-nt)*(t[Y].y-$t)-(Mt-t[Y].x)*(H-$t)),W>V&&(V=W,A=t[Y],$=Y);d[b++]=A,C=$}return d[b++]=t[S],d}function d6(t,e,i,s){let l=0,h=0,d,c,b,S,C,P,A,V,W,$;const nt=[],H=e+i-1,Y=t[e].x,K=t[H].x-Y;for(d=e;d<e+i;++d){c=t[d],b=(c.x-Y)/K*s,S=c.y;const at=b|0;if(at===C)S<W?(W=S,P=d):S>$&&($=S,A=d),l=(h*l+c.x)/++h;else{const mt=d-1;if(!oi(P)&&!oi(A)){const xt=Math.min(P,A),Tt=Math.max(P,A);xt!==V&&xt!==mt&&nt.push({...t[xt],x:l}),Tt!==V&&Tt!==mt&&nt.push({...t[Tt],x:l})}d>0&&mt!==V&&nt.push(t[mt]),nt.push(c),C=at,h=0,W=$=S,P=A=V=d}}return nt}function z9(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function Lw(t){t.data.datasets.forEach(e=>{z9(e)})}function p6(t,e){const i=e.length;let s=0,l;const{iScale:h}=t,{min:d,max:c,minDefined:b,maxDefined:S}=h.getUserBounds();return b&&(s=jr(Zo(e,h.axis,d).lo,0,i-1)),S?l=jr(Zo(e,h.axis,c).hi+1,s,i)-s:l=i-s,{start:s,count:l}}var f6={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,i)=>{if(!i.enabled){Lw(t);return}const s=t.width;t.data.datasets.forEach((l,h)=>{const{_data:d,indexAxis:c}=l,b=t.getDatasetMeta(h),S=d||l.data;if(jh([c,t.options.indexAxis])==="y"||!b.controller.supportsDecimation)return;const C=t.scales[b.xAxisID];if(C.type!=="linear"&&C.type!=="time"||t.options.parsing)return;let{start:P,count:A}=p6(b,S);const V=i.threshold||4*s;if(A<=V){z9(l);return}oi(d)&&(l._data=S,delete l.data,Object.defineProperty(l,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function($){this._data=$}}));let W;switch(i.algorithm){case"lttb":W=h6(S,P,A,s,i);break;case"min-max":W=d6(S,P,A,s);break;default:throw new Error(`Unsupported decimation algorithm '${i.algorithm}'`)}l._decimated=W})},destroy(t){Lw(t)}};function m6(t,e,i){const s=t.segments,l=t.points,h=e.points,d=[];for(const c of s){let{start:b,end:S}=c;S=Pv(b,S,l);const C=n_(i,l[b],l[S],c.loop);if(!e.segments){d.push({source:c,target:C,start:l[b],end:l[S]});continue}const P=p9(e,C);for(const A of P){const V=n_(i,h[A.start],h[A.end],A.loop),W=d9(c,l,V);for(const $ of W)d.push({source:$,target:A,start:{[i]:Rw(C,V,"start",Math.max)},end:{[i]:Rw(C,V,"end",Math.min)}})}}return d}function n_(t,e,i,s){if(s)return;let l=e[t],h=i[t];return t==="angle"&&(l=os(l),h=os(h)),{property:t,start:l,end:h}}function g6(t,e){const{x:i=null,y:s=null}=t||{},l=e.points,h=[];return e.segments.forEach(({start:d,end:c})=>{c=Pv(d,c,l);const b=l[d],S=l[c];s!==null?(h.push({x:b.x,y:s}),h.push({x:S.x,y:s})):i!==null&&(h.push({x:i,y:b.y}),h.push({x:i,y:S.y}))}),h}function Pv(t,e,i){for(;e>t;e--){const s=i[e];if(!isNaN(s.x)&&!isNaN(s.y))break}return e}function Rw(t,e,i,s){return t&&e?s(t[i],e[i]):t?t[i]:e?e[i]:0}function D9(t,e){let i=[],s=!1;return Zi(t)?(s=!0,i=t):i=g6(t,e),i.length?new Ia({points:i,options:{tension:0},_loop:s,_fullLoop:s}):null}function Fw(t){return t&&t.fill!==!1}function y6(t,e,i){let s=t[e].fill;const l=[e];let h;if(!i)return s;for(;s!==!1&&l.indexOf(s)===-1;){if(!rr(s))return s;if(h=t[s],!h)return!1;if(h.visible)return s;l.push(s),s=h.fill}return!1}function _6(t,e,i){const s=w6(t);if(Xe(s))return isNaN(s.value)?!1:s;let l=parseFloat(s);return rr(l)&&Math.floor(l)===l?v6(s[0],e,l,i):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function v6(t,e,i,s){return(t==="-"||t==="+")&&(i=e+i),i===e||i<0||i>=s?!1:i}function x6(t,e){let i=null;return t==="start"?i=e.bottom:t==="end"?i=e.top:Xe(t)?i=e.getPixelForValue(t.value):e.getBasePixel&&(i=e.getBasePixel()),i}function b6(t,e,i){let s;return t==="start"?s=i:t==="end"?s=e.options.reverse?e.min:e.max:Xe(t)?s=t.value:s=e.getBaseValue(),s}function w6(t){const e=t.options,i=e.fill;let s=Le(i&&i.target,i);return s===void 0&&(s=!!e.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function S6(t){const{scale:e,index:i,line:s}=t,l=[],h=s.segments,d=s.points,c=k6(e,i);c.push(D9({x:null,y:e.bottom},s));for(let b=0;b<h.length;b++){const S=h[b];for(let C=S.start;C<=S.end;C++)T6(l,d[C],c)}return new Ia({points:l,options:{}})}function k6(t,e){const i=[],s=t.getMatchingVisibleMetas("line");for(let l=0;l<s.length;l++){const h=s[l];if(h.index===e)break;h.hidden||i.unshift(h.dataset)}return i}function T6(t,e,i){const s=[];for(let l=0;l<i.length;l++){const h=i[l],{first:d,last:c,point:b}=M6(h,e,"x");if(!(!b||d&&c)){if(d)s.unshift(b);else if(t.push(b),!c)break}}t.push(...s)}function M6(t,e,i){const s=t.interpolate(e,i);if(!s)return{};const l=s[i],h=t.segments,d=t.points;let c=!1,b=!1;for(let S=0;S<h.length;S++){const C=h[S],P=d[C.start][i],A=d[C.end][i];if(Ho(l,P,A)){c=l===P,b=l===A;break}}return{first:c,last:b,point:s}}class L9{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,i,s){const{x:l,y:h,radius:d}=this;return i=i||{start:0,end:Fi},e.arc(l,h,d,i.end,i.start,!0),!s.bounds}interpolate(e){const{x:i,y:s,radius:l}=this,h=e.angle;return{x:i+Math.cos(h)*l,y:s+Math.sin(h)*l,angle:h}}}function C6(t){const{chart:e,fill:i,line:s}=t;if(rr(i))return E6(e,i);if(i==="stack")return S6(t);if(i==="shape")return!0;const l=P6(t);return l instanceof L9?l:D9(l,s)}function E6(t,e){const i=t.getDatasetMeta(e);return i&&t.isDatasetVisible(e)?i.dataset:null}function P6(t){return(t.scale||{}).getPointPositionForValue?A6(t):I6(t)}function I6(t){const{scale:e={},fill:i}=t,s=x6(i,e);if(rr(s)){const l=e.isHorizontal();return{x:l?s:null,y:l?null:s}}return null}function A6(t){const{scale:e,fill:i}=t,s=e.options,l=e.getLabels().length,h=s.reverse?e.max:e.min,d=b6(i,e,h),c=[];if(s.grid.circular){const b=e.getPointPositionForValue(0,h);return new L9({x:b.x,y:b.y,radius:e.getDistanceFromCenterForValue(d)})}for(let b=0;b<l;++b)c.push(e.getPointPositionForValue(b,d));return c}function X0(t,e,i){const s=C6(e),{line:l,scale:h,axis:d}=e,c=l.options,b=c.fill,S=c.backgroundColor,{above:C=S,below:P=S}=b||{};s&&l.points.length&&(Qm(t,i),z6(t,{line:l,target:s,above:C,below:P,area:i,scale:h,axis:d}),tg(t))}function z6(t,e){const{line:i,target:s,above:l,below:h,area:d,scale:c}=e,b=i._loop?"angle":e.axis;t.save(),b==="x"&&h!==l&&(Ow(t,s,d.top),Bw(t,{line:i,target:s,color:l,scale:c,property:b}),t.restore(),t.save(),Ow(t,s,d.bottom)),Bw(t,{line:i,target:s,color:h,scale:c,property:b}),t.restore()}function Ow(t,e,i){const{segments:s,points:l}=e;let h=!0,d=!1;t.beginPath();for(const c of s){const{start:b,end:S}=c,C=l[b],P=l[Pv(b,S,l)];h?(t.moveTo(C.x,C.y),h=!1):(t.lineTo(C.x,i),t.lineTo(C.x,C.y)),d=!!e.pathSegment(t,c,{move:d}),d?t.closePath():t.lineTo(P.x,i)}t.lineTo(e.first().x,i),t.closePath(),t.clip()}function Bw(t,e){const{line:i,target:s,property:l,color:h,scale:d}=e,c=m6(i,s,l);for(const{source:b,target:S,start:C,end:P}of c){const{style:{backgroundColor:A=h}={}}=b,V=s!==!0;t.save(),t.fillStyle=A,D6(t,d,V&&n_(l,C,P)),t.beginPath();const W=!!i.pathSegment(t,b);let $;if(V){W?t.closePath():Vw(t,s,P,l);const nt=!!s.pathSegment(t,S,{move:W,reverse:!0});$=W&&nt,$||Vw(t,s,C,l)}t.closePath(),t.fill($?"evenodd":"nonzero"),t.restore()}}function D6(t,e,i){const{top:s,bottom:l}=e.chart.chartArea,{property:h,start:d,end:c}=i||{};h==="x"&&(t.beginPath(),t.rect(d,s,c-d,l-s),t.clip())}function Vw(t,e,i,s){const l=e.interpolate(i,s);l&&t.lineTo(l.x,l.y)}var L6={id:"filler",afterDatasetsUpdate(t,e,i){const s=(t.data.datasets||[]).length,l=[];let h,d,c,b;for(d=0;d<s;++d)h=t.getDatasetMeta(d),c=h.dataset,b=null,c&&c.options&&c instanceof Ia&&(b={visible:t.isDatasetVisible(d),index:d,fill:_6(c,d,s),chart:t,axis:h.controller.options.indexAxis,scale:h.vScale,line:c}),h.$filler=b,l.push(b);for(d=0;d<s;++d)b=l[d],!(!b||b.fill===!1)&&(b.fill=y6(l,d,i.propagate))},beforeDraw(t,e,i){const s=i.drawTime==="beforeDraw",l=t.getSortedVisibleDatasetMetas(),h=t.chartArea;for(let d=l.length-1;d>=0;--d){const c=l[d].$filler;c&&(c.line.updateControlPoints(h,c.axis),s&&c.fill&&X0(t.ctx,c,h))}},beforeDatasetsDraw(t,e,i){if(i.drawTime!=="beforeDatasetsDraw")return;const s=t.getSortedVisibleDatasetMetas();for(let l=s.length-1;l>=0;--l){const h=s[l].$filler;Fw(h)&&X0(t.ctx,h,t.chartArea)}},beforeDatasetDraw(t,e,i){const s=e.meta.$filler;!Fw(s)||i.drawTime!=="beforeDatasetDraw"||X0(t.ctx,s,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const $w=(t,e)=>{let{boxHeight:i=e,boxWidth:s=e}=t;return t.usePointStyle&&(i=Math.min(i,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:i,itemHeight:Math.max(e,i)}},R6=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class Nw extends Gs{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,i,s){this.maxWidth=e,this.maxHeight=i,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let i=Ve(e.generateLabels,[this.chart],this)||[];e.filter&&(i=i.filter(s=>e.filter(s,this.chart.data))),e.sort&&(i=i.sort((s,l)=>e.sort(s,l,this.chart.data))),this.options.reverse&&i.reverse(),this.legendItems=i}fit(){const{options:e,ctx:i}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,l=Pr(s.font),h=l.size,d=this._computeTitleHeight(),{boxWidth:c,itemHeight:b}=$w(s,h);let S,C;i.font=l.string,this.isHorizontal()?(S=this.maxWidth,C=this._fitRows(d,h,c,b)+10):(C=this.maxHeight,S=this._fitCols(d,l,c,b)+10),this.width=Math.min(S,e.maxWidth||this.maxWidth),this.height=Math.min(C,e.maxHeight||this.maxHeight)}_fitRows(e,i,s,l){const{ctx:h,maxWidth:d,options:{labels:{padding:c}}}=this,b=this.legendHitBoxes=[],S=this.lineWidths=[0],C=l+c;let P=e;h.textAlign="left",h.textBaseline="middle";let A=-1,V=-C;return this.legendItems.forEach((W,$)=>{const nt=s+i/2+h.measureText(W.text).width;($===0||S[S.length-1]+nt+2*c>d)&&(P+=C,S[S.length-($>0?0:1)]=0,V+=C,A++),b[$]={left:0,top:V,row:A,width:nt,height:l},S[S.length-1]+=nt+c}),P}_fitCols(e,i,s,l){const{ctx:h,maxHeight:d,options:{labels:{padding:c}}}=this,b=this.legendHitBoxes=[],S=this.columnSizes=[],C=d-e;let P=c,A=0,V=0,W=0,$=0;return this.legendItems.forEach((nt,H)=>{const{itemWidth:Y,itemHeight:K}=F6(s,i,h,nt,l);H>0&&V+K+2*c>C&&(P+=A+c,S.push({width:A,height:V}),W+=A+c,$++,A=V=0),b[H]={left:W,top:V,col:$,width:Y,height:K},A=Math.max(A,Y),V+=K+c}),P+=A,S.push({width:A,height:V}),P}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:i,options:{align:s,labels:{padding:l},rtl:h}}=this,d=eu(h,this.left,this.width);if(this.isHorizontal()){let c=0,b=dn(s,this.left+l,this.right-this.lineWidths[c]);for(const S of i)c!==S.row&&(c=S.row,b=dn(s,this.left+l,this.right-this.lineWidths[c])),S.top+=this.top+e+l,S.left=d.leftForLtr(d.x(b),S.width),b+=S.width+l}else{let c=0,b=dn(s,this.top+e+l,this.bottom-this.columnSizes[c].height);for(const S of i)S.col!==c&&(c=S.col,b=dn(s,this.top+e+l,this.bottom-this.columnSizes[c].height)),S.top=b,S.left+=this.left+l,S.left=d.leftForLtr(d.x(S.left),S.width),b+=S.height+l}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Qm(e,this),this._draw(),tg(e)}}_draw(){const{options:e,columnSizes:i,lineWidths:s,ctx:l}=this,{align:h,labels:d}=e,c=nr.color,b=eu(e.rtl,this.left,this.width),S=Pr(d.font),{padding:C}=d,P=S.size,A=P/2;let V;this.drawTitle(),l.textAlign=b.textAlign("left"),l.textBaseline="middle",l.lineWidth=.5,l.font=S.string;const{boxWidth:W,boxHeight:$,itemHeight:nt}=$w(d,P),H=function(xt,Tt,Mt){if(isNaN(W)||W<=0||isNaN($)||$<0)return;l.save();const $t=Le(Mt.lineWidth,1);if(l.fillStyle=Le(Mt.fillStyle,c),l.lineCap=Le(Mt.lineCap,"butt"),l.lineDashOffset=Le(Mt.lineDashOffset,0),l.lineJoin=Le(Mt.lineJoin,"miter"),l.lineWidth=$t,l.strokeStyle=Le(Mt.strokeStyle,c),l.setLineDash(Le(Mt.lineDash,[])),d.usePointStyle){const Ft={radius:$*Math.SQRT2/2,pointStyle:Mt.pointStyle,rotation:Mt.rotation,borderWidth:$t},Ot=b.xPlus(xt,W/2),ge=Tt+A;e9(l,Ft,Ot,ge,d.pointStyleWidth&&W)}else{const Ft=Tt+Math.max((P-$)/2,0),Ot=b.leftForLtr(xt,W),ge=Ll(Mt.borderRadius);l.beginPath(),Object.values(ge).some(_e=>_e!==0)?zd(l,{x:Ot,y:Ft,w:W,h:$,radius:ge}):l.rect(Ot,Ft,W,$),l.fill(),$t!==0&&l.stroke()}l.restore()},Y=function(xt,Tt,Mt){jl(l,Mt.text,xt,Tt+nt/2,S,{strikethrough:Mt.hidden,textAlign:b.textAlign(Mt.textAlign)})},K=this.isHorizontal(),at=this._computeTitleHeight();K?V={x:dn(h,this.left+C,this.right-s[0]),y:this.top+C+at,line:0}:V={x:this.left+C,y:dn(h,this.top+at+C,this.bottom-i[0].height),line:0},c9(this.ctx,e.textDirection);const mt=nt+C;this.legendItems.forEach((xt,Tt)=>{l.strokeStyle=xt.fontColor,l.fillStyle=xt.fontColor;const Mt=l.measureText(xt.text).width,$t=b.textAlign(xt.textAlign||(xt.textAlign=d.textAlign)),Ft=W+A+Mt;let Ot=V.x,ge=V.y;b.setWidth(this.width),K?Tt>0&&Ot+Ft+C>this.right&&(ge=V.y+=mt,V.line++,Ot=V.x=dn(h,this.left+C,this.right-s[V.line])):Tt>0&&ge+mt>this.bottom&&(Ot=V.x=Ot+i[V.line].width+C,V.line++,ge=V.y=dn(h,this.top+at+C,this.bottom-i[V.line].height));const _e=b.x(Ot);if(H(_e,ge,xt),Ot=rE($t,Ot+W+A,K?Ot+Ft:this.right,e.rtl),Y(b.x(Ot),ge,xt),K)V.x+=Ft+C;else if(typeof xt.text!="string"){const Ae=S.lineHeight;V.y+=R9(xt,Ae)+C}else V.y+=mt}),u9(this.ctx,e.textDirection)}drawTitle(){const e=this.options,i=e.title,s=Pr(i.font),l=gn(i.padding);if(!i.display)return;const h=eu(e.rtl,this.left,this.width),d=this.ctx,c=i.position,b=s.size/2,S=l.top+b;let C,P=this.left,A=this.width;if(this.isHorizontal())A=Math.max(...this.lineWidths),C=this.top+S,P=dn(e.align,P,this.right-A);else{const W=this.columnSizes.reduce(($,nt)=>Math.max($,nt.height),0);C=S+dn(e.align,this.top,this.bottom-W-e.labels.padding-this._computeTitleHeight())}const V=dn(c,P,P+A);d.textAlign=h.textAlign(xv(c)),d.textBaseline="middle",d.strokeStyle=i.color,d.fillStyle=i.color,d.font=s.string,jl(d,i.text,V,C,s)}_computeTitleHeight(){const e=this.options.title,i=Pr(e.font),s=gn(e.padding);return e.display?i.lineHeight+s.height:0}_getLegendItemAt(e,i){let s,l,h;if(Ho(e,this.left,this.right)&&Ho(i,this.top,this.bottom)){for(h=this.legendHitBoxes,s=0;s<h.length;++s)if(l=h[s],Ho(e,l.left,l.left+l.width)&&Ho(i,l.top,l.top+l.height))return this.legendItems[s]}return null}handleEvent(e){const i=this.options;if(!V6(e.type,i))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const l=this._hoveredItem,h=R6(l,s);l&&!h&&Ve(i.onLeave,[e,l,this],this),this._hoveredItem=s,s&&!h&&Ve(i.onHover,[e,s,this],this)}else s&&Ve(i.onClick,[e,s,this],this)}}function F6(t,e,i,s,l){const h=O6(s,t,e,i),d=B6(l,s,e.lineHeight);return{itemWidth:h,itemHeight:d}}function O6(t,e,i,s){let l=t.text;return l&&typeof l!="string"&&(l=l.reduce((h,d)=>h.length>d.length?h:d)),e+i.size/2+s.measureText(l).width}function B6(t,e,i){let s=t;return typeof e.text!="string"&&(s=R9(e,i)),s}function R9(t,e){const i=t.text?t.text.length:0;return e*i}function V6(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var $6={id:"legend",_element:Nw,start(t,e,i){const s=t.legend=new Nw({ctx:t.ctx,options:i,chart:t});fn.configure(t,s,i),fn.addBox(t,s)},stop(t){fn.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,i){const s=t.legend;fn.configure(t,s,i),s.options=i},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,i){const s=e.datasetIndex,l=i.chart;l.isDatasetVisible(s)?(l.hide(s),e.hidden=!0):(l.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:i,pointStyle:s,textAlign:l,color:h,useBorderRadius:d,borderRadius:c}}=t.legend.options;return t._getSortedDatasetMetas().map(b=>{const S=b.controller.getStyle(i?0:void 0),C=gn(S.borderWidth);return{text:e[b.index].label,fillStyle:S.backgroundColor,fontColor:h,hidden:!b.visible,lineCap:S.borderCapStyle,lineDash:S.borderDash,lineDashOffset:S.borderDashOffset,lineJoin:S.borderJoinStyle,lineWidth:(C.width+C.height)/4,strokeStyle:S.borderColor,pointStyle:s||S.pointStyle,rotation:S.rotation,textAlign:l||S.textAlign,borderRadius:d&&(c||S.borderRadius),datasetIndex:b.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class Iv extends Gs{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,i){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=i;const l=Zi(s.text)?s.text.length:1;this._padding=gn(s.padding);const h=l*Pr(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=h:this.width=h}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:i,left:s,bottom:l,right:h,options:d}=this,c=d.align;let b=0,S,C,P;return this.isHorizontal()?(C=dn(c,s,h),P=i+e,S=h-s):(d.position==="left"?(C=s+e,P=dn(c,l,i),b=Oi*-.5):(C=h-e,P=dn(c,i,l),b=Oi*.5),S=l-i),{titleX:C,titleY:P,maxWidth:S,rotation:b}}draw(){const e=this.ctx,i=this.options;if(!i.display)return;const s=Pr(i.font),l=s.lineHeight/2+this._padding.top,{titleX:h,titleY:d,maxWidth:c,rotation:b}=this._drawArgs(l);jl(e,i.text,0,0,s,{color:i.color,maxWidth:c,rotation:b,textAlign:xv(i.align),textBaseline:"middle",translation:[h,d]})}}function N6(t,e){const i=new Iv({ctx:t.ctx,options:e,chart:t});fn.configure(t,i,e),fn.addBox(t,i),t.titleBlock=i}var j6={id:"title",_element:Iv,start(t,e,i){N6(t,i)},stop(t){const e=t.titleBlock;fn.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,i){const s=t.titleBlock;fn.configure(t,s,i),s.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Cf=new WeakMap;var U6={id:"subtitle",start(t,e,i){const s=new Iv({ctx:t.ctx,options:i,chart:t});fn.configure(t,s,i),fn.addBox(t,s),Cf.set(t,s)},stop(t){fn.removeBox(t,Cf.get(t)),Cf.delete(t)},beforeUpdate(t,e,i){const s=Cf.get(t);fn.configure(t,s,i),s.options=i},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ad={average(t){if(!t.length)return!1;let e,i,s=new Set,l=0,h=0;for(e=0,i=t.length;e<i;++e){const d=t[e].element;if(d&&d.hasValue()){const c=d.tooltipPosition();s.add(c.x),l+=c.y,++h}}return h===0||s.size===0?!1:{x:[...s].reduce((d,c)=>d+c)/s.size,y:l/h}},nearest(t,e){if(!t.length)return!1;let i=e.x,s=e.y,l=Number.POSITIVE_INFINITY,h,d,c;for(h=0,d=t.length;h<d;++h){const b=t[h].element;if(b&&b.hasValue()){const S=b.getCenterPoint(),C=Ky(e,S);C<l&&(l=C,c=b)}}if(c){const b=c.tooltipPosition();i=b.x,s=b.y}return{x:i,y:s}}};function ho(t,e){return e&&(Zi(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Oo(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function H6(t,e){const{element:i,datasetIndex:s,index:l}=e,h=t.getDatasetMeta(s).controller,{label:d,value:c}=h.getLabelAndValue(l);return{chart:t,label:d,parsed:h.getParsed(l),raw:t.data.datasets[s].data[l],formattedValue:c,dataset:h.getDataset(),dataIndex:l,datasetIndex:s,element:i}}function jw(t,e){const i=t.chart.ctx,{body:s,footer:l,title:h}=t,{boxWidth:d,boxHeight:c}=e,b=Pr(e.bodyFont),S=Pr(e.titleFont),C=Pr(e.footerFont),P=h.length,A=l.length,V=s.length,W=gn(e.padding);let $=W.height,nt=0,H=s.reduce((at,mt)=>at+mt.before.length+mt.lines.length+mt.after.length,0);if(H+=t.beforeBody.length+t.afterBody.length,P&&($+=P*S.lineHeight+(P-1)*e.titleSpacing+e.titleMarginBottom),H){const at=e.displayColors?Math.max(c,b.lineHeight):b.lineHeight;$+=V*at+(H-V)*b.lineHeight+(H-1)*e.bodySpacing}A&&($+=e.footerMarginTop+A*C.lineHeight+(A-1)*e.footerSpacing);let Y=0;const K=function(at){nt=Math.max(nt,i.measureText(at).width+Y)};return i.save(),i.font=S.string,We(t.title,K),i.font=b.string,We(t.beforeBody.concat(t.afterBody),K),Y=e.displayColors?d+2+e.boxPadding:0,We(s,at=>{We(at.before,K),We(at.lines,K),We(at.after,K)}),Y=0,i.font=C.string,We(t.footer,K),i.restore(),nt+=W.width,{width:nt,height:$}}function Z6(t,e){const{y:i,height:s}=e;return i<s/2?"top":i>t.height-s/2?"bottom":"center"}function q6(t,e,i,s){const{x:l,width:h}=s,d=i.caretSize+i.caretPadding;if(t==="left"&&l+h+d>e.width||t==="right"&&l-h-d<0)return!0}function G6(t,e,i,s){const{x:l,width:h}=i,{width:d,chartArea:{left:c,right:b}}=t;let S="center";return s==="center"?S=l<=(c+b)/2?"left":"right":l<=h/2?S="left":l>=d-h/2&&(S="right"),q6(S,t,e,i)&&(S="center"),S}function Uw(t,e,i){const s=i.yAlign||e.yAlign||Z6(t,i);return{xAlign:i.xAlign||e.xAlign||G6(t,e,i,s),yAlign:s}}function W6(t,e){let{x:i,width:s}=t;return e==="right"?i-=s:e==="center"&&(i-=s/2),i}function Y6(t,e,i){let{y:s,height:l}=t;return e==="top"?s+=i:e==="bottom"?s-=l+i:s-=l/2,s}function Hw(t,e,i,s){const{caretSize:l,caretPadding:h,cornerRadius:d}=t,{xAlign:c,yAlign:b}=i,S=l+h,{topLeft:C,topRight:P,bottomLeft:A,bottomRight:V}=Ll(d);let W=W6(e,c);const $=Y6(e,b,S);return b==="center"?c==="left"?W+=S:c==="right"&&(W-=S):c==="left"?W-=Math.max(C,A)+l:c==="right"&&(W+=Math.max(P,V)+l),{x:jr(W,0,s.width-e.width),y:jr($,0,s.height-e.height)}}function Ef(t,e,i){const s=gn(i.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function Zw(t){return ho([],Oo(t))}function K6(t,e,i){return Ka(t,{tooltip:e,tooltipItems:i,type:"tooltip"})}function qw(t,e){const i=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return i?t.override(i):t}const F9={beforeTitle:Ro,title(t){if(t.length>0){const e=t[0],i=e.chart.data.labels,s=i?i.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return i[e.dataIndex]}return""},afterTitle:Ro,beforeBody:Ro,beforeLabel:Ro,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const i=t.formattedValue;return oi(i)||(e+=i),e},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:Ro,afterBody:Ro,beforeFooter:Ro,footer:Ro,afterFooter:Ro};function Ln(t,e,i,s){const l=t[e].call(i,s);return typeof l>"u"?F9[e].call(i,s):l}class s_ extends Gs{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const i=this.chart,s=this.options.setContext(this.getContext()),l=s.enabled&&i.options.animation&&s.animations,h=new f9(this.chart,l);return l._cacheable&&(this._cachedAnimations=Object.freeze(h)),h}getContext(){return this.$context||(this.$context=K6(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,i){const{callbacks:s}=i,l=Ln(s,"beforeTitle",this,e),h=Ln(s,"title",this,e),d=Ln(s,"afterTitle",this,e);let c=[];return c=ho(c,Oo(l)),c=ho(c,Oo(h)),c=ho(c,Oo(d)),c}getBeforeBody(e,i){return Zw(Ln(i.callbacks,"beforeBody",this,e))}getBody(e,i){const{callbacks:s}=i,l=[];return We(e,h=>{const d={before:[],lines:[],after:[]},c=qw(s,h);ho(d.before,Oo(Ln(c,"beforeLabel",this,h))),ho(d.lines,Ln(c,"label",this,h)),ho(d.after,Oo(Ln(c,"afterLabel",this,h))),l.push(d)}),l}getAfterBody(e,i){return Zw(Ln(i.callbacks,"afterBody",this,e))}getFooter(e,i){const{callbacks:s}=i,l=Ln(s,"beforeFooter",this,e),h=Ln(s,"footer",this,e),d=Ln(s,"afterFooter",this,e);let c=[];return c=ho(c,Oo(l)),c=ho(c,Oo(h)),c=ho(c,Oo(d)),c}_createItems(e){const i=this._active,s=this.chart.data,l=[],h=[],d=[];let c=[],b,S;for(b=0,S=i.length;b<S;++b)c.push(H6(this.chart,i[b]));return e.filter&&(c=c.filter((C,P,A)=>e.filter(C,P,A,s))),e.itemSort&&(c=c.sort((C,P)=>e.itemSort(C,P,s))),We(c,C=>{const P=qw(e.callbacks,C);l.push(Ln(P,"labelColor",this,C)),h.push(Ln(P,"labelPointStyle",this,C)),d.push(Ln(P,"labelTextColor",this,C))}),this.labelColors=l,this.labelPointStyles=h,this.labelTextColors=d,this.dataPoints=c,c}update(e,i){const s=this.options.setContext(this.getContext()),l=this._active;let h,d=[];if(!l.length)this.opacity!==0&&(h={opacity:0});else{const c=ad[s.position].call(this,l,this._eventPosition);d=this._createItems(s),this.title=this.getTitle(d,s),this.beforeBody=this.getBeforeBody(d,s),this.body=this.getBody(d,s),this.afterBody=this.getAfterBody(d,s),this.footer=this.getFooter(d,s);const b=this._size=jw(this,s),S=Object.assign({},c,b),C=Uw(this.chart,s,S),P=Hw(s,S,C,this.chart);this.xAlign=C.xAlign,this.yAlign=C.yAlign,h={opacity:1,x:P.x,y:P.y,width:b.width,height:b.height,caretX:c.x,caretY:c.y}}this._tooltipItems=d,this.$context=void 0,h&&this._resolveAnimations().update(this,h),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:i})}drawCaret(e,i,s,l){const h=this.getCaretPosition(e,s,l);i.lineTo(h.x1,h.y1),i.lineTo(h.x2,h.y2),i.lineTo(h.x3,h.y3)}getCaretPosition(e,i,s){const{xAlign:l,yAlign:h}=this,{caretSize:d,cornerRadius:c}=s,{topLeft:b,topRight:S,bottomLeft:C,bottomRight:P}=Ll(c),{x:A,y:V}=e,{width:W,height:$}=i;let nt,H,Y,K,at,mt;return h==="center"?(at=V+$/2,l==="left"?(nt=A,H=nt-d,K=at+d,mt=at-d):(nt=A+W,H=nt+d,K=at-d,mt=at+d),Y=nt):(l==="left"?H=A+Math.max(b,C)+d:l==="right"?H=A+W-Math.max(S,P)-d:H=this.caretX,h==="top"?(K=V,at=K-d,nt=H-d,Y=H+d):(K=V+$,at=K+d,nt=H+d,Y=H-d),mt=K),{x1:nt,x2:H,x3:Y,y1:K,y2:at,y3:mt}}drawTitle(e,i,s){const l=this.title,h=l.length;let d,c,b;if(h){const S=eu(s.rtl,this.x,this.width);for(e.x=Ef(this,s.titleAlign,s),i.textAlign=S.textAlign(s.titleAlign),i.textBaseline="middle",d=Pr(s.titleFont),c=s.titleSpacing,i.fillStyle=s.titleColor,i.font=d.string,b=0;b<h;++b)i.fillText(l[b],S.x(e.x),e.y+d.lineHeight/2),e.y+=d.lineHeight+c,b+1===h&&(e.y+=s.titleMarginBottom-c)}}_drawColorBox(e,i,s,l,h){const d=this.labelColors[s],c=this.labelPointStyles[s],{boxHeight:b,boxWidth:S}=h,C=Pr(h.bodyFont),P=Ef(this,"left",h),A=l.x(P),V=b<C.lineHeight?(C.lineHeight-b)/2:0,W=i.y+V;if(h.usePointStyle){const $={radius:Math.min(S,b)/2,pointStyle:c.pointStyle,rotation:c.rotation,borderWidth:1},nt=l.leftForLtr(A,S)+S/2,H=W+b/2;e.strokeStyle=h.multiKeyBackground,e.fillStyle=h.multiKeyBackground,Jy(e,$,nt,H),e.strokeStyle=d.borderColor,e.fillStyle=d.backgroundColor,Jy(e,$,nt,H)}else{e.lineWidth=Xe(d.borderWidth)?Math.max(...Object.values(d.borderWidth)):d.borderWidth||1,e.strokeStyle=d.borderColor,e.setLineDash(d.borderDash||[]),e.lineDashOffset=d.borderDashOffset||0;const $=l.leftForLtr(A,S),nt=l.leftForLtr(l.xPlus(A,1),S-2),H=Ll(d.borderRadius);Object.values(H).some(Y=>Y!==0)?(e.beginPath(),e.fillStyle=h.multiKeyBackground,zd(e,{x:$,y:W,w:S,h:b,radius:H}),e.fill(),e.stroke(),e.fillStyle=d.backgroundColor,e.beginPath(),zd(e,{x:nt,y:W+1,w:S-2,h:b-2,radius:H}),e.fill()):(e.fillStyle=h.multiKeyBackground,e.fillRect($,W,S,b),e.strokeRect($,W,S,b),e.fillStyle=d.backgroundColor,e.fillRect(nt,W+1,S-2,b-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,i,s){const{body:l}=this,{bodySpacing:h,bodyAlign:d,displayColors:c,boxHeight:b,boxWidth:S,boxPadding:C}=s,P=Pr(s.bodyFont);let A=P.lineHeight,V=0;const W=eu(s.rtl,this.x,this.width),$=function(Mt){i.fillText(Mt,W.x(e.x+V),e.y+A/2),e.y+=A+h},nt=W.textAlign(d);let H,Y,K,at,mt,xt,Tt;for(i.textAlign=d,i.textBaseline="middle",i.font=P.string,e.x=Ef(this,nt,s),i.fillStyle=s.bodyColor,We(this.beforeBody,$),V=c&&nt!=="right"?d==="center"?S/2+C:S+2+C:0,at=0,xt=l.length;at<xt;++at){for(H=l[at],Y=this.labelTextColors[at],i.fillStyle=Y,We(H.before,$),K=H.lines,c&&K.length&&(this._drawColorBox(i,e,at,W,s),A=Math.max(P.lineHeight,b)),mt=0,Tt=K.length;mt<Tt;++mt)$(K[mt]),A=P.lineHeight;We(H.after,$)}V=0,A=P.lineHeight,We(this.afterBody,$),e.y-=h}drawFooter(e,i,s){const l=this.footer,h=l.length;let d,c;if(h){const b=eu(s.rtl,this.x,this.width);for(e.x=Ef(this,s.footerAlign,s),e.y+=s.footerMarginTop,i.textAlign=b.textAlign(s.footerAlign),i.textBaseline="middle",d=Pr(s.footerFont),i.fillStyle=s.footerColor,i.font=d.string,c=0;c<h;++c)i.fillText(l[c],b.x(e.x),e.y+d.lineHeight/2),e.y+=d.lineHeight+s.footerSpacing}}drawBackground(e,i,s,l){const{xAlign:h,yAlign:d}=this,{x:c,y:b}=e,{width:S,height:C}=s,{topLeft:P,topRight:A,bottomLeft:V,bottomRight:W}=Ll(l.cornerRadius);i.fillStyle=l.backgroundColor,i.strokeStyle=l.borderColor,i.lineWidth=l.borderWidth,i.beginPath(),i.moveTo(c+P,b),d==="top"&&this.drawCaret(e,i,s,l),i.lineTo(c+S-A,b),i.quadraticCurveTo(c+S,b,c+S,b+A),d==="center"&&h==="right"&&this.drawCaret(e,i,s,l),i.lineTo(c+S,b+C-W),i.quadraticCurveTo(c+S,b+C,c+S-W,b+C),d==="bottom"&&this.drawCaret(e,i,s,l),i.lineTo(c+V,b+C),i.quadraticCurveTo(c,b+C,c,b+C-V),d==="center"&&h==="left"&&this.drawCaret(e,i,s,l),i.lineTo(c,b+P),i.quadraticCurveTo(c,b,c+P,b),i.closePath(),i.fill(),l.borderWidth>0&&i.stroke()}_updateAnimationTarget(e){const i=this.chart,s=this.$animations,l=s&&s.x,h=s&&s.y;if(l||h){const d=ad[e.position].call(this,this._active,this._eventPosition);if(!d)return;const c=this._size=jw(this,e),b=Object.assign({},d,this._size),S=Uw(i,e,b),C=Hw(e,b,S,i);(l._to!==C.x||h._to!==C.y)&&(this.xAlign=S.xAlign,this.yAlign=S.yAlign,this.width=c.width,this.height=c.height,this.caretX=d.x,this.caretY=d.y,this._resolveAnimations().update(this,C))}}_willRender(){return!!this.opacity}draw(e){const i=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(i);const l={width:this.width,height:this.height},h={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const d=gn(i.padding),c=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;i.enabled&&c&&(e.save(),e.globalAlpha=s,this.drawBackground(h,e,l,i),c9(e,i.textDirection),h.y+=d.top,this.drawTitle(h,e,i),this.drawBody(h,e,i),this.drawFooter(h,e,i),u9(e,i.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,i){const s=this._active,l=e.map(({datasetIndex:c,index:b})=>{const S=this.chart.getDatasetMeta(c);if(!S)throw new Error("Cannot find a dataset at index "+c);return{datasetIndex:c,element:S.data[b],index:b}}),h=!Mm(s,l),d=this._positionChanged(l,i);(h||d)&&(this._active=l,this._eventPosition=i,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,i,s=!0){if(i&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const l=this.options,h=this._active||[],d=this._getActiveElements(e,h,i,s),c=this._positionChanged(d,e),b=i||!Mm(d,h)||c;return b&&(this._active=d,(l.enabled||l.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,i))),b}_getActiveElements(e,i,s,l){const h=this.options;if(e.type==="mouseout")return[];if(!l)return i.filter(c=>this.chart.data.datasets[c.datasetIndex]&&this.chart.getDatasetMeta(c.datasetIndex).controller.getParsed(c.index)!==void 0);const d=this.chart.getElementsAtEventForMode(e,h.mode,h,s);return h.reverse&&d.reverse(),d}_positionChanged(e,i){const{caretX:s,caretY:l,options:h}=this,d=ad[h.position].call(this,e,i);return d!==!1&&(s!==d.x||l!==d.y)}}se(s_,"positioners",ad);var X6={id:"tooltip",_element:s_,positioners:ad,afterInit(t,e,i){i&&(t.tooltip=new s_({chart:t,options:i}))},beforeUpdate(t,e,i){t.tooltip&&t.tooltip.initialize(i)},reset(t,e,i){t.tooltip&&t.tooltip.initialize(i)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const i={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...i,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",i)}},afterEvent(t,e){if(t.tooltip){const i=e.replay;t.tooltip.handleEvent(e.event,i,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:F9},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},J6=Object.freeze({__proto__:null,Colors:u6,Decimation:f6,Filler:L6,Legend:$6,SubTitle:U6,Title:j6,Tooltip:X6});const Q6=(t,e,i,s)=>(typeof e=="string"?(i=t.push(e)-1,s.unshift({index:i,label:e})):isNaN(e)&&(i=null),i);function tA(t,e,i,s){const l=t.indexOf(e);if(l===-1)return Q6(t,e,i,s);const h=t.lastIndexOf(e);return l!==h?i:l}const eA=(t,e)=>t===null?null:jr(Math.round(t),0,e);function O9(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class o_ extends Zl{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const i=this._addedLabels;if(i.length){const s=this.getLabels();for(const{index:l,label:h}of i)s[l]===h&&s.splice(l,1);this._addedLabels=[]}super.init(e)}parse(e,i){if(oi(e))return null;const s=this.getLabels();return i=isFinite(i)&&s[i]===e?i:tA(s,e,Le(i,e),this._addedLabels),eA(i,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:s,max:l}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),i||(l=this.getLabels().length-1)),this.min=s,this.max=l}buildTicks(){const e=this.min,i=this.max,s=this.options.offset,l=[];let h=this.getLabels();h=e===0&&i===h.length-1?h:h.slice(e,i+1),this._valueRange=Math.max(h.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let d=e;d<=i;d++)l.push({value:d});return l}getLabelForValue(e){return O9.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const i=this.ticks;return e<0||e>i.length-1?null:this.getPixelForValue(i[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}se(o_,"id","category"),se(o_,"defaults",{ticks:{callback:O9}});function iA(t,e){const i=[],{bounds:s,step:l,min:h,max:d,precision:c,count:b,maxTicks:S,maxDigits:C,includeBounds:P}=t,A=l||1,V=S-1,{min:W,max:$}=e,nt=!oi(h),H=!oi(d),Y=!oi(b),K=($-W)/(C+1);let at=jb(($-W)/V/A)*A,mt,xt,Tt,Mt;if(at<1e-14&&!nt&&!H)return[{value:W},{value:$}];Mt=Math.ceil($/at)-Math.floor(W/at),Mt>V&&(at=jb(Mt*at/V/A)*A),oi(c)||(mt=Math.pow(10,c),at=Math.ceil(at*mt)/mt),s==="ticks"?(xt=Math.floor(W/at)*at,Tt=Math.ceil($/at)*at):(xt=W,Tt=$),nt&&H&&l&&KC((d-h)/l,at/1e3)?(Mt=Math.round(Math.min((d-h)/at,S)),at=(d-h)/Mt,xt=h,Tt=d):Y?(xt=nt?h:xt,Tt=H?d:Tt,Mt=b-1,at=(Tt-xt)/Mt):(Mt=(Tt-xt)/at,rd(Mt,Math.round(Mt),at/1e3)?Mt=Math.round(Mt):Mt=Math.ceil(Mt));const $t=Math.max(Ub(at),Ub(xt));mt=Math.pow(10,oi(c)?$t:c),xt=Math.round(xt*mt)/mt,Tt=Math.round(Tt*mt)/mt;let Ft=0;for(nt&&(P&&xt!==h?(i.push({value:h}),xt<h&&Ft++,rd(Math.round((xt+Ft*at)*mt)/mt,h,Gw(h,K,t))&&Ft++):xt<h&&Ft++);Ft<Mt;++Ft){const Ot=Math.round((xt+Ft*at)*mt)/mt;if(H&&Ot>d)break;i.push({value:Ot})}return H&&P&&Tt!==d?i.length&&rd(i[i.length-1].value,d,Gw(d,K,t))?i[i.length-1].value=d:i.push({value:d}):(!H||Tt===d)&&i.push({value:Tt}),i}function Gw(t,e,{horizontal:i,minRotation:s}){const l=js(s),h=(i?Math.sin(l):Math.cos(l))||.001,d=.75*e*(""+t).length;return Math.min(e/h,d)}class Lm extends Zl{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,i){return oi(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:i,maxDefined:s}=this.getUserBounds();let{min:l,max:h}=this;const d=b=>l=i?l:b,c=b=>h=s?h:b;if(e){const b=Ss(l),S=Ss(h);b<0&&S<0?c(0):b>0&&S>0&&d(0)}if(l===h){let b=h===0?1:Math.abs(h*.05);c(h+b),e||d(l-b)}this.min=l,this.max=h}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:i,stepSize:s}=e,l;return s?(l=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,l>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${l} ticks. Limiting to 1000.`),l=1e3)):(l=this.computeTickLimit(),i=i||11),i&&(l=Math.min(i,l)),l}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,i=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const l={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:i.precision,step:i.stepSize,count:i.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:i.minRotation||0,includeBounds:i.includeBounds!==!1},h=this._range||this,d=iA(l,h);return e.bounds==="ticks"&&qS(d,this,"value"),e.reverse?(d.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),d}configure(){const e=this.ticks;let i=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const l=(s-i)/Math.max(e.length-1,1)/2;i-=l,s+=l}this._startValue=i,this._endValue=s,this._valueRange=s-i}getLabelForValue(e){return Hd(e,this.chart.options.locale,this.options.ticks.format)}}class a_ extends Lm{determineDataLimits(){const{min:e,max:i}=this.getMinMax(!0);this.min=rr(e)?e:0,this.max=rr(i)?i:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),i=e?this.width:this.height,s=js(this.options.ticks.minRotation),l=(e?Math.sin(s):Math.cos(s))||.001,h=this._resolveTickFontOptions(0);return Math.ceil(i/Math.min(40,h.lineHeight/l))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}se(a_,"id","linear"),se(a_,"defaults",{ticks:{callback:Jm.formatters.numeric}});const Ld=t=>Math.floor(Pa(t)),kl=(t,e)=>Math.pow(10,Ld(t)+e);function Ww(t){return t/Math.pow(10,Ld(t))===1}function Yw(t,e,i){const s=Math.pow(10,i),l=Math.floor(t/s);return Math.ceil(e/s)-l}function rA(t,e){const i=e-t;let s=Ld(i);for(;Yw(t,e,s)>10;)s++;for(;Yw(t,e,s)<10;)s--;return Math.min(s,Ld(t))}function nA(t,{min:e,max:i}){e=ns(t.min,e);const s=[],l=Ld(e);let h=rA(e,i),d=h<0?Math.pow(10,Math.abs(h)):1;const c=Math.pow(10,h),b=l>h?Math.pow(10,l):0,S=Math.round((e-b)*d)/d,C=Math.floor((e-b)/c/10)*c*10;let P=Math.floor((S-C)/Math.pow(10,h)),A=ns(t.min,Math.round((b+C+P*Math.pow(10,h))*d)/d);for(;A<i;)s.push({value:A,major:Ww(A),significand:P}),P>=10?P=P<15?15:20:P++,P>=20&&(h++,P=2,d=h>=0?1:d),A=Math.round((b+C+P*Math.pow(10,h))*d)/d;const V=ns(t.max,A);return s.push({value:V,major:Ww(V),significand:P}),s}class l_ extends Zl{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,i){const s=Lm.prototype.parse.apply(this,[e,i]);if(s===0){this._zero=!0;return}return rr(s)&&s>0?s:null}determineDataLimits(){const{min:e,max:i}=this.getMinMax(!0);this.min=rr(e)?Math.max(0,e):null,this.max=rr(i)?Math.max(0,i):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!rr(this._userMin)&&(this.min=e===kl(this.min,0)?kl(this.min,-1):kl(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:i}=this.getUserBounds();let s=this.min,l=this.max;const h=c=>s=e?s:c,d=c=>l=i?l:c;s===l&&(s<=0?(h(1),d(10)):(h(kl(s,-1)),d(kl(l,1)))),s<=0&&h(kl(l,-1)),l<=0&&d(kl(s,1)),this.min=s,this.max=l}buildTicks(){const e=this.options,i={min:this._userMin,max:this._userMax},s=nA(i,this);return e.bounds==="ticks"&&qS(s,this,"value"),e.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(e){return e===void 0?"0":Hd(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=Pa(e),this._valueRange=Pa(this.max)-Pa(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Pa(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const i=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+i*this._valueRange)}}se(l_,"id","logarithmic"),se(l_,"defaults",{ticks:{callback:Jm.formatters.logarithmic,major:{enabled:!0}}});function c_(t){const e=t.ticks;if(e.display&&t.display){const i=gn(e.backdropPadding);return Le(e.font&&e.font.size,nr.font.size)+i.height}return 0}function sA(t,e,i){return i=Zi(i)?i:[i],{w:pE(t,e.string,i),h:i.length*e.lineHeight}}function Kw(t,e,i,s,l){return t===s||t===l?{start:e-i/2,end:e+i/2}:t<s||t>l?{start:e-i,end:e}:{start:e,end:e+i}}function oA(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},i=Object.assign({},e),s=[],l=[],h=t._pointLabels.length,d=t.options.pointLabels,c=d.centerPointLabels?Oi/h:0;for(let b=0;b<h;b++){const S=d.setContext(t.getPointLabelContext(b));l[b]=S.padding;const C=t.getPointPosition(b,t.drawingArea+l[b],c),P=Pr(S.font),A=sA(t.ctx,P,t._pointLabels[b]);s[b]=A;const V=os(t.getIndexAngle(b)+c),W=Math.round(_v(V)),$=Kw(W,C.x,A.w,0,180),nt=Kw(W,C.y,A.h,90,270);aA(i,e,V,$,nt)}t.setCenterPoint(e.l-i.l,i.r-e.r,e.t-i.t,i.b-e.b),t._pointLabelItems=uA(t,s,l)}function aA(t,e,i,s,l){const h=Math.abs(Math.sin(i)),d=Math.abs(Math.cos(i));let c=0,b=0;s.start<e.l?(c=(e.l-s.start)/h,t.l=Math.min(t.l,e.l-c)):s.end>e.r&&(c=(s.end-e.r)/h,t.r=Math.max(t.r,e.r+c)),l.start<e.t?(b=(e.t-l.start)/d,t.t=Math.min(t.t,e.t-b)):l.end>e.b&&(b=(l.end-e.b)/d,t.b=Math.max(t.b,e.b+b))}function lA(t,e,i){const s=t.drawingArea,{extra:l,additionalAngle:h,padding:d,size:c}=i,b=t.getPointPosition(e,s+l+d,h),S=Math.round(_v(os(b.angle+hr))),C=pA(b.y,c.h,S),P=hA(S),A=dA(b.x,c.w,P);return{visible:!0,x:b.x,y:C,textAlign:P,left:A,top:C,right:A+c.w,bottom:C+c.h}}function cA(t,e){if(!e)return!0;const{left:i,top:s,right:l,bottom:h}=t;return!(qo({x:i,y:s},e)||qo({x:i,y:h},e)||qo({x:l,y:s},e)||qo({x:l,y:h},e))}function uA(t,e,i){const s=[],l=t._pointLabels.length,h=t.options,{centerPointLabels:d,display:c}=h.pointLabels,b={extra:c_(h)/2,additionalAngle:d?Oi/l:0};let S;for(let C=0;C<l;C++){b.padding=i[C],b.size=e[C];const P=lA(t,C,b);s.push(P),c==="auto"&&(P.visible=cA(P,S),P.visible&&(S=P))}return s}function hA(t){return t===0||t===180?"center":t<180?"left":"right"}function dA(t,e,i){return i==="right"?t-=e:i==="center"&&(t-=e/2),t}function pA(t,e,i){return i===90||i===270?t-=e/2:(i>270||i<90)&&(t-=e),t}function fA(t,e,i){const{left:s,top:l,right:h,bottom:d}=i,{backdropColor:c}=e;if(!oi(c)){const b=Ll(e.borderRadius),S=gn(e.backdropPadding);t.fillStyle=c;const C=s-S.left,P=l-S.top,A=h-s+S.width,V=d-l+S.height;Object.values(b).some(W=>W!==0)?(t.beginPath(),zd(t,{x:C,y:P,w:A,h:V,radius:b}),t.fill()):t.fillRect(C,P,A,V)}}function mA(t,e){const{ctx:i,options:{pointLabels:s}}=t;for(let l=e-1;l>=0;l--){const h=t._pointLabelItems[l];if(!h.visible)continue;const d=s.setContext(t.getPointLabelContext(l));fA(i,d,h);const c=Pr(d.font),{x:b,y:S,textAlign:C}=h;jl(i,t._pointLabels[l],b,S+c.lineHeight/2,c,{color:d.color,textAlign:C,textBaseline:"middle"})}}function B9(t,e,i,s){const{ctx:l}=t;if(i)l.arc(t.xCenter,t.yCenter,e,0,Fi);else{let h=t.getPointPosition(0,e);l.moveTo(h.x,h.y);for(let d=1;d<s;d++)h=t.getPointPosition(d,e),l.lineTo(h.x,h.y)}}function gA(t,e,i,s,l){const h=t.ctx,d=e.circular,{color:c,lineWidth:b}=e;!d&&!s||!c||!b||i<0||(h.save(),h.strokeStyle=c,h.lineWidth=b,h.setLineDash(l.dash),h.lineDashOffset=l.dashOffset,h.beginPath(),B9(t,i,d,s),h.closePath(),h.stroke(),h.restore())}function yA(t,e,i){return Ka(t,{label:i,index:e,type:"pointLabel"})}class Zh extends Lm{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=gn(c_(this.options)/2),i=this.width=this.maxWidth-e.width,s=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+i/2+e.left),this.yCenter=Math.floor(this.top+s/2+e.top),this.drawingArea=Math.floor(Math.min(i,s)/2)}determineDataLimits(){const{min:e,max:i}=this.getMinMax(!1);this.min=rr(e)&&!isNaN(e)?e:0,this.max=rr(i)&&!isNaN(i)?i:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/c_(this.options))}generateTickLabels(e){Lm.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((i,s)=>{const l=Ve(this.options.pointLabels.callback,[i,s],this);return l||l===0?l:""}).filter((i,s)=>this.chart.getDataVisibility(s))}fit(){const e=this.options;e.display&&e.pointLabels.display?oA(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,i,s,l){this.xCenter+=Math.floor((e-i)/2),this.yCenter+=Math.floor((s-l)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,i,s,l))}getIndexAngle(e){const i=Fi/(this._pointLabels.length||1),s=this.options.startAngle||0;return os(e*i+js(s))}getDistanceFromCenterForValue(e){if(oi(e))return NaN;const i=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*i:(e-this.min)*i}getValueForDistanceFromCenter(e){if(oi(e))return NaN;const i=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-i:this.min+i}getPointLabelContext(e){const i=this._pointLabels||[];if(e>=0&&e<i.length){const s=i[e];return yA(this.getContext(),e,s)}}getPointPosition(e,i,s=0){const l=this.getIndexAngle(e)-hr+s;return{x:Math.cos(l)*i+this.xCenter,y:Math.sin(l)*i+this.yCenter,angle:l}}getPointPositionForValue(e,i){return this.getPointPosition(e,this.getDistanceFromCenterForValue(i))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:i,top:s,right:l,bottom:h}=this._pointLabelItems[e];return{left:i,top:s,right:l,bottom:h}}drawBackground(){const{backgroundColor:e,grid:{circular:i}}=this.options;if(e){const s=this.ctx;s.save(),s.beginPath(),B9(this,this.getDistanceFromCenterForValue(this._endValue),i,this._pointLabels.length),s.closePath(),s.fillStyle=e,s.fill(),s.restore()}}drawGrid(){const e=this.ctx,i=this.options,{angleLines:s,grid:l,border:h}=i,d=this._pointLabels.length;let c,b,S;if(i.pointLabels.display&&mA(this,d),l.display&&this.ticks.forEach((C,P)=>{if(P!==0||P===0&&this.min<0){b=this.getDistanceFromCenterForValue(C.value);const A=this.getContext(P),V=l.setContext(A),W=h.setContext(A);gA(this,V,b,d,W)}}),s.display){for(e.save(),c=d-1;c>=0;c--){const C=s.setContext(this.getPointLabelContext(c)),{color:P,lineWidth:A}=C;!A||!P||(e.lineWidth=A,e.strokeStyle=P,e.setLineDash(C.borderDash),e.lineDashOffset=C.borderDashOffset,b=this.getDistanceFromCenterForValue(i.reverse?this.min:this.max),S=this.getPointPosition(c,b),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(S.x,S.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,i=this.options,s=i.ticks;if(!s.display)return;const l=this.getIndexAngle(0);let h,d;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(l),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((c,b)=>{if(b===0&&this.min>=0&&!i.reverse)return;const S=s.setContext(this.getContext(b)),C=Pr(S.font);if(h=this.getDistanceFromCenterForValue(this.ticks[b].value),S.showLabelBackdrop){e.font=C.string,d=e.measureText(c.label).width,e.fillStyle=S.backdropColor;const P=gn(S.backdropPadding);e.fillRect(-d/2-P.left,-h-C.size/2-P.top,d+P.width,C.size+P.height)}jl(e,c.label,0,-h,C,{color:S.color,strokeColor:S.textStrokeColor,strokeWidth:S.textStrokeWidth})}),e.restore()}drawTitle(){}}se(Zh,"id","radialLinear"),se(Zh,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Jm.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),se(Zh,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),se(Zh,"descriptors",{angleLines:{_fallback:"grid"}});const ig={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},On=Object.keys(ig);function Xw(t,e){return t-e}function Jw(t,e){if(oi(e))return null;const i=t._adapter,{parser:s,round:l,isoWeekday:h}=t._parseOpts;let d=e;return typeof s=="function"&&(d=s(d)),rr(d)||(d=typeof s=="string"?i.parse(d,s):i.parse(d)),d===null?null:(l&&(d=l==="week"&&(cu(h)||h===!0)?i.startOf(d,"isoWeek",h):i.startOf(d,l)),+d)}function Qw(t,e,i,s){const l=On.length;for(let h=On.indexOf(t);h<l-1;++h){const d=ig[On[h]],c=d.steps?d.steps:Number.MAX_SAFE_INTEGER;if(d.common&&Math.ceil((i-e)/(c*d.size))<=s)return On[h]}return On[l-1]}function _A(t,e,i,s,l){for(let h=On.length-1;h>=On.indexOf(i);h--){const d=On[h];if(ig[d].common&&t._adapter.diff(l,s,d)>=e-1)return d}return On[i?On.indexOf(i):0]}function vA(t){for(let e=On.indexOf(t)+1,i=On.length;e<i;++e)if(ig[On[e]].common)return On[e]}function t2(t,e,i){if(!i)t[e]=!0;else if(i.length){const{lo:s,hi:l}=vv(i,e),h=i[s]>=e?i[s]:i[l];t[h]=!0}}function xA(t,e,i,s){const l=t._adapter,h=+l.startOf(e[0].value,s),d=e[e.length-1].value;let c,b;for(c=h;c<=d;c=+l.add(c,1,s))b=i[c],b>=0&&(e[b].major=!0);return e}function e2(t,e,i){const s=[],l={},h=e.length;let d,c;for(d=0;d<h;++d)c=e[d],l[c]=d,s.push({value:c,major:!1});return h===0||!i?s:xA(t,s,l,i)}class Rd extends Zl{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,i={}){const s=e.time||(e.time={}),l=this._adapter=new PP._date(e.adapters.date);l.init(i),id(s.displayFormats,l.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=i.normalized}parse(e,i){return e===void 0?null:Jw(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,i=this._adapter,s=e.time.unit||"day";let{min:l,max:h,minDefined:d,maxDefined:c}=this.getUserBounds();function b(S){!d&&!isNaN(S.min)&&(l=Math.min(l,S.min)),!c&&!isNaN(S.max)&&(h=Math.max(h,S.max))}(!d||!c)&&(b(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&b(this.getMinMax(!1))),l=rr(l)&&!isNaN(l)?l:+i.startOf(Date.now(),s),h=rr(h)&&!isNaN(h)?h:+i.endOf(Date.now(),s)+1,this.min=Math.min(l,h-1),this.max=Math.max(l+1,h)}_getLabelBounds(){const e=this.getLabelTimestamps();let i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(i=e[0],s=e[e.length-1]),{min:i,max:s}}buildTicks(){const e=this.options,i=e.time,s=e.ticks,l=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&l.length&&(this.min=this._userMin||l[0],this.max=this._userMax||l[l.length-1]);const h=this.min,d=this.max,c=tE(l,h,d);return this._unit=i.unit||(s.autoSkip?Qw(i.minUnit,this.min,this.max,this._getLabelCapacity(h)):_A(this,c.length,i.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:vA(this._unit),this.initOffsets(l),e.reverse&&c.reverse(),e2(this,c,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let i=0,s=0,l,h;this.options.offset&&e.length&&(l=this.getDecimalForValue(e[0]),e.length===1?i=1-l:i=(this.getDecimalForValue(e[1])-l)/2,h=this.getDecimalForValue(e[e.length-1]),e.length===1?s=h:s=(h-this.getDecimalForValue(e[e.length-2]))/2);const d=e.length<3?.5:.25;i=jr(i,0,d),s=jr(s,0,d),this._offsets={start:i,end:s,factor:1/(i+1+s)}}_generate(){const e=this._adapter,i=this.min,s=this.max,l=this.options,h=l.time,d=h.unit||Qw(h.minUnit,i,s,this._getLabelCapacity(i)),c=Le(l.ticks.stepSize,1),b=d==="week"?h.isoWeekday:!1,S=cu(b)||b===!0,C={};let P=i,A,V;if(S&&(P=+e.startOf(P,"isoWeek",b)),P=+e.startOf(P,S?"day":d),e.diff(s,i,d)>1e5*c)throw new Error(i+" and "+s+" are too far apart with stepSize of "+c+" "+d);const W=l.ticks.source==="data"&&this.getDataTimestamps();for(A=P,V=0;A<s;A=+e.add(A,c,d),V++)t2(C,A,W);return(A===s||l.bounds==="ticks"||V===1)&&t2(C,A,W),Object.keys(C).sort(Xw).map($=>+$)}getLabelForValue(e){const i=this._adapter,s=this.options.time;return s.tooltipFormat?i.format(e,s.tooltipFormat):i.format(e,s.displayFormats.datetime)}format(e,i){const s=this.options.time.displayFormats,l=this._unit,h=i||s[l];return this._adapter.format(e,h)}_tickFormatFunction(e,i,s,l){const h=this.options,d=h.ticks.callback;if(d)return Ve(d,[e,i,s],this);const c=h.time.displayFormats,b=this._unit,S=this._majorUnit,C=b&&c[b],P=S&&c[S],A=s[i],V=S&&P&&A&&A.major;return this._adapter.format(e,l||(V?P:C))}generateTickLabels(e){let i,s,l;for(i=0,s=e.length;i<s;++i)l=e[i],l.label=this._tickFormatFunction(l.value,i,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const i=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((i.start+s)*i.factor)}getValueForPixel(e){const i=this._offsets,s=this.getDecimalForPixel(e)/i.factor-i.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const i=this.options.ticks,s=this.ctx.measureText(e).width,l=js(this.isHorizontal()?i.maxRotation:i.minRotation),h=Math.cos(l),d=Math.sin(l),c=this._resolveTickFontOptions(0).size;return{w:s*h+c*d,h:s*d+c*h}}_getLabelCapacity(e){const i=this.options.time,s=i.displayFormats,l=s[i.unit]||s.millisecond,h=this._tickFormatFunction(e,0,e2(this,[e],this._majorUnit),l),d=this._getLabelSize(h),c=Math.floor(this.isHorizontal()?this.width/d.w:this.height/d.h)-1;return c>0?c:1}getDataTimestamps(){let e=this._cache.data||[],i,s;if(e.length)return e;const l=this.getMatchingVisibleMetas();if(this._normalized&&l.length)return this._cache.data=l[0].controller.getAllParsedValues(this);for(i=0,s=l.length;i<s;++i)e=e.concat(l[i].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let i,s;if(e.length)return e;const l=this.getLabels();for(i=0,s=l.length;i<s;++i)e.push(Jw(this,l[i]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return YS(e.sort(Xw))}}se(Rd,"id","time"),se(Rd,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Pf(t,e,i){let s=0,l=t.length-1,h,d,c,b;i?(e>=t[s].pos&&e<=t[l].pos&&({lo:s,hi:l}=Zo(t,"pos",e)),{pos:h,time:c}=t[s],{pos:d,time:b}=t[l]):(e>=t[s].time&&e<=t[l].time&&({lo:s,hi:l}=Zo(t,"time",e)),{time:h,pos:c}=t[s],{time:d,pos:b}=t[l]);const S=d-h;return S?c+(b-c)*(e-h)/S:c}class u_ extends Rd{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),i=this._table=this.buildLookupTable(e);this._minPos=Pf(i,this.min),this._tableRange=Pf(i,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:i,max:s}=this,l=[],h=[];let d,c,b,S,C;for(d=0,c=e.length;d<c;++d)S=e[d],S>=i&&S<=s&&l.push(S);if(l.length<2)return[{time:i,pos:0},{time:s,pos:1}];for(d=0,c=l.length;d<c;++d)C=l[d+1],b=l[d-1],S=l[d],Math.round((C+b)/2)!==S&&h.push({time:S,pos:d/(c-1)});return h}_generate(){const e=this.min,i=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(i)||s.length===1)&&s.push(i),s.sort((l,h)=>l-h)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const i=this.getDataTimestamps(),s=this.getLabelTimestamps();return i.length&&s.length?e=this.normalize(i.concat(s)):e=i.length?i:s,e=this._cache.all=e,e}getDecimalForValue(e){return(Pf(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const i=this._offsets,s=this.getDecimalForPixel(e)/i.factor-i.end;return Pf(this._table,s*this._tableRange+this._minPos,!0)}}se(u_,"id","timeseries"),se(u_,"defaults",Rd.defaults);var bA=Object.freeze({__proto__:null,CategoryScale:o_,LinearScale:a_,LogarithmicScale:l_,RadialLinearScale:Zh,TimeScale:Rd,TimeSeriesScale:u_});const wA=[EP,n6,J6,bA];var V9={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,i,s,l){var h=["","webkit","Moz","MS","ms","o"],d=i.createElement("div"),c="function",b=Math.round,S=Math.abs,C=Date.now;function P(U,Q,ft){return setTimeout(K(U,ft),Q)}function A(U,Q,ft){return Array.isArray(U)?(V(U,ft[Q],ft),!0):!1}function V(U,Q,ft){var Pt;if(U)if(U.forEach)U.forEach(Q,ft);else if(U.length!==l)for(Pt=0;Pt<U.length;)Q.call(ft,U[Pt],Pt,U),Pt++;else for(Pt in U)U.hasOwnProperty(Pt)&&Q.call(ft,U[Pt],Pt,U)}function W(U,Q,ft){var Pt="DEPRECATED METHOD: "+Q+`
`+ft+` AT 
`;return function(){var Nt=new Error("get-stack-trace"),xe=Nt&&Nt.stack?Nt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",He=e.console&&(e.console.warn||e.console.log);return He&&He.call(e.console,Pt,xe),U.apply(this,arguments)}}var $;typeof Object.assign!="function"?$=function(U){if(U===l||U===null)throw new TypeError("Cannot convert undefined or null to object");for(var Q=Object(U),ft=1;ft<arguments.length;ft++){var Pt=arguments[ft];if(Pt!==l&&Pt!==null)for(var Nt in Pt)Pt.hasOwnProperty(Nt)&&(Q[Nt]=Pt[Nt])}return Q}:$=Object.assign;var nt=W(function(U,Q,ft){for(var Pt=Object.keys(Q),Nt=0;Nt<Pt.length;)(!ft||ft&&U[Pt[Nt]]===l)&&(U[Pt[Nt]]=Q[Pt[Nt]]),Nt++;return U},"extend","Use `assign`."),H=W(function(U,Q){return nt(U,Q,!0)},"merge","Use `assign`.");function Y(U,Q,ft){var Pt=Q.prototype,Nt;Nt=U.prototype=Object.create(Pt),Nt.constructor=U,Nt._super=Pt,ft&&$(Nt,ft)}function K(U,Q){return function(){return U.apply(Q,arguments)}}function at(U,Q){return typeof U==c?U.apply(Q&&Q[0]||l,Q):U}function mt(U,Q){return U===l?Q:U}function xt(U,Q,ft){V(Ft(Q),function(Pt){U.addEventListener(Pt,ft,!1)})}function Tt(U,Q,ft){V(Ft(Q),function(Pt){U.removeEventListener(Pt,ft,!1)})}function Mt(U,Q){for(;U;){if(U==Q)return!0;U=U.parentNode}return!1}function $t(U,Q){return U.indexOf(Q)>-1}function Ft(U){return U.trim().split(/\s+/g)}function Ot(U,Q,ft){if(U.indexOf&&!ft)return U.indexOf(Q);for(var Pt=0;Pt<U.length;){if(ft&&U[Pt][ft]==Q||!ft&&U[Pt]===Q)return Pt;Pt++}return-1}function ge(U){return Array.prototype.slice.call(U,0)}function _e(U,Q,ft){for(var Pt=[],Nt=[],xe=0;xe<U.length;){var He=U[xe][Q];Ot(Nt,He)<0&&Pt.push(U[xe]),Nt[xe]=He,xe++}return Pt=Pt.sort(function(ki,Gr){return ki[Q]>Gr[Q]}),Pt}function Ae(U,Q){for(var ft,Pt,Nt=Q[0].toUpperCase()+Q.slice(1),xe=0;xe<h.length;){if(ft=h[xe],Pt=ft?ft+Nt:Q,Pt in U)return Pt;xe++}return l}var ve=1;function Ee(){return ve++}function $e(U){var Q=U.ownerDocument||U;return Q.defaultView||Q.parentWindow||e}var Vt=/mobile|tablet|ip(ad|hone|od)|android/i,re="ontouchstart"in e,Kt=Ae(e,"PointerEvent")!==l,we=re&&Vt.test(navigator.userAgent),Se="touch",ai="pen",Qe="mouse",fi="kinect",ni=25,Ue=1,Mi=2,Ze=4,ti=8,_r=1,sr=2,vr=4,ci=8,Hr=16,Et=sr|vr,Bi=ci|Hr,nn=Et|Bi,Ke=["x","y"],li=["clientX","clientY"];function Vi(U,Q){var ft=this;this.manager=U,this.callback=Q,this.element=U.element,this.target=U.options.inputTarget,this.domHandler=function(Pt){at(U.options.enable,[U])&&ft.handler(Pt)},this.init()}Vi.prototype={handler:function(){},init:function(){this.evEl&&xt(this.element,this.evEl,this.domHandler),this.evTarget&&xt(this.target,this.evTarget,this.domHandler),this.evWin&&xt($e(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Tt(this.element,this.evEl,this.domHandler),this.evTarget&&Tt(this.target,this.evTarget,this.domHandler),this.evWin&&Tt($e(this.element),this.evWin,this.domHandler)}};function Ws(U){var Q,ft=U.options.inputClass;return ft?Q=ft:Kt?Q=B:we?Q=St:re?Q=de:Q=Me,new Q(U,vo)}function vo(U,Q,ft){var Pt=ft.pointers.length,Nt=ft.changedPointers.length,xe=Q&Ue&&Pt-Nt===0,He=Q&(Ze|ti)&&Pt-Nt===0;ft.isFirst=!!xe,ft.isFinal=!!He,xe&&(U.session={}),ft.eventType=Q,Ys(U,ft),U.emit("hammer.input",ft),U.recognize(ft),U.session.prevInput=ft}function Ys(U,Q){var ft=U.session,Pt=Q.pointers,Nt=Pt.length;ft.firstInput||(ft.firstInput=xo(Q)),Nt>1&&!ft.firstMultiple?ft.firstMultiple=xo(Q):Nt===1&&(ft.firstMultiple=!1);var xe=ft.firstInput,He=ft.firstMultiple,ki=He?He.center:xe.center,Gr=Q.center=Zt(Pt);Q.timeStamp=C(),Q.deltaTime=Q.timeStamp-xe.timeStamp,Q.angle=Hn(ki,Gr),Q.distance=Un(ki,Gr),jn(ft,Q),Q.offsetDirection=br(Q.deltaX,Q.deltaY);var Ar=xr(Q.deltaTime,Q.deltaX,Q.deltaY);Q.overallVelocityX=Ar.x,Q.overallVelocityY=Ar.y,Q.overallVelocity=S(Ar.x)>S(Ar.y)?Ar.x:Ar.y,Q.scale=He?De(He.pointers,Pt):1,Q.rotation=He?Ht(He.pointers,Pt):0,Q.maxPointers=ft.prevInput?Q.pointers.length>ft.prevInput.maxPointers?Q.pointers.length:ft.prevInput.maxPointers:Q.pointers.length,Ks(ft,Q);var fr=U.element;Mt(Q.srcEvent.target,fr)&&(fr=Q.srcEvent.target),Q.target=fr}function jn(U,Q){var ft=Q.center,Pt=U.offsetDelta||{},Nt=U.prevDelta||{},xe=U.prevInput||{};(Q.eventType===Ue||xe.eventType===Ze)&&(Nt=U.prevDelta={x:xe.deltaX||0,y:xe.deltaY||0},Pt=U.offsetDelta={x:ft.x,y:ft.y}),Q.deltaX=Nt.x+(ft.x-Pt.x),Q.deltaY=Nt.y+(ft.y-Pt.y)}function Ks(U,Q){var ft=U.lastInterval||Q,Pt=Q.timeStamp-ft.timeStamp,Nt,xe,He,ki;if(Q.eventType!=ti&&(Pt>ni||ft.velocity===l)){var Gr=Q.deltaX-ft.deltaX,Ar=Q.deltaY-ft.deltaY,fr=xr(Pt,Gr,Ar);xe=fr.x,He=fr.y,Nt=S(fr.x)>S(fr.y)?fr.x:fr.y,ki=br(Gr,Ar),U.lastInterval=Q}else Nt=ft.velocity,xe=ft.velocityX,He=ft.velocityY,ki=ft.direction;Q.velocity=Nt,Q.velocityX=xe,Q.velocityY=He,Q.direction=ki}function xo(U){for(var Q=[],ft=0;ft<U.pointers.length;)Q[ft]={clientX:b(U.pointers[ft].clientX),clientY:b(U.pointers[ft].clientY)},ft++;return{timeStamp:C(),pointers:Q,center:Zt(Q),deltaX:U.deltaX,deltaY:U.deltaY}}function Zt(U){var Q=U.length;if(Q===1)return{x:b(U[0].clientX),y:b(U[0].clientY)};for(var ft=0,Pt=0,Nt=0;Nt<Q;)ft+=U[Nt].clientX,Pt+=U[Nt].clientY,Nt++;return{x:b(ft/Q),y:b(Pt/Q)}}function xr(U,Q,ft){return{x:Q/U||0,y:ft/U||0}}function br(U,Q){return U===Q?_r:S(U)>=S(Q)?U<0?sr:vr:Q<0?ci:Hr}function Un(U,Q,ft){ft||(ft=Ke);var Pt=Q[ft[0]]-U[ft[0]],Nt=Q[ft[1]]-U[ft[1]];return Math.sqrt(Pt*Pt+Nt*Nt)}function Hn(U,Q,ft){ft||(ft=Ke);var Pt=Q[ft[0]]-U[ft[0]],Nt=Q[ft[1]]-U[ft[1]];return Math.atan2(Nt,Pt)*180/Math.PI}function Ht(U,Q){return Hn(Q[1],Q[0],li)+Hn(U[1],U[0],li)}function De(U,Q){return Un(Q[0],Q[1],li)/Un(U[0],U[1],li)}var Pe={mousedown:Ue,mousemove:Mi,mouseup:Ze},wr="mousedown",Sr="mousemove mouseup";function Me(){this.evEl=wr,this.evWin=Sr,this.pressed=!1,Vi.apply(this,arguments)}Y(Me,Vi,{handler:function(U){var Q=Pe[U.type];Q&Ue&&U.button===0&&(this.pressed=!0),Q&Mi&&U.which!==1&&(Q=Ze),this.pressed&&(Q&Ze&&(this.pressed=!1),this.callback(this.manager,Q,{pointers:[U],changedPointers:[U],pointerType:Qe,srcEvent:U}))}});var Zn={pointerdown:Ue,pointermove:Mi,pointerup:Ze,pointercancel:ti,pointerout:ti},qn={2:Se,3:ai,4:Qe,5:fi},qi="pointerdown",rt="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(qi="MSPointerDown",rt="MSPointerMove MSPointerUp MSPointerCancel");function B(){this.evEl=qi,this.evWin=rt,Vi.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Y(B,Vi,{handler:function(U){var Q=this.store,ft=!1,Pt=U.type.toLowerCase().replace("ms",""),Nt=Zn[Pt],xe=qn[U.pointerType]||U.pointerType,He=xe==Se,ki=Ot(Q,U.pointerId,"pointerId");Nt&Ue&&(U.button===0||He)?ki<0&&(Q.push(U),ki=Q.length-1):Nt&(Ze|ti)&&(ft=!0),!(ki<0)&&(Q[ki]=U,this.callback(this.manager,Nt,{pointers:Q,changedPointers:[U],pointerType:xe,srcEvent:U}),ft&&Q.splice(ki,1))}});var N={touchstart:Ue,touchmove:Mi,touchend:Ze,touchcancel:ti},G="touchstart",st="touchstart touchmove touchend touchcancel";function dt(){this.evTarget=G,this.evWin=st,this.started=!1,Vi.apply(this,arguments)}Y(dt,Vi,{handler:function(U){var Q=N[U.type];if(Q===Ue&&(this.started=!0),!!this.started){var ft=yt.call(this,U,Q);Q&(Ze|ti)&&ft[0].length-ft[1].length===0&&(this.started=!1),this.callback(this.manager,Q,{pointers:ft[0],changedPointers:ft[1],pointerType:Se,srcEvent:U})}}});function yt(U,Q){var ft=ge(U.touches),Pt=ge(U.changedTouches);return Q&(Ze|ti)&&(ft=_e(ft.concat(Pt),"identifier")),[ft,Pt]}var bt={touchstart:Ue,touchmove:Mi,touchend:Ze,touchcancel:ti},ht="touchstart touchmove touchend touchcancel";function St(){this.evTarget=ht,this.targetIds={},Vi.apply(this,arguments)}Y(St,Vi,{handler:function(U){var Q=bt[U.type],ft=Bt.call(this,U,Q);ft&&this.callback(this.manager,Q,{pointers:ft[0],changedPointers:ft[1],pointerType:Se,srcEvent:U})}});function Bt(U,Q){var ft=ge(U.touches),Pt=this.targetIds;if(Q&(Ue|Mi)&&ft.length===1)return Pt[ft[0].identifier]=!0,[ft,ft];var Nt,xe,He=ge(U.changedTouches),ki=[],Gr=this.target;if(xe=ft.filter(function(Ar){return Mt(Ar.target,Gr)}),Q===Ue)for(Nt=0;Nt<xe.length;)Pt[xe[Nt].identifier]=!0,Nt++;for(Nt=0;Nt<He.length;)Pt[He[Nt].identifier]&&ki.push(He[Nt]),Q&(Ze|ti)&&delete Pt[He[Nt].identifier],Nt++;if(ki.length)return[_e(xe.concat(ki),"identifier"),ki]}var At=2500,It=25;function de(){Vi.apply(this,arguments);var U=K(this.handler,this);this.touch=new St(this.manager,U),this.mouse=new Me(this.manager,U),this.primaryTouch=null,this.lastTouches=[]}Y(de,Vi,{handler:function(U,Q,ft){var Pt=ft.pointerType==Se,Nt=ft.pointerType==Qe;if(!(Nt&&ft.sourceCapabilities&&ft.sourceCapabilities.firesTouchEvents)){if(Pt)fe.call(this,Q,ft);else if(Nt&&ke.call(this,ft))return;this.callback(U,Q,ft)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function fe(U,Q){U&Ue?(this.primaryTouch=Q.changedPointers[0].identifier,Fe.call(this,Q)):U&(Ze|ti)&&Fe.call(this,Q)}function Fe(U){var Q=U.changedPointers[0];if(Q.identifier===this.primaryTouch){var ft={x:Q.clientX,y:Q.clientY};this.lastTouches.push(ft);var Pt=this.lastTouches,Nt=function(){var xe=Pt.indexOf(ft);xe>-1&&Pt.splice(xe,1)};setTimeout(Nt,At)}}function ke(U){for(var Q=U.srcEvent.clientX,ft=U.srcEvent.clientY,Pt=0;Pt<this.lastTouches.length;Pt++){var Nt=this.lastTouches[Pt],xe=Math.abs(Q-Nt.x),He=Math.abs(ft-Nt.y);if(xe<=It&&He<=It)return!0}return!1}var Ne=Ae(d.style,"touchAction"),ei=Ne!==l,ui="compute",Ai="auto",Ie="manipulation",ii="none",bi="pan-x",Xi="pan-y",pr=_u();function zi(U,Q){this.manager=U,this.set(Q)}zi.prototype={set:function(U){U==ui&&(U=this.compute()),ei&&this.manager.element.style&&pr[U]&&(this.manager.element.style[Ne]=U),this.actions=U.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var U=[];return V(this.manager.recognizers,function(Q){at(Q.options.enable,[Q])&&(U=U.concat(Q.getTouchAction()))}),Xs(U.join(" "))},preventDefaults:function(U){var Q=U.srcEvent,ft=U.offsetDirection;if(this.manager.session.prevented){Q.preventDefault();return}var Pt=this.actions,Nt=$t(Pt,ii)&&!pr[ii],xe=$t(Pt,Xi)&&!pr[Xi],He=$t(Pt,bi)&&!pr[bi];if(Nt){var ki=U.pointers.length===1,Gr=U.distance<2,Ar=U.deltaTime<250;if(ki&&Gr&&Ar)return}if(!(He&&xe)&&(Nt||xe&&ft&Et||He&&ft&Bi))return this.preventSrc(Q)},preventSrc:function(U){this.manager.session.prevented=!0,U.preventDefault()}};function Xs(U){if($t(U,ii))return ii;var Q=$t(U,bi),ft=$t(U,Xi);return Q&&ft?ii:Q||ft?Q?bi:Xi:$t(U,Ie)?Ie:Ai}function _u(){if(!ei)return!1;var U={},Q=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(ft){U[ft]=Q?e.CSS.supports("touch-action",ft):!0}),U}var qe=1,Ir=2,ds=4,$i=8,Ci=$i,Gn=16,wi=32;function Ni(U){this.options=$({},this.defaults,U||{}),this.id=Ee(),this.manager=null,this.options.enable=mt(this.options.enable,!0),this.state=qe,this.simultaneous={},this.requireFail=[]}Ni.prototype={defaults:{},set:function(U){return $(this.options,U),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(U){if(A(U,"recognizeWith",this))return this;var Q=this.simultaneous;return U=Si(U,this),Q[U.id]||(Q[U.id]=U,U.recognizeWith(this)),this},dropRecognizeWith:function(U){return A(U,"dropRecognizeWith",this)?this:(U=Si(U,this),delete this.simultaneous[U.id],this)},requireFailure:function(U){if(A(U,"requireFailure",this))return this;var Q=this.requireFail;return U=Si(U,this),Ot(Q,U)===-1&&(Q.push(U),U.requireFailure(this)),this},dropRequireFailure:function(U){if(A(U,"dropRequireFailure",this))return this;U=Si(U,this);var Q=Ot(this.requireFail,U);return Q>-1&&this.requireFail.splice(Q,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(U){return!!this.simultaneous[U.id]},emit:function(U){var Q=this,ft=this.state;function Pt(Nt){Q.manager.emit(Nt,U)}ft<$i&&Pt(Q.options.event+Xa(ft)),Pt(Q.options.event),U.additionalEvent&&Pt(U.additionalEvent),ft>=$i&&Pt(Q.options.event+Xa(ft))},tryEmit:function(U){if(this.canEmit())return this.emit(U);this.state=wi},canEmit:function(){for(var U=0;U<this.requireFail.length;){if(!(this.requireFail[U].state&(wi|qe)))return!1;U++}return!0},recognize:function(U){var Q=$({},U);if(!at(this.options.enable,[this,Q])){this.reset(),this.state=wi;return}this.state&(Ci|Gn|wi)&&(this.state=qe),this.state=this.process(Q),this.state&(Ir|ds|$i|Gn)&&this.tryEmit(Q)},process:function(U){},getTouchAction:function(){},reset:function(){}};function Xa(U){return U&Gn?"cancel":U&$i?"end":U&ds?"move":U&Ir?"start":""}function Pn(U){return U==Hr?"down":U==ci?"up":U==sr?"left":U==vr?"right":""}function Si(U,Q){var ft=Q.manager;return ft?ft.get(U):U}function kr(){Ni.apply(this,arguments)}Y(kr,Ni,{defaults:{pointers:1},attrTest:function(U){var Q=this.options.pointers;return Q===0||U.pointers.length===Q},process:function(U){var Q=this.state,ft=U.eventType,Pt=Q&(Ir|ds),Nt=this.attrTest(U);return Pt&&(ft&ti||!Nt)?Q|Gn:Pt||Nt?ft&Ze?Q|$i:Q&Ir?Q|ds:Ir:wi}});function In(){kr.apply(this,arguments),this.pX=null,this.pY=null}Y(In,kr,{defaults:{event:"pan",threshold:10,pointers:1,direction:nn},getTouchAction:function(){var U=this.options.direction,Q=[];return U&Et&&Q.push(Xi),U&Bi&&Q.push(bi),Q},directionTest:function(U){var Q=this.options,ft=!0,Pt=U.distance,Nt=U.direction,xe=U.deltaX,He=U.deltaY;return Nt&Q.direction||(Q.direction&Et?(Nt=xe===0?_r:xe<0?sr:vr,ft=xe!=this.pX,Pt=Math.abs(U.deltaX)):(Nt=He===0?_r:He<0?ci:Hr,ft=He!=this.pY,Pt=Math.abs(U.deltaY))),U.direction=Nt,ft&&Pt>Q.threshold&&Nt&Q.direction},attrTest:function(U){return kr.prototype.attrTest.call(this,U)&&(this.state&Ir||!(this.state&Ir)&&this.directionTest(U))},emit:function(U){this.pX=U.deltaX,this.pY=U.deltaY;var Q=Pn(U.direction);Q&&(U.additionalEvent=this.options.event+Q),this._super.emit.call(this,U)}});function yi(){kr.apply(this,arguments)}Y(yi,kr,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ii]},attrTest:function(U){return this._super.attrTest.call(this,U)&&(Math.abs(U.scale-1)>this.options.threshold||this.state&Ir)},emit:function(U){if(U.scale!==1){var Q=U.scale<1?"in":"out";U.additionalEvent=this.options.event+Q}this._super.emit.call(this,U)}});function Wn(){Ni.apply(this,arguments),this._timer=null,this._input=null}Y(Wn,Ni,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ai]},process:function(U){var Q=this.options,ft=U.pointers.length===Q.pointers,Pt=U.distance<Q.threshold,Nt=U.deltaTime>Q.time;if(this._input=U,!Pt||!ft||U.eventType&(Ze|ti)&&!Nt)this.reset();else if(U.eventType&Ue)this.reset(),this._timer=P(function(){this.state=Ci,this.tryEmit()},Q.time,this);else if(U.eventType&Ze)return Ci;return wi},reset:function(){clearTimeout(this._timer)},emit:function(U){this.state===Ci&&(U&&U.eventType&Ze?this.manager.emit(this.options.event+"up",U):(this._input.timeStamp=C(),this.manager.emit(this.options.event,this._input)))}});function Zr(){kr.apply(this,arguments)}Y(Zr,kr,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ii]},attrTest:function(U){return this._super.attrTest.call(this,U)&&(Math.abs(U.rotation)>this.options.threshold||this.state&Ir)}});function Js(){kr.apply(this,arguments)}Y(Js,kr,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Et|Bi,pointers:1},getTouchAction:function(){return In.prototype.getTouchAction.call(this)},attrTest:function(U){var Q=this.options.direction,ft;return Q&(Et|Bi)?ft=U.overallVelocity:Q&Et?ft=U.overallVelocityX:Q&Bi&&(ft=U.overallVelocityY),this._super.attrTest.call(this,U)&&Q&U.offsetDirection&&U.distance>this.options.threshold&&U.maxPointers==this.options.pointers&&S(ft)>this.options.velocity&&U.eventType&Ze},emit:function(U){var Q=Pn(U.offsetDirection);Q&&this.manager.emit(this.options.event+Q,U),this.manager.emit(this.options.event,U)}});function qr(){Ni.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Y(qr,Ni,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ie]},process:function(U){var Q=this.options,ft=U.pointers.length===Q.pointers,Pt=U.distance<Q.threshold,Nt=U.deltaTime<Q.time;if(this.reset(),U.eventType&Ue&&this.count===0)return this.failTimeout();if(Pt&&Nt&&ft){if(U.eventType!=Ze)return this.failTimeout();var xe=this.pTime?U.timeStamp-this.pTime<Q.interval:!0,He=!this.pCenter||Un(this.pCenter,U.center)<Q.posThreshold;this.pTime=U.timeStamp,this.pCenter=U.center,!He||!xe?this.count=1:this.count+=1,this._input=U;var ki=this.count%Q.taps;if(ki===0)return this.hasRequireFailures()?(this._timer=P(function(){this.state=Ci,this.tryEmit()},Q.interval,this),Ir):Ci}return wi},failTimeout:function(){return this._timer=P(function(){this.state=wi},this.options.interval,this),wi},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ci&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function An(U,Q){return Q=Q||{},Q.recognizers=mt(Q.recognizers,An.defaults.preset),new to(U,Q)}An.VERSION="2.0.7",An.defaults={domEvents:!1,touchAction:ui,enable:!0,inputTarget:null,inputClass:null,preset:[[Zr,{enable:!1}],[yi,{enable:!1},["rotate"]],[Js,{direction:Et}],[In,{direction:Et},["swipe"]],[qr],[qr,{event:"doubletap",taps:2},["tap"]],[Wn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Qs=1,Ge=2;function to(U,Q){this.options=$({},An.defaults,Q||{}),this.options.inputTarget=this.options.inputTarget||U,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=U,this.input=Ws(this),this.touchAction=new zi(this,this.options.touchAction),Ms(this,!0),V(this.options.recognizers,function(ft){var Pt=this.add(new ft[0](ft[1]));ft[2]&&Pt.recognizeWith(ft[2]),ft[3]&&Pt.requireFailure(ft[3])},this)}to.prototype={set:function(U){return $(this.options,U),U.touchAction&&this.touchAction.update(),U.inputTarget&&(this.input.destroy(),this.input.target=U.inputTarget,this.input.init()),this},stop:function(U){this.session.stopped=U?Ge:Qs},recognize:function(U){var Q=this.session;if(!Q.stopped){this.touchAction.preventDefaults(U);var ft,Pt=this.recognizers,Nt=Q.curRecognizer;(!Nt||Nt&&Nt.state&Ci)&&(Nt=Q.curRecognizer=null);for(var xe=0;xe<Pt.length;)ft=Pt[xe],Q.stopped!==Ge&&(!Nt||ft==Nt||ft.canRecognizeWith(Nt))?ft.recognize(U):ft.reset(),!Nt&&ft.state&(Ir|ds|$i)&&(Nt=Q.curRecognizer=ft),xe++}},get:function(U){if(U instanceof Ni)return U;for(var Q=this.recognizers,ft=0;ft<Q.length;ft++)if(Q[ft].options.event==U)return Q[ft];return null},add:function(U){if(A(U,"add",this))return this;var Q=this.get(U.options.event);return Q&&this.remove(Q),this.recognizers.push(U),U.manager=this,this.touchAction.update(),U},remove:function(U){if(A(U,"remove",this))return this;if(U=this.get(U),U){var Q=this.recognizers,ft=Ot(Q,U);ft!==-1&&(Q.splice(ft,1),this.touchAction.update())}return this},on:function(U,Q){if(U!==l&&Q!==l){var ft=this.handlers;return V(Ft(U),function(Pt){ft[Pt]=ft[Pt]||[],ft[Pt].push(Q)}),this}},off:function(U,Q){if(U!==l){var ft=this.handlers;return V(Ft(U),function(Pt){Q?ft[Pt]&&ft[Pt].splice(Ot(ft[Pt],Q),1):delete ft[Pt]}),this}},emit:function(U,Q){this.options.domEvents&&Ja(U,Q);var ft=this.handlers[U]&&this.handlers[U].slice();if(!(!ft||!ft.length)){Q.type=U,Q.preventDefault=function(){Q.srcEvent.preventDefault()};for(var Pt=0;Pt<ft.length;)ft[Pt](Q),Pt++}},destroy:function(){this.element&&Ms(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Ms(U,Q){var ft=U.element;if(ft.style){var Pt;V(U.options.cssProps,function(Nt,xe){Pt=Ae(ft.style,xe),Q?(U.oldCssProps[Pt]=ft.style[Pt],ft.style[Pt]=Nt):ft.style[Pt]=U.oldCssProps[Pt]||""}),Q||(U.oldCssProps={})}}function Ja(U,Q){var ft=i.createEvent("Event");ft.initEvent(U,!0,!0),ft.gesture=Q,Q.target.dispatchEvent(ft)}$(An,{INPUT_START:Ue,INPUT_MOVE:Mi,INPUT_END:Ze,INPUT_CANCEL:ti,STATE_POSSIBLE:qe,STATE_BEGAN:Ir,STATE_CHANGED:ds,STATE_ENDED:$i,STATE_RECOGNIZED:Ci,STATE_CANCELLED:Gn,STATE_FAILED:wi,DIRECTION_NONE:_r,DIRECTION_LEFT:sr,DIRECTION_RIGHT:vr,DIRECTION_UP:ci,DIRECTION_DOWN:Hr,DIRECTION_HORIZONTAL:Et,DIRECTION_VERTICAL:Bi,DIRECTION_ALL:nn,Manager:to,Input:Vi,TouchAction:zi,TouchInput:St,MouseInput:Me,PointerEventInput:B,TouchMouseInput:de,SingleTouchInput:dt,Recognizer:Ni,AttrRecognizer:kr,Tap:qr,Pan:In,Swipe:Js,Pinch:yi,Rotate:Zr,Press:Wn,on:xt,off:Tt,each:V,merge:H,extend:nt,assign:$,inherit:Y,bindFn:K,prefixed:Ae});var Qo=typeof e<"u"?e:typeof self<"u"?self:{};Qo.Hammer=An,t.exports?t.exports=An:e[s]=An})(window,document,"Hammer")})(V9);var SA=V9.exports;const ld=kS(SA);/*!
* chartjs-plugin-zoom v2.0.1
* undefined
 * (c) 2016-2023 chartjs-plugin-zoom Contributors
 * Released under the MIT License
 */const Fd=t=>t&&t.enabled&&t.modifierKey,$9=(t,e)=>t&&e[t+"Key"],Av=(t,e)=>t&&!e[t+"Key"];function qa(t,e,i){return t===void 0?!0:typeof t=="string"?t.indexOf(e)!==-1:typeof t=="function"?t({chart:i}).indexOf(e)!==-1:!1}function J0(t,e){return typeof t=="function"&&(t=t({chart:e})),typeof t=="string"?{x:t.indexOf("x")!==-1,y:t.indexOf("y")!==-1}:{x:!1,y:!1}}function kA(t,e){let i;return function(){return clearTimeout(i),i=setTimeout(t,e),e}}function TA({x:t,y:e},i){const s=i.scales,l=Object.keys(s);for(let h=0;h<l.length;h++){const d=s[l[h]];if(e>=d.top&&e<=d.bottom&&t>=d.left&&t<=d.right)return d}return null}function N9(t,e,i){const{mode:s="xy",scaleMode:l,overScaleMode:h}=t||{},d=TA(e,i),c=J0(s,i),b=J0(l,i);if(h){const C=J0(h,i);for(const P of["x","y"])C[P]&&(b[P]=c[P],c[P]=!1)}if(d&&b[d.axis])return[d];const S=[];return We(i.scales,function(C){c[C.axis]&&S.push(C)}),S}const h_=new WeakMap;function dr(t){let e=h_.get(t);return e||(e={originalScaleLimits:{},updatedScaleLimits:{},handlers:{},panDelta:{}},h_.set(t,e)),e}function MA(t){h_.delete(t)}function j9(t,e,i){const s=t.max-t.min,l=s*(e-1),h=t.isHorizontal()?i.x:i.y,d=Math.max(0,Math.min(1,(t.getValueForPixel(h)-t.min)/s||0)),c=1-d;return{min:l*d,max:l*c}}function i2(t,e,i,s,l){let h=i[s];if(h==="original"){const d=t.originalScaleLimits[e.id][s];h=Le(d.options,d.scale)}return Le(h,l)}function CA(t,e,i){const s=t.getValueForPixel(e),l=t.getValueForPixel(i);return{min:Math.min(s,l),max:Math.max(s,l)}}function gu(t,{min:e,max:i},s,l=!1){const h=dr(t.chart),{id:d,axis:c,options:b}=t,S=s&&(s[d]||s[c])||{},{minRange:C=0}=S,P=i2(h,t,S,"min",-1/0),A=i2(h,t,S,"max",1/0),V=l?Math.max(i-e,C):t.max-t.min,W=(V-i+e)/2;return e-=W,i+=W,e<P?(e=P,i=Math.min(P+V,A)):i>A&&(i=A,e=Math.max(A-V,P)),b.min=e,b.max=i,h.updatedScaleLimits[t.id]={min:e,max:i},t.parse(e)!==t.min||t.parse(i)!==t.max}function EA(t,e,i,s){const l=j9(t,e,i),h={min:t.min+l.min,max:t.max-l.max};return gu(t,h,s,!0)}function PA(t,e,i,s){gu(t,CA(t,e,i),s,!0)}const r2=t=>t===0||isNaN(t)?0:t<0?Math.min(Math.round(t),-1):Math.max(Math.round(t),1);function IA(t){const e=t.getLabels().length-1;t.min>0&&(t.min-=1),t.max<e&&(t.max+=1)}function AA(t,e,i,s){const l=j9(t,e,i);t.min===t.max&&e<1&&IA(t);const h={min:t.min+r2(l.min),max:t.max-r2(l.max)};return gu(t,h,s,!0)}function zA(t){return t.isHorizontal()?t.width:t.height}function DA(t,e,i){const s=t.getLabels().length-1;let{min:l,max:h}=t;const d=Math.max(h-l,1),c=Math.round(zA(t)/Math.max(d,10)),b=Math.round(Math.abs(e/c));let S;return e<-c?(h=Math.min(h+b,s),l=d===1?h:h-d,S=h===s):e>c&&(l=Math.max(0,l-b),h=d===1?l:l+d,S=l===0),gu(t,{min:l,max:h},i)||S}const LA={second:500,minute:30*1e3,hour:30*60*1e3,day:12*60*60*1e3,week:3.5*24*60*60*1e3,month:15*24*60*60*1e3,quarter:60*24*60*60*1e3,year:182*24*60*60*1e3};function U9(t,e,i,s=!1){const{min:l,max:h,options:d}=t,c=d.time&&d.time.round,b=LA[c]||0,S=t.getValueForPixel(t.getPixelForValue(l+b)-e),C=t.getValueForPixel(t.getPixelForValue(h+b)-e),{min:P=-1/0,max:A=1/0}=s&&i&&i[t.axis]||{};return isNaN(S)||isNaN(C)||S<P||C>A?!0:gu(t,{min:S,max:C},i,s)}function n2(t,e,i){return U9(t,e,i,!0)}const d_={category:AA,default:EA},p_={default:PA},f_={category:DA,default:U9,logarithmic:n2,timeseries:n2};function RA(t,e,i){const{id:s,options:{min:l,max:h}}=t;if(!e[s]||!i[s])return!0;const d=i[s];return d.min!==l||d.max!==h}function s2(t,e){We(t,(i,s)=>{e[s]||delete t[s]})}function yu(t,e){const{scales:i}=t,{originalScaleLimits:s,updatedScaleLimits:l}=e;return We(i,function(h){RA(h,s,l)&&(s[h.id]={min:{scale:h.min,options:h.options.min},max:{scale:h.max,options:h.options.max}})}),s2(s,i),s2(l,i),s}function o2(t,e,i,s){const l=d_[t.type]||d_.default;Ve(l,[t,e,i,s])}function a2(t,e,i,s,l){const h=p_[t.type]||p_.default;Ve(h,[t,e,i,s,l])}function FA(t){const e=t.chartArea;return{x:(e.left+e.right)/2,y:(e.top+e.bottom)/2}}function zv(t,e,i="none"){const{x:s=1,y:l=1,focalPoint:h=FA(t)}=typeof e=="number"?{x:e,y:e}:e,d=dr(t),{options:{limits:c,zoom:b}}=d;yu(t,d);const S=s!==1,C=l!==1,P=N9(b,h,t);We(P||t.scales,function(A){A.isHorizontal()&&S?o2(A,s,h,c):!A.isHorizontal()&&C&&o2(A,l,h,c)}),t.update(i),Ve(b.onZoom,[{chart:t}])}function H9(t,e,i,s="none"){const l=dr(t),{options:{limits:h,zoom:d}}=l,{mode:c="xy"}=d;yu(t,l);const b=qa(c,"x",t),S=qa(c,"y",t);We(t.scales,function(C){C.isHorizontal()&&b?a2(C,e.x,i.x,h):!C.isHorizontal()&&S&&a2(C,e.y,i.y,h)}),t.update(s),Ve(d.onZoom,[{chart:t}])}function OA(t,e,i,s="none"){yu(t,dr(t));const l=t.scales[e];gu(l,i,void 0,!0),t.update(s)}function BA(t,e="default"){const i=dr(t),s=yu(t,i);We(t.scales,function(l){const h=l.options;s[l.id]?(h.min=s[l.id].min.options,h.max=s[l.id].max.options):(delete h.min,delete h.max)}),t.update(e),Ve(i.options.zoom.onZoomComplete,[{chart:t}])}function VA(t,e){const i=t.originalScaleLimits[e];if(!i)return;const{min:s,max:l}=i;return Le(l.options,l.scale)-Le(s.options,s.scale)}function $A(t){const e=dr(t);let i=1,s=1;return We(t.scales,function(l){const h=VA(e,l.id);if(h){const d=Math.round(h/(l.max-l.min)*100)/100;i=Math.min(i,d),s=Math.max(s,d)}}),i<1?i:s}function l2(t,e,i,s){const{panDelta:l}=s,h=l[t.id]||0;Ss(h)===Ss(e)&&(e+=h);const d=f_[t.type]||f_.default;Ve(d,[t,e,i])?l[t.id]=0:l[t.id]=e}function Z9(t,e,i,s="none"){const{x:l=0,y:h=0}=typeof e=="number"?{x:e,y:e}:e,d=dr(t),{options:{pan:c,limits:b}}=d,{onPan:S}=c||{};yu(t,d);const C=l!==0,P=h!==0;We(i||t.scales,function(A){A.isHorizontal()&&C?l2(A,l,b,d):!A.isHorizontal()&&P&&l2(A,h,b,d)}),t.update(s),Ve(S,[{chart:t}])}function q9(t){const e=dr(t);yu(t,e);const i={};for(const s of Object.keys(t.scales)){const{min:l,max:h}=e.originalScaleLimits[s]||{min:{},max:{}};i[s]={min:l.scale,max:h.scale}}return i}function NA(t){const e=q9(t);for(const i of Object.keys(t.scales)){const{min:s,max:l}=e[i];if(s!==void 0&&t.scales[i].min!==s||l!==void 0&&t.scales[i].max!==l)return!0}return!1}function Fn(t,e){const{handlers:i}=dr(t),s=i[e];s&&s.target&&(s.target.removeEventListener(e,s),delete i[e])}function cd(t,e,i,s){const{handlers:l,options:h}=dr(t),d=l[i];d&&d.target===e||(Fn(t,i),l[i]=c=>s(t,c,h),l[i].target=e,e.addEventListener(i,l[i]))}function jA(t,e){const i=dr(t);i.dragStart&&(i.dragging=!0,i.dragEnd=e,t.update("none"))}function UA(t,e){const i=dr(t);!i.dragStart||e.key!=="Escape"||(Fn(t,"keydown"),i.dragging=!1,i.dragStart=i.dragEnd=null,t.update("none"))}function G9(t,e,i){const{onZoomStart:s,onZoomRejected:l}=i;if(s){const h=mo(e,t);if(Ve(s,[{chart:t,event:e,point:h}])===!1)return Ve(l,[{chart:t,event:e}]),!1}}function HA(t,e){const i=dr(t),{pan:s,zoom:l={}}=i.options;if(e.button!==0||$9(Fd(s),e)||Av(Fd(l.drag),e))return Ve(l.onZoomRejected,[{chart:t,event:e}]);G9(t,e,l)!==!1&&(i.dragStart=e,cd(t,t.canvas,"mousemove",jA),cd(t,window.document,"keydown",UA))}function W9(t,e,i,s){const l=qa(e,"x",t),h=qa(e,"y",t);let{top:d,left:c,right:b,bottom:S,width:C,height:P}=t.chartArea;const A=mo(i,t),V=mo(s,t);l&&(c=Math.min(A.x,V.x),b=Math.max(A.x,V.x)),h&&(d=Math.min(A.y,V.y),S=Math.max(A.y,V.y));const W=b-c,$=S-d;return{left:c,top:d,right:b,bottom:S,width:W,height:$,zoomX:l&&W?1+(C-W)/C:1,zoomY:h&&$?1+(P-$)/P:1}}function ZA(t,e){const i=dr(t);if(!i.dragStart)return;Fn(t,"mousemove");const{mode:s,onZoomComplete:l,drag:{threshold:h=0}}=i.options.zoom,d=W9(t,s,i.dragStart,e),c=qa(s,"x",t)?d.width:0,b=qa(s,"y",t)?d.height:0,S=Math.sqrt(c*c+b*b);if(i.dragStart=i.dragEnd=null,S<=h){i.dragging=!1,t.update("none");return}H9(t,{x:d.left,y:d.top},{x:d.right,y:d.bottom},"zoom"),setTimeout(()=>i.dragging=!1,500),Ve(l,[{chart:t}])}function qA(t,e,i){if(Av(Fd(i.wheel),e)){Ve(i.onZoomRejected,[{chart:t,event:e}]);return}if(G9(t,e,i)!==!1&&(e.cancelable&&e.preventDefault(),e.deltaY!==void 0))return!0}function GA(t,e){const{handlers:{onZoomComplete:i},options:{zoom:s}}=dr(t);if(!qA(t,e,s))return;const l=e.target.getBoundingClientRect(),h=1+(e.deltaY>=0?-s.wheel.speed:s.wheel.speed),d={x:h,y:h,focalPoint:{x:e.clientX-l.left,y:e.clientY-l.top}};zv(t,d),i&&i()}function WA(t,e,i,s){i&&(dr(t).handlers[e]=kA(()=>Ve(i,[{chart:t}]),s))}function YA(t,e){const i=t.canvas,{wheel:s,drag:l,onZoomComplete:h}=e.zoom;s.enabled?(cd(t,i,"wheel",GA),WA(t,"onZoomComplete",h,250)):Fn(t,"wheel"),l.enabled?(cd(t,i,"mousedown",HA),cd(t,i.ownerDocument,"mouseup",ZA)):(Fn(t,"mousedown"),Fn(t,"mousemove"),Fn(t,"mouseup"),Fn(t,"keydown"))}function KA(t){Fn(t,"mousedown"),Fn(t,"mousemove"),Fn(t,"mouseup"),Fn(t,"wheel"),Fn(t,"click"),Fn(t,"keydown")}function XA(t,e){return function(i,s){const{pan:l,zoom:h={}}=e.options;if(!l||!l.enabled)return!1;const d=s&&s.srcEvent;return d&&!e.panning&&s.pointerType==="mouse"&&(Av(Fd(l),d)||$9(Fd(h.drag),d))?(Ve(l.onPanRejected,[{chart:t,event:s}]),!1):!0}}function JA(t,e){const i=Math.abs(t.clientX-e.clientX),s=Math.abs(t.clientY-e.clientY),l=i/s;let h,d;return l>.3&&l<1.7?h=d=!0:i>s?h=!0:d=!0,{x:h,y:d}}function Y9(t,e,i){if(e.scale){const{center:s,pointers:l}=i,h=1/e.scale*i.scale,d=i.target.getBoundingClientRect(),c=JA(l[0],l[1]),b=e.options.zoom.mode,S={x:c.x&&qa(b,"x",t)?h:1,y:c.y&&qa(b,"y",t)?h:1,focalPoint:{x:s.x-d.left,y:s.y-d.top}};zv(t,S),e.scale=i.scale}}function QA(t,e){e.options.zoom.pinch.enabled&&(e.scale=1)}function t8(t,e,i){e.scale&&(Y9(t,e,i),e.scale=null,Ve(e.options.zoom.onZoomComplete,[{chart:t}]))}function K9(t,e,i){const s=e.delta;s&&(e.panning=!0,Z9(t,{x:i.deltaX-s.x,y:i.deltaY-s.y},e.panScales),e.delta={x:i.deltaX,y:i.deltaY})}function e8(t,e,i){const{enabled:s,onPanStart:l,onPanRejected:h}=e.options.pan;if(!s)return;const d=i.target.getBoundingClientRect(),c={x:i.center.x-d.left,y:i.center.y-d.top};if(Ve(l,[{chart:t,event:i,point:c}])===!1)return Ve(h,[{chart:t,event:i}]);e.panScales=N9(e.options.pan,c,t),e.delta={x:0,y:0},clearTimeout(e.panEndTimeout),K9(t,e,i)}function i8(t,e){e.delta=null,e.panning&&(e.panEndTimeout=setTimeout(()=>e.panning=!1,500),Ve(e.options.pan.onPanComplete,[{chart:t}]))}const m_=new WeakMap;function r8(t,e){const i=dr(t),s=t.canvas,{pan:l,zoom:h}=e,d=new ld.Manager(s);h&&h.pinch.enabled&&(d.add(new ld.Pinch),d.on("pinchstart",()=>QA(t,i)),d.on("pinch",c=>Y9(t,i,c)),d.on("pinchend",c=>t8(t,i,c))),l&&l.enabled&&(d.add(new ld.Pan({threshold:l.threshold,enable:XA(t,i)})),d.on("panstart",c=>e8(t,i,c)),d.on("panmove",c=>K9(t,i,c)),d.on("panend",()=>i8(t,i))),m_.set(t,d)}function n8(t){const e=m_.get(t);e&&(e.remove("pinchstart"),e.remove("pinch"),e.remove("pinchend"),e.remove("panstart"),e.remove("pan"),e.remove("panend"),e.destroy(),m_.delete(t))}var s8="2.0.1";function If(t,e,i){const s=i.zoom.drag,{dragStart:l,dragEnd:h}=dr(t);if(s.drawTime!==e||!h)return;const{left:d,top:c,width:b,height:S}=W9(t,i.zoom.mode,l,h),C=t.ctx;C.save(),C.beginPath(),C.fillStyle=s.backgroundColor||"rgba(225,225,225,0.3)",C.fillRect(d,c,b,S),s.borderWidth>0&&(C.lineWidth=s.borderWidth,C.strokeStyle=s.borderColor||"rgba(225,225,225)",C.strokeRect(d,c,b,S)),C.restore()}var o8={id:"zoom",version:s8,defaults:{pan:{enabled:!1,mode:"xy",threshold:10,modifierKey:null},zoom:{wheel:{enabled:!1,speed:.1,modifierKey:null},drag:{enabled:!1,drawTime:"beforeDatasetsDraw",modifierKey:null},pinch:{enabled:!1},mode:"xy"}},start:function(t,e,i){const s=dr(t);s.options=i,Object.prototype.hasOwnProperty.call(i.zoom,"enabled")&&console.warn("The option `zoom.enabled` is no longer supported. Please use `zoom.wheel.enabled`, `zoom.drag.enabled`, or `zoom.pinch.enabled`."),(Object.prototype.hasOwnProperty.call(i.zoom,"overScaleMode")||Object.prototype.hasOwnProperty.call(i.pan,"overScaleMode"))&&console.warn("The option `overScaleMode` is deprecated. Please use `scaleMode` instead (and update `mode` as desired)."),ld&&r8(t,i),t.pan=(l,h,d)=>Z9(t,l,h,d),t.zoom=(l,h)=>zv(t,l,h),t.zoomRect=(l,h,d)=>H9(t,l,h,d),t.zoomScale=(l,h,d)=>OA(t,l,h,d),t.resetZoom=l=>BA(t,l),t.getZoomLevel=()=>$A(t),t.getInitialScaleBounds=()=>q9(t),t.isZoomedOrPanned=()=>NA(t)},beforeEvent(t){const e=dr(t);if(e.panning||e.dragging)return!1},beforeUpdate:function(t,e,i){const s=dr(t);s.options=i,YA(t,i)},beforeDatasetsDraw(t,e,i){If(t,"beforeDatasetsDraw",i)},afterDatasetsDraw(t,e,i){If(t,"afterDatasetsDraw",i)},beforeDraw(t,e,i){If(t,"beforeDraw",i)},afterDraw(t,e,i){If(t,"afterDraw",i)},stop:function(t){KA(t),ld&&n8(t),MA(t)},panFunctions:f_,zoomFunctions:d_,zoomRectFunctions:p_},Q0={line:{color:"#F66",width:1,dashPattern:[]},sync:{enabled:!0,group:1,suppressTooltips:!1},zoom:{enabled:!0,zoomboxBackgroundColor:"rgba(66,133,244,0.2)",zoomboxBorderColor:"#48F",zoomButtonText:"Reset Zoom",zoomButtonClass:"reset-zoom"},snap:{enabled:!1},callbacks:{beforeZoom:function(t,e){return!0},afterZoom:function(t,e){}}},a8={id:"crosshair",afterInit:function(t){if(t.config.options.scales.x){var e=t.config.options.scales.x.type;if(!(e!=="linear"&&e!=="time"&&e!=="category"&&e!=="logarithmic")){t.options.plugins.crosshair===void 0&&(t.options.plugins.crosshair=Q0),t.crosshair={enabled:!1,suppressUpdate:!1,x:null,originalData:[],originalXRange:{},dragStarted:!1,dragStartX:null,dragEndX:null,suppressTooltips:!1,ignoreNextEvents:0,reset:(function(){this.resetZoom(t,!1,!1)}).bind(this)};var i=this.getOption(t,"sync","enabled");i&&(t.crosshair.syncEventHandler=(function(s){this.handleSyncEvent(t,s)}).bind(this),t.crosshair.resetZoomEventHandler=(function(s){var l=this.getOption(t,"sync","group");s.chartId!==t.id&&s.syncGroup===l&&this.resetZoom(t,!0)}).bind(this),window.addEventListener("sync-event",t.crosshair.syncEventHandler),window.addEventListener("reset-zoom-event",t.crosshair.resetZoomEventHandler)),t.panZoom=this.panZoom.bind(this,t)}}},afterDestroy:function(t){var e=this.getOption(t,"sync","enabled");e&&(window.removeEventListener("sync-event",t.crosshair.syncEventHandler),window.removeEventListener("reset-zoom-event",t.crosshair.resetZoomEventHandler))},panZoom:function(t,e){if(t.crosshair.originalData.length!==0){var i=t.crosshair.end-t.crosshair.start,s=t.crosshair.min,l=t.crosshair.max;e<0?(t.crosshair.start=Math.max(t.crosshair.start+e,s),t.crosshair.end=t.crosshair.start===s?s+i:t.crosshair.end+e):(t.crosshair.end=Math.min(t.crosshair.end+e,t.crosshair.max),t.crosshair.start=t.crosshair.end===l?l-i:t.crosshair.start+e),this.doZoom(t,t.crosshair.start,t.crosshair.end)}},getOption:function(t,e,i){return Le(t.options.plugins.crosshair[e]?t.options.plugins.crosshair[e][i]:void 0,Q0[e][i])},getXScale:function(t){return t.data.datasets.length?t.scales[t.getDatasetMeta(0).xAxisID]:null},getYScale:function(t){return t.scales[t.getDatasetMeta(0).yAxisID]},handleSyncEvent:function(t,e){var i=this.getOption(t,"sync","group");if(e.chartId!==t.id&&e.syncGroup===i){var s=this.getXScale(t);if(s){var l=e.original.native.buttons===void 0?e.original.native.which:e.original.native.buttons;e.original.type==="mouseup"&&(l=0);var h={type:e.original.type=="click"?"mousemove":e.original.type,chart:t,x:s.getPixelForValue(e.xValue),y:e.original.y,native:{buttons:l},stop:!0};t._eventHandler(h)}}},afterEvent:function(t,e){if(t.config.options.scales.x.length==0)return;let i=e.event;var s=t.config.options.scales.x.type;if(!(s!=="linear"&&s!=="time"&&s!=="category"&&xscaleType!=="logarithmic")){var l=this.getXScale(t);if(l){if(t.crosshair.ignoreNextEvents>0){t.crosshair.ignoreNextEvents-=1;return}var h=i.native.buttons===void 0?i.native.which:i.native.buttons;i.native.type==="mouseup"&&(h=0);var d=this.getOption(t,"sync","enabled"),c=this.getOption(t,"sync","group");if(!i.stop&&d){var e=new CustomEvent("sync-event");e.chartId=t.id,e.syncGroup=c,e.original=i,e.xValue=l.getValueForPixel(i.x),window.dispatchEvent(e)}var b=this.getOption(t,"sync","suppressTooltips");if(t.crosshair.suppressTooltips=i.stop&&b,t.crosshair.enabled=i.type!=="mouseout"&&i.x>l.getPixelForValue(l.min)&&i.x<l.getPixelForValue(l.max),!t.crosshair.enabled&&!t.crosshair.suppressUpdate)return i.x>l.getPixelForValue(l.max)&&(t.crosshair.suppressUpdate=!0,t.update("none")),t.crosshair.dragStarted=!1,!1;t.crosshair.suppressUpdate=!1;var S=this.getOption(t,"zoom","enabled");if(h===1&&!t.crosshair.dragStarted&&S&&(t.crosshair.dragStartX=i.x,t.crosshair.dragStarted=!0),t.crosshair.dragStarted&&h===0){t.crosshair.dragStarted=!1;var C=l.getValueForPixel(t.crosshair.dragStartX),P=l.getValueForPixel(t.crosshair.x);Math.abs(t.crosshair.dragStartX-t.crosshair.x)>1&&this.doZoom(t,C,P),t.update("none")}t.crosshair.x=i.x,t.draw()}}},afterDraw:function(t){if(t.crosshair.enabled)return t.crosshair.dragStarted?this.drawZoombox(t):(this.drawTraceLine(t),this.interpolateValues(t),this.drawTracePoints(t)),!0},beforeTooltipDraw:function(t){return!t.crosshair.dragStarted&&!t.crosshair.suppressTooltips},resetZoom:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(i){if(t.crosshair.originalData.length>0)for(var s=0;s<t.data.datasets.length;s++){var l=t.data.datasets[s];l.data=t.crosshair.originalData.shift(0)}t.crosshair.originalXRange.min?(t.options.scales.x.min=t.crosshair.originalXRange.min,t.crosshair.originalXRange.min=null):delete t.options.scales.x.min,t.crosshair.originalXRange.max?(t.options.scales.x.max=t.crosshair.originalXRange.max,t.crosshair.originalXRange.max=null):delete t.options.scales.x.max}t.crosshair.button&&t.crosshair.button.parentNode&&(t.crosshair.button.parentNode.removeChild(t.crosshair.button),t.crosshair.button=!1);var h=this.getOption(t,"sync","enabled");if(!e&&i&&h){var d=this.getOption(t,"sync","group"),c=new CustomEvent("reset-zoom-event");c.chartId=t.id,c.syncGroup=d,window.dispatchEvent(c)}i&&t.update("none")},doZoom:function(t,e,i){if(e>i){var s=e;e=i,i=s}var l=Le(t.options.plugins.crosshair.callbacks?t.options.plugins.crosshair.callbacks.beforeZoom:void 0,Q0.callbacks.beforeZoom);if(!l(e,i))return!1;if(t.crosshair.dragStarted=!1,t.options.scales.x.min&&t.crosshair.originalData.length===0&&(t.crosshair.originalXRange.min=t.options.scales.x.min),t.options.scales.x.max&&t.crosshair.originalData.length===0&&(t.crosshair.originalXRange.max=t.options.scales.x.max),!t.crosshair.button){var h=document.createElement("button"),d=this.getOption(t,"zoom","zoomButtonText"),c=this.getOption(t,"zoom","zoomButtonClass"),b=document.createTextNode(d);h.appendChild(b),h.className=c,h.addEventListener("click",(function(){this.resetZoom(t)}).bind(this)),t.canvas.parentNode.appendChild(h),t.crosshair.button=h}t.options.scales.x.min=e,t.options.scales.x.max=i;var S=t.crosshair.originalData.length===0,C=t.config.options.scales.x.type!=="category";if(C)for(var P=0;P<t.data.datasets.length;P++){var A=[],V=0,W=!1,$=!1;S&&(t.crosshair.originalData[P]=t.data.datasets[P].data);for(var nt=t.crosshair.originalData[P],H=0;H<nt.length;H++){var Y=nt[H],K=Y.x!==void 0?Y.x:NaN;K>=e&&!W&&V>0&&(A.push(nt[V-1]),W=!0),K>=e&&K<=i&&A.push(Y),K>i&&!$&&V<nt.length&&(A.push(Y),$=!0),V+=1}t.data.datasets[P].data=A}if(t.crosshair.start=e,t.crosshair.end=i,S){var at=this.getXScale(t);t.crosshair.min=at.min,t.crosshair.max=at.max}t.crosshair.ignoreNextEvents=2,t.update("none");var mt=this.getOption(t,"callbacks","afterZoom");mt(e,i)},drawZoombox:function(t){var e=this.getYScale(t),i=this.getOption(t,"zoom","zoomboxBorderColor"),s=this.getOption(t,"zoom","zoomboxBackgroundColor");t.ctx.beginPath(),t.ctx.rect(t.crosshair.dragStartX,e.getPixelForValue(e.max),t.crosshair.x-t.crosshair.dragStartX,e.getPixelForValue(e.min)-e.getPixelForValue(e.max)),t.ctx.lineWidth=1,t.ctx.strokeStyle=i,t.ctx.fillStyle=s,t.ctx.fill(),t.ctx.fillStyle="",t.ctx.stroke(),t.ctx.closePath()},drawTraceLine:function(t){var e=this.getYScale(t),i=this.getOption(t,"line","width"),s=this.getOption(t,"line","color"),l=this.getOption(t,"line","dashPattern"),h=this.getOption(t,"snap","enabled"),d=t.crosshair.x;h&&t._active.length&&(d=t._active[0].element.x),t.ctx.beginPath(),t.ctx.setLineDash(l),t.ctx.moveTo(d,e.getPixelForValue(e.max)),t.ctx.lineWidth=i,t.ctx.strokeStyle=s,t.ctx.lineTo(d,e.getPixelForValue(e.min)),t.ctx.stroke(),t.ctx.setLineDash([])},drawTracePoints:function(t){for(var e=0;e<t.data.datasets.length;e++){var i=t.data.datasets[e],s=t.getDatasetMeta(e),l=t.scales[s.yAxisID];s.hidden||!i.interpolate||(t.ctx.beginPath(),t.ctx.arc(t.crosshair.x,l.getPixelForValue(i.interpolatedValue),3,0,2*Math.PI,!1),t.ctx.fillStyle="white",t.ctx.lineWidth=2,t.ctx.strokeStyle=i.borderColor,t.ctx.fill(),t.ctx.stroke())}},interpolateValues:function(t){for(var e=0;e<t.data.datasets.length;e++){var i=t.data.datasets[e],s=t.getDatasetMeta(e),l=t.scales[s.xAxisID],h=l.getValueForPixel(t.crosshair.x);if(!(s.hidden||!i.interpolate)){var d=i.data,c=d.findIndex(function(P){return P.x>=h}),b=d[c-1],S=d[c];if(t.data.datasets[e].steppedLine&&b)i.interpolatedValue=b.y;else if(b&&S){var C=(S.y-b.y)/(S.x-b.x);i.interpolatedValue=b.y+(h-b.x)*C}else i.interpolatedValue=NaN}}}};class g_{constructor(){this.chartHeight=null,this.chartBackgroundColor=null,this.displayChartTitle=!0,this.chartTitleText="Elevation Profile",this.chartTitleColor="#000",this.chartTitlePosition="bottom",this.unitSystem="imperial",this.fontSize=12,this.displayXAxisDistanceLabels=!0,this.displayYAxisElevationLabels=!0,this.displayAxisLabelUnits=!0,this.axisLabelColor="#0009",this.profileLineWidth=2,this.profileLineColor="#1d2323",this.belowProfileLineColor="#0000000a",this.profileLineGradeColors=["#02b305","#60b302","#95b302","#e3d405","#f0bd05","#faa507","#fa8507","#fa6c07","#fa5007","#fa3407","#fa0707","#b00000"],this.displayProfileGradeColors=!1,this.mapMarkerColor="#A4693A",this.mapMarkerSize="15px",this.displayMarker=!0,this.displayTooltip=!0,this.tooltipTextColor="#fff",this.tooltipBackgroundColor="#000",this.displayTooltipDistance=!0,this.displayTooltipElevation=!0,this.displayTooltipDPlus=!1,this.displayTooltipGrade=!0,this.displayDistanceVerticalGridLines=!1,this.displayElevationHorizontalGridLines=!1,this.distanceVerticalGridLineColor="#0001",this.elevationHorizontalGridLineColor="#0001",this.displayProfileLineCrosshair=!0,this.crosshairLineColor="#b00000",this.chartPaddingTop=5,this.chartPaddingBottom=5,this.chartPaddingLeft=10,this.chartPaddingRight=10,this.onChangeView=null,this.onClick=null,this.onMove=null}}class l8{constructor(e,i={}){var s,l,h;this.elevatedPositions=[],this.elevatedPositionsAdjustedUnit=[],this.cumulatedDistance=[],this.cumulatedDistanceAdjustedUnit=[],this.cumulatedDPlus=[],this.grade=[];const d=typeof e=="string"?document.getElementById(e):e;if(!d)throw new Error("The container does not exist!");this.canvas=document.createElement("canvas"),d.appendChild(this.canvas),xs.register(...wA),xs.register(o8),xs.register(a8),this.options={...new g_,...i},d.style.height=this.options.chartHeight??d.style.height,d.style.backgroundColor=this.options.chartBackgroundColor??d.style.backgroundColor;const c=this.options.unitSystem==="imperial"?"mi":"km",b=this.options.unitSystem==="imperial"?"ft":"m";if(xs.defaults.font.size=this.options.fontSize,this.chart=new xs(this.canvas,{type:"line",data:{labels:[],datasets:[{label:"Elevation",data:[],pointRadius:0,fill:!!this.options.belowProfileLineColor,borderColor:this.options.profileLineColor??"#0000",backgroundColor:this.options.belowProfileLineColor??"#0000",tension:.1,spanGaps:!0,borderWidth:this.options.profileLineColor?this.options.profileLineWidth:0,segment:{borderColor:S=>{var C,P;if(this.options.displayProfileGradeColors&&((P=(C=this.options)==null?void 0:C.profileLineGradeColors)==null?void 0:P.length)===12){const A=~~this.grade[S.p0DataIndex];return A<1?this.options.profileLineGradeColors[0]:A>10?this.options.profileLineGradeColors[11]:this.options.profileLineGradeColors[A]}}}}]},options:{layout:{padding:{left:this.options.chartPaddingLeft,right:this.options.chartPaddingRight,bottom:this.options.chartPaddingBottom,top:this.options.chartPaddingTop}},onClick:(S,C)=>{if(typeof this.options.onClick=="function")try{const P=C[0].index;this.options.onClick.apply(this,[{position:this.elevatedPositionsAdjustedUnit[P],distance:this.cumulatedDistanceAdjustedUnit[P],dPlus:this.cumulatedDPlus[P],gradePercent:this.grade[P]}])}catch{}},onHover:(S,C)=>{if(typeof this.options.onMove=="function")try{const P=C[0].index;this.options.onMove.apply(this,[{position:this.elevatedPositionsAdjustedUnit[P],distance:this.cumulatedDistanceAdjustedUnit[P],dPlus:this.cumulatedDPlus[P],gradePercent:this.grade[P]}])}catch{}},animation:!1,maintainAspectRatio:!1,scales:{x:{min:0,max:0,type:"linear",grid:{display:this.options.displayDistanceVerticalGridLines,color:this.options.distanceVerticalGridLineColor,drawTicks:!1},ticks:{align:"inner",display:this.options.displayXAxisDistanceLabels,color:this.options.axisLabelColor,callback:S=>{const C=~~(S*100)/100;return this.options.displayAxisLabelUnits?`${C} ${c}`:C}}},y:{min:0,max:0,type:"linear",ticks:{mirror:!0,align:"end",display:this.options.displayYAxisElevationLabels,color:this.options.axisLabelColor,callback:S=>{const C=~~(S*100)/100;return this.options.displayAxisLabelUnits?`${C} ${b}`:C}},grid:{display:this.options.displayElevationHorizontalGridLines,color:this.options.elevationHorizontalGridLineColor,drawTicks:!1}}},interaction:{intersect:!1,mode:"index"},plugins:{zoom:{zoom:{wheel:{enabled:!0},pinch:{enabled:!0},mode:"x"},pan:{enabled:!0,mode:"x"},limits:{x:{min:"original",max:"original"}}},title:{display:this.options.displayChartTitle,color:((s=this.options)==null?void 0:s.chartTitleColor)||this.options.axisLabelColor,text:((l=this.options)==null?void 0:l.chartTitleText)||"",position:(h=this.options)==null?void 0:h.chartTitlePosition},legend:{display:!1},tooltip:{enabled:this.options.displayTooltip,yAlign:"center",cornerRadius:3,displayColors:!1,backgroundColor:this.options.tooltipBackgroundColor,bodyColor:this.options.tooltipTextColor,callbacks:{title:()=>"",label:S=>{var C,P,A,V;const W=[];return this.options.displayTooltipDistance&&W.push(`Distance: ${(C=this.cumulatedDistanceAdjustedUnit[S.dataIndex])==null?void 0:C.toFixed(4)} ${c}`),this.options.displayTooltipElevation&&W.push(`Elevation: ${(P=this.elevatedPositionsAdjustedUnit[S.dataIndex][2])==null?void 0:P.toFixed(2)} ${b}`),this.options.displayTooltipDPlus&&W.push(`D+: ${(A=this.cumulatedDPlus[S.dataIndex])==null?void 0:A.toFixed(0)} ${b}`),this.options.displayTooltipGrade&&W.push(`Grade: ${(V=this.grade[S.dataIndex])==null?void 0:V.toFixed(1)}%`),W}}},crosshair:{zoom:{enabled:!1},line:{color:this.options.displayProfileLineCrosshair?this.options.crosshairLineColor:"#0000",width:1}}}},plugins:[{id:"customZoomEvent",afterDataLimits:()=>{if(typeof this.options.onChangeView=="function")try{this.options.onChangeView.apply(this,[this.createWindowExtractLineString()])}catch{}}}]}),this.options.displayTooltip){let S=!1;this.chart.canvas.addEventListener("mousedown",()=>{S=!0}),this.chart.canvas.addEventListener("mousemove",()=>{S&&this.chart.options.plugins&&this.chart.options.plugins.tooltip&&(this.chart.options.plugins.tooltip.enabled=!1,this.chart.update())}),window.addEventListener("mouseup",()=>{this.chart.options.plugins&&this.chart.options.plugins.tooltip&&(this.chart.options.plugins.tooltip.enabled=!0,this.chart.update(),S=!1)})}}createWindowExtractLineString(){const e=this.chart.scales.x.min,i=this.chart.scales.x.max,s=this.cumulatedDistanceAdjustedUnit,l=s.length;let h=0,d=l-1;for(let c=0;c<l;c+=1)if(s[c]>=e){h=c;break}for(let c=l-1;c>=h;c-=1)if(s[c]<=i){d=c;break}return this.createExtractLineString(h,d)}createExtractLineString(e,i){const s=this.elevatedPositions.slice(e,i);return{type:Xm,coordinates:s}}async setData(e){typeof e=="string"&&(e=JSON.parse(e));const i=Array.isArray(e)?e:dC(e);this.elevatedPositions=i,this.cumulatedDistance=fC(this.elevatedPositions),this.cumulatedDPlus=[],this.grade=[];let s=0;for(let c=0;c<this.elevatedPositions.length;c+=1){const b=this.elevatedPositions[c][2];if(c>1){const S=this.elevatedPositions[c-1][2],C=b-S,P=this.cumulatedDistance[c]-this.cumulatedDistance[c-1];s+=Math.max(0,C),this.cumulatedDPlus.push(s),this.grade.push(C/P*1e3/10)}}this.grade.push(0),this.cumulatedDPlus.push(s),this.options.unitSystem==="imperial"?(this.cumulatedDistanceAdjustedUnit=this.cumulatedDistance.map(c=>c*ZM),this.elevatedPositionsAdjustedUnit=this.elevatedPositions.map(c=>[c[0],c[1],c[2]*Pb]),this.cumulatedDPlus=this.cumulatedDPlus.map(c=>c*Pb)):(this.cumulatedDistanceAdjustedUnit=this.cumulatedDistance.map(c=>c/1e3),this.elevatedPositionsAdjustedUnit=this.elevatedPositions);let l=1/0,h=-1/0;for(let c=0;c<this.elevatedPositionsAdjustedUnit.length;c+=1)this.elevatedPositionsAdjustedUnit[c][2]<l&&(l=this.elevatedPositionsAdjustedUnit[c][2]),this.elevatedPositionsAdjustedUnit[c][2]>h&&(h=this.elevatedPositionsAdjustedUnit[c][2]);const d=(h-l)*.1;this.chart.data.labels=this.cumulatedDistanceAdjustedUnit,this.chart.data.datasets[0].data=this.elevatedPositionsAdjustedUnit.map(c=>c[2]),this.chart.options.scales&&this.chart.options.scales.x&&this.chart.options.scales.y&&(this.chart.options.scales.x.min=this.cumulatedDistanceAdjustedUnit[0],this.chart.options.scales.x.max=this.cumulatedDistanceAdjustedUnit[this.cumulatedDistanceAdjustedUnit.length-1],this.chart.options.scales.y.min=l-d,this.chart.options.scales.y.max=h+d),this.chart.update()}}class X9{createDiv(){return this.toggleDiv=document.createElement("div"),this.toggleDiv}onAdd(e){return this.createDiv()}onRemove(){this.toggleDiv&&this.toggleDiv.remove(),this.toggleDiv=void 0}getDefaultPosition(){return Wy}}class c8 extends X9{createDiv(){const e="trail-alert-checkbox",i=document.createElement("div");i.className=`${LS} ${RS} ${OS}`;const s=document.createElement("label");s.className="switch";const l=document.createElement("span");l.setAttribute("for",e),l.innerText="Show Alerts",l.className=`${BS} ${FS}`;const h=document.createElement("input");h.type="checkbox",h.name=e,h.id=h.name,h.setAttribute("checked","checked"),h.style.display="none";const d=document.createElement("span");return d.className="slider round",s.appendChild(h),s.appendChild(d),i.appendChild(s),i.appendChild(l),Uf(i),h.addEventListener("click",function(c){QM(!km),aC(),Os.setLayoutProperty(ES,"visibility",km?"visible":"none")}),this.toggleDiv=i,this.toggleDiv}}class u8 extends X9{constructor(e){super(),this.options=e}createDiv(){const e=document.createElement("div");e.className=`${LS} ${RS}`;const i=document.createElement("button");i.setAttribute("aria-label","Show/hide elevation profile chart"),i.alt="Show/hide elevation profile chart",i.appendChild(cC(WM)),e.appendChild(i),Uf(e),i.addEventListener("click",function(h){Lb()});const s=document.createElement("div");s.id=MS,s.className=`${VS}`,Uf(s),new l8(s,this.options).setData(Jf);const l=document.createElement("button");return l.innerText="x",l.setAttribute("type","button"),l.setAttribute("aria-label","Close profile chart"),l.alt="Close profile chart",l.className="maplibregl-popup-close-button",Uf(l),s.appendChild(l),l.addEventListener("click",function(h){Lb()}),Od==null||Od.appendChild(s),No&&(Tm(!No,dv),Tm(!No,pv)),this.toggleDiv=e,this.toggleDiv}}var J9={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.3.2/LICENSE.txt
 */(function(t,e){(function(i,s){t.exports=s()})(SS,function(){var i={},s={};function l(d,c,b){if(s[d]=b,d==="index"){var S="var sharedModule = {}; ("+s.shared+")(sharedModule); ("+s.worker+")(sharedModule);",C={};return s.shared(C),s.index(i,C),typeof window<"u"&&i.setWorkerUrl(window.URL.createObjectURL(new Blob([S],{type:"text/javascript"}))),i}}l("shared",["exports"],function(d){function c(o,r,a,p){return new(a||(a=Promise))(function(m,_){function x(I){try{T(p.next(I))}catch(D){_(D)}}function w(I){try{T(p.throw(I))}catch(D){_(D)}}function T(I){var D;I.done?m(I.value):(D=I.value,D instanceof a?D:new a(function(L){L(D)})).then(x,w)}T((p=p.apply(o,r||[])).next())})}function b(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}typeof SuppressedError=="function"&&SuppressedError;var S=C;function C(o,r){this.x=o,this.y=r}C.prototype={clone:function(){return new C(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,r){return this.clone()._rotateAround(o,r)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var r=o.x-this.x,a=o.y-this.y;return r*r+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,r){return Math.atan2(this.x*r-this.y*o,this.x*o+this.y*r)},_matMult:function(o){var r=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=r,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var r=Math.cos(o),a=Math.sin(o),p=a*this.x+r*this.y;return this.x=r*this.x-a*this.y,this.y=p,this},_rotateAround:function(o,r){var a=Math.cos(o),p=Math.sin(o),m=r.y+p*(this.x-r.x)+a*(this.y-r.y);return this.x=r.x+a*(this.x-r.x)-p*(this.y-r.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},C.convert=function(o){return o instanceof C?o:Array.isArray(o)?new C(o[0],o[1]):o};var P=b(S),A=V;function V(o,r,a,p){this.cx=3*o,this.bx=3*(a-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(p-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=r,this.p2x=a,this.p2y=p}V.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,r){if(r===void 0&&(r=1e-6),o<0)return 0;if(o>1)return 1;for(var a=o,p=0;p<8;p++){var m=this.sampleCurveX(a)-o;if(Math.abs(m)<r)return a;var _=this.sampleCurveDerivativeX(a);if(Math.abs(_)<1e-6)break;a-=m/_}var x=0,w=1;for(a=o,p=0;p<20&&(m=this.sampleCurveX(a),!(Math.abs(m-o)<r));p++)o>m?x=a:w=a,a=.5*(w-x)+x;return a},solve:function(o,r){return this.sampleCurveY(this.solveCurveX(o,r))}};var W=b(A);let $,nt;function H(){return $==null&&($=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),$}function Y(){if(nt==null&&(nt=!1,H())){const o=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(o){for(let a=0;a<5*5;a++){const p=4*a;o.fillStyle=`rgb(${p},${p+1},${p+2})`,o.fillRect(a%5,Math.floor(a/5),1,1)}const r=o.getImageData(0,0,5,5).data;for(let a=0;a<5*5*4;a++)if(a%4!=3&&r[a]!==a){nt=!0;break}}}return nt||!1}function K(o,r,a,p){const m=new W(o,r,a,p);return _=>m.solve(_)}const at=K(.25,.1,.25,1);function mt(o,r,a){return Math.min(a,Math.max(r,o))}function xt(o,r,a){const p=a-r,m=((o-r)%p+p)%p+r;return m===r?a:m}function Tt(o,...r){for(const a of r)for(const p in a)o[p]=a[p];return o}let Mt=1;function $t(o,r,a){const p={};for(const m in o)p[m]=r.call(this,o[m],m,o);return p}function Ft(o,r,a){const p={};for(const m in o)r.call(this,o[m],m,o)&&(p[m]=o[m]);return p}function Ot(o){return Array.isArray(o)?o.map(Ot):typeof o=="object"&&o?$t(o,Ot):o}const ge={};function _e(o){ge[o]||(typeof console<"u"&&console.warn(o),ge[o]=!0)}function Ae(o,r,a){return(a.y-o.y)*(r.x-o.x)>(r.y-o.y)*(a.x-o.x)}function ve(o){return typeof WorkerGlobalScope<"u"&&o!==void 0&&o instanceof WorkerGlobalScope}let Ee=null;function $e(o){return typeof ImageBitmap<"u"&&o instanceof ImageBitmap}const Vt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function re(o,r,a,p,m){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(o,{timestamp:0});try{const x=_==null?void 0:_.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const w=x.startsWith("BGR"),T=new Uint8ClampedArray(p*m*4);if(yield _.copyTo(T,function(I,D,L,O,j){const q=4*Math.max(-D,0),J=(Math.max(0,L)-L)*O*4+q,it=4*O,ct=Math.max(0,D),wt=Math.max(0,L);return{rect:{x:ct,y:wt,width:Math.min(I.width,D+O)-ct,height:Math.min(I.height,L+j)-wt},layout:[{offset:J,stride:it}]}}(o,r,a,p,m)),w)for(let I=0;I<T.length;I+=4){const D=T[I];T[I]=T[I+2],T[I+2]=D}return T}finally{_.close()}})}let Kt,we;const Se="AbortError";function ai(){return new Error(Se)}const Qe={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function fi(o){return Qe.REGISTERED_PROTOCOLS[o.substring(0,o.indexOf("://"))]}const ni="global-dispatcher";class Ue extends Error{constructor(r,a,p,m){super(`AJAXError: ${a} (${r}): ${p}`),this.status=r,this.statusText=a,this.url=p,this.body=m}}const Mi=()=>ve(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ze=function(o,r){if(/:\/\//.test(o.url)&&!/^https?:|^file:/.test(o.url)){const p=fi(o.url);if(p)return p(o,r);if(ve(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,targetMapId:ni},r)}if(!(/^file:/.test(a=o.url)||/^file:/.test(Mi())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(p,m){return c(this,void 0,void 0,function*(){const _=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,cache:p.cache,referrer:Mi(),signal:m.signal});p.type==="json"&&_.headers.set("Accept","application/json");const x=yield fetch(_);if(!x.ok){const I=yield x.blob();throw new Ue(x.status,x.statusText,p.url,I)}let w;w=p.type==="arrayBuffer"||p.type==="image"?x.arrayBuffer():p.type==="json"?x.json():x.text();const T=yield w;if(m.signal.aborted)throw ai();return{data:T,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}})}(o,r);if(ve(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,mustQueue:!0,targetMapId:ni},r)}var a;return function(p,m){return new Promise((_,x)=>{const w=new XMLHttpRequest;w.open(p.method||"GET",p.url,!0),p.type!=="arrayBuffer"&&p.type!=="image"||(w.responseType="arraybuffer");for(const T in p.headers)w.setRequestHeader(T,p.headers[T]);p.type==="json"&&(w.responseType="text",w.setRequestHeader("Accept","application/json")),w.withCredentials=p.credentials==="include",w.onerror=()=>{x(new Error(w.statusText))},w.onload=()=>{if(!m.signal.aborted)if((w.status>=200&&w.status<300||w.status===0)&&w.response!==null){let T=w.response;if(p.type==="json")try{T=JSON.parse(w.response)}catch(I){return void x(I)}_({data:T,cacheControl:w.getResponseHeader("Cache-Control"),expires:w.getResponseHeader("Expires")})}else{const T=new Blob([w.response],{type:w.getResponseHeader("Content-Type")});x(new Ue(w.status,w.statusText,p.url,T))}},m.signal.addEventListener("abort",()=>{w.abort(),x(ai())}),w.send(p.body)})}(o,r)};function ti(o){if(!o||o.indexOf("://")<=0||o.indexOf("data:image/")===0||o.indexOf("blob:")===0)return!0;const r=new URL(o),a=window.location;return r.protocol===a.protocol&&r.host===a.host}function _r(o,r,a){a[o]&&a[o].indexOf(r)!==-1||(a[o]=a[o]||[],a[o].push(r))}function sr(o,r,a){if(a&&a[o]){const p=a[o].indexOf(r);p!==-1&&a[o].splice(p,1)}}class vr{constructor(r,a={}){Tt(this,a),this.type=r}}class ci extends vr{constructor(r,a={}){super("error",Tt({error:r},a))}}class Hr{on(r,a){return this._listeners=this._listeners||{},_r(r,a,this._listeners),this}off(r,a){return sr(r,a,this._listeners),sr(r,a,this._oneTimeListeners),this}once(r,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},_r(r,a,this._oneTimeListeners),this):new Promise(p=>this.once(r,p))}fire(r,a){typeof r=="string"&&(r=new vr(r,a||{}));const p=r.type;if(this.listens(p)){r.target=this;const m=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const w of m)w.call(this,r);const _=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const w of _)sr(p,w,this._oneTimeListeners),w.call(this,r);const x=this._eventedParent;x&&(Tt(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(r))}else r instanceof ci&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,a){return this._eventedParent=r,this._eventedParentData=a,this}}var Et={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Bi=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function nn(o,r){const a={};for(const p in o)p!=="ref"&&(a[p]=o[p]);return Bi.forEach(p=>{p in r&&(a[p]=r[p])}),a}function Ke(o,r){if(Array.isArray(o)){if(!Array.isArray(r)||o.length!==r.length)return!1;for(let a=0;a<o.length;a++)if(!Ke(o[a],r[a]))return!1;return!0}if(typeof o=="object"&&o!==null&&r!==null){if(typeof r!="object"||Object.keys(o).length!==Object.keys(r).length)return!1;for(const a in o)if(!Ke(o[a],r[a]))return!1;return!0}return o===r}function li(o,r){o.push(r)}function Vi(o,r,a){li(a,{command:"addSource",args:[o,r[o]]})}function Ws(o,r,a){li(r,{command:"removeSource",args:[o]}),a[o]=!0}function vo(o,r,a,p){Ws(o,a,p),Vi(o,r,a)}function Ys(o,r,a){let p;for(p in o[a])if(Object.prototype.hasOwnProperty.call(o[a],p)&&p!=="data"&&!Ke(o[a][p],r[a][p]))return!1;for(p in r[a])if(Object.prototype.hasOwnProperty.call(r[a],p)&&p!=="data"&&!Ke(o[a][p],r[a][p]))return!1;return!0}function jn(o,r,a,p,m,_){o=o||{},r=r||{};for(const x in o)Object.prototype.hasOwnProperty.call(o,x)&&(Ke(o[x],r[x])||a.push({command:_,args:[p,x,r[x],m]}));for(const x in r)Object.prototype.hasOwnProperty.call(r,x)&&!Object.prototype.hasOwnProperty.call(o,x)&&(Ke(o[x],r[x])||a.push({command:_,args:[p,x,r[x],m]}))}function Ks(o){return o.id}function xo(o,r){return o[r.id]=r,o}class Zt{constructor(r,a,p,m){this.message=(r?`${r}: `:"")+p,m&&(this.identifier=m),a!=null&&a.__line__&&(this.line=a.__line__)}}function xr(o,...r){for(const a of r)for(const p in a)o[p]=a[p];return o}class br extends Error{constructor(r,a){super(a),this.message=a,this.key=r}}class Un{constructor(r,a=[]){this.parent=r,this.bindings={};for(const[p,m]of a)this.bindings[p]=m}concat(r){return new Un(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const Hn={kind:"null"},Ht={kind:"number"},De={kind:"string"},Pe={kind:"boolean"},wr={kind:"color"},Sr={kind:"object"},Me={kind:"value"},Zn={kind:"collator"},qn={kind:"formatted"},qi={kind:"padding"},rt={kind:"resolvedImage"},B={kind:"variableAnchorOffsetCollection"};function N(o,r){return{kind:"array",itemType:o,N:r}}function G(o){if(o.kind==="array"){const r=G(o.itemType);return typeof o.N=="number"?`array<${r}, ${o.N}>`:o.itemType.kind==="value"?"array":`array<${r}>`}return o.kind}const st=[Hn,Ht,De,Pe,wr,qn,Sr,N(Me),qi,rt,B];function dt(o,r){if(r.kind==="error")return null;if(o.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!dt(o.itemType,r.itemType))&&(typeof o.N!="number"||o.N===r.N))return null}else{if(o.kind===r.kind)return null;if(o.kind==="value"){for(const a of st)if(!dt(a,r))return null}}return`Expected ${G(o)} but found ${G(r)} instead.`}function yt(o,r){return r.some(a=>a.kind===o.kind)}function bt(o,r){return r.some(a=>a==="null"?o===null:a==="array"?Array.isArray(o):a==="object"?o&&!Array.isArray(o)&&typeof o=="object":a===typeof o)}function ht(o,r){return o.kind==="array"&&r.kind==="array"?o.itemType.kind===r.itemType.kind&&typeof o.N=="number":o.kind===r.kind}const St=.96422,Bt=.82521,At=4/29,It=6/29,de=3*It*It,fe=It*It*It,Fe=Math.PI/180,ke=180/Math.PI;function Ne(o){return(o%=360)<0&&(o+=360),o}function ei([o,r,a,p]){let m,_;const x=Ai((.2225045*(o=ui(o))+.7168786*(r=ui(r))+.0606169*(a=ui(a)))/1);o===r&&r===a?m=_=x:(m=Ai((.4360747*o+.3850649*r+.1430804*a)/St),_=Ai((.0139322*o+.0971045*r+.7141733*a)/Bt));const w=116*x-16;return[w<0?0:w,500*(m-x),200*(x-_),p]}function ui(o){return o<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function Ai(o){return o>fe?Math.pow(o,1/3):o/de+At}function Ie([o,r,a,p]){let m=(o+16)/116,_=isNaN(r)?m:m+r/500,x=isNaN(a)?m:m-a/200;return m=1*bi(m),_=St*bi(_),x=Bt*bi(x),[ii(3.1338561*_-1.6168667*m-.4906146*x),ii(-.9787684*_+1.9161415*m+.033454*x),ii(.0719453*_-.2289914*m+1.4052427*x),p]}function ii(o){return(o=o<=.00304?12.92*o:1.055*Math.pow(o,1/2.4)-.055)<0?0:o>1?1:o}function bi(o){return o>It?o*o*o:de*(o-At)}function Xi(o){return parseInt(o.padEnd(2,o),16)/255}function pr(o,r){return zi(r?o/100:o,0,1)}function zi(o,r,a){return Math.min(Math.max(r,o),a)}function Xs(o){return!o.some(Number.isNaN)}const _u={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class qe{constructor(r,a,p,m=1,_=!0){this.r=r,this.g=a,this.b=p,this.a=m,_||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[r,a,p,m]))}static parse(r){if(r instanceof qe)return r;if(typeof r!="string")return;const a=function(p){if((p=p.toLowerCase().trim())==="transparent")return[0,0,0,0];const m=_u[p];if(m){const[x,w,T]=m;return[x/255,w/255,T/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const x=p.length<6?1:2;let w=1;return[Xi(p.slice(w,w+=x)),Xi(p.slice(w,w+=x)),Xi(p.slice(w,w+=x)),Xi(p.slice(w,w+x)||"ff")]}if(p.startsWith("rgb")){const x=p.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[w,T,I,D,L,O,j,q,J,it,ct,wt]=x,pt=[D||" ",j||" ",it].join("");if(pt==="  "||pt==="  /"||pt===",,"||pt===",,,"){const vt=[I,O,J].join(""),zt=vt==="%%%"?100:vt===""?255:0;if(zt){const Lt=[zi(+T/zt,0,1),zi(+L/zt,0,1),zi(+q/zt,0,1),ct?pr(+ct,wt):1];if(Xs(Lt))return Lt}}return}}const _=p.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[x,w,T,I,D,L,O,j,q]=_,J=[T||" ",D||" ",O].join("");if(J==="  "||J==="  /"||J===",,"||J===",,,"){const it=[+w,zi(+I,0,100),zi(+L,0,100),j?pr(+j,q):1];if(Xs(it))return function([ct,wt,pt,vt]){function zt(Lt){const ee=(Lt+ct/30)%12,he=wt*Math.min(pt,1-pt);return pt-he*Math.max(-1,Math.min(ee-3,9-ee,1))}return ct=Ne(ct),wt/=100,pt/=100,[zt(0),zt(8),zt(4),vt]}(it)}}}(r);return a?new qe(...a,!1):void 0}get rgb(){const{r,g:a,b:p,a:m}=this,_=m||1/0;return this.overwriteGetter("rgb",[r/_,a/_,p/_,m])}get hcl(){return this.overwriteGetter("hcl",function(r){const[a,p,m,_]=ei(r),x=Math.sqrt(p*p+m*m);return[Math.round(1e4*x)?Ne(Math.atan2(m,p)*ke):NaN,x,a,_]}(this.rgb))}get lab(){return this.overwriteGetter("lab",ei(this.rgb))}overwriteGetter(r,a){return Object.defineProperty(this,r,{value:a}),a}toString(){const[r,a,p,m]=this.rgb;return`rgba(${[r,a,p].map(_=>Math.round(255*_)).join(",")},${m})`}}qe.black=new qe(0,0,0,1),qe.white=new qe(1,1,1,1),qe.transparent=new qe(0,0,0,0),qe.red=new qe(1,0,0,1);class Ir{constructor(r,a,p){this.sensitivity=r?a?"variant":"case":a?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,a){return this.collator.compare(r,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ds{constructor(r,a,p,m,_){this.text=r,this.image=a,this.scale=p,this.fontStack=m,this.textColor=_}}class $i{constructor(r){this.sections=r}static fromString(r){return new $i([new ds(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof $i?r:$i.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}}class Ci{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Ci)return r;if(typeof r=="number")return new Ci([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const a of r)if(typeof a!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new Ci(r)}}toString(){return JSON.stringify(this.values)}}const Gn=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class wi{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof wi)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let a=0;a<r.length;a+=2){const p=r[a],m=r[a+1];if(typeof p!="string"||!Gn.has(p)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new wi(r)}}toString(){return JSON.stringify(this.values)}}class Ni{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new Ni({name:r,available:!1}):null}}function Xa(o,r,a,p){return typeof o=="number"&&o>=0&&o<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof a=="number"&&a>=0&&a<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[o,r,a,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[o,r,a,p]:[o,r,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Pn(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof qe||o instanceof Ir||o instanceof $i||o instanceof Ci||o instanceof wi||o instanceof Ni)return!0;if(Array.isArray(o)){for(const r of o)if(!Pn(r))return!1;return!0}if(typeof o=="object"){for(const r in o)if(!Pn(o[r]))return!1;return!0}return!1}function Si(o){if(o===null)return Hn;if(typeof o=="string")return De;if(typeof o=="boolean")return Pe;if(typeof o=="number")return Ht;if(o instanceof qe)return wr;if(o instanceof Ir)return Zn;if(o instanceof $i)return qn;if(o instanceof Ci)return qi;if(o instanceof wi)return B;if(o instanceof Ni)return rt;if(Array.isArray(o)){const r=o.length;let a;for(const p of o){const m=Si(p);if(a){if(a===m)continue;a=Me;break}a=m}return N(a||Me,r)}return Sr}function kr(o){const r=typeof o;return o===null?"":r==="string"||r==="number"||r==="boolean"?String(o):o instanceof qe||o instanceof $i||o instanceof Ci||o instanceof wi||o instanceof Ni?o.toString():JSON.stringify(o)}class In{constructor(r,a){this.type=r,this.value=a}static parse(r,a){if(r.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!Pn(r[1]))return a.error("invalid value");const p=r[1];let m=Si(p);const _=a.expectedType;return m.kind!=="array"||m.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(m=_),new In(m,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class yi{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const Wn={string:De,number:Ht,boolean:Pe,object:Sr};class Zr{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");let p,m=1;const _=r[0];if(_==="array"){let w,T;if(r.length>2){const I=r[1];if(typeof I!="string"||!(I in Wn)||I==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);w=Wn[I],m++}else w=Me;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return a.error('The length argument to "array" must be a positive integer literal',2);T=r[2],m++}p=N(w,T)}else{if(!Wn[_])throw new Error(`Types doesn't contain name = ${_}`);p=Wn[_]}const x=[];for(;m<r.length;m++){const w=a.parse(r[m],m,Me);if(!w)return null;x.push(w)}return new Zr(p,x)}evaluate(r){for(let a=0;a<this.args.length;a++){const p=this.args[a].evaluate(r);if(!dt(this.type,Si(p)))return p;if(a===this.args.length-1)throw new yi(`Expected value to be of type ${G(this.type)}, but found ${G(Si(p))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const Js={"to-boolean":Pe,"to-color":wr,"to-number":Ht,"to-string":De};class qr{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");const p=r[0];if(!Js[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&r.length!==2)return a.error("Expected one argument.");const m=Js[p],_=[];for(let x=1;x<r.length;x++){const w=a.parse(r[x],x,Me);if(!w)return null;_.push(w)}return new qr(m,_)}evaluate(r){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(r);case"color":{let a,p;for(const m of this.args){if(a=m.evaluate(r),p=null,a instanceof qe)return a;if(typeof a=="string"){const _=r.parseColor(a);if(_)return _}else if(Array.isArray(a)&&(p=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Xa(a[0],a[1],a[2],a[3]),!p))return new qe(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new yi(p||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const p of this.args){a=p.evaluate(r);const m=Ci.parse(a);if(m)return m}throw new yi(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const p of this.args){a=p.evaluate(r);const m=wi.parse(a);if(m)return m}throw new yi(`Could not parse variableAnchorOffsetCollection from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const p of this.args){if(a=p.evaluate(r),a===null)return 0;const m=Number(a);if(!isNaN(m))return m}throw new yi(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return $i.fromString(kr(this.args[0].evaluate(r)));case"resolvedImage":return Ni.fromString(kr(this.args[0].evaluate(r)));default:return kr(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const An=["Unknown","Point","LineString","Polygon"];class Qs{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?An[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let a=this._parseColorCache[r];return a||(a=this._parseColorCache[r]=qe.parse(r)),a}}class Ge{constructor(r,a,p=[],m,_=new Un,x=[]){this.registry=r,this.path=p,this.key=p.map(w=>`[${w}]`).join(""),this.scope=_,this.errors=x,this.expectedType=m,this._isConstant=a}parse(r,a,p,m,_={}){return a?this.concat(a,p,m)._parse(r,_):this._parse(r,_)}_parse(r,a){function p(m,_,x){return x==="assert"?new Zr(_,[m]):x==="coerce"?new qr(_,[m]):m}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=r[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[m];if(_){let x=_.parse(r,this);if(!x)return null;if(this.expectedType){const w=this.expectedType,T=x.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||T.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string")if(w.kind!=="padding"||T.kind!=="value"&&T.kind!=="number"&&T.kind!=="array")if(w.kind!=="variableAnchorOffsetCollection"||T.kind!=="value"&&T.kind!=="array"){if(this.checkSubtype(w,T))return null}else x=p(x,w,a.typeAnnotation||"coerce");else x=p(x,w,a.typeAnnotation||"coerce");else x=p(x,w,a.typeAnnotation||"coerce");else x=p(x,w,a.typeAnnotation||"assert")}if(!(x instanceof In)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const w=new Qs;try{x=new In(x.type,x.evaluate(w))}catch(T){return this.error(T.message),null}}return x}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,a,p){const m=typeof r=="number"?this.path.concat(r):this.path,_=p?this.scope.concat(p):this.scope;return new Ge(this.registry,this._isConstant,m,a||null,_,this.errors)}error(r,...a){const p=`${this.key}${a.map(m=>`[${m}]`).join("")}`;this.errors.push(new br(p,r))}checkSubtype(r,a){const p=dt(r,a);return p&&this.error(p),p}}class to{constructor(r,a){this.type=a.type,this.bindings=[].concat(r),this.result=a}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const a of this.bindings)r(a[1]);r(this.result)}static parse(r,a){if(r.length<4)return a.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const p=[];for(let _=1;_<r.length-1;_+=2){const x=r[_];if(typeof x!="string")return a.error(`Expected string, but found ${typeof x} instead.`,_);if(/[^a-zA-Z0-9_]/.test(x))return a.error("Variable names must contain only alphanumeric characters or '_'.",_);const w=a.parse(r[_+1],_+1);if(!w)return null;p.push([x,w])}const m=a.parse(r[r.length-1],r.length-1,a.expectedType,p);return m?new to(p,m):null}outputDefined(){return this.result.outputDefined()}}class Ms{constructor(r,a){this.type=a.type,this.name=r,this.boundExpression=a}static parse(r,a){if(r.length!==2||typeof r[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const p=r[1];return a.scope.has(p)?new Ms(p,a.scope.get(p)):a.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class Ja{constructor(r,a,p){this.type=r,this.index=a,this.input=p}static parse(r,a){if(r.length!==3)return a.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const p=a.parse(r[1],1,Ht),m=a.parse(r[2],2,N(a.expectedType||Me));return p&&m?new Ja(m.type.itemType,p,m):null}evaluate(r){const a=this.index.evaluate(r),p=this.input.evaluate(r);if(a<0)throw new yi(`Array index out of bounds: ${a} < 0.`);if(a>=p.length)throw new yi(`Array index out of bounds: ${a} > ${p.length-1}.`);if(a!==Math.floor(a))throw new yi(`Array index must be an integer, but found ${a} instead.`);return p[a]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class Qo{constructor(r,a){this.type=Pe,this.needle=r,this.haystack=a}static parse(r,a){if(r.length!==3)return a.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const p=a.parse(r[1],1,Me),m=a.parse(r[2],2,Me);return p&&m?yt(p.type,[Pe,De,Ht,Hn,Me])?new Qo(p,m):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${G(p.type)} instead`):null}evaluate(r){const a=this.needle.evaluate(r),p=this.haystack.evaluate(r);if(!p)return!1;if(!bt(a,["boolean","string","number","null"]))throw new yi(`Expected first argument to be of type boolean, string, number or null, but found ${G(Si(a))} instead.`);if(!bt(p,["string","array"]))throw new yi(`Expected second argument to be of type array or string, but found ${G(Si(p))} instead.`);return p.indexOf(a)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class U{constructor(r,a,p){this.type=Ht,this.needle=r,this.haystack=a,this.fromIndex=p}static parse(r,a){if(r.length<=2||r.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const p=a.parse(r[1],1,Me),m=a.parse(r[2],2,Me);if(!p||!m)return null;if(!yt(p.type,[Pe,De,Ht,Hn,Me]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${G(p.type)} instead`);if(r.length===4){const _=a.parse(r[3],3,Ht);return _?new U(p,m,_):null}return new U(p,m)}evaluate(r){const a=this.needle.evaluate(r),p=this.haystack.evaluate(r);if(!bt(a,["boolean","string","number","null"]))throw new yi(`Expected first argument to be of type boolean, string, number or null, but found ${G(Si(a))} instead.`);if(!bt(p,["string","array"]))throw new yi(`Expected second argument to be of type array or string, but found ${G(Si(p))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(r);return p.indexOf(a,m)}return p.indexOf(a)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class Q{constructor(r,a,p,m,_,x){this.inputType=r,this.type=a,this.input=p,this.cases=m,this.outputs=_,this.otherwise=x}static parse(r,a){if(r.length<5)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return a.error("Expected an even number of arguments.");let p,m;a.expectedType&&a.expectedType.kind!=="value"&&(m=a.expectedType);const _={},x=[];for(let I=2;I<r.length-1;I+=2){let D=r[I];const L=r[I+1];Array.isArray(D)||(D=[D]);const O=a.concat(I);if(D.length===0)return O.error("Expected at least one branch label.");for(const q of D){if(typeof q!="number"&&typeof q!="string")return O.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return O.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return O.error("Numeric branch labels must be integer values.");if(p){if(O.checkSubtype(p,Si(q)))return null}else p=Si(q);if(_[String(q)]!==void 0)return O.error("Branch labels must be unique.");_[String(q)]=x.length}const j=a.parse(L,I,m);if(!j)return null;m=m||j.type,x.push(j)}const w=a.parse(r[1],1,Me);if(!w)return null;const T=a.parse(r[r.length-1],r.length-1,m);return T?w.type.kind!=="value"&&a.concat(1).checkSubtype(p,w.type)?null:new Q(p,m,w,_,x,T):null}evaluate(r){const a=this.input.evaluate(r);return(Si(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}}class ft{constructor(r,a,p){this.type=r,this.branches=a,this.otherwise=p}static parse(r,a){if(r.length<4)return a.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return a.error("Expected an odd number of arguments.");let p;a.expectedType&&a.expectedType.kind!=="value"&&(p=a.expectedType);const m=[];for(let x=1;x<r.length-1;x+=2){const w=a.parse(r[x],x,Pe);if(!w)return null;const T=a.parse(r[x+1],x+1,p);if(!T)return null;m.push([w,T]),p=p||T.type}const _=a.parse(r[r.length-1],r.length-1,p);if(!_)return null;if(!p)throw new Error("Can't infer output type");return new ft(p,m,_)}evaluate(r){for(const[a,p]of this.branches)if(a.evaluate(r))return p.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[a,p]of this.branches)r(a),r(p);r(this.otherwise)}outputDefined(){return this.branches.every(([r,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class Pt{constructor(r,a,p,m){this.type=r,this.input=a,this.beginIndex=p,this.endIndex=m}static parse(r,a){if(r.length<=2||r.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const p=a.parse(r[1],1,Me),m=a.parse(r[2],2,Ht);if(!p||!m)return null;if(!yt(p.type,[N(Me),De,Me]))return a.error(`Expected first argument to be of type array or string, but found ${G(p.type)} instead`);if(r.length===4){const _=a.parse(r[3],3,Ht);return _?new Pt(p.type,p,m,_):null}return new Pt(p.type,p,m)}evaluate(r){const a=this.input.evaluate(r),p=this.beginIndex.evaluate(r);if(!bt(a,["string","array"]))throw new yi(`Expected first argument to be of type array or string, but found ${G(Si(a))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(r);return a.slice(p,m)}return a.slice(p)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function Nt(o,r){const a=o.length-1;let p,m,_=0,x=a,w=0;for(;_<=x;)if(w=Math.floor((_+x)/2),p=o[w],m=o[w+1],p<=r){if(w===a||r<m)return w;_=w+1}else{if(!(p>r))throw new yi("Input is not a number.");x=w-1}return 0}class xe{constructor(r,a,p){this.type=r,this.input=a,this.labels=[],this.outputs=[];for(const[m,_]of p)this.labels.push(m),this.outputs.push(_)}static parse(r,a){if(r.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");const p=a.parse(r[1],1,Ht);if(!p)return null;const m=[];let _=null;a.expectedType&&a.expectedType.kind!=="value"&&(_=a.expectedType);for(let x=1;x<r.length;x+=2){const w=x===1?-1/0:r[x],T=r[x+1],I=x,D=x+1;if(typeof w!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(m.length&&m[m.length-1][0]>=w)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const L=a.parse(T,D,_);if(!L)return null;_=_||L.type,m.push([w,L])}return new xe(_,p,m)}evaluate(r){const a=this.labels,p=this.outputs;if(a.length===1)return p[0].evaluate(r);const m=this.input.evaluate(r);if(m<=a[0])return p[0].evaluate(r);const _=a.length;return m>=a[_-1]?p[_-1].evaluate(r):p[Nt(a,m)].evaluate(r)}eachChild(r){r(this.input);for(const a of this.outputs)r(a)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function He(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var ki=Gr;function Gr(o,r,a,p){this.cx=3*o,this.bx=3*(a-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(p-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=r,this.p2x=a,this.p2y=p}Gr.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,r){if(r===void 0&&(r=1e-6),o<0)return 0;if(o>1)return 1;for(var a=o,p=0;p<8;p++){var m=this.sampleCurveX(a)-o;if(Math.abs(m)<r)return a;var _=this.sampleCurveDerivativeX(a);if(Math.abs(_)<1e-6)break;a-=m/_}var x=0,w=1;for(a=o,p=0;p<20&&(m=this.sampleCurveX(a),!(Math.abs(m-o)<r));p++)o>m?x=a:w=a,a=.5*(w-x)+x;return a},solve:function(o,r){return this.sampleCurveY(this.solveCurveX(o,r))}};var Ar=He(ki);function fr(o,r,a){return o+a*(r-o)}function ql(o,r,a){return o.map((p,m)=>fr(p,r[m],a))}const Wr={number:fr,color:function(o,r,a,p="rgb"){switch(p){case"rgb":{const[m,_,x,w]=ql(o.rgb,r.rgb,a);return new qe(m,_,x,w,!1)}case"hcl":{const[m,_,x,w]=o.hcl,[T,I,D,L]=r.hcl;let O,j;if(isNaN(m)||isNaN(T))isNaN(m)?isNaN(T)?O=NaN:(O=T,x!==1&&x!==0||(j=I)):(O=m,D!==1&&D!==0||(j=_));else{let wt=T-m;T>m&&wt>180?wt-=360:T<m&&m-T>180&&(wt+=360),O=m+a*wt}const[q,J,it,ct]=function([wt,pt,vt,zt]){return wt=isNaN(wt)?0:wt*Fe,Ie([vt,Math.cos(wt)*pt,Math.sin(wt)*pt,zt])}([O,j??fr(_,I,a),fr(x,D,a),fr(w,L,a)]);return new qe(q,J,it,ct,!1)}case"lab":{const[m,_,x,w]=Ie(ql(o.lab,r.lab,a));return new qe(m,_,x,w,!1)}}},array:ql,padding:function(o,r,a){return new Ci(ql(o.values,r.values,a))},variableAnchorOffsetCollection:function(o,r,a){const p=o.values,m=r.values;if(p.length!==m.length)throw new yi(`Cannot interpolate values of different length. from: ${o.toString()}, to: ${r.toString()}`);const _=[];for(let x=0;x<p.length;x+=2){if(p[x]!==m[x])throw new yi(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${p[x]}, to[${x}]: ${m[x]}`);_.push(p[x]);const[w,T]=p[x+1],[I,D]=m[x+1];_.push([fr(w,I,a),fr(T,D,a)])}return new wi(_)}};class yn{constructor(r,a,p,m,_){this.type=r,this.operator=a,this.interpolation=p,this.input=m,this.labels=[],this.outputs=[];for(const[x,w]of _)this.labels.push(x),this.outputs.push(w)}static interpolationFactor(r,a,p,m){let _=0;if(r.name==="exponential")_=vu(a,r.base,p,m);else if(r.name==="linear")_=vu(a,1,p,m);else if(r.name==="cubic-bezier"){const x=r.controlPoints;_=new Ar(x[0],x[1],x[2],x[3]).solve(vu(a,1,p,m))}return _}static parse(r,a){let[p,m,_,...x]=r;if(!Array.isArray(m)||m.length===0)return a.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const I=m[1];if(typeof I!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:I}}else{if(m[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const I=m.slice(1);if(I.length!==4||I.some(D=>typeof D!="number"||D<0||D>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:I}}}if(r.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(_=a.parse(_,2,Ht),!_)return null;const w=[];let T=null;p==="interpolate-hcl"||p==="interpolate-lab"?T=wr:a.expectedType&&a.expectedType.kind!=="value"&&(T=a.expectedType);for(let I=0;I<x.length;I+=2){const D=x[I],L=x[I+1],O=I+3,j=I+4;if(typeof D!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(w.length&&w[w.length-1][0]>=D)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',O);const q=a.parse(L,j,T);if(!q)return null;T=T||q.type,w.push([D,q])}return ht(T,Ht)||ht(T,wr)||ht(T,qi)||ht(T,B)||ht(T,N(Ht))?new yn(T,p,m,_,w):a.error(`Type ${G(T)} is not interpolatable.`)}evaluate(r){const a=this.labels,p=this.outputs;if(a.length===1)return p[0].evaluate(r);const m=this.input.evaluate(r);if(m<=a[0])return p[0].evaluate(r);const _=a.length;if(m>=a[_-1])return p[_-1].evaluate(r);const x=Nt(a,m),w=yn.interpolationFactor(this.interpolation,m,a[x],a[x+1]),T=p[x].evaluate(r),I=p[x+1].evaluate(r);switch(this.operator){case"interpolate":return Wr[this.type.kind](T,I,w);case"interpolate-hcl":return Wr.color(T,I,w,"hcl");case"interpolate-lab":return Wr.color(T,I,w,"lab")}}eachChild(r){r(this.input);for(const a of this.outputs)r(a)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function vu(o,r,a,p){const m=p-a,_=o-a;return m===0?0:r===1?_/m:(Math.pow(r,_)-1)/(Math.pow(r,m)-1)}class Gl{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expectected at least one argument.");let p=null;const m=a.expectedType;m&&m.kind!=="value"&&(p=m);const _=[];for(const w of r.slice(1)){const T=a.parse(w,1+_.length,p,void 0,{typeAnnotation:"omit"});if(!T)return null;p=p||T.type,_.push(T)}if(!p)throw new Error("No output type");const x=m&&_.some(w=>dt(m,w.type));return new Gl(x?Me:p,_)}evaluate(r){let a,p=null,m=0;for(const _ of this.args)if(m++,p=_.evaluate(r),p&&p instanceof Ni&&!p.available&&(a||(a=p.name),p=null,m===this.args.length&&(p=a)),p!==null)break;return p}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}function xu(o,r){return o==="=="||o==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function bu(o,r,a,p){return p.compare(r,a)===0}function ta(o,r,a){const p=o!=="=="&&o!=="!=";return class Q9{constructor(_,x,w){this.type=Pe,this.lhs=_,this.rhs=x,this.collator=w,this.hasUntypedArgument=_.type.kind==="value"||x.type.kind==="value"}static parse(_,x){if(_.length!==3&&_.length!==4)return x.error("Expected two or three arguments.");const w=_[0];let T=x.parse(_[1],1,Me);if(!T)return null;if(!xu(w,T.type))return x.concat(1).error(`"${w}" comparisons are not supported for type '${G(T.type)}'.`);let I=x.parse(_[2],2,Me);if(!I)return null;if(!xu(w,I.type))return x.concat(2).error(`"${w}" comparisons are not supported for type '${G(I.type)}'.`);if(T.type.kind!==I.type.kind&&T.type.kind!=="value"&&I.type.kind!=="value")return x.error(`Cannot compare types '${G(T.type)}' and '${G(I.type)}'.`);p&&(T.type.kind==="value"&&I.type.kind!=="value"?T=new Zr(I.type,[T]):T.type.kind!=="value"&&I.type.kind==="value"&&(I=new Zr(T.type,[I])));let D=null;if(_.length===4){if(T.type.kind!=="string"&&I.type.kind!=="string"&&T.type.kind!=="value"&&I.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(D=x.parse(_[3],3,Zn),!D)return null}return new Q9(T,I,D)}evaluate(_){const x=this.lhs.evaluate(_),w=this.rhs.evaluate(_);if(p&&this.hasUntypedArgument){const T=Si(x),I=Si(w);if(T.kind!==I.kind||T.kind!=="string"&&T.kind!=="number")throw new yi(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${T.kind}, ${I.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const T=Si(x),I=Si(w);if(T.kind!=="string"||I.kind!=="string")return r(_,x,w)}return this.collator?a(_,x,w,this.collator.evaluate(_)):r(_,x,w)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const rg=ta("==",function(o,r,a){return r===a},bu),qd=ta("!=",function(o,r,a){return r!==a},function(o,r,a,p){return!bu(0,r,a,p)}),Gd=ta("<",function(o,r,a){return r<a},function(o,r,a,p){return p.compare(r,a)<0}),ng=ta(">",function(o,r,a){return r>a},function(o,r,a,p){return p.compare(r,a)>0}),sg=ta("<=",function(o,r,a){return r<=a},function(o,r,a,p){return p.compare(r,a)<=0}),og=ta(">=",function(o,r,a){return r>=a},function(o,r,a,p){return p.compare(r,a)>=0});class Wl{constructor(r,a,p){this.type=Zn,this.locale=p,this.caseSensitive=r,this.diacriticSensitive=a}static parse(r,a){if(r.length!==2)return a.error("Expected one argument.");const p=r[1];if(typeof p!="object"||Array.isArray(p))return a.error("Collator options argument must be an object.");const m=a.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,Pe);if(!m)return null;const _=a.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,Pe);if(!_)return null;let x=null;return p.locale&&(x=a.parse(p.locale,1,De),!x)?null:new Wl(m,_,x)}evaluate(r){return new Ir(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}class wu{constructor(r,a,p,m,_){this.type=De,this.number=r,this.locale=a,this.currency=p,this.minFractionDigits=m,this.maxFractionDigits=_}static parse(r,a){if(r.length!==3)return a.error("Expected two arguments.");const p=a.parse(r[1],1,Ht);if(!p)return null;const m=r[2];if(typeof m!="object"||Array.isArray(m))return a.error("NumberFormat options argument must be an object.");let _=null;if(m.locale&&(_=a.parse(m.locale,1,De),!_))return null;let x=null;if(m.currency&&(x=a.parse(m.currency,1,De),!x))return null;let w=null;if(m["min-fraction-digits"]&&(w=a.parse(m["min-fraction-digits"],1,Ht),!w))return null;let T=null;return m["max-fraction-digits"]&&(T=a.parse(m["max-fraction-digits"],1,Ht),!T)?null:new wu(p,_,x,w,T)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class Yl{constructor(r){this.type=qn,this.sections=r}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");const p=r[1];if(!Array.isArray(p)&&typeof p=="object")return a.error("First argument must be an image or text section.");const m=[];let _=!1;for(let x=1;x<=r.length-1;++x){const w=r[x];if(_&&typeof w=="object"&&!Array.isArray(w)){_=!1;let T=null;if(w["font-scale"]&&(T=a.parse(w["font-scale"],1,Ht),!T))return null;let I=null;if(w["text-font"]&&(I=a.parse(w["text-font"],1,N(De)),!I))return null;let D=null;if(w["text-color"]&&(D=a.parse(w["text-color"],1,wr),!D))return null;const L=m[m.length-1];L.scale=T,L.font=I,L.textColor=D}else{const T=a.parse(r[x],1,Me);if(!T)return null;const I=T.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,m.push({content:T,scale:null,font:null,textColor:null})}}return new Yl(m)}evaluate(r){return new $i(this.sections.map(a=>{const p=a.content.evaluate(r);return Si(p)===rt?new ds("",p,null,null,null):new ds(kr(p),null,a.scale?a.scale.evaluate(r):null,a.font?a.font.evaluate(r).join(","):null,a.textColor?a.textColor.evaluate(r):null)}))}eachChild(r){for(const a of this.sections)r(a.content),a.scale&&r(a.scale),a.font&&r(a.font),a.textColor&&r(a.textColor)}outputDefined(){return!1}}class Su{constructor(r){this.type=rt,this.input=r}static parse(r,a){if(r.length!==2)return a.error("Expected two arguments.");const p=a.parse(r[1],1,De);return p?new Su(p):a.error("No image name provided.")}evaluate(r){const a=this.input.evaluate(r),p=Ni.fromString(a);return p&&r.availableImages&&(p.available=r.availableImages.indexOf(a)>-1),p}eachChild(r){r(this.input)}outputDefined(){return!1}}class Qa{constructor(r){this.type=Ht,this.input=r}static parse(r,a){if(r.length!==2)return a.error(`Expected 1 argument, but found ${r.length-1} instead.`);const p=a.parse(r[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${G(p.type)} instead.`):new Qa(p):null}evaluate(r){const a=this.input.evaluate(r);if(typeof a=="string"||Array.isArray(a))return a.length;throw new yi(`Expected value to be of type string or array, but found ${G(Si(a))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const _n=8192;function ri(o,r){const a=(180+o[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,m=Math.pow(2,r.z);return[Math.round(a*m*_n),Math.round(p*m*_n)]}function ku(o,r){const a=Math.pow(2,r.z);return[(m=(o[0]/_n+r.x)/a,360*m-180),(p=(o[1]/_n+r.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90)];var p,m}function tl(o,r){o[0]=Math.min(o[0],r[0]),o[1]=Math.min(o[1],r[1]),o[2]=Math.max(o[2],r[0]),o[3]=Math.max(o[3],r[1])}function el(o,r){return!(o[0]<=r[0]||o[2]>=r[2]||o[1]<=r[1]||o[3]>=r[3])}function ag(o,r,a){const p=o[0]-r[0],m=o[1]-r[1],_=o[0]-a[0],x=o[1]-a[1];return p*x-_*m==0&&p*_<=0&&m*x<=0}function Kl(o,r,a,p){return(m=[p[0]-a[0],p[1]-a[1]])[0]*(_=[r[0]-o[0],r[1]-o[1]])[1]-m[1]*_[0]!=0&&!(!Yd(o,r,a,p)||!Yd(a,p,o,r));var m,_}function lg(o,r,a){for(const p of a)for(let m=0;m<p.length-1;++m)if(Kl(o,r,p[m],p[m+1]))return!0;return!1}function ea(o,r,a=!1){let p=!1;for(const w of r)for(let T=0;T<w.length-1;T++){if(ag(o,w[T],w[T+1]))return a;(_=w[T])[1]>(m=o)[1]!=(x=w[T+1])[1]>m[1]&&m[0]<(x[0]-_[0])*(m[1]-_[1])/(x[1]-_[1])+_[0]&&(p=!p)}var m,_,x;return p}function cg(o,r){for(const a of r)if(ea(o,a))return!0;return!1}function Wd(o,r){for(const a of o)if(!ea(a,r))return!1;for(let a=0;a<o.length-1;++a)if(lg(o[a],o[a+1],r))return!1;return!0}function ug(o,r){for(const a of r)if(Wd(o,a))return!0;return!1}function Yd(o,r,a,p){const m=p[0]-a[0],_=p[1]-a[1],x=(o[0]-a[0])*_-m*(o[1]-a[1]),w=(r[0]-a[0])*_-m*(r[1]-a[1]);return x>0&&w<0||x<0&&w>0}function Tu(o,r,a){const p=[];for(let m=0;m<o.length;m++){const _=[];for(let x=0;x<o[m].length;x++){const w=ri(o[m][x],a);tl(r,w),_.push(w)}p.push(_)}return p}function Kd(o,r,a){const p=[];for(let m=0;m<o.length;m++){const _=Tu(o[m],r,a);p.push(_)}return p}function Xd(o,r,a,p){if(o[0]<a[0]||o[0]>a[2]){const m=.5*p;let _=o[0]-a[0]>m?-p:a[0]-o[0]>m?p:0;_===0&&(_=o[0]-a[2]>m?-p:a[2]-o[0]>m?p:0),o[0]+=_}tl(r,o)}function Jd(o,r,a,p){const m=Math.pow(2,p.z)*_n,_=[p.x*_n,p.y*_n],x=[];for(const w of o)for(const T of w){const I=[T.x+_[0],T.y+_[1]];Xd(I,r,a,m),x.push(I)}return x}function Qd(o,r,a,p){const m=Math.pow(2,p.z)*_n,_=[p.x*_n,p.y*_n],x=[];for(const T of o){const I=[];for(const D of T){const L=[D.x+_[0],D.y+_[1]];tl(r,L),I.push(L)}x.push(I)}if(r[2]-r[0]<=m/2){(w=r)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const T of x)for(const I of T)Xd(I,r,a,m)}var w;return x}class bo{constructor(r,a){this.type=Pe,this.geojson=r,this.geometries=a}static parse(r,a){if(r.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Pn(r[1])){const p=r[1];if(p.type==="FeatureCollection"){const m=[];for(const _ of p.features){const{type:x,coordinates:w}=_.geometry;x==="Polygon"&&m.push(w),x==="MultiPolygon"&&m.push(...w)}if(m.length)return new bo(p,{type:"MultiPolygon",coordinates:m})}else if(p.type==="Feature"){const m=p.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new bo(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new bo(p,p)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(a,p){const m=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=a.canonicalID();if(p.type==="Polygon"){const w=Tu(p.coordinates,_,x),T=Jd(a.geometry(),m,_,x);if(!el(m,_))return!1;for(const I of T)if(!ea(I,w))return!1}if(p.type==="MultiPolygon"){const w=Kd(p.coordinates,_,x),T=Jd(a.geometry(),m,_,x);if(!el(m,_))return!1;for(const I of T)if(!cg(I,w))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(a,p){const m=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=a.canonicalID();if(p.type==="Polygon"){const w=Tu(p.coordinates,_,x),T=Qd(a.geometry(),m,_,x);if(!el(m,_))return!1;for(const I of T)if(!Wd(I,w))return!1}if(p.type==="MultiPolygon"){const w=Kd(p.coordinates,_,x),T=Qd(a.geometry(),m,_,x);if(!el(m,_))return!1;for(const I of T)if(!ug(I,w))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let tp=class{constructor(o=[],r=hg){if(this.data=o,this.length=this.data.length,this.compare=r,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(o){this.data.push(o),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const o=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:r,compare:a}=this,p=r[o];for(;o>0;){const m=o-1>>1,_=r[m];if(a(p,_)>=0)break;r[o]=_,o=m}r[o]=p}_down(o){const{data:r,compare:a}=this,p=this.length>>1,m=r[o];for(;o<p;){let _=1+(o<<1),x=r[_];const w=_+1;if(w<this.length&&a(r[w],x)<0&&(_=w,x=r[w]),a(x,m)>=0)break;r[o]=x,o=_}r[o]=m}};function hg(o,r){return o<r?-1:o>r?1:0}function dg(o,r,a,p,m){ep(o,r,a,p||o.length-1,m||pg)}function ep(o,r,a,p,m){for(;p>a;){if(p-a>600){var _=p-a+1,x=r-a+1,w=Math.log(_),T=.5*Math.exp(2*w/3),I=.5*Math.sqrt(w*T*(_-T)/_)*(x-_/2<0?-1:1);ep(o,r,Math.max(a,Math.floor(r-x*T/_+I)),Math.min(p,Math.floor(r+(_-x)*T/_+I)),m)}var D=o[r],L=a,O=p;for(il(o,a,r),m(o[p],D)>0&&il(o,a,p);L<O;){for(il(o,L,O),L++,O--;m(o[L],D)<0;)L++;for(;m(o[O],D)>0;)O--}m(o[a],D)===0?il(o,a,O):il(o,++O,p),O<=r&&(a=O+1),r<=O&&(p=O-1)}}function il(o,r,a){var p=o[r];o[r]=o[a],o[a]=p}function pg(o,r){return o<r?-1:o>r?1:0}function Xl(o,r){if(o.length<=1)return[o];const a=[];let p,m;for(const _ of o){const x=mg(_);x!==0&&(_.area=Math.abs(x),m===void 0&&(m=x<0),m===x<0?(p&&a.push(p),p=[_]):p.push(_))}if(p&&a.push(p),r>1)for(let _=0;_<a.length;_++)a[_].length<=r||(dg(a[_],r,1,a[_].length-1,fg),a[_]=a[_].slice(0,r));return a}function fg(o,r){return r.area-o.area}function mg(o){let r=0;for(let a,p,m=0,_=o.length,x=_-1;m<_;x=m++)a=o[m],p=o[x],r+=(p.x-a.x)*(a.y+p.y);return r}const ip=1/298.257223563,rp=ip*(2-ip),np=Math.PI/180;class Mu{constructor(r){const a=6378.137*np*1e3,p=Math.cos(r*np),m=1/(1-rp*(1-p*p)),_=Math.sqrt(m);this.kx=a*_*p,this.ky=a*_*m*(1-rp)}distance(r,a){const p=this.wrap(r[0]-a[0])*this.kx,m=(r[1]-a[1])*this.ky;return Math.sqrt(p*p+m*m)}pointOnLine(r,a){let p,m,_,x,w=1/0;for(let T=0;T<r.length-1;T++){let I=r[T][0],D=r[T][1],L=this.wrap(r[T+1][0]-I)*this.kx,O=(r[T+1][1]-D)*this.ky,j=0;L===0&&O===0||(j=(this.wrap(a[0]-I)*this.kx*L+(a[1]-D)*this.ky*O)/(L*L+O*O),j>1?(I=r[T+1][0],D=r[T+1][1]):j>0&&(I+=L/this.kx*j,D+=O/this.ky*j)),L=this.wrap(a[0]-I)*this.kx,O=(a[1]-D)*this.ky;const q=L*L+O*O;q<w&&(w=q,p=I,m=D,_=T,x=j)}return{point:[p,m],index:_,t:Math.max(0,Math.min(1,x))}}wrap(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}}function sp(o,r){return r[0]-o[0]}function ia(o){return o[1]-o[0]+1}function Cs(o,r){return o[1]>=o[0]&&o[1]<r}function Cu(o,r){if(o[0]>o[1])return[null,null];const a=ia(o);if(r){if(a===2)return[o,null];const m=Math.floor(a/2);return[[o[0],o[0]+m],[o[0]+m,o[1]]]}if(a===1)return[o,null];const p=Math.floor(a/2)-1;return[[o[0],o[0]+p],[o[0]+p+1,o[1]]]}function Eu(o,r){if(!Cs(r,o.length))return[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0];for(let p=r[0];p<=r[1];++p)tl(a,o[p]);return a}function Pu(o){const r=[1/0,1/0,-1/0,-1/0];for(const a of o)for(const p of a)tl(r,p);return r}function ji(o){return o[0]!==-1/0&&o[1]!==-1/0&&o[2]!==1/0&&o[3]!==1/0}function Iu(o,r,a){if(!ji(o)||!ji(r))return NaN;let p=0,m=0;return o[2]<r[0]&&(p=r[0]-o[2]),o[0]>r[2]&&(p=o[0]-r[2]),o[1]>r[3]&&(m=o[1]-r[3]),o[3]<r[1]&&(m=r[1]-o[3]),a.distance([0,0],[p,m])}function Oe(o,r,a){const p=a.pointOnLine(r,o);return a.distance(o,p.point)}function rl(o,r,a,p,m){const _=Math.min(Oe(o,[a,p],m),Oe(r,[a,p],m)),x=Math.min(Oe(a,[o,r],m),Oe(p,[o,r],m));return Math.min(_,x)}function Ei(o,r,a,p,m){if(!Cs(r,o.length)||!Cs(p,a.length))return 1/0;let _=1/0;for(let x=r[0];x<r[1];++x){const w=o[x],T=o[x+1];for(let I=p[0];I<p[1];++I){const D=a[I],L=a[I+1];if(Kl(w,T,D,L))return 0;_=Math.min(_,rl(w,T,D,L,m))}}return _}function Ti(o,r,a,p,m){if(!Cs(r,o.length)||!Cs(p,a.length))return NaN;let _=1/0;for(let x=r[0];x<=r[1];++x)for(let w=p[0];w<=p[1];++w)if(_=Math.min(_,m.distance(o[x],a[w])),_===0)return _;return _}function Jl(o,r,a){if(ea(o,r,!0))return 0;let p=1/0;for(const m of r){const _=m[0],x=m[m.length-1];if(_!==x&&(p=Math.min(p,Oe(o,[x,_],a)),p===0))return p;const w=a.pointOnLine(m,o);if(p=Math.min(p,a.distance(o,w.point)),p===0)return p}return p}function op(o,r,a,p){if(!Cs(r,o.length))return NaN;for(let _=r[0];_<=r[1];++_)if(ea(o[_],a,!0))return 0;let m=1/0;for(let _=r[0];_<r[1];++_){const x=o[_],w=o[_+1];for(const T of a)for(let I=0,D=T.length,L=D-1;I<D;L=I++){const O=T[L],j=T[I];if(Kl(x,w,O,j))return 0;m=Math.min(m,rl(x,w,O,j,p))}}return m}function Au(o,r){for(const a of o)for(const p of a)if(ea(p,r,!0))return!0;return!1}function gg(o,r,a,p=1/0){const m=Pu(o),_=Pu(r);if(p!==1/0&&Iu(m,_,a)>=p)return p;if(el(m,_)){if(Au(o,r))return 0}else if(Au(r,o))return 0;let x=1/0;for(const w of o)for(let T=0,I=w.length,D=I-1;T<I;D=T++){const L=w[D],O=w[T];for(const j of r)for(let q=0,J=j.length,it=J-1;q<J;it=q++){const ct=j[it],wt=j[q];if(Kl(L,O,ct,wt))return 0;x=Math.min(x,rl(L,O,ct,wt,a))}}return x}function ap(o,r,a,p,m,_){if(!_)return;const x=Iu(Eu(p,_),m,a);x<r&&o.push([x,_,[0,0]])}function Ql(o,r,a,p,m,_,x){if(!_||!x)return;const w=Iu(Eu(p,_),Eu(m,x),a);w<r&&o.push([w,_,x])}function tc(o,r,a,p,m=1/0){let _=Math.min(p.distance(o[0],a[0][0]),m);if(_===0)return _;const x=new tp([[0,[0,o.length-1],[0,0]]],sp),w=Pu(a);for(;x.length>0;){const T=x.pop();if(T[0]>=_)continue;const I=T[1],D=r?50:100;if(ia(I)<=D){if(!Cs(I,o.length))return NaN;if(r){const L=op(o,I,a,p);if(isNaN(L)||L===0)return L;_=Math.min(_,L)}else for(let L=I[0];L<=I[1];++L){const O=Jl(o[L],a,p);if(_=Math.min(_,O),_===0)return 0}}else{const L=Cu(I,r);ap(x,_,p,o,w,L[0]),ap(x,_,p,o,w,L[1])}}return _}function nl(o,r,a,p,m,_=1/0){let x=Math.min(_,m.distance(o[0],a[0]));if(x===0)return x;const w=new tp([[0,[0,o.length-1],[0,a.length-1]]],sp);for(;w.length>0;){const T=w.pop();if(T[0]>=x)continue;const I=T[1],D=T[2],L=r?50:100,O=p?50:100;if(ia(I)<=L&&ia(D)<=O){if(!Cs(I,o.length)&&Cs(D,a.length))return NaN;let j;if(r&&p)j=Ei(o,I,a,D,m),x=Math.min(x,j);else if(r&&!p){const q=o.slice(I[0],I[1]+1);for(let J=D[0];J<=D[1];++J)if(j=Oe(a[J],q,m),x=Math.min(x,j),x===0)return x}else if(!r&&p){const q=a.slice(D[0],D[1]+1);for(let J=I[0];J<=I[1];++J)if(j=Oe(o[J],q,m),x=Math.min(x,j),x===0)return x}else j=Ti(o,I,a,D,m),x=Math.min(x,j)}else{const j=Cu(I,r),q=Cu(D,p);Ql(w,x,m,o,a,j[0],q[0]),Ql(w,x,m,o,a,j[0],q[1]),Ql(w,x,m,o,a,j[1],q[0]),Ql(w,x,m,o,a,j[1],q[1])}}return x}function ec(o){return o.type==="MultiPolygon"?o.coordinates.map(r=>({type:"Polygon",coordinates:r})):o.type==="MultiLineString"?o.coordinates.map(r=>({type:"LineString",coordinates:r})):o.type==="MultiPoint"?o.coordinates.map(r=>({type:"Point",coordinates:r})):[o]}class eo{constructor(r,a){this.type=Ht,this.geojson=r,this.geometries=a}static parse(r,a){if(r.length!==2)return a.error(`'distance' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Pn(r[1])){const p=r[1];if(p.type==="FeatureCollection")return new eo(p,p.features.map(m=>ec(m.geometry)).flat());if(p.type==="Feature")return new eo(p,ec(p.geometry));if("type"in p&&"coordinates"in p)return new eo(p,ec(p))}return a.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(a,p){const m=a.geometry(),_=m.flat().map(T=>ku([T.x,T.y],a.canonical));if(m.length===0)return NaN;const x=new Mu(_[0][1]);let w=1/0;for(const T of p){switch(T.type){case"Point":w=Math.min(w,nl(_,!1,[T.coordinates],!1,x,w));break;case"LineString":w=Math.min(w,nl(_,!1,T.coordinates,!0,x,w));break;case"Polygon":w=Math.min(w,tc(_,!1,T.coordinates,x,w))}if(w===0)return w}return w}(r,this.geometries);if(r.geometryType()==="LineString")return function(a,p){const m=a.geometry(),_=m.flat().map(T=>ku([T.x,T.y],a.canonical));if(m.length===0)return NaN;const x=new Mu(_[0][1]);let w=1/0;for(const T of p){switch(T.type){case"Point":w=Math.min(w,nl(_,!0,[T.coordinates],!1,x,w));break;case"LineString":w=Math.min(w,nl(_,!0,T.coordinates,!0,x,w));break;case"Polygon":w=Math.min(w,tc(_,!0,T.coordinates,x,w))}if(w===0)return w}return w}(r,this.geometries);if(r.geometryType()==="Polygon")return function(a,p){const m=a.geometry();if(m.length===0||m[0].length===0)return NaN;const _=Xl(m,0).map(T=>T.map(I=>I.map(D=>ku([D.x,D.y],a.canonical)))),x=new Mu(_[0][0][0][1]);let w=1/0;for(const T of p)for(const I of _){switch(T.type){case"Point":w=Math.min(w,tc([T.coordinates],!1,I,x,w));break;case"LineString":w=Math.min(w,tc(T.coordinates,!0,I,x,w));break;case"Polygon":w=Math.min(w,gg(I,T.coordinates,x,w))}if(w===0)return w}return w}(r,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const wo={"==":rg,"!=":qd,">":ng,"<":Gd,">=":og,"<=":sg,array:Zr,at:Ja,boolean:Zr,case:ft,coalesce:Gl,collator:Wl,format:Yl,image:Su,in:Qo,"index-of":U,interpolate:yn,"interpolate-hcl":yn,"interpolate-lab":yn,length:Qa,let:to,literal:In,match:Q,number:Zr,"number-format":wu,object:Zr,slice:Pt,step:xe,string:Zr,"to-boolean":qr,"to-color":qr,"to-number":qr,"to-string":qr,var:Ms,within:bo,distance:eo};class sn{constructor(r,a,p,m){this.name=r,this.type=a,this._evaluate=p,this.args=m}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,a){const p=r[0],m=sn.definitions[p];if(!m)return a.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(m)?m[0]:m.type,x=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,w=x.filter(([I])=>!Array.isArray(I)||I.length===r.length-1);let T=null;for(const[I,D]of w){T=new Ge(a.registry,ic,a.path,null,a.scope);const L=[];let O=!1;for(let j=1;j<r.length;j++){const q=r[j],J=Array.isArray(I)?I[j-1]:I.type,it=T.parse(q,1+L.length,J);if(!it){O=!0;break}L.push(it)}if(!O)if(Array.isArray(I)&&I.length!==L.length)T.error(`Expected ${I.length} arguments, but found ${L.length} instead.`);else{for(let j=0;j<L.length;j++){const q=Array.isArray(I)?I[j]:I.type,J=L[j];T.concat(j+1).checkSubtype(q,J.type)}if(T.errors.length===0)return new sn(p,_,D,L)}}if(w.length===1)a.errors.push(...T.errors);else{const I=(w.length?w:x).map(([L])=>{return O=L,Array.isArray(O)?`(${O.map(G).join(", ")})`:`(${G(O.type)}...)`;var O}).join(" | "),D=[];for(let L=1;L<r.length;L++){const O=a.parse(r[L],1+D.length);if(!O)return null;D.push(G(O.type))}a.error(`Expected arguments of type ${I}, but found (${D.join(", ")}) instead.`)}return null}static register(r,a){sn.definitions=a;for(const p in a)r[p]=sn}}function lp(o,[r,a,p,m]){r=r.evaluate(o),a=a.evaluate(o),p=p.evaluate(o);const _=m?m.evaluate(o):1,x=Xa(r,a,p,_);if(x)throw new yi(x);return new qe(r/255,a/255,p/255,_,!1)}function cp(o,r){return o in r}function zu(o,r){const a=r[o];return a===void 0?null:a}function So(o){return{type:o}}function ic(o){if(o instanceof Ms)return ic(o.boundExpression);if(o instanceof sn&&o.name==="error"||o instanceof Wl||o instanceof bo||o instanceof eo)return!1;const r=o instanceof qr||o instanceof Zr;let a=!0;return o.eachChild(p=>{a=r?a&&ic(p):a&&p instanceof In}),!!a&&rc(o)&&nc(o,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function rc(o){if(o instanceof sn&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof bo||o instanceof eo)return!1;let r=!0;return o.eachChild(a=>{r&&!rc(a)&&(r=!1)}),r}function sl(o){if(o instanceof sn&&o.name==="feature-state")return!1;let r=!0;return o.eachChild(a=>{r&&!sl(a)&&(r=!1)}),r}function nc(o,r){if(o instanceof sn&&r.indexOf(o.name)>=0)return!1;let a=!0;return o.eachChild(p=>{a&&!nc(p,r)&&(a=!1)}),a}function Du(o){return{result:"success",value:o}}function ko(o){return{result:"error",value:o}}function Es(o){return o["property-type"]==="data-driven"||o["property-type"]==="cross-faded-data-driven"}function up(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function sc(o){return!!o.expression&&o.expression.interpolated}function Je(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function ra(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)}function oc(o){return o}function ol(o,r){const a=r.type==="color",p=o.stops&&typeof o.stops[0][0]=="object",m=p||!(p||o.property!==void 0),_=o.type||(sc(r)?"exponential":"interval");if(a||r.type==="padding"){const D=a?qe.parse:Ci.parse;(o=xr({},o)).stops&&(o.stops=o.stops.map(L=>[L[0],D(L[1])])),o.default=D(o.default?o.default:r.default)}if(o.colorSpace&&(x=o.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${o.colorSpace}"`);var x;let w,T,I;if(_==="exponential")w=Ru;else if(_==="interval")w=hp;else if(_==="categorical"){w=Lu,T=Object.create(null);for(const D of o.stops)T[D[0]]=D[1];I=typeof o.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);w=ac}if(p){const D={},L=[];for(let q=0;q<o.stops.length;q++){const J=o.stops[q],it=J[0].zoom;D[it]===void 0&&(D[it]={zoom:it,type:o.type,property:o.property,default:o.default,stops:[]},L.push(it)),D[it].stops.push([J[0].value,J[1]])}const O=[];for(const q of L)O.push([D[q].zoom,ol(D[q],r)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:yn.interpolationFactor.bind(void 0,j),zoomStops:O.map(q=>q[0]),evaluate:({zoom:q},J)=>Ru({stops:O,base:o.base},r,q).evaluate(q,J)}}if(m){const D=_==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:yn.interpolationFactor.bind(void 0,D),zoomStops:o.stops.map(L=>L[0]),evaluate:({zoom:L})=>w(o,r,L,T,I)}}return{kind:"source",evaluate(D,L){const O=L&&L.properties?L.properties[o.property]:void 0;return O===void 0?na(o.default,r.default):w(o,r,O,T,I)}}}function na(o,r,a){return o!==void 0?o:r!==void 0?r:a!==void 0?a:void 0}function Lu(o,r,a,p,m){return na(typeof a===m?p[a]:void 0,o.default,r.default)}function hp(o,r,a){if(Je(a)!=="number")return na(o.default,r.default);const p=o.stops.length;if(p===1||a<=o.stops[0][0])return o.stops[0][1];if(a>=o.stops[p-1][0])return o.stops[p-1][1];const m=Nt(o.stops.map(_=>_[0]),a);return o.stops[m][1]}function Ru(o,r,a){const p=o.base!==void 0?o.base:1;if(Je(a)!=="number")return na(o.default,r.default);const m=o.stops.length;if(m===1||a<=o.stops[0][0])return o.stops[0][1];if(a>=o.stops[m-1][0])return o.stops[m-1][1];const _=Nt(o.stops.map(D=>D[0]),a),x=function(D,L,O,j){const q=j-O,J=D-O;return q===0?0:L===1?J/q:(Math.pow(L,J)-1)/(Math.pow(L,q)-1)}(a,p,o.stops[_][0],o.stops[_+1][0]),w=o.stops[_][1],T=o.stops[_+1][1],I=Wr[r.type]||oc;return typeof w.evaluate=="function"?{evaluate(...D){const L=w.evaluate.apply(void 0,D),O=T.evaluate.apply(void 0,D);if(L!==void 0&&O!==void 0)return I(L,O,x,o.colorSpace)}}:I(w,T,x,o.colorSpace)}function ac(o,r,a){switch(r.type){case"color":a=qe.parse(a);break;case"formatted":a=$i.fromString(a.toString());break;case"resolvedImage":a=Ni.fromString(a.toString());break;case"padding":a=Ci.parse(a);break;default:Je(a)===r.type||r.type==="enum"&&r.values[a]||(a=void 0)}return na(a,o.default,r.default)}sn.register(wo,{error:[{kind:"error"},[De],(o,[r])=>{throw new yi(r.evaluate(o))}],typeof:[De,[Me],(o,[r])=>G(Si(r.evaluate(o)))],"to-rgba":[N(Ht,4),[wr],(o,[r])=>{const[a,p,m,_]=r.evaluate(o).rgb;return[255*a,255*p,255*m,_]}],rgb:[wr,[Ht,Ht,Ht],lp],rgba:[wr,[Ht,Ht,Ht,Ht],lp],has:{type:Pe,overloads:[[[De],(o,[r])=>cp(r.evaluate(o),o.properties())],[[De,Sr],(o,[r,a])=>cp(r.evaluate(o),a.evaluate(o))]]},get:{type:Me,overloads:[[[De],(o,[r])=>zu(r.evaluate(o),o.properties())],[[De,Sr],(o,[r,a])=>zu(r.evaluate(o),a.evaluate(o))]]},"feature-state":[Me,[De],(o,[r])=>zu(r.evaluate(o),o.featureState||{})],properties:[Sr,[],o=>o.properties()],"geometry-type":[De,[],o=>o.geometryType()],id:[Me,[],o=>o.id()],zoom:[Ht,[],o=>o.globals.zoom],"heatmap-density":[Ht,[],o=>o.globals.heatmapDensity||0],"line-progress":[Ht,[],o=>o.globals.lineProgress||0],accumulated:[Me,[],o=>o.globals.accumulated===void 0?null:o.globals.accumulated],"+":[Ht,So(Ht),(o,r)=>{let a=0;for(const p of r)a+=p.evaluate(o);return a}],"*":[Ht,So(Ht),(o,r)=>{let a=1;for(const p of r)a*=p.evaluate(o);return a}],"-":{type:Ht,overloads:[[[Ht,Ht],(o,[r,a])=>r.evaluate(o)-a.evaluate(o)],[[Ht],(o,[r])=>-r.evaluate(o)]]},"/":[Ht,[Ht,Ht],(o,[r,a])=>r.evaluate(o)/a.evaluate(o)],"%":[Ht,[Ht,Ht],(o,[r,a])=>r.evaluate(o)%a.evaluate(o)],ln2:[Ht,[],()=>Math.LN2],pi:[Ht,[],()=>Math.PI],e:[Ht,[],()=>Math.E],"^":[Ht,[Ht,Ht],(o,[r,a])=>Math.pow(r.evaluate(o),a.evaluate(o))],sqrt:[Ht,[Ht],(o,[r])=>Math.sqrt(r.evaluate(o))],log10:[Ht,[Ht],(o,[r])=>Math.log(r.evaluate(o))/Math.LN10],ln:[Ht,[Ht],(o,[r])=>Math.log(r.evaluate(o))],log2:[Ht,[Ht],(o,[r])=>Math.log(r.evaluate(o))/Math.LN2],sin:[Ht,[Ht],(o,[r])=>Math.sin(r.evaluate(o))],cos:[Ht,[Ht],(o,[r])=>Math.cos(r.evaluate(o))],tan:[Ht,[Ht],(o,[r])=>Math.tan(r.evaluate(o))],asin:[Ht,[Ht],(o,[r])=>Math.asin(r.evaluate(o))],acos:[Ht,[Ht],(o,[r])=>Math.acos(r.evaluate(o))],atan:[Ht,[Ht],(o,[r])=>Math.atan(r.evaluate(o))],min:[Ht,So(Ht),(o,r)=>Math.min(...r.map(a=>a.evaluate(o)))],max:[Ht,So(Ht),(o,r)=>Math.max(...r.map(a=>a.evaluate(o)))],abs:[Ht,[Ht],(o,[r])=>Math.abs(r.evaluate(o))],round:[Ht,[Ht],(o,[r])=>{const a=r.evaluate(o);return a<0?-Math.round(-a):Math.round(a)}],floor:[Ht,[Ht],(o,[r])=>Math.floor(r.evaluate(o))],ceil:[Ht,[Ht],(o,[r])=>Math.ceil(r.evaluate(o))],"filter-==":[Pe,[De,Me],(o,[r,a])=>o.properties()[r.value]===a.value],"filter-id-==":[Pe,[Me],(o,[r])=>o.id()===r.value],"filter-type-==":[Pe,[De],(o,[r])=>o.geometryType()===r.value],"filter-<":[Pe,[De,Me],(o,[r,a])=>{const p=o.properties()[r.value],m=a.value;return typeof p==typeof m&&p<m}],"filter-id-<":[Pe,[Me],(o,[r])=>{const a=o.id(),p=r.value;return typeof a==typeof p&&a<p}],"filter->":[Pe,[De,Me],(o,[r,a])=>{const p=o.properties()[r.value],m=a.value;return typeof p==typeof m&&p>m}],"filter-id->":[Pe,[Me],(o,[r])=>{const a=o.id(),p=r.value;return typeof a==typeof p&&a>p}],"filter-<=":[Pe,[De,Me],(o,[r,a])=>{const p=o.properties()[r.value],m=a.value;return typeof p==typeof m&&p<=m}],"filter-id-<=":[Pe,[Me],(o,[r])=>{const a=o.id(),p=r.value;return typeof a==typeof p&&a<=p}],"filter->=":[Pe,[De,Me],(o,[r,a])=>{const p=o.properties()[r.value],m=a.value;return typeof p==typeof m&&p>=m}],"filter-id->=":[Pe,[Me],(o,[r])=>{const a=o.id(),p=r.value;return typeof a==typeof p&&a>=p}],"filter-has":[Pe,[Me],(o,[r])=>r.value in o.properties()],"filter-has-id":[Pe,[],o=>o.id()!==null&&o.id()!==void 0],"filter-type-in":[Pe,[N(De)],(o,[r])=>r.value.indexOf(o.geometryType())>=0],"filter-id-in":[Pe,[N(Me)],(o,[r])=>r.value.indexOf(o.id())>=0],"filter-in-small":[Pe,[De,N(Me)],(o,[r,a])=>a.value.indexOf(o.properties()[r.value])>=0],"filter-in-large":[Pe,[De,N(Me)],(o,[r,a])=>function(p,m,_,x){for(;_<=x;){const w=_+x>>1;if(m[w]===p)return!0;m[w]>p?x=w-1:_=w+1}return!1}(o.properties()[r.value],a.value,0,a.value.length-1)],all:{type:Pe,overloads:[[[Pe,Pe],(o,[r,a])=>r.evaluate(o)&&a.evaluate(o)],[So(Pe),(o,r)=>{for(const a of r)if(!a.evaluate(o))return!1;return!0}]]},any:{type:Pe,overloads:[[[Pe,Pe],(o,[r,a])=>r.evaluate(o)||a.evaluate(o)],[So(Pe),(o,r)=>{for(const a of r)if(a.evaluate(o))return!0;return!1}]]},"!":[Pe,[Pe],(o,[r])=>!r.evaluate(o)],"is-supported-script":[Pe,[De],(o,[r])=>{const a=o.globals&&o.globals.isSupportedScript;return!a||a(r.evaluate(o))}],upcase:[De,[De],(o,[r])=>r.evaluate(o).toUpperCase()],downcase:[De,[De],(o,[r])=>r.evaluate(o).toLowerCase()],concat:[De,So(Me),(o,r)=>r.map(a=>kr(a.evaluate(o))).join("")],"resolved-locale":[De,[Zn],(o,[r])=>r.evaluate(o).resolvedLocale()]});class Fu{constructor(r,a){var p;this.expression=r,this._warningHistory={},this._evaluator=new Qs,this._defaultValue=a?(p=a).type==="color"&&ra(p.default)?new qe(0,0,0,0):p.type==="color"?qe.parse(p.default)||null:p.type==="padding"?Ci.parse(p.default)||null:p.type==="variableAnchorOffsetCollection"?wi.parse(p.default)||null:p.default===void 0?null:p.default:null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(r,a,p,m,_,x){return this._evaluator.globals=r,this._evaluator.feature=a,this._evaluator.featureState=p,this._evaluator.canonical=m,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(r,a,p,m,_,x){this._evaluator.globals=r,this._evaluator.feature=a||null,this._evaluator.featureState=p||null,this._evaluator.canonical=m,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new yi(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function lc(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in wo}function cc(o,r){const a=new Ge(wo,ic,[],r?function(m){const _={color:wr,string:De,number:Ht,enum:De,boolean:Pe,formatted:qn,padding:qi,resolvedImage:rt,variableAnchorOffsetCollection:B};return m.type==="array"?N(_[m.value]||Me,m.length):_[m.type]}(r):void 0),p=a.parse(o,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?Du(new Fu(p,r)):ko(a.errors)}class Ou{constructor(r,a){this.kind=r,this._styleExpression=a,this.isStateDependent=r!=="constant"&&!sl(a.expression)}evaluateWithoutErrorHandling(r,a,p,m,_,x){return this._styleExpression.evaluateWithoutErrorHandling(r,a,p,m,_,x)}evaluate(r,a,p,m,_,x){return this._styleExpression.evaluate(r,a,p,m,_,x)}}class Bu{constructor(r,a,p,m){this.kind=r,this.zoomStops=p,this._styleExpression=a,this.isStateDependent=r!=="camera"&&!sl(a.expression),this.interpolationType=m}evaluateWithoutErrorHandling(r,a,p,m,_,x){return this._styleExpression.evaluateWithoutErrorHandling(r,a,p,m,_,x)}evaluate(r,a,p,m,_,x){return this._styleExpression.evaluate(r,a,p,m,_,x)}interpolationFactor(r,a,p){return this.interpolationType?yn.interpolationFactor(this.interpolationType,r,a,p):0}}function al(o,r){const a=cc(o,r);if(a.result==="error")return a;const p=a.value.expression,m=rc(p);if(!m&&!Es(r))return ko([new br("","data expressions not supported")]);const _=nc(p,["zoom"]);if(!_&&!up(r))return ko([new br("","zoom expressions not supported")]);const x=zr(p);return x||_?x instanceof br?ko([x]):x instanceof yn&&!sc(r)?ko([new br("",'"interpolate" expressions cannot be used with this property')]):Du(x?new Bu(m?"camera":"composite",a.value,x.labels,x instanceof yn?x.interpolation:void 0):new Ou(m?"constant":"source",a.value)):ko([new br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class To{constructor(r,a){this._parameters=r,this._specification=a,xr(this,ol(this._parameters,this._specification))}static deserialize(r){return new To(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function zr(o){let r=null;if(o instanceof to)r=zr(o.result);else if(o instanceof Gl){for(const a of o.args)if(r=zr(a),r)break}else(o instanceof xe||o instanceof yn)&&o.input instanceof sn&&o.input.name==="zoom"&&(r=o);return r instanceof br||o.eachChild(a=>{const p=zr(a);p instanceof br?r=p:!r&&p?r=new br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&p&&r!==p&&(r=new br("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function Mo(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const r of o.slice(1))if(!Mo(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const dp={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Vu(o){if(o==null)return{filter:()=>!0,needGeometry:!1};Mo(o)||(o=ll(o));const r=cc(o,dp);if(r.result==="error")throw new Error(r.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,p,m)=>r.value.evaluate(a,p,{},m),needGeometry:sa(o)}}function yg(o,r){return o<r?-1:o>r?1:0}function sa(o){if(!Array.isArray(o))return!1;if(o[0]==="within"||o[0]==="distance")return!0;for(let r=1;r<o.length;r++)if(sa(o[r]))return!0;return!1}function ll(o){if(!o)return!0;const r=o[0];return o.length<=1?r!=="any":r==="=="?cl(o[1],o[2],"=="):r==="!="?hc(cl(o[1],o[2],"==")):r==="<"||r===">"||r==="<="||r===">="?cl(o[1],o[2],r):r==="any"?(a=o.slice(1),["any"].concat(a.map(ll))):r==="all"?["all"].concat(o.slice(1).map(ll)):r==="none"?["all"].concat(o.slice(1).map(ll).map(hc)):r==="in"?pp(o[1],o.slice(2)):r==="!in"?hc(pp(o[1],o.slice(2))):r==="has"?uc(o[1]):r!=="!has"||hc(uc(o[1]));var a}function cl(o,r,a){switch(o){case"$type":return[`filter-type-${a}`,r];case"$id":return[`filter-id-${a}`,r];default:return[`filter-${a}`,o,r]}}function pp(o,r){if(r.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(a=>typeof a!=typeof r[0])?["filter-in-large",o,["literal",r.sort(yg)]]:["filter-in-small",o,["literal",r]]}}function uc(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function hc(o){return["!",o]}function Co(o){const r=typeof o;if(r==="number"||r==="boolean"||r==="string"||o==null)return JSON.stringify(o);if(Array.isArray(o)){let m="[";for(const _ of o)m+=`${Co(_)},`;return`${m}]`}const a=Object.keys(o).sort();let p="{";for(let m=0;m<a.length;m++)p+=`${JSON.stringify(a[m])}:${Co(o[a[m]])},`;return`${p}}`}function _g(o){let r="";for(const a of Bi)r+=`/${Co(o[a])}`;return r}function dc(o){const r=o.value;return r?[new Zt(o.key,r,"constants have been deprecated as of v8")]:[]}function Di(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function Ps(o){if(Array.isArray(o))return o.map(Ps);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const r={};for(const a in o)r[a]=Ps(o[a]);return r}return Di(o)}function vn(o){const r=o.key,a=o.value,p=o.valueSpec||{},m=o.objectElementValidators||{},_=o.style,x=o.styleSpec,w=o.validateSpec;let T=[];const I=Je(a);if(I!=="object")return[new Zt(r,a,`object expected, ${I} found`)];for(const D in a){const L=D.split(".")[0],O=p[L]||p["*"];let j;if(m[L])j=m[L];else if(p[L])j=w;else if(m["*"])j=m["*"];else{if(!p["*"]){T.push(new Zt(r,a[D],`unknown property "${D}"`));continue}j=w}T=T.concat(j({key:(r&&`${r}.`)+D,value:a[D],valueSpec:O,style:_,styleSpec:x,object:a,objectKey:D,validateSpec:w},a))}for(const D in p)m[D]||p[D].required&&p[D].default===void 0&&a[D]===void 0&&T.push(new Zt(r,a,`missing required property "${D}"`));return T}function pc(o){const r=o.value,a=o.valueSpec,p=o.style,m=o.styleSpec,_=o.key,x=o.arrayElementValidator||o.validateSpec;if(Je(r)!=="array")return[new Zt(_,r,`array expected, ${Je(r)} found`)];if(a.length&&r.length!==a.length)return[new Zt(_,r,`array length ${a.length} expected, length ${r.length} found`)];if(a["min-length"]&&r.length<a["min-length"])return[new Zt(_,r,`array length at least ${a["min-length"]} expected, length ${r.length} found`)];let w={type:a.value,values:a.values};m.$version<7&&(w.function=a.function),Je(a.value)==="object"&&(w=a.value);let T=[];for(let I=0;I<r.length;I++)T=T.concat(x({array:r,arrayIndex:I,value:r[I],valueSpec:w,validateSpec:o.validateSpec,style:p,styleSpec:m,key:`${_}[${I}]`}));return T}function $u(o){const r=o.key,a=o.value,p=o.valueSpec;let m=Je(a);return m==="number"&&a!=a&&(m="NaN"),m!=="number"?[new Zt(r,a,`number expected, ${m} found`)]:"minimum"in p&&a<p.minimum?[new Zt(r,a,`${a} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&a>p.maximum?[new Zt(r,a,`${a} is greater than the maximum value ${p.maximum}`)]:[]}function fc(o){const r=o.valueSpec,a=Di(o.value.type);let p,m,_,x={};const w=a!=="categorical"&&o.value.property===void 0,T=!w,I=Je(o.value.stops)==="array"&&Je(o.value.stops[0])==="array"&&Je(o.value.stops[0][0])==="object",D=vn({key:o.key,value:o.value,valueSpec:o.styleSpec.function,validateSpec:o.validateSpec,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(j){if(a==="identity")return[new Zt(j.key,j.value,'identity function may not have a "stops" property')];let q=[];const J=j.value;return q=q.concat(pc({key:j.key,value:J,valueSpec:j.valueSpec,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:L})),Je(J)==="array"&&J.length===0&&q.push(new Zt(j.key,J,"array must have at least one stop")),q},default:function(j){return j.validateSpec({key:j.key,value:j.value,valueSpec:r,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec})}}});return a==="identity"&&w&&D.push(new Zt(o.key,o.value,'missing required property "property"')),a==="identity"||o.value.stops||D.push(new Zt(o.key,o.value,'missing required property "stops"')),a==="exponential"&&o.valueSpec.expression&&!sc(o.valueSpec)&&D.push(new Zt(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(T&&!Es(o.valueSpec)?D.push(new Zt(o.key,o.value,"property functions not supported")):w&&!up(o.valueSpec)&&D.push(new Zt(o.key,o.value,"zoom functions not supported"))),a!=="categorical"&&!I||o.value.property!==void 0||D.push(new Zt(o.key,o.value,'"property" property is required')),D;function L(j){let q=[];const J=j.value,it=j.key;if(Je(J)!=="array")return[new Zt(it,J,`array expected, ${Je(J)} found`)];if(J.length!==2)return[new Zt(it,J,`array length 2 expected, length ${J.length} found`)];if(I){if(Je(J[0])!=="object")return[new Zt(it,J,`object expected, ${Je(J[0])} found`)];if(J[0].zoom===void 0)return[new Zt(it,J,"object stop key must have zoom")];if(J[0].value===void 0)return[new Zt(it,J,"object stop key must have value")];if(_&&_>Di(J[0].zoom))return[new Zt(it,J[0].zoom,"stop zoom values must appear in ascending order")];Di(J[0].zoom)!==_&&(_=Di(J[0].zoom),m=void 0,x={}),q=q.concat(vn({key:`${it}[0]`,value:J[0],valueSpec:{zoom:{}},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:$u,value:O}}))}else q=q.concat(O({key:`${it}[0]`,value:J[0],valueSpec:{},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec},J));return lc(Ps(J[1]))?q.concat([new Zt(`${it}[1]`,J[1],"expressions are not allowed in function stops.")]):q.concat(j.validateSpec({key:`${it}[1]`,value:J[1],valueSpec:r,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec}))}function O(j,q){const J=Je(j.value),it=Di(j.value),ct=j.value!==null?j.value:q;if(p){if(J!==p)return[new Zt(j.key,ct,`${J} stop domain type must match previous stop domain type ${p}`)]}else p=J;if(J!=="number"&&J!=="string"&&J!=="boolean")return[new Zt(j.key,ct,"stop domain value must be a number, string, or boolean")];if(J!=="number"&&a!=="categorical"){let wt=`number expected, ${J} found`;return Es(r)&&a===void 0&&(wt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Zt(j.key,ct,wt)]}return a!=="categorical"||J!=="number"||isFinite(it)&&Math.floor(it)===it?a!=="categorical"&&J==="number"&&m!==void 0&&it<m?[new Zt(j.key,ct,"stop domain values must appear in ascending order")]:(m=it,a==="categorical"&&it in x?[new Zt(j.key,ct,"stop domain values must be unique")]:(x[it]=!0,[])):[new Zt(j.key,ct,`integer expected, found ${it}`)]}}function Is(o){const r=(o.expressionContext==="property"?al:cc)(Ps(o.value),o.valueSpec);if(r.result==="error")return r.value.map(p=>new Zt(`${o.key}${p.key}`,o.value,p.message));const a=r.value.expression||r.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!a.outputDefined())return[new Zt(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!sl(a))return[new Zt(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter"&&!sl(a))return[new Zt(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!nc(a,["zoom","feature-state"]))return[new Zt(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!rc(a))return[new Zt(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function oa(o){const r=o.key,a=o.value,p=o.valueSpec,m=[];return Array.isArray(p.values)?p.values.indexOf(Di(a))===-1&&m.push(new Zt(r,a,`expected one of [${p.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(p.values).indexOf(Di(a))===-1&&m.push(new Zt(r,a,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(a)} found`)),m}function mc(o){return Mo(Ps(o.value))?Is(xr({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Nu(o)}function Nu(o){const r=o.value,a=o.key;if(Je(r)!=="array")return[new Zt(a,r,`array expected, ${Je(r)} found`)];const p=o.styleSpec;let m,_=[];if(r.length<1)return[new Zt(a,r,"filter array must have at least 1 element")];switch(_=_.concat(oa({key:`${a}[0]`,value:r[0],valueSpec:p.filter_operator,style:o.style,styleSpec:o.styleSpec})),Di(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&Di(r[1])==="$type"&&_.push(new Zt(a,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&_.push(new Zt(a,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(m=Je(r[1]),m!=="string"&&_.push(new Zt(`${a}[1]`,r[1],`string expected, ${m} found`)));for(let x=2;x<r.length;x++)m=Je(r[x]),Di(r[1])==="$type"?_=_.concat(oa({key:`${a}[${x}]`,value:r[x],valueSpec:p.geometry_type,style:o.style,styleSpec:o.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&_.push(new Zt(`${a}[${x}]`,r[x],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let x=1;x<r.length;x++)_=_.concat(Nu({key:`${a}[${x}]`,value:r[x],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":m=Je(r[1]),r.length!==2?_.push(new Zt(a,r,`filter array for "${r[0]}" operator must have 2 elements`)):m!=="string"&&_.push(new Zt(`${a}[1]`,r[1],`string expected, ${m} found`))}return _}function ju(o,r){const a=o.key,p=o.validateSpec,m=o.style,_=o.styleSpec,x=o.value,w=o.objectKey,T=_[`${r}_${o.layerType}`];if(!T)return[];const I=w.match(/^(.*)-transition$/);if(r==="paint"&&I&&T[I[1]]&&T[I[1]].transition)return p({key:a,value:x,valueSpec:_.transition,style:m,styleSpec:_});const D=o.valueSpec||T[w];if(!D)return[new Zt(a,x,`unknown property "${w}"`)];let L;if(Je(x)==="string"&&Es(D)&&!D.tokens&&(L=/^{([^}]+)}$/.exec(x)))return[new Zt(a,x,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(L[1])} }\`.`)];const O=[];return o.layerType==="symbol"&&(w==="text-field"&&m&&!m.glyphs&&O.push(new Zt(a,x,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&ra(Ps(x))&&Di(x.type)==="identity"&&O.push(new Zt(a,x,'"text-font" does not support identity functions'))),O.concat(p({key:o.key,value:x,valueSpec:D,style:m,styleSpec:_,expressionContext:"property",propertyType:r,propertyKey:w}))}function gc(o){return ju(o,"paint")}function Uu(o){return ju(o,"layout")}function fp(o){let r=[];const a=o.value,p=o.key,m=o.style,_=o.styleSpec;a.type||a.ref||r.push(new Zt(p,a,'either "type" or "ref" is required'));let x=Di(a.type);const w=Di(a.ref);if(a.id){const T=Di(a.id);for(let I=0;I<o.arrayIndex;I++){const D=m.layers[I];Di(D.id)===T&&r.push(new Zt(p,a.id,`duplicate layer id "${a.id}", previously used at line ${D.id.__line__}`))}}if("ref"in a){let T;["type","source","source-layer","filter","layout"].forEach(I=>{I in a&&r.push(new Zt(p,a[I],`"${I}" is prohibited for ref layers`))}),m.layers.forEach(I=>{Di(I.id)===w&&(T=I)}),T?T.ref?r.push(new Zt(p,a.ref,"ref cannot reference another ref layer")):x=Di(T.type):r.push(new Zt(p,a.ref,`ref layer "${w}" not found`))}else if(x!=="background")if(a.source){const T=m.sources&&m.sources[a.source],I=T&&Di(T.type);T?I==="vector"&&x==="raster"?r.push(new Zt(p,a.source,`layer "${a.id}" requires a raster source`)):I!=="raster-dem"&&x==="hillshade"?r.push(new Zt(p,a.source,`layer "${a.id}" requires a raster-dem source`)):I==="raster"&&x!=="raster"?r.push(new Zt(p,a.source,`layer "${a.id}" requires a vector source`)):I!=="vector"||a["source-layer"]?I==="raster-dem"&&x!=="hillshade"?r.push(new Zt(p,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!a.paint||!a.paint["line-gradient"]||I==="geojson"&&T.lineMetrics||r.push(new Zt(p,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new Zt(p,a,`layer "${a.id}" must specify a "source-layer"`)):r.push(new Zt(p,a.source,`source "${a.source}" not found`))}else r.push(new Zt(p,a,'missing required property "source"'));return r=r.concat(vn({key:p,value:a,valueSpec:_.layer,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,objectElementValidators:{"*":()=>[],type:()=>o.validateSpec({key:`${p}.type`,value:a.type,valueSpec:_.layer.type,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,object:a,objectKey:"type"}),filter:mc,layout:T=>vn({layer:a,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":I=>Uu(xr({layerType:x},I))}}),paint:T=>vn({layer:a,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":I=>gc(xr({layerType:x},I))}})}})),r}function io(o){const r=o.value,a=o.key,p=Je(r);return p!=="string"?[new Zt(a,r,`string expected, ${p} found`)]:[]}const mp={promoteId:function({key:o,value:r}){if(Je(r)==="string")return io({key:o,value:r});{const a=[];for(const p in r)a.push(...io({key:`${o}.${p}`,value:r[p]}));return a}}};function Hu(o){const r=o.value,a=o.key,p=o.styleSpec,m=o.style,_=o.validateSpec;if(!r.type)return[new Zt(a,r,'"type" is required')];const x=Di(r.type);let w;switch(x){case"vector":case"raster":return w=vn({key:a,value:r,valueSpec:p[`source_${x.replace("-","_")}`],style:o.style,styleSpec:p,objectElementValidators:mp,validateSpec:_}),w;case"raster-dem":return w=function(T){var I;const D=(I=T.sourceName)!==null&&I!==void 0?I:"",L=T.value,O=T.styleSpec,j=O.source_raster_dem,q=T.style;let J=[];const it=Je(L);if(L===void 0)return J;if(it!=="object")return J.push(new Zt("source_raster_dem",L,`object expected, ${it} found`)),J;const ct=Di(L.encoding)==="custom",wt=["redFactor","greenFactor","blueFactor","baseShift"],pt=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const vt in L)!ct&&wt.includes(vt)?J.push(new Zt(vt,L[vt],`In "${D}": "${vt}" is only valid when "encoding" is set to "custom". ${pt} encoding found`)):j[vt]?J=J.concat(T.validateSpec({key:vt,value:L[vt],valueSpec:j[vt],validateSpec:T.validateSpec,style:q,styleSpec:O})):J.push(new Zt(vt,L[vt],`unknown property "${vt}"`));return J}({sourceName:a,value:r,style:o.style,styleSpec:p,validateSpec:_}),w;case"geojson":if(w=vn({key:a,value:r,valueSpec:p.source_geojson,style:m,styleSpec:p,validateSpec:_,objectElementValidators:mp}),r.cluster)for(const T in r.clusterProperties){const[I,D]=r.clusterProperties[T],L=typeof I=="string"?[I,["accumulated"],["get",T]]:I;w.push(...Is({key:`${a}.${T}.map`,value:D,validateSpec:_,expressionContext:"cluster-map"})),w.push(...Is({key:`${a}.${T}.reduce`,value:L,validateSpec:_,expressionContext:"cluster-reduce"}))}return w;case"video":return vn({key:a,value:r,valueSpec:p.source_video,style:m,validateSpec:_,styleSpec:p});case"image":return vn({key:a,value:r,valueSpec:p.source_image,style:m,validateSpec:_,styleSpec:p});case"canvas":return[new Zt(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return oa({key:`${a}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:m,validateSpec:_,styleSpec:p})}}function Zu(o){const r=o.value,a=o.styleSpec,p=a.light,m=o.style;let _=[];const x=Je(r);if(r===void 0)return _;if(x!=="object")return _=_.concat([new Zt("light",r,`object expected, ${x} found`)]),_;for(const w in r){const T=w.match(/^(.*)-transition$/);_=_.concat(T&&p[T[1]]&&p[T[1]].transition?o.validateSpec({key:w,value:r[w],valueSpec:a.transition,validateSpec:o.validateSpec,style:m,styleSpec:a}):p[w]?o.validateSpec({key:w,value:r[w],valueSpec:p[w],validateSpec:o.validateSpec,style:m,styleSpec:a}):[new Zt(w,r[w],`unknown property "${w}"`)])}return _}function qu(o){const r=o.value,a=o.styleSpec,p=a.sky,m=o.style,_=Je(r);if(r===void 0)return[];if(_!=="object")return[new Zt("sky",r,`object expected, ${_} found`)];let x=[];for(const w in r)x=x.concat(p[w]?o.validateSpec({key:w,value:r[w],valueSpec:p[w],style:m,styleSpec:a}):[new Zt(w,r[w],`unknown property "${w}"`)]);return x}function gp(o){const r=o.value,a=o.styleSpec,p=a.terrain,m=o.style;let _=[];const x=Je(r);if(r===void 0)return _;if(x!=="object")return _=_.concat([new Zt("terrain",r,`object expected, ${x} found`)]),_;for(const w in r)_=_.concat(p[w]?o.validateSpec({key:w,value:r[w],valueSpec:p[w],validateSpec:o.validateSpec,style:m,styleSpec:a}):[new Zt(w,r[w],`unknown property "${w}"`)]);return _}function yp(o){let r=[];const a=o.value,p=o.key;if(Array.isArray(a)){const m=[],_=[];for(const x in a)a[x].id&&m.includes(a[x].id)&&r.push(new Zt(p,a,`all the sprites' ids must be unique, but ${a[x].id} is duplicated`)),m.push(a[x].id),a[x].url&&_.includes(a[x].url)&&r.push(new Zt(p,a,`all the sprites' URLs must be unique, but ${a[x].url} is duplicated`)),_.push(a[x].url),r=r.concat(vn({key:`${p}[${x}]`,value:a[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:o.validateSpec}));return r}return io({key:p,value:a})}const Gu={"*":()=>[],array:pc,boolean:function(o){const r=o.value,a=o.key,p=Je(r);return p!=="boolean"?[new Zt(a,r,`boolean expected, ${p} found`)]:[]},number:$u,color:function(o){const r=o.key,a=o.value,p=Je(a);return p!=="string"?[new Zt(r,a,`color expected, ${p} found`)]:qe.parse(String(a))?[]:[new Zt(r,a,`color expected, "${a}" found`)]},constants:dc,enum:oa,filter:mc,function:fc,layer:fp,object:vn,source:Hu,light:Zu,sky:qu,terrain:gp,string:io,formatted:function(o){return io(o).length===0?[]:Is(o)},resolvedImage:function(o){return io(o).length===0?[]:Is(o)},padding:function(o){const r=o.key,a=o.value;if(Je(a)==="array"){if(a.length<1||a.length>4)return[new Zt(r,a,`padding requires 1 to 4 values; ${a.length} values found`)];const p={type:"number"};let m=[];for(let _=0;_<a.length;_++)m=m.concat(o.validateSpec({key:`${r}[${_}]`,value:a[_],validateSpec:o.validateSpec,valueSpec:p}));return m}return $u({key:r,value:a,valueSpec:{}})},variableAnchorOffsetCollection:function(o){const r=o.key,a=o.value,p=Je(a),m=o.styleSpec;if(p!=="array"||a.length<1||a.length%2!=0)return[new Zt(r,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let x=0;x<a.length;x+=2)_=_.concat(oa({key:`${r}[${x}]`,value:a[x],valueSpec:m.layout_symbol["text-anchor"]})),_=_.concat(pc({key:`${r}[${x+1}]`,value:a[x+1],valueSpec:{length:2,value:"number"},validateSpec:o.validateSpec,style:o.style,styleSpec:m}));return _},sprite:yp};function aa(o){const r=o.value,a=o.valueSpec,p=o.styleSpec;return o.validateSpec=aa,a.expression&&ra(Di(r))?fc(o):a.expression&&lc(Ps(r))?Is(o):a.type&&Gu[a.type]?Gu[a.type](o):vn(xr({},o,{valueSpec:a.type?p[a.type]:a}))}function Wu(o){const r=o.value,a=o.key,p=io(o);return p.length||(r.indexOf("{fontstack}")===-1&&p.push(new Zt(a,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&p.push(new Zt(a,r,'"glyphs" url must include a "{range}" token'))),p}function zn(o,r=Et){let a=[];return a=a.concat(aa({key:"",value:o,valueSpec:r.$root,styleSpec:r,style:o,validateSpec:aa,objectElementValidators:{glyphs:Wu,"*":()=>[]}})),o.constants&&(a=a.concat(dc({key:"constants",value:o.constants,style:o,styleSpec:r,validateSpec:aa}))),_p(a)}function xn(o){return function(r){return o({...r,validateSpec:aa})}}function _p(o){return[].concat(o).sort((r,a)=>r.line-a.line)}function Dn(o){return function(...r){return _p(o.apply(this,r))}}zn.source=Dn(xn(Hu)),zn.sprite=Dn(xn(yp)),zn.glyphs=Dn(xn(Wu)),zn.light=Dn(xn(Zu)),zn.sky=Dn(xn(qu)),zn.terrain=Dn(xn(gp)),zn.layer=Dn(xn(fp)),zn.filter=Dn(xn(mc)),zn.paintProperty=Dn(xn(gc)),zn.layoutProperty=Dn(xn(Uu));const ul=zn,vg=ul.light,vp=ul.paintProperty,xp=ul.layoutProperty;function Yu(o,r){let a=!1;if(r&&r.length)for(const p of r)o.fire(new ci(new Error(p.message))),a=!0;return a}class hl{constructor(r,a,p){const m=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const x=new Int32Array(this.arrayBuffer);r=x[0],this.d=(a=x[1])+2*(p=x[2]);for(let T=0;T<this.d*this.d;T++){const I=x[3+T],D=x[3+T+1];m.push(I===D?null:x.subarray(I,D))}const w=x[3+m.length+1];this.keys=x.subarray(x[3+m.length],w),this.bboxes=x.subarray(w),this.insert=this._insertReadonly}else{this.d=a+2*p;for(let x=0;x<this.d*this.d;x++)m.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=r,this.padding=p,this.scale=a/r,this.uid=0;const _=p/a*r;this.min=-_,this.max=r+_}insert(r,a,p,m,_){this._forEachCell(a,p,m,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(a),this.bboxes.push(p),this.bboxes.push(m),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,a,p,m,_,x){this.cells[_].push(x)}query(r,a,p,m,_){const x=this.min,w=this.max;if(r<=x&&a<=x&&w<=p&&w<=m&&!_)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(r,a,p,m,this._queryCell,T,{},_),T}}_queryCell(r,a,p,m,_,x,w,T){const I=this.cells[_];if(I!==null){const D=this.keys,L=this.bboxes;for(let O=0;O<I.length;O++){const j=I[O];if(w[j]===void 0){const q=4*j;(T?T(L[q+0],L[q+1],L[q+2],L[q+3]):r<=L[q+2]&&a<=L[q+3]&&p>=L[q+0]&&m>=L[q+1])?(w[j]=!0,x.push(D[j])):w[j]=!1}}}}_forEachCell(r,a,p,m,_,x,w,T){const I=this._convertToCellCoord(r),D=this._convertToCellCoord(a),L=this._convertToCellCoord(p),O=this._convertToCellCoord(m);for(let j=I;j<=L;j++)for(let q=D;q<=O;q++){const J=this.d*q+j;if((!T||T(this._convertFromCellCoord(j),this._convertFromCellCoord(q),this._convertFromCellCoord(j+1),this._convertFromCellCoord(q+1)))&&_.call(this,r,a,p,m,J,x,w,T))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,a=3+this.cells.length+1+1;let p=0;for(let x=0;x<this.cells.length;x++)p+=this.cells[x].length;const m=new Int32Array(a+p+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let _=a;for(let x=0;x<r.length;x++){const w=r[x];m[3+x]=_,m.set(w,_),_+=w.length}return m[3+r.length]=_,m.set(this.keys,_),_+=this.keys.length,m[3+r.length+1]=_,m.set(this.bboxes,_),_+=this.bboxes.length,m.buffer}static serialize(r,a){const p=r.toArrayBuffer();return a&&a.push(p),{buffer:p}}static deserialize(r){return new hl(r.buffer)}}const ro={};function oe(o,r,a={}){if(ro[o])throw new Error(`${o} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:o,writeable:!1}),ro[o]={klass:r,omit:a.omit||[],shallow:a.shallow||[]}}oe("Object",Object),oe("TransferableGridIndex",hl),oe("Color",qe),oe("Error",Error),oe("AJAXError",Ue),oe("ResolvedImage",Ni),oe("StylePropertyFunction",To),oe("StyleExpression",Fu,{omit:["_evaluator"]}),oe("ZoomDependentExpression",Bu),oe("ZoomConstantExpression",Ou),oe("CompoundExpression",sn,{omit:["_evaluate"]});for(const o in wo)wo[o]._classRegistryKey||oe(`Expression_${o}`,wo[o]);function bp(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function dl(o,r){if(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob||o instanceof Error)return o;if(bp(o)||$e(o))return r&&r.push(o),o;if(ArrayBuffer.isView(o)){const a=o;return r&&r.push(a.buffer),a}if(o instanceof ImageData)return r&&r.push(o.data.buffer),o;if(Array.isArray(o)){const a=[];for(const p of o)a.push(dl(p,r));return a}if(typeof o=="object"){const a=o.constructor,p=a._classRegistryKey;if(!p)throw new Error(`can't serialize object of unregistered class ${a.name}`);if(!ro[p])throw new Error(`${p} is not registered.`);const m=a.serialize?a.serialize(o,r):{};if(a.serialize){if(r&&m===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in o){if(!o.hasOwnProperty(_)||ro[p].omit.indexOf(_)>=0)continue;const x=o[_];m[_]=ro[p].shallow.indexOf(_)>=0?x:dl(x,r)}o instanceof Error&&(m.message=o.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(m.$name=p),m}throw new Error("can't serialize object of type "+typeof o)}function ps(o){if(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob||o instanceof Error||bp(o)||$e(o)||ArrayBuffer.isView(o)||o instanceof ImageData)return o;if(Array.isArray(o))return o.map(ps);if(typeof o=="object"){const r=o.$name||"Object";if(!ro[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:a}=ro[r];if(!a)throw new Error(`can't deserialize unregistered class ${r}`);if(a.deserialize)return a.deserialize(o);const p=Object.create(a.prototype);for(const m of Object.keys(o)){if(m==="$name")continue;const _=o[m];p[m]=ro[r].shallow.indexOf(m)>=0?_:ps(_)}return p}throw new Error("can't deserialize object of type "+typeof o)}class wp{constructor(){this.first=!0}update(r,a){const p=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=a),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=p,!0))}}const te={"Latin-1 Supplement":o=>o>=128&&o<=255,Arabic:o=>o>=1536&&o<=1791,"Arabic Supplement":o=>o>=1872&&o<=1919,"Arabic Extended-A":o=>o>=2208&&o<=2303,"Hangul Jamo":o=>o>=4352&&o<=4607,"Unified Canadian Aboriginal Syllabics":o=>o>=5120&&o<=5759,Khmer:o=>o>=6016&&o<=6143,"Unified Canadian Aboriginal Syllabics Extended":o=>o>=6320&&o<=6399,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"CJK Radicals Supplement":o=>o>=11904&&o<=12031,"Kangxi Radicals":o=>o>=12032&&o<=12255,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Bopomofo:o=>o>=12544&&o<=12591,"Hangul Compatibility Jamo":o=>o>=12592&&o<=12687,Kanbun:o=>o>=12688&&o<=12703,"Bopomofo Extended":o=>o>=12704&&o<=12735,"CJK Strokes":o=>o>=12736&&o<=12783,"Katakana Phonetic Extensions":o=>o>=12784&&o<=12799,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"CJK Unified Ideographs Extension A":o=>o>=13312&&o<=19903,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Yi Syllables":o=>o>=40960&&o<=42127,"Yi Radicals":o=>o>=42128&&o<=42191,"Hangul Jamo Extended-A":o=>o>=43360&&o<=43391,"Hangul Syllables":o=>o>=44032&&o<=55215,"Hangul Jamo Extended-B":o=>o>=55216&&o<=55295,"Private Use Area":o=>o>=57344&&o<=63743,"CJK Compatibility Ideographs":o=>o>=63744&&o<=64255,"Arabic Presentation Forms-A":o=>o>=64336&&o<=65023,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Arabic Presentation Forms-B":o=>o>=65136&&o<=65279,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function Ku(o){for(const r of o)if(Xu(r.charCodeAt(0)))return!0;return!1}function xg(o){for(const r of o)if(!Sp(r.charCodeAt(0)))return!1;return!0}function Sp(o){return!(te.Arabic(o)||te["Arabic Supplement"](o)||te["Arabic Extended-A"](o)||te["Arabic Presentation Forms-A"](o)||te["Arabic Presentation Forms-B"](o))}function Xu(o){return!(o!==746&&o!==747&&(o<4352||!(te["Bopomofo Extended"](o)||te.Bopomofo(o)||te["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||te["CJK Compatibility Ideographs"](o)||te["CJK Compatibility"](o)||te["CJK Radicals Supplement"](o)||te["CJK Strokes"](o)||!(!te["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||o===12336)||te["CJK Unified Ideographs Extension A"](o)||te["CJK Unified Ideographs"](o)||te["Enclosed CJK Letters and Months"](o)||te["Hangul Compatibility Jamo"](o)||te["Hangul Jamo Extended-A"](o)||te["Hangul Jamo Extended-B"](o)||te["Hangul Jamo"](o)||te["Hangul Syllables"](o)||te.Hiragana(o)||te["Ideographic Description Characters"](o)||te.Kanbun(o)||te["Kangxi Radicals"](o)||te["Katakana Phonetic Extensions"](o)||te.Katakana(o)&&o!==12540||!(!te["Halfwidth and Fullwidth Forms"](o)||o===65288||o===65289||o===65293||o>=65306&&o<=65310||o===65339||o===65341||o===65343||o>=65371&&o<=65503||o===65507||o>=65512&&o<=65519)||!(!te["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||te["Unified Canadian Aboriginal Syllabics"](o)||te["Unified Canadian Aboriginal Syllabics Extended"](o)||te["Vertical Forms"](o)||te["Yijing Hexagram Symbols"](o)||te["Yi Syllables"](o)||te["Yi Radicals"](o))))}function kp(o){return!(Xu(o)||function(r){return!!(te["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||te["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||te["Letterlike Symbols"](r)||te["Number Forms"](r)||te["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||te["Control Pictures"](r)&&r!==9251||te["Optical Character Recognition"](r)||te["Enclosed Alphanumerics"](r)||te["Geometric Shapes"](r)||te["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||te["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||te["CJK Symbols and Punctuation"](r)||te.Katakana(r)||te["Private Use Area"](r)||te["CJK Compatibility Forms"](r)||te["Small Form Variants"](r)||te["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(o))}function no(o){return o>=1424&&o<=2303||te["Arabic Presentation Forms-A"](o)||te["Arabic Presentation Forms-B"](o)}function Tp(o,r){return!(!r&&no(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||te.Khmer(o))}function Ju(o){for(const r of o)if(no(r.charCodeAt(0)))return!0;return!1}const so=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(o){this.pluginStatus=o.pluginStatus,this.pluginURL=o.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(o){this.applyArabicShaping=o.applyArabicShaping,this.processBidirectionalText=o.processBidirectionalText,this.processStyledBidirectionalText=o.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class mi{constructor(r,a){this.zoom=r,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new wp,this.transition={})}isSupportedScript(r){return function(a,p){for(const m of a)if(!Tp(m.charCodeAt(0),p))return!1;return!0}(r,so.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,a=r-Math.floor(r),p=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*a}}}class yc{constructor(r,a){this.property=r,this.value=a,this.expression=function(p,m){if(ra(p))return new To(p,m);if(lc(p)){const _=al(p,m);if(_.result==="error")throw new Error(_.value.map(x=>`${x.key}: ${x.message}`).join(", "));return _.value}{let _=p;return m.type==="color"&&typeof p=="string"?_=qe.parse(p):m.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?m.type==="variableAnchorOffsetCollection"&&Array.isArray(p)&&(_=wi.parse(p)):_=Ci.parse(p),{kind:"constant",evaluate:()=>_}}}(a===void 0?r.specification.default:a,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,a,p){return this.property.possiblyEvaluate(this,r,a,p)}}class la{constructor(r){this.property=r,this.value=new yc(r,void 0)}transitioned(r,a){return new Mp(this.property,this.value,a,Tt({},r.transition,this.transition),r.now)}untransitioned(){return new Mp(this.property,this.value,null,{},0)}}class ca{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return Ot(this._values[r].value.value)}setValue(r,a){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new la(this._values[r].property)),this._values[r].value=new yc(this._values[r].property,a===null?void 0:Ot(a))}getTransition(r){return Ot(this._values[r].transition)}setTransition(r,a){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new la(this._values[r].property)),this._values[r].transition=Ot(a)||void 0}serialize(){const r={};for(const a of Object.keys(this._values)){const p=this.getValue(a);p!==void 0&&(r[a]=p);const m=this.getTransition(a);m!==void 0&&(r[`${a}-transition`]=m)}return r}transitioned(r,a){const p=new Qu(this._properties);for(const m of Object.keys(this._values))p._values[m]=this._values[m].transitioned(r,a._values[m]);return p}untransitioned(){const r=new Qu(this._properties);for(const a of Object.keys(this._values))r._values[a]=this._values[a].untransitioned();return r}}class Mp{constructor(r,a,p,m,_){this.property=r,this.value=a,this.begin=_+m.delay||0,this.end=this.begin+m.duration||0,r.specification.transition&&(m.delay||m.duration)&&(this.prior=p)}possiblyEvaluate(r,a,p){const m=r.now||0,_=this.value.possiblyEvaluate(r,a,p),x=this.prior;if(x){if(m>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(m<this.begin)return x.possiblyEvaluate(r,a,p);{const w=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(r,a,p),_,function(T){if(T<=0)return 0;if(T>=1)return 1;const I=T*T,D=I*T;return 4*(T<.5?D:3*(T-I)+D-.75)}(w))}}return _}}class Qu{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,a,p){const m=new _c(this._properties);for(const _ of Object.keys(this._values))m._values[_]=this._values[_].possiblyEvaluate(r,a,p);return m}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class pl{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}hasValue(r){return this._values[r].value!==void 0}getValue(r){return Ot(this._values[r].value)}setValue(r,a){this._values[r]=new yc(this._values[r].property,a===null?void 0:Ot(a))}serialize(){const r={};for(const a of Object.keys(this._values)){const p=this.getValue(a);p!==void 0&&(r[a]=p)}return r}possiblyEvaluate(r,a,p){const m=new _c(this._properties);for(const _ of Object.keys(this._values))m._values[_]=this._values[_].possiblyEvaluate(r,a,p);return m}}class fs{constructor(r,a,p){this.property=r,this.value=a,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,a,p,m){return this.property.evaluate(this.value,this.parameters,r,a,p,m)}}class _c{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class pe{constructor(r){this.specification=r}possiblyEvaluate(r,a){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(a)}interpolate(r,a,p){const m=Wr[this.specification.type];return m?m(r,a,p):r}}class be{constructor(r,a){this.specification=r,this.overrides=a}possiblyEvaluate(r,a,p,m){return new fs(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(a,null,{},p,m)}:r.expression,a)}interpolate(r,a,p){if(r.value.kind!=="constant"||a.value.kind!=="constant")return r;if(r.value.value===void 0||a.value.value===void 0)return new fs(this,{kind:"constant",value:void 0},r.parameters);const m=Wr[this.specification.type];if(m){const _=m(r.value.value,a.value.value,p);return new fs(this,{kind:"constant",value:_},r.parameters)}return r}evaluate(r,a,p,m,_,x){return r.kind==="constant"?r.value:r.evaluate(a,p,m,_,x)}}class y extends be{possiblyEvaluate(r,a,p,m){if(r.value===void 0)return new fs(this,{kind:"constant",value:void 0},a);if(r.expression.kind==="constant"){const _=r.expression.evaluate(a,null,{},p,m),x=r.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,w=this._calculate(x,x,x,a);return new fs(this,{kind:"constant",value:w},a)}if(r.expression.kind==="camera"){const _=this._calculate(r.expression.evaluate({zoom:a.zoom-1}),r.expression.evaluate({zoom:a.zoom}),r.expression.evaluate({zoom:a.zoom+1}),a);return new fs(this,{kind:"constant",value:_},a)}return new fs(this,r.expression,a)}evaluate(r,a,p,m,_,x){if(r.kind==="source"){const w=r.evaluate(a,p,m,_,x);return this._calculate(w,w,w,a)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(a.zoom)-1},p,m),r.evaluate({zoom:Math.floor(a.zoom)},p,m),r.evaluate({zoom:Math.floor(a.zoom)+1},p,m),a):r.value}_calculate(r,a,p,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:r,to:a}:{from:p,to:a}}interpolate(r){return r}}class n{constructor(r){this.specification=r}possiblyEvaluate(r,a,p,m){if(r.value!==void 0){if(r.expression.kind==="constant"){const _=r.expression.evaluate(a,null,{},p,m);return this._calculate(_,_,_,a)}return this._calculate(r.expression.evaluate(new mi(Math.floor(a.zoom-1),a)),r.expression.evaluate(new mi(Math.floor(a.zoom),a)),r.expression.evaluate(new mi(Math.floor(a.zoom+1),a)),a)}}_calculate(r,a,p,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:r,to:a}:{from:p,to:a}}interpolate(r){return r}}class u{constructor(r){this.specification=r}possiblyEvaluate(r,a,p,m){return!!r.expression.evaluate(a,null,{},p,m)}interpolate(){return!1}}class f{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in r){const p=r[a];p.specification.overridable&&this.overridableProperties.push(a);const m=this.defaultPropertyValues[a]=new yc(p,void 0),_=this.defaultTransitionablePropertyValues[a]=new la(p);this.defaultTransitioningPropertyValues[a]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=m.possiblyEvaluate({})}}}oe("DataDrivenProperty",be),oe("DataConstantProperty",pe),oe("CrossFadedDataDrivenProperty",y),oe("CrossFadedProperty",n),oe("ColorRampProperty",u);const g="-transition";class v extends Hr{constructor(r,a){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1},r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),a.layout&&(this._unevaluatedLayout=new pl(a.layout)),a.paint)){this._transitionablePaint=new ca(a.paint);for(const p in r.paint)this.setPaintProperty(p,r.paint[p],{validate:!1});for(const p in r.layout)this.setLayoutProperty(p,r.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _c(a.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,a,p={}){a!=null&&this._validate(xp,`layers.${this.id}.layout.${r}`,r,a,p)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,a):this.visibility=a)}getPaintProperty(r){return r.endsWith(g)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,a,p={}){if(a!=null&&this._validate(vp,`layers.${this.id}.paint.${r}`,r,a,p))return!1;if(r.endsWith(g))return this._transitionablePaint.setTransition(r.slice(0,-11),a||void 0),!1;{const m=this._transitionablePaint._values[r],_=m.property.specification["property-type"]==="cross-faded-data-driven",x=m.value.isDataDriven(),w=m.value;this._transitionablePaint.setValue(r,a),this._handleSpecialPaintPropertyUpdate(r);const T=this._transitionablePaint._values[r].value;return T.isDataDriven()||x||_||this._handleOverridablePaintPropertyUpdate(r,w,T)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,a,p){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,a){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,a)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Ft(r,(a,p)=>!(a===void 0||p==="layout"&&!Object.keys(a).length||p==="paint"&&!Object.keys(a).length))}_validate(r,a,p,m,_={}){return(!_||_.validate!==!1)&&Yu(this,r.call(ul,{key:a,layerType:this.type,objectKey:p,value:m,styleSpec:Et,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const a=this.paint.get(r);if(a instanceof fs&&Es(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const k={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class M{constructor(r,a){this._structArray=r,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class E{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,a){return r._trim(),a&&(r.isTransferred=!0,a.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const a=Object.create(this.prototype);return a.arrayBuffer=r.arrayBuffer,a.length=r.length,a.capacity=r.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function z(o,r=1){let a=0,p=0;return{members:o.map(m=>{const _=k[m.type].BYTES_PER_ELEMENT,x=a=F(a,Math.max(r,_)),w=m.components||1;return p=Math.max(p,_),a+=_*w,{name:m.name,type:m.type,components:w,offset:x}}),size:F(a,Math.max(p,r)),alignment:r}}function F(o,r){return Math.ceil(o/r)*r}class R extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a){const p=this.length;return this.resize(p+1),this.emplace(p,r,a)}emplace(r,a,p){const m=2*r;return this.int16[m+0]=a,this.int16[m+1]=p,r}}R.prototype.bytesPerElement=4,oe("StructArrayLayout2i4",R);class Z extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,p){const m=this.length;return this.resize(m+1),this.emplace(m,r,a,p)}emplace(r,a,p,m){const _=3*r;return this.int16[_+0]=a,this.int16[_+1]=p,this.int16[_+2]=m,r}}Z.prototype.bytesPerElement=6,oe("StructArrayLayout3i6",Z);class X extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,p,m){const _=this.length;return this.resize(_+1),this.emplace(_,r,a,p,m)}emplace(r,a,p,m,_){const x=4*r;return this.int16[x+0]=a,this.int16[x+1]=p,this.int16[x+2]=m,this.int16[x+3]=_,r}}X.prototype.bytesPerElement=8,oe("StructArrayLayout4i8",X);class tt extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,p,m,_,x){const w=this.length;return this.resize(w+1),this.emplace(w,r,a,p,m,_,x)}emplace(r,a,p,m,_,x,w){const T=6*r;return this.int16[T+0]=a,this.int16[T+1]=p,this.int16[T+2]=m,this.int16[T+3]=_,this.int16[T+4]=x,this.int16[T+5]=w,r}}tt.prototype.bytesPerElement=12,oe("StructArrayLayout2i4i12",tt);class lt extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,p,m,_,x){const w=this.length;return this.resize(w+1),this.emplace(w,r,a,p,m,_,x)}emplace(r,a,p,m,_,x,w){const T=4*r,I=8*r;return this.int16[T+0]=a,this.int16[T+1]=p,this.uint8[I+4]=m,this.uint8[I+5]=_,this.uint8[I+6]=x,this.uint8[I+7]=w,r}}lt.prototype.bytesPerElement=8,oe("StructArrayLayout2i4ub8",lt);class et extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a){const p=this.length;return this.resize(p+1),this.emplace(p,r,a)}emplace(r,a,p){const m=2*r;return this.float32[m+0]=a,this.float32[m+1]=p,r}}et.prototype.bytesPerElement=8,oe("StructArrayLayout2f8",et);class ut extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,p,m,_,x,w,T,I,D){const L=this.length;return this.resize(L+1),this.emplace(L,r,a,p,m,_,x,w,T,I,D)}emplace(r,a,p,m,_,x,w,T,I,D,L){const O=10*r;return this.uint16[O+0]=a,this.uint16[O+1]=p,this.uint16[O+2]=m,this.uint16[O+3]=_,this.uint16[O+4]=x,this.uint16[O+5]=w,this.uint16[O+6]=T,this.uint16[O+7]=I,this.uint16[O+8]=D,this.uint16[O+9]=L,r}}ut.prototype.bytesPerElement=20,oe("StructArrayLayout10ui20",ut);class gt extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,p,m,_,x,w,T,I,D,L,O){const j=this.length;return this.resize(j+1),this.emplace(j,r,a,p,m,_,x,w,T,I,D,L,O)}emplace(r,a,p,m,_,x,w,T,I,D,L,O,j){const q=12*r;return this.int16[q+0]=a,this.int16[q+1]=p,this.int16[q+2]=m,this.int16[q+3]=_,this.uint16[q+4]=x,this.uint16[q+5]=w,this.uint16[q+6]=T,this.uint16[q+7]=I,this.int16[q+8]=D,this.int16[q+9]=L,this.int16[q+10]=O,this.int16[q+11]=j,r}}gt.prototype.bytesPerElement=24,oe("StructArrayLayout4i4ui4i24",gt);class ot extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,p){const m=this.length;return this.resize(m+1),this.emplace(m,r,a,p)}emplace(r,a,p,m){const _=3*r;return this.float32[_+0]=a,this.float32[_+1]=p,this.float32[_+2]=m,r}}ot.prototype.bytesPerElement=12,oe("StructArrayLayout3f12",ot);class _t extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint32[1*r+0]=a,r}}_t.prototype.bytesPerElement=4,oe("StructArrayLayout1ul4",_t);class kt extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,p,m,_,x,w,T,I){const D=this.length;return this.resize(D+1),this.emplace(D,r,a,p,m,_,x,w,T,I)}emplace(r,a,p,m,_,x,w,T,I,D){const L=10*r,O=5*r;return this.int16[L+0]=a,this.int16[L+1]=p,this.int16[L+2]=m,this.int16[L+3]=_,this.int16[L+4]=x,this.int16[L+5]=w,this.uint32[O+3]=T,this.uint16[L+8]=I,this.uint16[L+9]=D,r}}kt.prototype.bytesPerElement=20,oe("StructArrayLayout6i1ul2ui20",kt);class Ct extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,p,m,_,x){const w=this.length;return this.resize(w+1),this.emplace(w,r,a,p,m,_,x)}emplace(r,a,p,m,_,x,w){const T=6*r;return this.int16[T+0]=a,this.int16[T+1]=p,this.int16[T+2]=m,this.int16[T+3]=_,this.int16[T+4]=x,this.int16[T+5]=w,r}}Ct.prototype.bytesPerElement=12,oe("StructArrayLayout2i2i2i12",Ct);class Dt extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,p,m,_){const x=this.length;return this.resize(x+1),this.emplace(x,r,a,p,m,_)}emplace(r,a,p,m,_,x){const w=4*r,T=8*r;return this.float32[w+0]=a,this.float32[w+1]=p,this.float32[w+2]=m,this.int16[T+6]=_,this.int16[T+7]=x,r}}Dt.prototype.bytesPerElement=16,oe("StructArrayLayout2f1f2i16",Dt);class jt extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,p,m,_,x){const w=this.length;return this.resize(w+1),this.emplace(w,r,a,p,m,_,x)}emplace(r,a,p,m,_,x,w){const T=16*r,I=4*r,D=8*r;return this.uint8[T+0]=a,this.uint8[T+1]=p,this.float32[I+1]=m,this.float32[I+2]=_,this.int16[D+6]=x,this.int16[D+7]=w,r}}jt.prototype.bytesPerElement=16,oe("StructArrayLayout2ub2f2i16",jt);class ie extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,p){const m=this.length;return this.resize(m+1),this.emplace(m,r,a,p)}emplace(r,a,p,m){const _=3*r;return this.uint16[_+0]=a,this.uint16[_+1]=p,this.uint16[_+2]=m,r}}ie.prototype.bytesPerElement=6,oe("StructArrayLayout3ui6",ie);class ne extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,p,m,_,x,w,T,I,D,L,O,j,q,J,it,ct){const wt=this.length;return this.resize(wt+1),this.emplace(wt,r,a,p,m,_,x,w,T,I,D,L,O,j,q,J,it,ct)}emplace(r,a,p,m,_,x,w,T,I,D,L,O,j,q,J,it,ct,wt){const pt=24*r,vt=12*r,zt=48*r;return this.int16[pt+0]=a,this.int16[pt+1]=p,this.uint16[pt+2]=m,this.uint16[pt+3]=_,this.uint32[vt+2]=x,this.uint32[vt+3]=w,this.uint32[vt+4]=T,this.uint16[pt+10]=I,this.uint16[pt+11]=D,this.uint16[pt+12]=L,this.float32[vt+7]=O,this.float32[vt+8]=j,this.uint8[zt+36]=q,this.uint8[zt+37]=J,this.uint8[zt+38]=it,this.uint32[vt+10]=ct,this.int16[pt+22]=wt,r}}ne.prototype.bytesPerElement=48,oe("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ne);class Ut extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,p,m,_,x,w,T,I,D,L,O,j,q,J,it,ct,wt,pt,vt,zt,Lt,ee,he,Jt,Yt,ae,me){const Qt=this.length;return this.resize(Qt+1),this.emplace(Qt,r,a,p,m,_,x,w,T,I,D,L,O,j,q,J,it,ct,wt,pt,vt,zt,Lt,ee,he,Jt,Yt,ae,me)}emplace(r,a,p,m,_,x,w,T,I,D,L,O,j,q,J,it,ct,wt,pt,vt,zt,Lt,ee,he,Jt,Yt,ae,me,Qt){const Rt=32*r,ue=16*r;return this.int16[Rt+0]=a,this.int16[Rt+1]=p,this.int16[Rt+2]=m,this.int16[Rt+3]=_,this.int16[Rt+4]=x,this.int16[Rt+5]=w,this.int16[Rt+6]=T,this.int16[Rt+7]=I,this.uint16[Rt+8]=D,this.uint16[Rt+9]=L,this.uint16[Rt+10]=O,this.uint16[Rt+11]=j,this.uint16[Rt+12]=q,this.uint16[Rt+13]=J,this.uint16[Rt+14]=it,this.uint16[Rt+15]=ct,this.uint16[Rt+16]=wt,this.uint16[Rt+17]=pt,this.uint16[Rt+18]=vt,this.uint16[Rt+19]=zt,this.uint16[Rt+20]=Lt,this.uint16[Rt+21]=ee,this.uint16[Rt+22]=he,this.uint32[ue+12]=Jt,this.float32[ue+13]=Yt,this.float32[ue+14]=ae,this.uint16[Rt+30]=me,this.uint16[Rt+31]=Qt,r}}Ut.prototype.bytesPerElement=64,oe("StructArrayLayout8i15ui1ul2f2ui64",Ut);class qt extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.float32[1*r+0]=a,r}}qt.prototype.bytesPerElement=4,oe("StructArrayLayout1f4",qt);class ce extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,p){const m=this.length;return this.resize(m+1),this.emplace(m,r,a,p)}emplace(r,a,p,m){const _=3*r;return this.uint16[6*r+0]=a,this.float32[_+1]=p,this.float32[_+2]=m,r}}ce.prototype.bytesPerElement=12,oe("StructArrayLayout1ui2f12",ce);class Ce extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,p){const m=this.length;return this.resize(m+1),this.emplace(m,r,a,p)}emplace(r,a,p,m){const _=4*r;return this.uint32[2*r+0]=a,this.uint16[_+2]=p,this.uint16[_+3]=m,r}}Ce.prototype.bytesPerElement=8,oe("StructArrayLayout1ul2ui8",Ce);class Wt extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a){const p=this.length;return this.resize(p+1),this.emplace(p,r,a)}emplace(r,a,p){const m=2*r;return this.uint16[m+0]=a,this.uint16[m+1]=p,r}}Wt.prototype.bytesPerElement=4,oe("StructArrayLayout2ui4",Wt);class Xt extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint16[1*r+0]=a,r}}Xt.prototype.bytesPerElement=2,oe("StructArrayLayout1ui2",Xt);class Te extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,p,m){const _=this.length;return this.resize(_+1),this.emplace(_,r,a,p,m)}emplace(r,a,p,m,_){const x=4*r;return this.float32[x+0]=a,this.float32[x+1]=p,this.float32[x+2]=m,this.float32[x+3]=_,r}}Te.prototype.bytesPerElement=16,oe("StructArrayLayout4f16",Te);class _i extends M{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new P(this.anchorPointX,this.anchorPointY)}}_i.prototype.size=20;class Re extends kt{get(r){return new _i(this,r)}}oe("CollisionBoxArray",Re);class je extends M{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}je.prototype.size=48;class vi extends ne{get(r){return new je(this,r)}}oe("PlacedSymbolArray",vi);class Dr extends M{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Dr.prototype.size=64;class Yn extends Ut{get(r){return new Dr(this,r)}}oe("SymbolInstanceArray",Yn);class xi extends qt{getoffsetX(r){return this.float32[1*r+0]}}oe("GlyphOffsetArray",xi);class on extends Z{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}oe("SymbolLineVertexArray",on);class Yr extends M{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Yr.prototype.size=12;class Lr extends ce{get(r){return new Yr(this,r)}}oe("TextAnchorOffsetArray",Lr);class Rr extends M{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Rr.prototype.size=8;class Kn extends Ce{get(r){return new Rr(this,r)}}oe("FeatureIndexArray",Kn);class Eo extends R{}class vc extends R{}class ua extends R{}class Po extends tt{}class xc extends lt{}class th extends et{}class Tr extends ut{}class Xn extends gt{}class oo extends ot{}class ha extends _t{}class Fr extends Ct{}class Or extends jt{}class mr extends ie{}class Pi extends Wt{}const da=z([{name:"a_pos",components:2,type:"Int16"}],4),{members:eh}=da;class or{constructor(r=[]){this.segments=r}prepareSegment(r,a,p,m){let _=this.segments[this.segments.length-1];return r>or.MAX_VERTEX_ARRAY_LENGTH&&_e(`Max vertices per segment is ${or.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!_||_.vertexLength+r>or.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==m)&&(_={vertexOffset:a.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},m!==void 0&&(_.sortKey=m),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const r of this.segments)for(const a in r.vaos)r.vaos[a].destroy()}static simpleSegment(r,a,p,m){return new or([{vertexOffset:r,primitiveOffset:a,vertexLength:p,primitiveLength:m,vaos:{},sortKey:0}])}}function Cp(o,r){return 256*(o=mt(Math.floor(o),0,255))+mt(Math.floor(r),0,255)}or.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,oe("SegmentVector",or);const bc=z([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var wc={exports:{}},ao={exports:{}};ao.exports=function(o,r){var a,p,m,_,x,w,T,I;for(p=o.length-(a=3&o.length),m=r,x=3432918353,w=461845907,I=0;I<p;)T=255&o.charCodeAt(I)|(255&o.charCodeAt(++I))<<8|(255&o.charCodeAt(++I))<<16|(255&o.charCodeAt(++I))<<24,++I,m=27492+(65535&(_=5*(65535&(m=(m^=T=(65535&(T=(T=(65535&T)*x+(((T>>>16)*x&65535)<<16)&4294967295)<<15|T>>>17))*w+(((T>>>16)*w&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(T=0,a){case 3:T^=(255&o.charCodeAt(I+2))<<16;case 2:T^=(255&o.charCodeAt(I+1))<<8;case 1:m^=T=(65535&(T=(T=(65535&(T^=255&o.charCodeAt(I)))*x+(((T>>>16)*x&65535)<<16)&4294967295)<<15|T>>>17))*w+(((T>>>16)*w&65535)<<16)&4294967295}return m^=o.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0};var Ep=ao.exports,ih={exports:{}};ih.exports=function(o,r){for(var a,p=o.length,m=r^p,_=0;p>=4;)a=1540483477*(65535&(a=255&o.charCodeAt(_)|(255&o.charCodeAt(++_))<<8|(255&o.charCodeAt(++_))<<16|(255&o.charCodeAt(++_))<<24))+((1540483477*(a>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),p-=4,++_;switch(p){case 3:m^=(255&o.charCodeAt(_+2))<<16;case 2:m^=(255&o.charCodeAt(_+1))<<8;case 1:m=1540483477*(65535&(m^=255&o.charCodeAt(_)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};var rh=Ep,nh=ih.exports;wc.exports=rh,wc.exports.murmur3=rh,wc.exports.murmur2=nh;var Sc=b(wc.exports);class pa{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,a,p,m){this.ids.push(Dv(r)),this.positions.push(a,p,m)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=Dv(r);let p=0,m=this.ids.length-1;for(;p<m;){const x=p+m>>1;this.ids[x]>=a?m=x:p=x+1}const _=[];for(;this.ids[p]===a;)_.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return _}static serialize(r,a){const p=new Float64Array(r.ids),m=new Uint32Array(r.positions);return bg(p,m,0,p.length-1),a&&a.push(p.buffer,m.buffer),{ids:p,positions:m}}static deserialize(r){const a=new pa;return a.ids=r.ids,a.positions=r.positions,a.indexed=!0,a}}function Dv(o){const r=+o;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:Sc(String(o))}function bg(o,r,a,p){for(;a<p;){const m=o[a+p>>1];let _=a-1,x=p+1;for(;;){do _++;while(o[_]<m);do x--;while(o[x]>m);if(_>=x)break;Pp(o,_,x),Pp(r,3*_,3*x),Pp(r,3*_+1,3*x+1),Pp(r,3*_+2,3*x+2)}x-a<p-x?(bg(o,r,a,x),a=x+1):(bg(o,r,x+1,p),p=x)}}function Pp(o,r,a){const p=o[r];o[r]=o[a],o[a]=p}oe("FeaturePositionMap",pa);class fl{constructor(r,a){this.gl=r.gl,this.location=a}}class Ip extends fl{constructor(r,a){super(r,a),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class Lv extends fl{constructor(r,a){super(r,a),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class Rv extends fl{constructor(r,a){super(r,a),this.current=qe.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const i3=new Float32Array(16);function wg(o){return[Cp(255*o.r,255*o.g),Cp(255*o.b,255*o.a)]}class sh{constructor(r,a,p){this.value=r,this.uniformNames=a.map(m=>`u_${m}`),this.type=p}setUniform(r,a,p){r.set(p.constantOr(this.value))}getBinding(r,a,p){return this.type==="color"?new Rv(r,a):new Ip(r,a)}}class kc{constructor(r,a){this.uniformNames=a.map(p=>`u_${p}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=r.tlbr}setUniform(r,a,p,m){const _=m==="u_pattern_to"?this.patternTo:m==="u_pattern_from"?this.patternFrom:m==="u_pixel_ratio_to"?this.pixelRatioTo:m==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&r.set(_)}getBinding(r,a,p){return p.substr(0,9)==="u_pattern"?new Lv(r,a):new Ip(r,a)}}class Io{constructor(r,a,p,m){this.expression=r,this.type=p,this.maxValue=0,this.paintVertexAttributes=a.map(_=>({name:`a_${_}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(r,a,p,m,_){const x=this.paintVertexArray.length,w=this.expression.evaluate(new mi(0),a,{},m,[],_);this.paintVertexArray.resize(r),this._setPaintValue(x,r,w)}updatePaintArray(r,a,p,m){const _=this.expression.evaluate({zoom:0},p,m);this._setPaintValue(r,a,_)}_setPaintValue(r,a,p){if(this.type==="color"){const m=wg(p);for(let _=r;_<a;_++)this.paintVertexArray.emplace(_,m[0],m[1])}else{for(let m=r;m<a;m++)this.paintVertexArray.emplace(m,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class As{constructor(r,a,p,m,_,x){this.expression=r,this.uniformNames=a.map(w=>`u_${w}_t`),this.type=p,this.useIntegerZoom=m,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=a.map(w=>({name:`a_${w}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(r,a,p,m,_){const x=this.expression.evaluate(new mi(this.zoom),a,{},m,[],_),w=this.expression.evaluate(new mi(this.zoom+1),a,{},m,[],_),T=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(T,r,x,w)}updatePaintArray(r,a,p,m){const _=this.expression.evaluate({zoom:this.zoom},p,m),x=this.expression.evaluate({zoom:this.zoom+1},p,m);this._setPaintValue(r,a,_,x)}_setPaintValue(r,a,p,m){if(this.type==="color"){const _=wg(p),x=wg(m);for(let w=r;w<a;w++)this.paintVertexArray.emplace(w,_[0],_[1],x[0],x[1])}else{for(let _=r;_<a;_++)this.paintVertexArray.emplace(_,p,m);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(m))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,a){const p=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,m=mt(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);r.set(m)}getBinding(r,a,p){return new Ip(r,a)}}class fa{constructor(r,a,p,m,_,x){this.expression=r,this.type=a,this.useIntegerZoom=p,this.zoom=m,this.layerId=x,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(r,a,p){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(m,r,a.patterns&&a.patterns[this.layerId],p)}updatePaintArray(r,a,p,m,_){this._setPaintValues(r,a,p.patterns&&p.patterns[this.layerId],_)}_setPaintValues(r,a,p,m){if(!m||!p)return;const{min:_,mid:x,max:w}=p,T=m[_],I=m[x],D=m[w];if(T&&I&&D)for(let L=r;L<a;L++)this.zoomInPaintVertexArray.emplace(L,I.tl[0],I.tl[1],I.br[0],I.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],I.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(L,I.tl[0],I.tl[1],I.br[0],I.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],I.pixelRatio,D.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,bc.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,bc.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Fv{constructor(r,a,p){this.binders={},this._buffers=[];const m=[];for(const _ in r.paint._values){if(!p(_))continue;const x=r.paint.get(_);if(!(x instanceof fs&&Es(x.property.specification)))continue;const w=r3(_,r.type),T=x.value,I=x.property.specification.type,D=x.property.useIntegerZoom,L=x.property.specification["property-type"],O=L==="cross-faded"||L==="cross-faded-data-driven";if(T.kind==="constant")this.binders[_]=O?new kc(T.value,w):new sh(T.value,w,I),m.push(`/u_${_}`);else if(T.kind==="source"||O){const j=Ov(_,I,"source");this.binders[_]=O?new fa(T,I,D,a,j,r.id):new Io(T,w,I,j),m.push(`/a_${_}`)}else{const j=Ov(_,I,"composite");this.binders[_]=new As(T,w,I,D,a,j),m.push(`/z_${_}`)}}this.cacheKey=m.sort().join("")}getMaxValue(r){const a=this.binders[r];return a instanceof Io||a instanceof As?a.maxValue:0}populatePaintArrays(r,a,p,m,_){for(const x in this.binders){const w=this.binders[x];(w instanceof Io||w instanceof As||w instanceof fa)&&w.populatePaintArray(r,a,p,m,_)}}setConstantPatternPositions(r,a){for(const p in this.binders){const m=this.binders[p];m instanceof kc&&m.setConstantPatternPositions(r,a)}}updatePaintArrays(r,a,p,m,_){let x=!1;for(const w in r){const T=a.getPositions(w);for(const I of T){const D=p.feature(I.index);for(const L in this.binders){const O=this.binders[L];if((O instanceof Io||O instanceof As||O instanceof fa)&&O.expression.isStateDependent===!0){const j=m.paint.get(L);O.expression=j.value,O.updatePaintArray(I.start,I.end,D,r[w],_),x=!0}}}}return x}defines(){const r=[];for(const a in this.binders){const p=this.binders[a];(p instanceof sh||p instanceof kc)&&r.push(...p.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return r}getBinderAttributes(){const r=[];for(const a in this.binders){const p=this.binders[a];if(p instanceof Io||p instanceof As)for(let m=0;m<p.paintVertexAttributes.length;m++)r.push(p.paintVertexAttributes[m].name);else if(p instanceof fa)for(let m=0;m<bc.members.length;m++)r.push(bc.members[m].name)}return r}getBinderUniforms(){const r=[];for(const a in this.binders){const p=this.binders[a];if(p instanceof sh||p instanceof kc||p instanceof As)for(const m of p.uniformNames)r.push(m)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,a){const p=[];for(const m in this.binders){const _=this.binders[m];if(_ instanceof sh||_ instanceof kc||_ instanceof As){for(const x of _.uniformNames)if(a[x]){const w=_.getBinding(r,a[x],x);p.push({name:x,property:m,binding:w})}}}return p}setUniforms(r,a,p,m){for(const{name:_,property:x,binding:w}of a)this.binders[x].setUniform(w,m,p.get(x),_)}updatePaintBuffers(r){this._buffers=[];for(const a in this.binders){const p=this.binders[a];if(r&&p instanceof fa){const m=r.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(p instanceof Io||p instanceof As)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(r){for(const a in this.binders){const p=this.binders[a];(p instanceof Io||p instanceof As||p instanceof fa)&&p.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const a=this.binders[r];(a instanceof Io||a instanceof As||a instanceof fa)&&a.destroy()}}}class ml{constructor(r,a,p=()=>!0){this.programConfigurations={};for(const m of r)this.programConfigurations[m.id]=new Fv(m,a,p);this.needsUpload=!1,this._featureMap=new pa,this._bufferOffset=0}populatePaintArrays(r,a,p,m,_,x){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(r,a,m,_,x);a.id!==void 0&&this._featureMap.add(a.id,p,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,a,p,m){for(const _ of p)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(r,this._featureMap,a,_,m)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function r3(o,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[o]||[o.replace(`${r}-`,"").replace(/-/g,"_")]}function Ov(o,r,a){const p={color:{source:et,composite:Te},number:{source:qt,composite:et}},m=function(_){return{"line-pattern":{source:Tr,composite:Tr},"fill-pattern":{source:Tr,composite:Tr},"fill-extrusion-pattern":{source:Tr,composite:Tr}}[_]}(o);return m&&m[a]||p[r][a]}oe("ConstantBinder",sh),oe("CrossFadedConstantBinder",kc),oe("SourceExpressionBinder",Io),oe("CrossFadedCompositeBinder",fa),oe("CompositeExpressionBinder",As),oe("ProgramConfiguration",Fv,{omit:["_buffers"]}),oe("ProgramConfigurationSet",ml);const Ji=8192,Sg=Math.pow(2,14)-1,Bv=-Sg-1;function gl(o){const r=Ji/o.extent,a=o.loadGeometry();for(let p=0;p<a.length;p++){const m=a[p];for(let _=0;_<m.length;_++){const x=m[_],w=Math.round(x.x*r),T=Math.round(x.y*r);x.x=mt(w,Bv,Sg),x.y=mt(T,Bv,Sg),(w<x.x||w>x.x+1||T<x.y||T>x.y+1)&&_e("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function yl(o,r){return{type:o.type,id:o.id,properties:o.properties,geometry:r?gl(o):[]}}function Ap(o,r,a,p,m){o.emplaceBack(2*r+(p+1)/2,2*a+(m+1)/2)}class kg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new vc,this.indexArray=new mr,this.segments=new or,this.programConfigurations=new ml(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(r,a,p){const m=this.layers[0],_=[];let x=null,w=!1;m.type==="circle"&&(x=m.layout.get("circle-sort-key"),w=!x.isConstant());for(const{feature:T,id:I,index:D,sourceLayerIndex:L}of r){const O=this.layers[0]._featureFilter.needGeometry,j=yl(T,O);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),j,p))continue;const q=w?x.evaluate(j,{},p):void 0,J={id:I,properties:T.properties,type:T.type,sourceLayerIndex:L,index:D,geometry:O?j.geometry:gl(T),patterns:{},sortKey:q};_.push(J)}w&&_.sort((T,I)=>T.sortKey-I.sortKey);for(const T of _){const{geometry:I,index:D,sourceLayerIndex:L}=T,O=r[D].feature;this.addFeature(T,I,D,p),a.featureIndex.insert(O,I,D,L,this.index)}}update(r,a,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,eh),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,a,p,m){for(const _ of a)for(const x of _){const w=x.x,T=x.y;if(w<0||w>=Ji||T<0||T>=Ji)continue;const I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),D=I.vertexLength;Ap(this.layoutVertexArray,w,T,-1,-1),Ap(this.layoutVertexArray,w,T,1,-1),Ap(this.layoutVertexArray,w,T,1,1),Ap(this.layoutVertexArray,w,T,-1,1),this.indexArray.emplaceBack(D,D+1,D+2),this.indexArray.emplaceBack(D,D+3,D+2),I.vertexLength+=4,I.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,p,{},m)}}function Vv(o,r){for(let a=0;a<o.length;a++)if(Tc(r,o[a]))return!0;for(let a=0;a<r.length;a++)if(Tc(o,r[a]))return!0;return!!Tg(o,r)}function n3(o,r,a){return!!Tc(o,r)||!!Mg(r,o,a)}function $v(o,r){if(o.length===1)return jv(r,o[0]);for(let a=0;a<r.length;a++){const p=r[a];for(let m=0;m<p.length;m++)if(Tc(o,p[m]))return!0}for(let a=0;a<o.length;a++)if(jv(r,o[a]))return!0;for(let a=0;a<r.length;a++)if(Tg(o,r[a]))return!0;return!1}function s3(o,r,a){if(o.length>1){if(Tg(o,r))return!0;for(let p=0;p<r.length;p++)if(Mg(r[p],o,a))return!0}for(let p=0;p<o.length;p++)if(Mg(o[p],r,a))return!0;return!1}function Tg(o,r){if(o.length===0||r.length===0)return!1;for(let a=0;a<o.length-1;a++){const p=o[a],m=o[a+1];for(let _=0;_<r.length-1;_++)if(o3(p,m,r[_],r[_+1]))return!0}return!1}function o3(o,r,a,p){return Ae(o,a,p)!==Ae(r,a,p)&&Ae(o,r,a)!==Ae(o,r,p)}function Mg(o,r,a){const p=a*a;if(r.length===1)return o.distSqr(r[0])<p;for(let m=1;m<r.length;m++)if(Nv(o,r[m-1],r[m])<p)return!0;return!1}function Nv(o,r,a){const p=r.distSqr(a);if(p===0)return o.distSqr(r);const m=((o.x-r.x)*(a.x-r.x)+(o.y-r.y)*(a.y-r.y))/p;return o.distSqr(m<0?r:m>1?a:a.sub(r)._mult(m)._add(r))}function jv(o,r){let a,p,m,_=!1;for(let x=0;x<o.length;x++){a=o[x];for(let w=0,T=a.length-1;w<a.length;T=w++)p=a[w],m=a[T],p.y>r.y!=m.y>r.y&&r.x<(m.x-p.x)*(r.y-p.y)/(m.y-p.y)+p.x&&(_=!_)}return _}function Tc(o,r){let a=!1;for(let p=0,m=o.length-1;p<o.length;m=p++){const _=o[p],x=o[m];_.y>r.y!=x.y>r.y&&r.x<(x.x-_.x)*(r.y-_.y)/(x.y-_.y)+_.x&&(a=!a)}return a}function a3(o,r,a){const p=a[0],m=a[2];if(o.x<p.x&&r.x<p.x||o.x>m.x&&r.x>m.x||o.y<p.y&&r.y<p.y||o.y>m.y&&r.y>m.y)return!1;const _=Ae(o,r,a[0]);return _!==Ae(o,r,a[1])||_!==Ae(o,r,a[2])||_!==Ae(o,r,a[3])}function oh(o,r,a){const p=r.paint.get(o).value;return p.kind==="constant"?p.value:a.programConfigurations.get(r.id).getMaxValue(o)}function zp(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function Dp(o,r,a,p,m){if(!r[0]&&!r[1])return o;const _=P.convert(r)._mult(m);a==="viewport"&&_._rotate(-p);const x=[];for(let w=0;w<o.length;w++)x.push(o[w].sub(_));return x}let Uv,Hv;oe("CircleBucket",kg,{omit:["layers"]});var l3={get paint(){return Hv=Hv||new f({"circle-radius":new be(Et.paint_circle["circle-radius"]),"circle-color":new be(Et.paint_circle["circle-color"]),"circle-blur":new be(Et.paint_circle["circle-blur"]),"circle-opacity":new be(Et.paint_circle["circle-opacity"]),"circle-translate":new pe(Et.paint_circle["circle-translate"]),"circle-translate-anchor":new pe(Et.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new pe(Et.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new pe(Et.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new be(Et.paint_circle["circle-stroke-width"]),"circle-stroke-color":new be(Et.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new be(Et.paint_circle["circle-stroke-opacity"])})},get layout(){return Uv=Uv||new f({"circle-sort-key":new be(Et.layout_circle["circle-sort-key"])})}},an=1e-6,Mc=typeof Float32Array<"u"?Float32Array:Array;function Cg(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function Zv(o,r,a){var p=r[0],m=r[1],_=r[2],x=r[3],w=r[4],T=r[5],I=r[6],D=r[7],L=r[8],O=r[9],j=r[10],q=r[11],J=r[12],it=r[13],ct=r[14],wt=r[15],pt=a[0],vt=a[1],zt=a[2],Lt=a[3];return o[0]=pt*p+vt*w+zt*L+Lt*J,o[1]=pt*m+vt*T+zt*O+Lt*it,o[2]=pt*_+vt*I+zt*j+Lt*ct,o[3]=pt*x+vt*D+zt*q+Lt*wt,o[4]=(pt=a[4])*p+(vt=a[5])*w+(zt=a[6])*L+(Lt=a[7])*J,o[5]=pt*m+vt*T+zt*O+Lt*it,o[6]=pt*_+vt*I+zt*j+Lt*ct,o[7]=pt*x+vt*D+zt*q+Lt*wt,o[8]=(pt=a[8])*p+(vt=a[9])*w+(zt=a[10])*L+(Lt=a[11])*J,o[9]=pt*m+vt*T+zt*O+Lt*it,o[10]=pt*_+vt*I+zt*j+Lt*ct,o[11]=pt*x+vt*D+zt*q+Lt*wt,o[12]=(pt=a[12])*p+(vt=a[13])*w+(zt=a[14])*L+(Lt=a[15])*J,o[13]=pt*m+vt*T+zt*O+Lt*it,o[14]=pt*_+vt*I+zt*j+Lt*ct,o[15]=pt*x+vt*D+zt*q+Lt*wt,o}Math.hypot||(Math.hypot=function(){for(var o=0,r=arguments.length;r--;)o+=arguments[r]*arguments[r];return Math.sqrt(o)});var ah,c3=Zv;function Lp(o,r,a){var p=r[0],m=r[1],_=r[2],x=r[3];return o[0]=a[0]*p+a[4]*m+a[8]*_+a[12]*x,o[1]=a[1]*p+a[5]*m+a[9]*_+a[13]*x,o[2]=a[2]*p+a[6]*m+a[10]*_+a[14]*x,o[3]=a[3]*p+a[7]*m+a[11]*_+a[15]*x,o}ah=new Mc(4),Mc!=Float32Array&&(ah[0]=0,ah[1]=0,ah[2]=0,ah[3]=0);class u3 extends v{constructor(r){super(r,l3)}createBucket(r){return new kg(r)}queryRadius(r){const a=r;return oh("circle-radius",this,a)+oh("circle-stroke-width",this,a)+zp(this.paint.get("circle-translate"))}queryIntersectsFeature(r,a,p,m,_,x,w,T){const I=Dp(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,w),D=this.paint.get("circle-radius").evaluate(a,p)+this.paint.get("circle-stroke-width").evaluate(a,p),L=this.paint.get("circle-pitch-alignment")==="map",O=L?I:function(q,J){return q.map(it=>qv(it,J))}(I,T),j=L?D*w:D;for(const q of m)for(const J of q){const it=L?J:qv(J,T);let ct=j;const wt=Lp([],[J.x,J.y,0,1],T);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ct*=wt[3]/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ct*=x.cameraToCenterDistance/wt[3]),n3(O,it,ct))return!0}return!1}}function qv(o,r){const a=Lp([],[o.x,o.y,0,1],r);return new P(a[0]/a[3],a[1]/a[3])}class Gv extends kg{}let Wv;oe("HeatmapBucket",Gv,{omit:["layers"]});var h3={get paint(){return Wv=Wv||new f({"heatmap-radius":new be(Et.paint_heatmap["heatmap-radius"]),"heatmap-weight":new be(Et.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new pe(Et.paint_heatmap["heatmap-intensity"]),"heatmap-color":new u(Et.paint_heatmap["heatmap-color"]),"heatmap-opacity":new pe(Et.paint_heatmap["heatmap-opacity"])})}};function Eg(o,{width:r,height:a},p,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==r*a*p)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${r*a*p}`)}else m=new Uint8Array(r*a*p);return o.width=r,o.height=a,o.data=m,o}function Yv(o,{width:r,height:a},p){if(r===o.width&&a===o.height)return;const m=Eg({},{width:r,height:a},p);Pg(o,m,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,r),height:Math.min(o.height,a)},p),o.width=r,o.height=a,o.data=m.data}function Pg(o,r,a,p,m,_){if(m.width===0||m.height===0)return r;if(m.width>o.width||m.height>o.height||a.x>o.width-m.width||a.y>o.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>r.width||m.height>r.height||p.x>r.width-m.width||p.y>r.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const x=o.data,w=r.data;if(x===w)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<m.height;T++){const I=((a.y+T)*o.width+a.x)*_,D=((p.y+T)*r.width+p.x)*_;for(let L=0;L<m.width*_;L++)w[D+L]=x[I+L]}return r}class lh{constructor(r,a){Eg(this,r,1,a)}resize(r){Yv(this,r,1)}clone(){return new lh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,a,p,m,_){Pg(r,a,p,m,_,1)}}class Jn{constructor(r,a){Eg(this,r,4,a)}resize(r){Yv(this,r,4)}replace(r,a){a?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Jn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,a,p,m,_){Pg(r,a,p,m,_,4)}}function Kv(o){const r={},a=o.resolution||256,p=o.clips?o.clips.length:1,m=o.image||new Jn({width:a,height:p});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const _=(x,w,T)=>{r[o.evaluationKey]=T;const I=o.expression.evaluate(r);m.data[x+w+0]=Math.floor(255*I.r/I.a),m.data[x+w+1]=Math.floor(255*I.g/I.a),m.data[x+w+2]=Math.floor(255*I.b/I.a),m.data[x+w+3]=Math.floor(255*I.a)};if(o.clips)for(let x=0,w=0;x<p;++x,w+=4*a)for(let T=0,I=0;T<a;T++,I+=4){const D=T/(a-1),{start:L,end:O}=o.clips[x];_(w,I,L*(1-D)+O*D)}else for(let x=0,w=0;x<a;x++,w+=4)_(0,w,x/(a-1));return m}oe("AlphaImage",lh),oe("RGBAImage",Jn);class d3 extends v{createBucket(r){return new Gv(r)}constructor(r){super(r,h3),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Kv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Xv;var p3={get paint(){return Xv=Xv||new f({"hillshade-illumination-direction":new pe(Et.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new pe(Et.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new pe(Et.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new pe(Et.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new pe(Et.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new pe(Et.paint_hillshade["hillshade-accent-color"])})}};class f3 extends v{constructor(r){super(r,p3)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const m3=z([{name:"a_pos",components:2,type:"Int16"}],4),{members:g3}=m3;var Ig={exports:{}};function Rp(o,r,a){a=a||2;var p,m,_,x,w,T,I,D=r&&r.length,L=D?r[0]*a:o.length,O=Jv(o,0,L,a,!0),j=[];if(!O||O.next===O.prev)return j;if(D&&(O=function(J,it,ct,wt){var pt,vt,zt,Lt=[];for(pt=0,vt=it.length;pt<vt;pt++)(zt=Jv(J,it[pt]*wt,pt<vt-1?it[pt+1]*wt:J.length,wt,!1))===zt.next&&(zt.steiner=!0),Lt.push(k3(zt));for(Lt.sort(b3),pt=0;pt<Lt.length;pt++)ct=w3(Lt[pt],ct);return ct}(o,r,O,a)),o.length>80*a){p=_=o[0],m=x=o[1];for(var q=a;q<L;q+=a)(w=o[q])<p&&(p=w),(T=o[q+1])<m&&(m=T),w>_&&(_=w),T>x&&(x=T);I=(I=Math.max(_-p,x-m))!==0?32767/I:0}return ch(O,j,a,p,m,I,0),j}function Jv(o,r,a,p,m){var _,x;if(m===Dg(o,r,a,p)>0)for(_=r;_<a;_+=p)x=ex(_,o[_],o[_+1],x);else for(_=a-p;_>=r;_-=p)x=ex(_,o[_],o[_+1],x);return x&&Fp(x,x.next)&&(hh(x),x=x.next),x}function _l(o,r){if(!o)return o;r||(r=o);var a,p=o;do if(a=!1,p.steiner||!Fp(p,p.next)&&Gi(p.prev,p,p.next)!==0)p=p.next;else{if(hh(p),(p=r=p.prev)===p.next)break;a=!0}while(a||p!==r);return r}function ch(o,r,a,p,m,_,x){if(o){!x&&_&&function(D,L,O,j){var q=D;do q.z===0&&(q.z=Ag(q.x,q.y,L,O,j)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==D);q.prevZ.nextZ=null,q.prevZ=null,function(J){var it,ct,wt,pt,vt,zt,Lt,ee,he=1;do{for(ct=J,J=null,vt=null,zt=0;ct;){for(zt++,wt=ct,Lt=0,it=0;it<he&&(Lt++,wt=wt.nextZ);it++);for(ee=he;Lt>0||ee>0&&wt;)Lt!==0&&(ee===0||!wt||ct.z<=wt.z)?(pt=ct,ct=ct.nextZ,Lt--):(pt=wt,wt=wt.nextZ,ee--),vt?vt.nextZ=pt:J=pt,pt.prevZ=vt,vt=pt;ct=wt}vt.nextZ=null,he*=2}while(zt>1)}(q)}(o,p,m,_);for(var w,T,I=o;o.prev!==o.next;)if(w=o.prev,T=o.next,_?_3(o,p,m,_):y3(o))r.push(w.i/a|0),r.push(o.i/a|0),r.push(T.i/a|0),hh(o),o=T.next,I=T.next;else if((o=T)===I){x?x===1?ch(o=v3(_l(o),r,a),r,a,p,m,_,2):x===2&&x3(o,r,a,p,m,_):ch(_l(o),r,a,p,m,_,1);break}}}function y3(o){var r=o.prev,a=o,p=o.next;if(Gi(r,a,p)>=0)return!1;for(var m=r.x,_=a.x,x=p.x,w=r.y,T=a.y,I=p.y,D=m<_?m<x?m:x:_<x?_:x,L=w<T?w<I?w:I:T<I?T:I,O=m>_?m>x?m:x:_>x?_:x,j=w>T?w>I?w:I:T>I?T:I,q=p.next;q!==r;){if(q.x>=D&&q.x<=O&&q.y>=L&&q.y<=j&&Cc(m,w,_,T,x,I,q.x,q.y)&&Gi(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function _3(o,r,a,p){var m=o.prev,_=o,x=o.next;if(Gi(m,_,x)>=0)return!1;for(var w=m.x,T=_.x,I=x.x,D=m.y,L=_.y,O=x.y,j=w<T?w<I?w:I:T<I?T:I,q=D<L?D<O?D:O:L<O?L:O,J=w>T?w>I?w:I:T>I?T:I,it=D>L?D>O?D:O:L>O?L:O,ct=Ag(j,q,r,a,p),wt=Ag(J,it,r,a,p),pt=o.prevZ,vt=o.nextZ;pt&&pt.z>=ct&&vt&&vt.z<=wt;){if(pt.x>=j&&pt.x<=J&&pt.y>=q&&pt.y<=it&&pt!==m&&pt!==x&&Cc(w,D,T,L,I,O,pt.x,pt.y)&&Gi(pt.prev,pt,pt.next)>=0||(pt=pt.prevZ,vt.x>=j&&vt.x<=J&&vt.y>=q&&vt.y<=it&&vt!==m&&vt!==x&&Cc(w,D,T,L,I,O,vt.x,vt.y)&&Gi(vt.prev,vt,vt.next)>=0))return!1;vt=vt.nextZ}for(;pt&&pt.z>=ct;){if(pt.x>=j&&pt.x<=J&&pt.y>=q&&pt.y<=it&&pt!==m&&pt!==x&&Cc(w,D,T,L,I,O,pt.x,pt.y)&&Gi(pt.prev,pt,pt.next)>=0)return!1;pt=pt.prevZ}for(;vt&&vt.z<=wt;){if(vt.x>=j&&vt.x<=J&&vt.y>=q&&vt.y<=it&&vt!==m&&vt!==x&&Cc(w,D,T,L,I,O,vt.x,vt.y)&&Gi(vt.prev,vt,vt.next)>=0)return!1;vt=vt.nextZ}return!0}function v3(o,r,a){var p=o;do{var m=p.prev,_=p.next.next;!Fp(m,_)&&Qv(m,p,p.next,_)&&uh(m,_)&&uh(_,m)&&(r.push(m.i/a|0),r.push(p.i/a|0),r.push(_.i/a|0),hh(p),hh(p.next),p=o=_),p=p.next}while(p!==o);return _l(p)}function x3(o,r,a,p,m,_){var x=o;do{for(var w=x.next.next;w!==x.prev;){if(x.i!==w.i&&T3(x,w)){var T=tx(x,w);return x=_l(x,x.next),T=_l(T,T.next),ch(x,r,a,p,m,_,0),void ch(T,r,a,p,m,_,0)}w=w.next}x=x.next}while(x!==o)}function b3(o,r){return o.x-r.x}function w3(o,r){var a=function(m,_){var x,w=_,T=m.x,I=m.y,D=-1/0;do{if(I<=w.y&&I>=w.next.y&&w.next.y!==w.y){var L=w.x+(I-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(L<=T&&L>D&&(D=L,x=w.x<w.next.x?w:w.next,L===T))return x}w=w.next}while(w!==_);if(!x)return null;var O,j=x,q=x.x,J=x.y,it=1/0;w=x;do T>=w.x&&w.x>=q&&T!==w.x&&Cc(I<J?T:D,I,q,J,I<J?D:T,I,w.x,w.y)&&(O=Math.abs(I-w.y)/(T-w.x),uh(w,m)&&(O<it||O===it&&(w.x>x.x||w.x===x.x&&S3(x,w)))&&(x=w,it=O)),w=w.next;while(w!==j);return x}(o,r);if(!a)return r;var p=tx(a,o);return _l(p,p.next),_l(a,a.next)}function S3(o,r){return Gi(o.prev,o,r.prev)<0&&Gi(r.next,o,o.next)<0}function Ag(o,r,a,p,m){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-a)*m|0)|o<<8))|o<<4))|o<<2))|o<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-p)*m|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function k3(o){var r=o,a=o;do(r.x<a.x||r.x===a.x&&r.y<a.y)&&(a=r),r=r.next;while(r!==o);return a}function Cc(o,r,a,p,m,_,x,w){return(m-x)*(r-w)>=(o-x)*(_-w)&&(o-x)*(p-w)>=(a-x)*(r-w)&&(a-x)*(_-w)>=(m-x)*(p-w)}function T3(o,r){return o.next.i!==r.i&&o.prev.i!==r.i&&!function(a,p){var m=a;do{if(m.i!==a.i&&m.next.i!==a.i&&m.i!==p.i&&m.next.i!==p.i&&Qv(m,m.next,a,p))return!0;m=m.next}while(m!==a);return!1}(o,r)&&(uh(o,r)&&uh(r,o)&&function(a,p){var m=a,_=!1,x=(a.x+p.x)/2,w=(a.y+p.y)/2;do m.y>w!=m.next.y>w&&m.next.y!==m.y&&x<(m.next.x-m.x)*(w-m.y)/(m.next.y-m.y)+m.x&&(_=!_),m=m.next;while(m!==a);return _}(o,r)&&(Gi(o.prev,o,r.prev)||Gi(o,r.prev,r))||Fp(o,r)&&Gi(o.prev,o,o.next)>0&&Gi(r.prev,r,r.next)>0)}function Gi(o,r,a){return(r.y-o.y)*(a.x-r.x)-(r.x-o.x)*(a.y-r.y)}function Fp(o,r){return o.x===r.x&&o.y===r.y}function Qv(o,r,a,p){var m=Bp(Gi(o,r,a)),_=Bp(Gi(o,r,p)),x=Bp(Gi(a,p,o)),w=Bp(Gi(a,p,r));return m!==_&&x!==w||!(m!==0||!Op(o,a,r))||!(_!==0||!Op(o,p,r))||!(x!==0||!Op(a,o,p))||!(w!==0||!Op(a,r,p))}function Op(o,r,a){return r.x<=Math.max(o.x,a.x)&&r.x>=Math.min(o.x,a.x)&&r.y<=Math.max(o.y,a.y)&&r.y>=Math.min(o.y,a.y)}function Bp(o){return o>0?1:o<0?-1:0}function uh(o,r){return Gi(o.prev,o,o.next)<0?Gi(o,r,o.next)>=0&&Gi(o,o.prev,r)>=0:Gi(o,r,o.prev)<0||Gi(o,o.next,r)<0}function tx(o,r){var a=new zg(o.i,o.x,o.y),p=new zg(r.i,r.x,r.y),m=o.next,_=r.prev;return o.next=r,r.prev=o,a.next=m,m.prev=a,p.next=a,a.prev=p,_.next=p,p.prev=_,p}function ex(o,r,a,p){var m=new zg(o,r,a);return p?(m.next=p.next,m.prev=p,p.next.prev=m,p.next=m):(m.prev=m,m.next=m),m}function hh(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function zg(o,r,a){this.i=o,this.x=r,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Dg(o,r,a,p){for(var m=0,_=r,x=a-p;_<a;_+=p)m+=(o[x]-o[_])*(o[_+1]+o[x+1]),x=_;return m}Ig.exports=Rp,Ig.exports.default=Rp,Rp.deviation=function(o,r,a,p){var m=r&&r.length,_=Math.abs(Dg(o,0,m?r[0]*a:o.length,a));if(m)for(var x=0,w=r.length;x<w;x++)_-=Math.abs(Dg(o,r[x]*a,x<w-1?r[x+1]*a:o.length,a));var T=0;for(x=0;x<p.length;x+=3){var I=p[x]*a,D=p[x+1]*a,L=p[x+2]*a;T+=Math.abs((o[I]-o[L])*(o[D+1]-o[I+1])-(o[I]-o[D])*(o[L+1]-o[I+1]))}return _===0&&T===0?0:Math.abs((T-_)/_)},Rp.flatten=function(o){for(var r=o[0][0].length,a={vertices:[],holes:[],dimensions:r},p=0,m=0;m<o.length;m++){for(var _=0;_<o[m].length;_++)for(var x=0;x<r;x++)a.vertices.push(o[m][_][x]);m>0&&a.holes.push(p+=o[m-1].length)}return a};var ix=b(Ig.exports);function Lg(o,r,a){const p=a.patternDependencies;let m=!1;for(const _ of r){const x=_.paint.get(`${o}-pattern`);x.isConstant()||(m=!0);const w=x.constantOr(null);w&&(m=!0,p[w.to]=!0,p[w.from]=!0)}return m}function Rg(o,r,a,p,m){const _=m.patternDependencies;for(const x of r){const w=x.paint.get(`${o}-pattern`).value;if(w.kind!=="constant"){let T=w.evaluate({zoom:p-1},a,{},m.availableImages),I=w.evaluate({zoom:p},a,{},m.availableImages),D=w.evaluate({zoom:p+1},a,{},m.availableImages);T=T&&T.name?T.name:T,I=I&&I.name?I.name:I,D=D&&D.name?D.name:D,_[T]=!0,_[I]=!0,_[D]=!0,a.patterns[x.id]={min:T,mid:I,max:D}}}return a}class Fg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ua,this.indexArray=new mr,this.indexArray2=new Pi,this.programConfigurations=new ml(r.layers,r.zoom),this.segments=new or,this.segments2=new or,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(r,a,p){this.hasPattern=Lg("fill",this.layers,a);const m=this.layers[0].layout.get("fill-sort-key"),_=!m.isConstant(),x=[];for(const{feature:w,id:T,index:I,sourceLayerIndex:D}of r){const L=this.layers[0]._featureFilter.needGeometry,O=yl(w,L);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),O,p))continue;const j=_?m.evaluate(O,{},p,a.availableImages):void 0,q={id:T,properties:w.properties,type:w.type,sourceLayerIndex:D,index:I,geometry:L?O.geometry:gl(w),patterns:{},sortKey:j};x.push(q)}_&&x.sort((w,T)=>w.sortKey-T.sortKey);for(const w of x){const{geometry:T,index:I,sourceLayerIndex:D}=w;if(this.hasPattern){const L=Rg("fill",this.layers,w,this.zoom,a);this.patternFeatures.push(L)}else this.addFeature(w,T,I,p,{});a.featureIndex.insert(r[I].feature,T,I,D,this.index)}}update(r,a,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,p)}addFeatures(r,a,p){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,a,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,g3),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,a,p,m,_){for(const x of Xl(a,500)){let w=0;for(const j of x)w+=j.length;const T=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),I=T.vertexLength,D=[],L=[];for(const j of x){if(j.length===0)continue;j!==x[0]&&L.push(D.length/2);const q=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),J=q.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack(J+j.length-1,J),D.push(j[0].x),D.push(j[0].y);for(let it=1;it<j.length;it++)this.layoutVertexArray.emplaceBack(j[it].x,j[it].y),this.indexArray2.emplaceBack(J+it-1,J+it),D.push(j[it].x),D.push(j[it].y);q.vertexLength+=j.length,q.primitiveLength+=j.length}const O=ix(D,L);for(let j=0;j<O.length;j+=3)this.indexArray.emplaceBack(I+O[j],I+O[j+1],I+O[j+2]);T.vertexLength+=w,T.primitiveLength+=O.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,p,_,m)}}let rx,nx;oe("FillBucket",Fg,{omit:["layers","patternFeatures"]});var M3={get paint(){return nx=nx||new f({"fill-antialias":new pe(Et.paint_fill["fill-antialias"]),"fill-opacity":new be(Et.paint_fill["fill-opacity"]),"fill-color":new be(Et.paint_fill["fill-color"]),"fill-outline-color":new be(Et.paint_fill["fill-outline-color"]),"fill-translate":new pe(Et.paint_fill["fill-translate"]),"fill-translate-anchor":new pe(Et.paint_fill["fill-translate-anchor"]),"fill-pattern":new y(Et.paint_fill["fill-pattern"])})},get layout(){return rx=rx||new f({"fill-sort-key":new be(Et.layout_fill["fill-sort-key"])})}};class C3 extends v{constructor(r){super(r,M3)}recalculate(r,a){super.recalculate(r,a);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new Fg(r)}queryRadius(){return zp(this.paint.get("fill-translate"))}queryIntersectsFeature(r,a,p,m,_,x,w){return $v(Dp(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,w),m)}isTileClipped(){return!0}}const E3=z([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),P3=z([{name:"a_centroid",components:2,type:"Int16"}],4),{members:I3}=E3;var ma={},A3=S,sx=Ec;function Ec(o,r,a,p,m){this.properties={},this.extent=a,this.type=0,this._pbf=o,this._geometry=-1,this._keys=p,this._values=m,o.readFields(z3,this,r)}function z3(o,r,a){o==1?r.id=a.readVarint():o==2?function(p,m){for(var _=p.readVarint()+p.pos;p.pos<_;){var x=m._keys[p.readVarint()],w=m._values[p.readVarint()];m.properties[x]=w}}(a,r):o==3?r.type=a.readVarint():o==4&&(r._geometry=a.pos)}function D3(o){for(var r,a,p=0,m=0,_=o.length,x=_-1;m<_;x=m++)p+=((a=o[x]).x-(r=o[m]).x)*(r.y+a.y);return p}Ec.types=["Unknown","Point","LineString","Polygon"],Ec.prototype.loadGeometry=function(){var o=this._pbf;o.pos=this._geometry;for(var r,a=o.readVarint()+o.pos,p=1,m=0,_=0,x=0,w=[];o.pos<a;){if(m<=0){var T=o.readVarint();p=7&T,m=T>>3}if(m--,p===1||p===2)_+=o.readSVarint(),x+=o.readSVarint(),p===1&&(r&&w.push(r),r=[]),r.push(new A3(_,x));else{if(p!==7)throw new Error("unknown command "+p);r&&r.push(r[0].clone())}}return r&&w.push(r),w},Ec.prototype.bbox=function(){var o=this._pbf;o.pos=this._geometry;for(var r=o.readVarint()+o.pos,a=1,p=0,m=0,_=0,x=1/0,w=-1/0,T=1/0,I=-1/0;o.pos<r;){if(p<=0){var D=o.readVarint();a=7&D,p=D>>3}if(p--,a===1||a===2)(m+=o.readSVarint())<x&&(x=m),m>w&&(w=m),(_+=o.readSVarint())<T&&(T=_),_>I&&(I=_);else if(a!==7)throw new Error("unknown command "+a)}return[x,T,w,I]},Ec.prototype.toGeoJSON=function(o,r,a){var p,m,_=this.extent*Math.pow(2,a),x=this.extent*o,w=this.extent*r,T=this.loadGeometry(),I=Ec.types[this.type];function D(j){for(var q=0;q<j.length;q++){var J=j[q];j[q]=[360*(J.x+x)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(J.y+w)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var L=[];for(p=0;p<T.length;p++)L[p]=T[p][0];D(T=L);break;case 2:for(p=0;p<T.length;p++)D(T[p]);break;case 3:for(T=function(j){var q=j.length;if(q<=1)return[j];for(var J,it,ct=[],wt=0;wt<q;wt++){var pt=D3(j[wt]);pt!==0&&(it===void 0&&(it=pt<0),it===pt<0?(J&&ct.push(J),J=[j[wt]]):J.push(j[wt]))}return J&&ct.push(J),ct}(T),p=0;p<T.length;p++)for(m=0;m<T[p].length;m++)D(T[p][m])}T.length===1?T=T[0]:I="Multi"+I;var O={type:"Feature",geometry:{type:I,coordinates:T},properties:this.properties};return"id"in this&&(O.id=this.id),O};var L3=sx,ox=ax;function ax(o,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(R3,this,r),this.length=this._features.length}function R3(o,r,a){o===15?r.version=a.readVarint():o===1?r.name=a.readString():o===5?r.extent=a.readVarint():o===2?r._features.push(a.pos):o===3?r._keys.push(a.readString()):o===4&&r._values.push(function(p){for(var m=null,_=p.readVarint()+p.pos;p.pos<_;){var x=p.readVarint()>>3;m=x===1?p.readString():x===2?p.readFloat():x===3?p.readDouble():x===4?p.readVarint64():x===5?p.readVarint():x===6?p.readSVarint():x===7?p.readBoolean():null}return m}(a))}ax.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var r=this._pbf.readVarint()+this._pbf.pos;return new L3(this._pbf,r,this.extent,this._keys,this._values)};var F3=ox;function O3(o,r,a){if(o===3){var p=new F3(a,a.readVarint()+a.pos);p.length&&(r[p.name]=p)}}ma.VectorTile=function(o,r){this.layers=o.readFields(O3,{},r)},ma.VectorTileFeature=sx,ma.VectorTileLayer=ox;const B3=ma.VectorTileFeature.types,Og=Math.pow(2,13);function dh(o,r,a,p,m,_,x,w){o.emplaceBack(r,a,2*Math.floor(p*Og)+x,m*Og*2,_*Og*2,Math.round(w))}class Bg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Po,this.centroidVertexArray=new Eo,this.indexArray=new mr,this.programConfigurations=new ml(r.layers,r.zoom),this.segments=new or,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(r,a,p){this.features=[],this.hasPattern=Lg("fill-extrusion",this.layers,a);for(const{feature:m,id:_,index:x,sourceLayerIndex:w}of r){const T=this.layers[0]._featureFilter.needGeometry,I=yl(m,T);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),I,p))continue;const D={id:_,sourceLayerIndex:w,index:x,geometry:T?I.geometry:gl(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(Rg("fill-extrusion",this.layers,D,this.zoom,a)):this.addFeature(D,D.geometry,x,p,{}),a.featureIndex.insert(m,D.geometry,x,w,this.index,!0)}}addFeatures(r,a,p){for(const m of this.features){const{geometry:_}=m;this.addFeature(m,_,m.index,a,p)}}update(r,a,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,I3),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,P3.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,a,p,m,_){const x={x:0,y:0,vertexCount:0};for(const w of Xl(a,500)){let T=0;for(const q of w)T+=q.length;let I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const q of w){if(q.length===0||$3(q))continue;let J=0;for(let it=0;it<q.length;it++){const ct=q[it];if(it>=1){const wt=q[it-1];if(!V3(ct,wt)){I.vertexLength+4>or.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const pt=ct.sub(wt)._perp()._unit(),vt=wt.dist(ct);J+vt>32768&&(J=0),dh(this.layoutVertexArray,ct.x,ct.y,pt.x,pt.y,0,0,J),dh(this.layoutVertexArray,ct.x,ct.y,pt.x,pt.y,0,1,J),x.x+=2*ct.x,x.y+=2*ct.y,x.vertexCount+=2,J+=vt,dh(this.layoutVertexArray,wt.x,wt.y,pt.x,pt.y,0,0,J),dh(this.layoutVertexArray,wt.x,wt.y,pt.x,pt.y,0,1,J),x.x+=2*wt.x,x.y+=2*wt.y,x.vertexCount+=2;const zt=I.vertexLength;this.indexArray.emplaceBack(zt,zt+2,zt+1),this.indexArray.emplaceBack(zt+1,zt+2,zt+3),I.vertexLength+=4,I.primitiveLength+=2}}}}if(I.vertexLength+T>or.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),B3[r.type]!=="Polygon")continue;const D=[],L=[],O=I.vertexLength;for(const q of w)if(q.length!==0){q!==w[0]&&L.push(D.length/2);for(let J=0;J<q.length;J++){const it=q[J];dh(this.layoutVertexArray,it.x,it.y,0,0,1,1,0),x.x+=it.x,x.y+=it.y,x.vertexCount+=1,D.push(it.x),D.push(it.y)}}const j=ix(D,L);for(let q=0;q<j.length;q+=3)this.indexArray.emplaceBack(O+j[q],O+j[q+2],O+j[q+1]);I.primitiveLength+=j.length/3,I.vertexLength+=T}for(let w=0;w<x.vertexCount;w++)this.centroidVertexArray.emplaceBack(Math.floor(x.x/x.vertexCount),Math.floor(x.y/x.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,p,_,m)}}function V3(o,r){return o.x===r.x&&(o.x<0||o.x>Ji)||o.y===r.y&&(o.y<0||o.y>Ji)}function $3(o){return o.every(r=>r.x<0)||o.every(r=>r.x>Ji)||o.every(r=>r.y<0)||o.every(r=>r.y>Ji)}let lx;oe("FillExtrusionBucket",Bg,{omit:["layers","features"]});var N3={get paint(){return lx=lx||new f({"fill-extrusion-opacity":new pe(Et["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new be(Et["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new pe(Et["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new pe(Et["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new y(Et["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new be(Et["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new be(Et["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new pe(Et["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class j3 extends v{constructor(r){super(r,N3)}createBucket(r){return new Bg(r)}queryRadius(){return zp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(r,a,p,m,_,x,w,T){const I=Dp(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,w),D=this.paint.get("fill-extrusion-height").evaluate(a,p),L=this.paint.get("fill-extrusion-base").evaluate(a,p),O=function(q,J,it,ct){const wt=[];for(const pt of q){const vt=[pt.x,pt.y,0,1];Lp(vt,vt,J),wt.push(new P(vt[0]/vt[3],vt[1]/vt[3]))}return wt}(I,T),j=function(q,J,it,ct){const wt=[],pt=[],vt=ct[8]*J,zt=ct[9]*J,Lt=ct[10]*J,ee=ct[11]*J,he=ct[8]*it,Jt=ct[9]*it,Yt=ct[10]*it,ae=ct[11]*it;for(const me of q){const Qt=[],Rt=[];for(const ue of me){const le=ue.x,ze=ue.y,di=ct[0]*le+ct[4]*ze+ct[12],pi=ct[1]*le+ct[5]*ze+ct[13],Qi=ct[2]*le+ct[6]*ze+ct[14],ts=ct[3]*le+ct[7]*ze+ct[15],Kr=Qi+Lt,lr=ts+ee,Mr=di+he,Xr=pi+Jt,ln=Qi+Yt,Jr=ts+ae,tr=new P((di+vt)/lr,(pi+zt)/lr);tr.z=Kr/lr,Qt.push(tr);const gr=new P(Mr/Jr,Xr/Jr);gr.z=ln/Jr,Rt.push(gr)}wt.push(Qt),pt.push(Rt)}return[wt,pt]}(m,L,D,T);return function(q,J,it){let ct=1/0;$v(it,J)&&(ct=cx(it,J[0]));for(let wt=0;wt<J.length;wt++){const pt=J[wt],vt=q[wt];for(let zt=0;zt<pt.length-1;zt++){const Lt=pt[zt],ee=[Lt,pt[zt+1],vt[zt+1],vt[zt],Lt];Vv(it,ee)&&(ct=Math.min(ct,cx(it,ee)))}}return ct!==1/0&&ct}(j[0],j[1],O)}}function ph(o,r){return o.x*r.x+o.y*r.y}function cx(o,r){if(o.length===1){let a=0;const p=r[a++];let m;for(;!m||p.equals(m);)if(m=r[a++],!m)return 1/0;for(;a<r.length;a++){const _=r[a],x=o[0],w=m.sub(p),T=_.sub(p),I=x.sub(p),D=ph(w,w),L=ph(w,T),O=ph(T,T),j=ph(I,w),q=ph(I,T),J=D*O-L*L,it=(O*j-L*q)/J,ct=(D*q-L*j)/J,wt=p.z*(1-it-ct)+m.z*it+_.z*ct;if(isFinite(wt))return wt}return 1/0}{let a=1/0;for(const p of r)a=Math.min(a,p.z);return a}}const U3=z([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:H3}=U3,Z3=z([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:q3}=Z3,G3=ma.VectorTileFeature.types,W3=Math.cos(Math.PI/180*37.5),ux=Math.pow(2,14)/.5;class Vg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new xc,this.layoutVertexArray2=new th,this.indexArray=new mr,this.programConfigurations=new ml(r.layers,r.zoom),this.segments=new or,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(r,a,p){this.hasPattern=Lg("line",this.layers,a);const m=this.layers[0].layout.get("line-sort-key"),_=!m.isConstant(),x=[];for(const{feature:w,id:T,index:I,sourceLayerIndex:D}of r){const L=this.layers[0]._featureFilter.needGeometry,O=yl(w,L);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),O,p))continue;const j=_?m.evaluate(O,{},p):void 0,q={id:T,properties:w.properties,type:w.type,sourceLayerIndex:D,index:I,geometry:L?O.geometry:gl(w),patterns:{},sortKey:j};x.push(q)}_&&x.sort((w,T)=>w.sortKey-T.sortKey);for(const w of x){const{geometry:T,index:I,sourceLayerIndex:D}=w;if(this.hasPattern){const L=Rg("line",this.layers,w,this.zoom,a);this.patternFeatures.push(L)}else this.addFeature(w,T,I,p,{});a.featureIndex.insert(r[I].feature,T,I,D,this.index)}}update(r,a,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,p)}addFeatures(r,a,p){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,a,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,q3)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,H3),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,a,p,m,_){const x=this.layers[0].layout,w=x.get("line-join").evaluate(r,{}),T=x.get("line-cap"),I=x.get("line-miter-limit"),D=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const L of a)this.addLine(L,r,w,T,I,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,p,_,m)}addLine(r,a,p,m,_,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ct=0;ct<r.length-1;ct++)this.totalDistance+=r[ct].dist(r[ct+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=G3[a.type]==="Polygon";let T=r.length;for(;T>=2&&r[T-1].equals(r[T-2]);)T--;let I=0;for(;I<T-1&&r[I].equals(r[I+1]);)I++;if(T<(w?3:2))return;p==="bevel"&&(_=1.05);const D=this.overscaling<=16?15*Ji/(512*this.overscaling):0,L=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let O,j,q,J,it;this.e1=this.e2=-1,w&&(O=r[T-2],it=r[I].sub(O)._unit()._perp());for(let ct=I;ct<T;ct++){if(q=ct===T-1?w?r[I+1]:void 0:r[ct+1],q&&r[ct].equals(q))continue;it&&(J=it),O&&(j=O),O=r[ct],it=q?q.sub(O)._unit()._perp():J,J=J||it;let wt=J.add(it);wt.x===0&&wt.y===0||wt._unit();const pt=J.x*it.x+J.y*it.y,vt=wt.x*it.x+wt.y*it.y,zt=vt!==0?1/vt:1/0,Lt=2*Math.sqrt(2-2*vt),ee=vt<W3&&j&&q,he=J.x*it.y-J.y*it.x>0;if(ee&&ct>I){const ae=O.dist(j);if(ae>2*D){const me=O.sub(O.sub(j)._mult(D/ae)._round());this.updateDistance(j,me),this.addCurrentVertex(me,J,0,0,L),j=me}}const Jt=j&&q;let Yt=Jt?p:w?"butt":m;if(Jt&&Yt==="round"&&(zt<x?Yt="miter":zt<=2&&(Yt="fakeround")),Yt==="miter"&&zt>_&&(Yt="bevel"),Yt==="bevel"&&(zt>2&&(Yt="flipbevel"),zt<_&&(Yt="miter")),j&&this.updateDistance(j,O),Yt==="miter")wt._mult(zt),this.addCurrentVertex(O,wt,0,0,L);else if(Yt==="flipbevel"){if(zt>100)wt=it.mult(-1);else{const ae=zt*J.add(it).mag()/J.sub(it).mag();wt._perp()._mult(ae*(he?-1:1))}this.addCurrentVertex(O,wt,0,0,L),this.addCurrentVertex(O,wt.mult(-1),0,0,L)}else if(Yt==="bevel"||Yt==="fakeround"){const ae=-Math.sqrt(zt*zt-1),me=he?ae:0,Qt=he?0:ae;if(j&&this.addCurrentVertex(O,J,me,Qt,L),Yt==="fakeround"){const Rt=Math.round(180*Lt/Math.PI/20);for(let ue=1;ue<Rt;ue++){let le=ue/Rt;if(le!==.5){const di=le-.5;le+=le*di*(le-1)*((1.0904+pt*(pt*(3.55645-1.43519*pt)-3.2452))*di*di+(.848013+pt*(.215638*pt-1.06021)))}const ze=it.sub(J)._mult(le)._add(J)._unit()._mult(he?-1:1);this.addHalfVertex(O,ze.x,ze.y,!1,he,0,L)}}q&&this.addCurrentVertex(O,it,-me,-Qt,L)}else if(Yt==="butt")this.addCurrentVertex(O,wt,0,0,L);else if(Yt==="square"){const ae=j?1:-1;this.addCurrentVertex(O,wt,ae,ae,L)}else Yt==="round"&&(j&&(this.addCurrentVertex(O,J,0,0,L),this.addCurrentVertex(O,J,1,1,L,!0)),q&&(this.addCurrentVertex(O,it,-1,-1,L,!0),this.addCurrentVertex(O,it,0,0,L)));if(ee&&ct<T-1){const ae=O.dist(q);if(ae>2*D){const me=O.add(q.sub(O)._mult(D/ae)._round());this.updateDistance(O,me),this.addCurrentVertex(me,it,0,0,L),O=me}}}}addCurrentVertex(r,a,p,m,_,x=!1){const w=a.y*m-a.x,T=-a.y-a.x*m;this.addHalfVertex(r,a.x+a.y*p,a.y-a.x*p,x,!1,p,_),this.addHalfVertex(r,w,T,x,!0,-m,_),this.distance>ux/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,a,p,m,_,x))}addHalfVertex({x:r,y:a},p,m,_,x,w,T){const I=.5*(this.lineClips?this.scaledDistance*(ux-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(_?1:0),(a<<1)+(x?1:0),Math.round(63*p)+128,Math.round(63*m)+128,1+(w===0?0:w<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),T.primitiveLength++),x?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,a){this.distance+=r.dist(a),this.updateScaledDistance()}}let hx,dx;oe("LineBucket",Vg,{omit:["layers","patternFeatures"]});var px={get paint(){return dx=dx||new f({"line-opacity":new be(Et.paint_line["line-opacity"]),"line-color":new be(Et.paint_line["line-color"]),"line-translate":new pe(Et.paint_line["line-translate"]),"line-translate-anchor":new pe(Et.paint_line["line-translate-anchor"]),"line-width":new be(Et.paint_line["line-width"]),"line-gap-width":new be(Et.paint_line["line-gap-width"]),"line-offset":new be(Et.paint_line["line-offset"]),"line-blur":new be(Et.paint_line["line-blur"]),"line-dasharray":new n(Et.paint_line["line-dasharray"]),"line-pattern":new y(Et.paint_line["line-pattern"]),"line-gradient":new u(Et.paint_line["line-gradient"])})},get layout(){return hx=hx||new f({"line-cap":new pe(Et.layout_line["line-cap"]),"line-join":new be(Et.layout_line["line-join"]),"line-miter-limit":new pe(Et.layout_line["line-miter-limit"]),"line-round-limit":new pe(Et.layout_line["line-round-limit"]),"line-sort-key":new be(Et.layout_line["line-sort-key"])})}};class Y3 extends be{possiblyEvaluate(r,a){return a=new mi(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(r,a)}evaluate(r,a,p,m){return a=Tt({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(r,a,p,m)}}let Vp;class K3 extends v{constructor(r){super(r,px),this.gradientVersion=0,Vp||(Vp=new Y3(px.paint.properties["line-width"].specification),Vp.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const a=this.gradientExpression();this.stepInterpolant=!!function(p){return p._styleExpression!==void 0}(a)&&a._styleExpression.expression instanceof xe,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,a){super.recalculate(r,a),this.paint._values["line-floorwidth"]=Vp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Vg(r)}queryRadius(r){const a=r,p=fx(oh("line-width",this,a),oh("line-gap-width",this,a)),m=oh("line-offset",this,a);return p/2+Math.abs(m)+zp(this.paint.get("line-translate"))}queryIntersectsFeature(r,a,p,m,_,x,w){const T=Dp(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,w),I=w/2*fx(this.paint.get("line-width").evaluate(a,p),this.paint.get("line-gap-width").evaluate(a,p)),D=this.paint.get("line-offset").evaluate(a,p);return D&&(m=function(L,O){const j=[];for(let q=0;q<L.length;q++){const J=L[q],it=[];for(let ct=0;ct<J.length;ct++){const wt=J[ct-1],pt=J[ct],vt=J[ct+1],zt=ct===0?new P(0,0):pt.sub(wt)._unit()._perp(),Lt=ct===J.length-1?new P(0,0):vt.sub(pt)._unit()._perp(),ee=zt._add(Lt)._unit(),he=ee.x*Lt.x+ee.y*Lt.y;he!==0&&ee._mult(1/he),it.push(ee._mult(O)._add(pt))}j.push(it)}return j}(m,D*w)),function(L,O,j){for(let q=0;q<O.length;q++){const J=O[q];if(L.length>=3){for(let it=0;it<J.length;it++)if(Tc(L,J[it]))return!0}if(s3(L,J,j))return!0}return!1}(T,m,I)}isTileClipped(){return!0}}function fx(o,r){return r>0?r+2*o:o}const X3=z([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),J3=z([{name:"a_projected_pos",components:3,type:"Float32"}],4);z([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Q3=z([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);z([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const mx=z([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),t4=z([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function e4(o,r,a){return o.sections.forEach(p=>{p.text=function(m,_,x){const w=_.layout.get("text-transform").evaluate(x,{});return w==="uppercase"?m=m.toLocaleUpperCase():w==="lowercase"&&(m=m.toLocaleLowerCase()),so.applyArabicShaping&&(m=so.applyArabicShaping(m)),m}(p.text,r,a)}),o}z([{name:"triangle",components:3,type:"Uint16"}]),z([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),z([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),z([{type:"Float32",name:"offsetX"}]),z([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),z([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const fh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ar=24,gx=hi,yx=function(o,r,a,p,m){var _,x,w=8*m-p-1,T=(1<<w)-1,I=T>>1,D=-7,L=m-1,O=-1,j=o[r+L];for(L+=O,_=j&(1<<-D)-1,j>>=-D,D+=w;D>0;_=256*_+o[r+L],L+=O,D-=8);for(x=_&(1<<-D)-1,_>>=-D,D+=p;D>0;x=256*x+o[r+L],L+=O,D-=8);if(_===0)_=1-I;else{if(_===T)return x?NaN:1/0*(j?-1:1);x+=Math.pow(2,p),_-=I}return(j?-1:1)*x*Math.pow(2,_-p)},_x=function(o,r,a,p,m,_){var x,w,T,I=8*_-m-1,D=(1<<I)-1,L=D>>1,O=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=0,q=1,J=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(w=isNaN(r)?1:0,x=D):(x=Math.floor(Math.log(r)/Math.LN2),r*(T=Math.pow(2,-x))<1&&(x--,T*=2),(r+=x+L>=1?O/T:O*Math.pow(2,1-L))*T>=2&&(x++,T/=2),x+L>=D?(w=0,x=D):x+L>=1?(w=(r*T-1)*Math.pow(2,m),x+=L):(w=r*Math.pow(2,L-1)*Math.pow(2,m),x=0));m>=8;o[a+j]=255&w,j+=q,w/=256,m-=8);for(x=x<<m|w,I+=m;I>0;o[a+j]=255&x,j+=q,x/=256,I-=8);o[a+j-q]|=128*J};function hi(o){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(o)?o:new Uint8Array(o||0),this.pos=0,this.type=0,this.length=this.buf.length}hi.Varint=0,hi.Fixed64=1,hi.Bytes=2,hi.Fixed32=5;var $g=4294967296,vx=1/$g,xx=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ao(o){return o.type===hi.Bytes?o.readVarint()+o.pos:o.pos+1}function i4(o,r,a){return a?4294967296*r+(o>>>0):4294967296*(r>>>0)+(o>>>0)}function bx(o,r,a){var p=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));a.realloc(p);for(var m=a.pos-1;m>=o;m--)a.buf[m+p]=a.buf[m]}function r4(o,r){for(var a=0;a<o.length;a++)r.writeVarint(o[a])}function n4(o,r){for(var a=0;a<o.length;a++)r.writeSVarint(o[a])}function s4(o,r){for(var a=0;a<o.length;a++)r.writeFloat(o[a])}function o4(o,r){for(var a=0;a<o.length;a++)r.writeDouble(o[a])}function a4(o,r){for(var a=0;a<o.length;a++)r.writeBoolean(o[a])}function l4(o,r){for(var a=0;a<o.length;a++)r.writeFixed32(o[a])}function c4(o,r){for(var a=0;a<o.length;a++)r.writeSFixed32(o[a])}function u4(o,r){for(var a=0;a<o.length;a++)r.writeFixed64(o[a])}function h4(o,r){for(var a=0;a<o.length;a++)r.writeSFixed64(o[a])}function $p(o,r){return(o[r]|o[r+1]<<8|o[r+2]<<16)+16777216*o[r+3]}function Pc(o,r,a){o[a]=r,o[a+1]=r>>>8,o[a+2]=r>>>16,o[a+3]=r>>>24}function wx(o,r){return(o[r]|o[r+1]<<8|o[r+2]<<16)+(o[r+3]<<24)}hi.prototype={destroy:function(){this.buf=null},readFields:function(o,r,a){for(a=a||this.length;this.pos<a;){var p=this.readVarint(),m=p>>3,_=this.pos;this.type=7&p,o(m,r,this),this.pos===_&&this.skip(p)}return r},readMessage:function(o,r){return this.readFields(o,r,this.readVarint()+this.pos)},readFixed32:function(){var o=$p(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=wx(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=$p(this.buf,this.pos)+$p(this.buf,this.pos+4)*$g;return this.pos+=8,o},readSFixed64:function(){var o=$p(this.buf,this.pos)+wx(this.buf,this.pos+4)*$g;return this.pos+=8,o},readFloat:function(){var o=yx(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=yx(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var r,a,p=this.buf;return r=127&(a=p[this.pos++]),a<128?r:(r|=(127&(a=p[this.pos++]))<<7,a<128?r:(r|=(127&(a=p[this.pos++]))<<14,a<128?r:(r|=(127&(a=p[this.pos++]))<<21,a<128?r:function(m,_,x){var w,T,I=x.buf;if(w=(112&(T=I[x.pos++]))>>4,T<128||(w|=(127&(T=I[x.pos++]))<<3,T<128)||(w|=(127&(T=I[x.pos++]))<<10,T<128)||(w|=(127&(T=I[x.pos++]))<<17,T<128)||(w|=(127&(T=I[x.pos++]))<<24,T<128)||(w|=(1&(T=I[x.pos++]))<<31,T<128))return i4(m,w,_);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(a=p[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var o=this.readVarint()+this.pos,r=this.pos;return this.pos=o,o-r>=12&&xx?function(a,p,m){return xx.decode(a.subarray(p,m))}(this.buf,r,o):function(a,p,m){for(var _="",x=p;x<m;){var w,T,I,D=a[x],L=null,O=D>239?4:D>223?3:D>191?2:1;if(x+O>m)break;O===1?D<128&&(L=D):O===2?(192&(w=a[x+1]))==128&&(L=(31&D)<<6|63&w)<=127&&(L=null):O===3?(T=a[x+2],(192&(w=a[x+1]))==128&&(192&T)==128&&((L=(15&D)<<12|(63&w)<<6|63&T)<=2047||L>=55296&&L<=57343)&&(L=null)):O===4&&(T=a[x+2],I=a[x+3],(192&(w=a[x+1]))==128&&(192&T)==128&&(192&I)==128&&((L=(15&D)<<18|(63&w)<<12|(63&T)<<6|63&I)<=65535||L>=1114112)&&(L=null)),L===null?(L=65533,O=1):L>65535&&(L-=65536,_+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),_+=String.fromCharCode(L),x+=O}return _}(this.buf,r,o)},readBytes:function(){var o=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,o);return this.pos=o,r},readPackedVarint:function(o,r){if(this.type!==hi.Bytes)return o.push(this.readVarint(r));var a=Ao(this);for(o=o||[];this.pos<a;)o.push(this.readVarint(r));return o},readPackedSVarint:function(o){if(this.type!==hi.Bytes)return o.push(this.readSVarint());var r=Ao(this);for(o=o||[];this.pos<r;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==hi.Bytes)return o.push(this.readBoolean());var r=Ao(this);for(o=o||[];this.pos<r;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==hi.Bytes)return o.push(this.readFloat());var r=Ao(this);for(o=o||[];this.pos<r;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==hi.Bytes)return o.push(this.readDouble());var r=Ao(this);for(o=o||[];this.pos<r;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==hi.Bytes)return o.push(this.readFixed32());var r=Ao(this);for(o=o||[];this.pos<r;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==hi.Bytes)return o.push(this.readSFixed32());var r=Ao(this);for(o=o||[];this.pos<r;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==hi.Bytes)return o.push(this.readFixed64());var r=Ao(this);for(o=o||[];this.pos<r;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==hi.Bytes)return o.push(this.readSFixed64());var r=Ao(this);for(o=o||[];this.pos<r;)o.push(this.readSFixed64());return o},skip:function(o){var r=7&o;if(r===hi.Varint)for(;this.buf[this.pos++]>127;);else if(r===hi.Bytes)this.pos=this.readVarint()+this.pos;else if(r===hi.Fixed32)this.pos+=4;else{if(r!==hi.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(o,r){this.writeVarint(o<<3|r)},realloc:function(o){for(var r=this.length||16;r<this.pos+o;)r*=2;if(r!==this.length){var a=new Uint8Array(r);a.set(this.buf),this.buf=a,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),Pc(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),Pc(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),Pc(this.buf,-1&o,this.pos),Pc(this.buf,Math.floor(o*vx),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),Pc(this.buf,-1&o,this.pos),Pc(this.buf,Math.floor(o*vx),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(r,a){var p,m;if(r>=0?(p=r%4294967296|0,m=r/4294967296|0):(m=~(-r/4294967296),4294967295^(p=~(-r%4294967296))?p=p+1|0:(p=0,m=m+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),function(_,x,w){w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,w.buf[w.pos]=127&(_>>>=7)}(p,0,a),function(_,x){var w=(7&_)<<4;x.buf[x.pos++]|=w|((_>>>=3)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_)))))}(m,a)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(!!o)},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var r=this.pos;this.pos=function(p,m,_){for(var x,w,T=0;T<m.length;T++){if((x=m.charCodeAt(T))>55295&&x<57344){if(!w){x>56319||T+1===m.length?(p[_++]=239,p[_++]=191,p[_++]=189):w=x;continue}if(x<56320){p[_++]=239,p[_++]=191,p[_++]=189,w=x;continue}x=w-55296<<10|x-56320|65536,w=null}else w&&(p[_++]=239,p[_++]=191,p[_++]=189,w=null);x<128?p[_++]=x:(x<2048?p[_++]=x>>6|192:(x<65536?p[_++]=x>>12|224:(p[_++]=x>>18|240,p[_++]=x>>12&63|128),p[_++]=x>>6&63|128),p[_++]=63&x|128)}return _}(this.buf,o,this.pos);var a=this.pos-r;a>=128&&bx(r,a,this),this.pos=r-1,this.writeVarint(a),this.pos+=a},writeFloat:function(o){this.realloc(4),_x(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),_x(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var r=o.length;this.writeVarint(r),this.realloc(r);for(var a=0;a<r;a++)this.buf[this.pos++]=o[a]},writeRawMessage:function(o,r){this.pos++;var a=this.pos;o(r,this);var p=this.pos-a;p>=128&&bx(a,p,this),this.pos=a-1,this.writeVarint(p),this.pos+=p},writeMessage:function(o,r,a){this.writeTag(o,hi.Bytes),this.writeRawMessage(r,a)},writePackedVarint:function(o,r){r.length&&this.writeMessage(o,r4,r)},writePackedSVarint:function(o,r){r.length&&this.writeMessage(o,n4,r)},writePackedBoolean:function(o,r){r.length&&this.writeMessage(o,a4,r)},writePackedFloat:function(o,r){r.length&&this.writeMessage(o,s4,r)},writePackedDouble:function(o,r){r.length&&this.writeMessage(o,o4,r)},writePackedFixed32:function(o,r){r.length&&this.writeMessage(o,l4,r)},writePackedSFixed32:function(o,r){r.length&&this.writeMessage(o,c4,r)},writePackedFixed64:function(o,r){r.length&&this.writeMessage(o,u4,r)},writePackedSFixed64:function(o,r){r.length&&this.writeMessage(o,h4,r)},writeBytesField:function(o,r){this.writeTag(o,hi.Bytes),this.writeBytes(r)},writeFixed32Field:function(o,r){this.writeTag(o,hi.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(o,r){this.writeTag(o,hi.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(o,r){this.writeTag(o,hi.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(o,r){this.writeTag(o,hi.Fixed64),this.writeSFixed64(r)},writeVarintField:function(o,r){this.writeTag(o,hi.Varint),this.writeVarint(r)},writeSVarintField:function(o,r){this.writeTag(o,hi.Varint),this.writeSVarint(r)},writeStringField:function(o,r){this.writeTag(o,hi.Bytes),this.writeString(r)},writeFloatField:function(o,r){this.writeTag(o,hi.Fixed32),this.writeFloat(r)},writeDoubleField:function(o,r){this.writeTag(o,hi.Fixed64),this.writeDouble(r)},writeBooleanField:function(o,r){this.writeVarintField(o,!!r)}};var Ng=b(gx);const jg=3;function d4(o,r,a){o===1&&a.readMessage(p4,r)}function p4(o,r,a){if(o===3){const{id:p,bitmap:m,width:_,height:x,left:w,top:T,advance:I}=a.readMessage(f4,{});r.push({id:p,bitmap:new lh({width:_+2*jg,height:x+2*jg},m),metrics:{width:_,height:x,left:w,top:T,advance:I}})}}function f4(o,r,a){o===1?r.id=a.readVarint():o===2?r.bitmap=a.readBytes():o===3?r.width=a.readVarint():o===4?r.height=a.readVarint():o===5?r.left=a.readSVarint():o===6?r.top=a.readSVarint():o===7&&(r.advance=a.readVarint())}const Sx=jg;function kx(o){let r=0,a=0;for(const x of o)r+=x.w*x.h,a=Math.max(a,x.w);o.sort((x,w)=>w.h-x.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),a),h:1/0}];let m=0,_=0;for(const x of o)for(let w=p.length-1;w>=0;w--){const T=p[w];if(!(x.w>T.w||x.h>T.h)){if(x.x=T.x,x.y=T.y,_=Math.max(_,x.y+x.h),m=Math.max(m,x.x+x.w),x.w===T.w&&x.h===T.h){const I=p.pop();w<p.length&&(p[w]=I)}else x.h===T.h?(T.x+=x.w,T.w-=x.w):x.w===T.w?(T.y+=x.h,T.h-=x.h):(p.push({x:T.x+x.w,y:T.y,w:T.w-x.w,h:x.h}),T.y+=x.h,T.h-=x.h);break}}return{w:m,h:_,fill:r/(m*_)||0}}const bn=1;class Ug{constructor(r,{pixelRatio:a,version:p,stretchX:m,stretchY:_,content:x,textFitWidth:w,textFitHeight:T}){this.paddedRect=r,this.pixelRatio=a,this.stretchX=m,this.stretchY=_,this.content=x,this.version=p,this.textFitWidth=w,this.textFitHeight=T}get tl(){return[this.paddedRect.x+bn,this.paddedRect.y+bn]}get br(){return[this.paddedRect.x+this.paddedRect.w-bn,this.paddedRect.y+this.paddedRect.h-bn]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*bn)/this.pixelRatio,(this.paddedRect.h-2*bn)/this.pixelRatio]}}class Tx{constructor(r,a){const p={},m={};this.haveRenderCallbacks=[];const _=[];this.addImages(r,p,_),this.addImages(a,m,_);const{w:x,h:w}=kx(_),T=new Jn({width:x||1,height:w||1});for(const I in r){const D=r[I],L=p[I].paddedRect;Jn.copy(D.data,T,{x:0,y:0},{x:L.x+bn,y:L.y+bn},D.data)}for(const I in a){const D=a[I],L=m[I].paddedRect,O=L.x+bn,j=L.y+bn,q=D.data.width,J=D.data.height;Jn.copy(D.data,T,{x:0,y:0},{x:O,y:j},D.data),Jn.copy(D.data,T,{x:0,y:J-1},{x:O,y:j-1},{width:q,height:1}),Jn.copy(D.data,T,{x:0,y:0},{x:O,y:j+J},{width:q,height:1}),Jn.copy(D.data,T,{x:q-1,y:0},{x:O-1,y:j},{width:1,height:J}),Jn.copy(D.data,T,{x:0,y:0},{x:O+q,y:j},{width:1,height:J})}this.image=T,this.iconPositions=p,this.patternPositions=m}addImages(r,a,p){for(const m in r){const _=r[m],x={x:0,y:0,w:_.data.width+2*bn,h:_.data.height+2*bn};p.push(x),a[m]=new Ug(x,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(r,a){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in r.updatedImages)this.patchUpdatedImage(this.iconPositions[p],r.getImage(p),a),this.patchUpdatedImage(this.patternPositions[p],r.getImage(p),a)}patchUpdatedImage(r,a,p){if(!r||!a||r.version===a.version)return;r.version=a.version;const[m,_]=r.tl;p.update(a.data,void 0,{x:m,y:_})}}var ga;oe("ImagePosition",Ug),oe("ImageAtlas",Tx),d.ah=void 0,(ga=d.ah||(d.ah={}))[ga.none=0]="none",ga[ga.horizontal=1]="horizontal",ga[ga.vertical=2]="vertical",ga[ga.horizontalOnly=3]="horizontalOnly";const mh=-17;class gh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,a){const p=new gh;return p.scale=r||1,p.fontStack=a,p}static forImage(r){const a=new gh;return a.imageName=r,a}}class Ic{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,a){const p=new Ic;for(let m=0;m<r.sections.length;m++){const _=r.sections[m];_.image?p.addImageSection(_):p.addTextSection(_,a)}return p}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=function(r){let a="";for(let p=0;p<r.length;p++){const m=r.charCodeAt(p+1)||null,_=r.charCodeAt(p-1)||null;a+=m&&kp(m)&&!fh[r[p+1]]||_&&kp(_)&&!fh[r[p-1]]||!fh[r[p]]?r[p]:fh[r[p]]}return a}(this.text)}trim(){let r=0;for(let p=0;p<this.text.length&&jp[this.text.charCodeAt(p)];p++)r++;let a=this.text.length;for(let p=this.text.length-1;p>=0&&p>=r&&jp[this.text.charCodeAt(p)];p--)a--;this.text=this.text.substring(r,a),this.sectionIndex=this.sectionIndex.slice(r,a)}substring(r,a){const p=new Ic;return p.text=this.text.substring(r,a),p.sectionIndex=this.sectionIndex.slice(r,a),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,a)=>Math.max(r,this.sections[a].scale),0)}addTextSection(r,a){this.text+=r.text,this.sections.push(gh.forText(r.scale,r.fontStack||a));const p=this.sections.length-1;for(let m=0;m<r.text.length;++m)this.sectionIndex.push(p)}addImageSection(r){const a=r.image?r.image.name:"";if(a.length===0)return void _e("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(gh.forImage(a)),this.sectionIndex.push(this.sections.length-1)):_e("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Np(o,r,a,p,m,_,x,w,T,I,D,L,O,j,q,J){const it=Ic.fromFeature(o,m);let ct;L===d.ah.vertical&&it.verticalizePunctuation();const{processBidirectionalText:wt,processStyledBidirectionalText:pt}=so;if(wt&&it.sections.length===1){ct=[];const Lt=wt(it.toString(),Hg(it,I,_,r,p,j,q));for(const ee of Lt){const he=new Ic;he.text=ee,he.sections=it.sections;for(let Jt=0;Jt<ee.length;Jt++)he.sectionIndex.push(0);ct.push(he)}}else if(pt){ct=[];const Lt=pt(it.text,it.sectionIndex,Hg(it,I,_,r,p,j,q));for(const ee of Lt){const he=new Ic;he.text=ee[0],he.sectionIndex=ee[1],he.sections=it.sections,ct.push(he)}}else ct=function(Lt,ee){const he=[],Jt=Lt.text;let Yt=0;for(const ae of ee)he.push(Lt.substring(Yt,ae)),Yt=ae;return Yt<Jt.length&&he.push(Lt.substring(Yt,Jt.length)),he}(it,Hg(it,I,_,r,p,j,q));const vt=[],zt={positionedLines:vt,text:it.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:L,iconsInText:!1,verticalizable:!1};return function(Lt,ee,he,Jt,Yt,ae,me,Qt,Rt,ue,le,ze){let di=0,pi=mh,Qi=0,ts=0;const Kr=Qt==="right"?1:Qt==="left"?0:.5;let lr=0;for(const tr of Yt){tr.trim();const gr=tr.getMaxScale(),cn=(gr-1)*ar,wn={positionedGlyphs:[],lineOffset:0};Lt.positionedLines[lr]=wn;const Vr=wn.positionedGlyphs;let Sn=0;if(!tr.length()){pi+=ae,++lr;continue}for(let Ui=0;Ui<tr.length();Ui++){const Be=tr.getSection(Ui),er=tr.getSectionIndex(Ui),$r=tr.getCharCode(Ui);let cr=0,ms=null,zs=null,Ds=null,zo=ar;const gs=!(Rt===d.ah.horizontal||!le&&!Xu($r)||le&&(jp[$r]||(Mr=$r,te.Arabic(Mr)||te["Arabic Supplement"](Mr)||te["Arabic Extended-A"](Mr)||te["Arabic Presentation Forms-A"](Mr)||te["Arabic Presentation Forms-B"](Mr))));if(Be.imageName){const is=Jt[Be.imageName];if(!is)continue;Ds=Be.imageName,Lt.iconsInText=Lt.iconsInText||!0,zs=is.paddedRect;const kn=is.displaySize;Be.scale=Be.scale*ar/ze,ms={width:kn[0],height:kn[1],left:bn,top:-Sx,advance:gs?kn[1]:kn[0]},cr=cn+(ar-kn[1]*Be.scale),zo=ms.advance;const Do=gs?kn[0]*Be.scale-ar*gr:kn[1]*Be.scale-ar*gr;Do>0&&Do>Sn&&(Sn=Do)}else{const is=he[Be.fontStack],kn=is&&is[$r];if(kn&&kn.rect)zs=kn.rect,ms=kn.metrics;else{const Do=ee[Be.fontStack],bh=Do&&Do[$r];if(!bh)continue;ms=bh.metrics}cr=(gr-Be.scale)*ar}gs?(Lt.verticalizable=!0,Vr.push({glyph:$r,imageName:Ds,x:di,y:pi+cr,vertical:gs,scale:Be.scale,fontStack:Be.fontStack,sectionIndex:er,metrics:ms,rect:zs}),di+=zo*Be.scale+ue):(Vr.push({glyph:$r,imageName:Ds,x:di,y:pi+cr,vertical:gs,scale:Be.scale,fontStack:Be.fontStack,sectionIndex:er,metrics:ms,rect:zs}),di+=ms.advance*Be.scale+ue)}Vr.length!==0&&(Qi=Math.max(di-ue,Qi),y4(Vr,0,Vr.length-1,Kr,Sn)),di=0;const es=ae*gr+Sn;wn.lineOffset=Math.max(Sn,cn),pi+=es,ts=Math.max(es,ts),++lr}var Mr;const Xr=pi-mh,{horizontalAlign:ln,verticalAlign:Jr}=Zg(me);(function(tr,gr,cn,wn,Vr,Sn,es,Ui,Be){const er=(gr-cn)*Vr;let $r=0;$r=Sn!==es?-Ui*wn-mh:(-wn*Be+.5)*es;for(const cr of tr)for(const ms of cr.positionedGlyphs)ms.x+=er,ms.y+=$r})(Lt.positionedLines,Kr,ln,Jr,Qi,ts,ae,Xr,Yt.length),Lt.top+=-Jr*Xr,Lt.bottom=Lt.top+Xr,Lt.left+=-ln*Qi,Lt.right=Lt.left+Qi}(zt,r,a,p,ct,x,w,T,L,I,O,J),!function(Lt){for(const ee of Lt)if(ee.positionedGlyphs.length!==0)return!1;return!0}(vt)&&zt}const jp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},m4={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Mx(o,r,a,p,m,_){if(r.imageName){const x=p[r.imageName];return x?x.displaySize[0]*r.scale*ar/_+m:0}{const x=a[r.fontStack],w=x&&x[o];return w?w.metrics.advance*r.scale+m:0}}function Cx(o,r,a,p){const m=Math.pow(o-r,2);return p?o<r?m/2:2*m:m+Math.abs(a)*a}function g4(o,r,a){let p=0;return o===10&&(p-=1e4),a&&(p+=150),o!==40&&o!==65288||(p+=50),r!==41&&r!==65289||(p+=50),p}function Ex(o,r,a,p,m,_){let x=null,w=Cx(r,a,m,_);for(const T of p){const I=Cx(r-T.x,a,m,_)+T.badness;I<=w&&(x=T,w=I)}return{index:o,x:r,priorBreak:x,badness:w}}function Px(o){return o?Px(o.priorBreak).concat(o.index):[]}function Hg(o,r,a,p,m,_,x){if(_!=="point")return[];if(!o)return[];const w=[],T=function(O,j,q,J,it,ct){let wt=0;for(let pt=0;pt<O.length();pt++){const vt=O.getSection(pt);wt+=Mx(O.getCharCode(pt),vt,J,it,j,ct)}return wt/Math.max(1,Math.ceil(wt/q))}(o,r,a,p,m,x),I=o.text.indexOf("")>=0;let D=0;for(let O=0;O<o.length();O++){const j=o.getSection(O),q=o.getCharCode(O);if(jp[q]||(D+=Mx(q,j,p,m,r,x)),O<o.length()-1){const J=!((L=q)<11904||!(te["Bopomofo Extended"](L)||te.Bopomofo(L)||te["CJK Compatibility Forms"](L)||te["CJK Compatibility Ideographs"](L)||te["CJK Compatibility"](L)||te["CJK Radicals Supplement"](L)||te["CJK Strokes"](L)||te["CJK Symbols and Punctuation"](L)||te["CJK Unified Ideographs Extension A"](L)||te["CJK Unified Ideographs"](L)||te["Enclosed CJK Letters and Months"](L)||te["Halfwidth and Fullwidth Forms"](L)||te.Hiragana(L)||te["Ideographic Description Characters"](L)||te["Kangxi Radicals"](L)||te["Katakana Phonetic Extensions"](L)||te.Katakana(L)||te["Vertical Forms"](L)||te["Yi Radicals"](L)||te["Yi Syllables"](L)));(m4[q]||J||j.imageName)&&w.push(Ex(O+1,D,T,w,g4(q,o.getCharCode(O+1),J&&I),!1))}}var L;return Px(Ex(o.length(),D,T,w,0,!0))}function Zg(o){let r=.5,a=.5;switch(o){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:r,verticalAlign:a}}function y4(o,r,a,p,m){if(!p&&!m)return;const _=o[a],x=(o[a].x+_.metrics.advance*_.scale)*p;for(let w=r;w<=a;w++)o[w].x-=x,o[w].y+=m}function _4(o,r,a){const{horizontalAlign:p,verticalAlign:m}=Zg(a),_=r[0]-o.displaySize[0]*p,x=r[1]-o.displaySize[1]*m;return{image:o,top:x,bottom:x+o.displaySize[1],left:_,right:_+o.displaySize[0]}}function Ix(o){var r,a;let p=o.left,m=o.top,_=o.right-p,x=o.bottom-m;const w=(r=o.image.textFitWidth)!==null&&r!==void 0?r:"stretchOrShrink",T=(a=o.image.textFitHeight)!==null&&a!==void 0?a:"stretchOrShrink",I=(o.image.content[2]-o.image.content[0])/(o.image.content[3]-o.image.content[1]);if(T==="proportional"){if(w==="stretchOnly"&&_/x<I||w==="proportional"){const D=Math.ceil(x*I);p*=D/_,_=D}}else if(w==="proportional"&&T==="stretchOnly"&&I!==0&&_/x>I){const D=Math.ceil(_/I);m*=D/x,x=D}return{x1:p,y1:m,x2:p+_,y2:m+x}}function Ax(o,r,a,p,m,_){const x=o.image;let w;if(x.content){const it=x.content,ct=x.pixelRatio||1;w=[it[0]/ct,it[1]/ct,x.displaySize[0]-it[2]/ct,x.displaySize[1]-it[3]/ct]}const T=r.left*_,I=r.right*_;let D,L,O,j;a==="width"||a==="both"?(j=m[0]+T-p[3],L=m[0]+I+p[1]):(j=m[0]+(T+I-x.displaySize[0])/2,L=j+x.displaySize[0]);const q=r.top*_,J=r.bottom*_;return a==="height"||a==="both"?(D=m[1]+q-p[0],O=m[1]+J+p[2]):(D=m[1]+(q+J-x.displaySize[1])/2,O=D+x.displaySize[1]),{image:x,top:D,right:L,bottom:O,left:j,collisionPadding:w}}const yh=255,lo=128,ya=yh*lo;function zx(o,r){const{expression:a}=r;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new mi(o+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:m}=a;let _=0;for(;_<p.length&&p[_]<=o;)_++;_=Math.max(0,_-1);let x=_;for(;x<p.length&&p[x]<o+1;)x++;x=Math.min(p.length-1,x);const w=p[_],T=p[x];return a.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:T,interpolationType:m}:{kind:"camera",minZoom:w,maxZoom:T,minSize:a.evaluate(new mi(w)),maxSize:a.evaluate(new mi(T)),interpolationType:m}}}function qg(o,r,a){let p="never";const m=o.get(r);return m?p=m:o.get(a)&&(p="always"),p}const v4=ma.VectorTileFeature.types,x4=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Up(o,r,a,p,m,_,x,w,T,I,D,L,O){const j=w?Math.min(ya,Math.round(w[0])):0,q=w?Math.min(ya,Math.round(w[1])):0;o.emplaceBack(r,a,Math.round(32*p),Math.round(32*m),_,x,(j<<1)+(T?1:0),q,16*I,16*D,256*L,256*O)}function Gg(o,r,a){o.emplaceBack(r.x,r.y,a),o.emplaceBack(r.x,r.y,a),o.emplaceBack(r.x,r.y,a),o.emplaceBack(r.x,r.y,a)}function b4(o){for(const r of o.sections)if(Ju(r.text))return!0;return!1}class Wg{constructor(r){this.layoutVertexArray=new Xn,this.indexArray=new mr,this.programConfigurations=r,this.segments=new or,this.dynamicLayoutVertexArray=new oo,this.opacityVertexArray=new ha,this.hasVisibleVertices=!1,this.placedSymbolArray=new vi}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,a,p,m){this.isEmpty()||(p&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,X3.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,J3.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,x4,!0),this.opacityVertexBuffer.itemSize=1),(p||m)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}oe("SymbolBuffers",Wg);class Yg{constructor(r,a,p){this.layoutVertexArray=new r,this.layoutAttributes=a,this.indexArray=new p,this.segments=new or,this.collisionVertexArray=new Or}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,Q3.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}oe("CollisionBuffers",Yg);class Ac{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(x=>x.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Cg([]),this.placementViewportMatrix=Cg([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=zx(this.zoom,a["text-size"]),this.iconSizeData=zx(this.zoom,a["icon-size"]);const p=this.layers[0].layout,m=p.get("symbol-sort-key"),_=p.get("symbol-z-order");this.canOverlap=qg(p,"text-overlap","text-allow-overlap")!=="never"||qg(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map(x=>d.ah[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=r.sourceID}createArrays(){this.text=new Wg(new ml(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new Wg(new ml(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new xi,this.lineVertexArray=new on,this.symbolInstances=new Yn,this.textAnchorOffsets=new Lr}calculateGlyphDependencies(r,a,p,m,_){for(let x=0;x<r.length;x++)if(a[r.charCodeAt(x)]=!0,(p||m)&&_){const w=fh[r.charAt(x)];w&&(a[w.charCodeAt(0)]=!0)}}populate(r,a,p){const m=this.layers[0],_=m.layout,x=_.get("text-font"),w=_.get("text-field"),T=_.get("icon-image"),I=(w.value.kind!=="constant"||w.value.value instanceof $i&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),D=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,L=_.get("symbol-sort-key");if(this.features=[],!I&&!D)return;const O=a.iconDependencies,j=a.glyphDependencies,q=a.availableImages,J=new mi(this.zoom);for(const{feature:it,id:ct,index:wt,sourceLayerIndex:pt}of r){const vt=m._featureFilter.needGeometry,zt=yl(it,vt);if(!m._featureFilter.filter(J,zt,p))continue;let Lt,ee;if(vt||(zt.geometry=gl(it)),I){const Jt=m.getValueAndResolveTokens("text-field",zt,p,q),Yt=$i.factory(Jt),ae=this.hasRTLText=this.hasRTLText||b4(Yt);(!ae||so.getRTLTextPluginStatus()==="unavailable"||ae&&so.isParsed())&&(Lt=e4(Yt,m,zt))}if(D){const Jt=m.getValueAndResolveTokens("icon-image",zt,p,q);ee=Jt instanceof Ni?Jt:Ni.fromString(Jt)}if(!Lt&&!ee)continue;const he=this.sortFeaturesByKey?L.evaluate(zt,{},p):void 0;if(this.features.push({id:ct,text:Lt,icon:ee,index:wt,sourceLayerIndex:pt,geometry:zt.geometry,properties:it.properties,type:v4[it.type],sortKey:he}),ee&&(O[ee.name]=!0),Lt){const Jt=x.evaluate(zt,{},p).join(","),Yt=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(d.ah.vertical)>=0;for(const ae of Lt.sections)if(ae.image)O[ae.image.name]=!0;else{const me=Ku(Lt.toString()),Qt=ae.fontStack||Jt,Rt=j[Qt]=j[Qt]||{};this.calculateGlyphDependencies(ae.text,Rt,Yt,this.allowVerticalPlacement,me)}}}_.get("symbol-placement")==="line"&&(this.features=function(it){const ct={},wt={},pt=[];let vt=0;function zt(Jt){pt.push(it[Jt]),vt++}function Lt(Jt,Yt,ae){const me=wt[Jt];return delete wt[Jt],wt[Yt]=me,pt[me].geometry[0].pop(),pt[me].geometry[0]=pt[me].geometry[0].concat(ae[0]),me}function ee(Jt,Yt,ae){const me=ct[Yt];return delete ct[Yt],ct[Jt]=me,pt[me].geometry[0].shift(),pt[me].geometry[0]=ae[0].concat(pt[me].geometry[0]),me}function he(Jt,Yt,ae){const me=ae?Yt[0][Yt[0].length-1]:Yt[0][0];return`${Jt}:${me.x}:${me.y}`}for(let Jt=0;Jt<it.length;Jt++){const Yt=it[Jt],ae=Yt.geometry,me=Yt.text?Yt.text.toString():null;if(!me){zt(Jt);continue}const Qt=he(me,ae),Rt=he(me,ae,!0);if(Qt in wt&&Rt in ct&&wt[Qt]!==ct[Rt]){const ue=ee(Qt,Rt,ae),le=Lt(Qt,Rt,pt[ue].geometry);delete ct[Qt],delete wt[Rt],wt[he(me,pt[le].geometry,!0)]=le,pt[ue].geometry=null}else Qt in wt?Lt(Qt,Rt,ae):Rt in ct?ee(Qt,Rt,ae):(zt(Jt),ct[Qt]=vt-1,wt[Rt]=vt-1)}return pt.filter(Jt=>Jt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((it,ct)=>it.sortKey-ct.sortKey)}update(r,a,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,a,this.layers,p),this.icon.programConfigurations.updatePaintArrays(r,a,this.layers,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,a){const p=this.lineVertexArray.length;if(r.segment!==void 0){let m=r.dist(a[r.segment+1]),_=r.dist(a[r.segment]);const x={};for(let w=r.segment+1;w<a.length;w++)x[w]={x:a[w].x,y:a[w].y,tileUnitDistanceFromAnchor:m},w<a.length-1&&(m+=a[w+1].dist(a[w]));for(let w=r.segment||0;w>=0;w--)x[w]={x:a[w].x,y:a[w].y,tileUnitDistanceFromAnchor:_},w>0&&(_+=a[w-1].dist(a[w]));for(let w=0;w<a.length;w++){const T=x[w];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(r,a,p,m,_,x,w,T,I,D,L,O){const j=r.indexArray,q=r.layoutVertexArray,J=r.segments.prepareSegment(4*a.length,q,j,this.canOverlap?x.sortKey:void 0),it=this.glyphOffsetArray.length,ct=J.vertexLength,wt=this.allowVerticalPlacement&&w===d.ah.vertical?Math.PI/2:0,pt=x.text&&x.text.sections;for(let vt=0;vt<a.length;vt++){const{tl:zt,tr:Lt,bl:ee,br:he,tex:Jt,pixelOffsetTL:Yt,pixelOffsetBR:ae,minFontScaleX:me,minFontScaleY:Qt,glyphOffset:Rt,isSDF:ue,sectionIndex:le}=a[vt],ze=J.vertexLength,di=Rt[1];Up(q,T.x,T.y,zt.x,di+zt.y,Jt.x,Jt.y,p,ue,Yt.x,Yt.y,me,Qt),Up(q,T.x,T.y,Lt.x,di+Lt.y,Jt.x+Jt.w,Jt.y,p,ue,ae.x,Yt.y,me,Qt),Up(q,T.x,T.y,ee.x,di+ee.y,Jt.x,Jt.y+Jt.h,p,ue,Yt.x,ae.y,me,Qt),Up(q,T.x,T.y,he.x,di+he.y,Jt.x+Jt.w,Jt.y+Jt.h,p,ue,ae.x,ae.y,me,Qt),Gg(r.dynamicLayoutVertexArray,T,wt),j.emplaceBack(ze,ze+1,ze+2),j.emplaceBack(ze+1,ze+2,ze+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Rt[0]),vt!==a.length-1&&le===a[vt+1].sectionIndex||r.programConfigurations.populatePaintArrays(q.length,x,x.index,{},O,pt&&pt[le])}r.placedSymbolArray.emplaceBack(T.x,T.y,it,this.glyphOffsetArray.length-it,ct,I,D,T.segment,p?p[0]:0,p?p[1]:0,m[0],m[1],w,0,!1,0,L)}_addCollisionDebugVertex(r,a,p,m,_,x){return a.emplaceBack(0,0),r.emplaceBack(p.x,p.y,m,_,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(r,a,p,m,_,x,w){const T=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),I=T.vertexLength,D=_.layoutVertexArray,L=_.collisionVertexArray,O=w.anchorX,j=w.anchorY;this._addCollisionDebugVertex(D,L,x,O,j,new P(r,a)),this._addCollisionDebugVertex(D,L,x,O,j,new P(p,a)),this._addCollisionDebugVertex(D,L,x,O,j,new P(p,m)),this._addCollisionDebugVertex(D,L,x,O,j,new P(r,m)),T.vertexLength+=4;const q=_.indexArray;q.emplaceBack(I,I+1),q.emplaceBack(I+1,I+2),q.emplaceBack(I+2,I+3),q.emplaceBack(I+3,I),T.primitiveLength+=4}addDebugCollisionBoxes(r,a,p,m){for(let _=r;_<a;_++){const x=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,m?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Yg(Fr,mx.members,Pi),this.iconCollisionBox=new Yg(Fr,mx.members,Pi);for(let r=0;r<this.symbolInstances.length;r++){const a=this.symbolInstances.get(r);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(r,a,p,m,_,x,w,T,I){const D={};for(let L=a;L<p;L++){const O=r.get(L);D.textBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},D.textFeatureIndex=O.featureIndex;break}for(let L=m;L<_;L++){const O=r.get(L);D.verticalTextBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},D.verticalTextFeatureIndex=O.featureIndex;break}for(let L=x;L<w;L++){const O=r.get(L);D.iconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},D.iconFeatureIndex=O.featureIndex;break}for(let L=T;L<I;L++){const O=r.get(L);D.verticalIconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},D.verticalIconFeatureIndex=O.featureIndex;break}return D}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const p=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,a){const p=r.placedSymbolArray.get(a),m=p.vertexStartIndex+4*p.numGlyphs;for(let _=p.vertexStartIndex;_<m;_+=4)r.indexArray.emplaceBack(_,_+1,_+2),r.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(r),p=Math.cos(r),m=[],_=[],x=[];for(let w=0;w<this.symbolInstances.length;++w){x.push(w);const T=this.symbolInstances.get(w);m.push(0|Math.round(a*T.anchorX+p*T.anchorY)),_.push(T.featureIndex)}return x.sort((w,T)=>m[w]-m[T]||_[T]-_[w]),x}addToSortKeyRanges(r,a){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===a?p.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const p=this.symbolInstances.get(a);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach((m,_,x)=>{m>=0&&x.indexOf(m)===_&&this.addIndicesForPlacedSymbol(this.text,m)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Dx,Lx;oe("SymbolBucket",Ac,{omit:["layers","collisionBoxArray","features","compareText"]}),Ac.MAX_GLYPHS=65535,Ac.addDynamicAttributes=Gg;var Kg={get paint(){return Lx=Lx||new f({"icon-opacity":new be(Et.paint_symbol["icon-opacity"]),"icon-color":new be(Et.paint_symbol["icon-color"]),"icon-halo-color":new be(Et.paint_symbol["icon-halo-color"]),"icon-halo-width":new be(Et.paint_symbol["icon-halo-width"]),"icon-halo-blur":new be(Et.paint_symbol["icon-halo-blur"]),"icon-translate":new pe(Et.paint_symbol["icon-translate"]),"icon-translate-anchor":new pe(Et.paint_symbol["icon-translate-anchor"]),"text-opacity":new be(Et.paint_symbol["text-opacity"]),"text-color":new be(Et.paint_symbol["text-color"],{runtimeType:wr,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new be(Et.paint_symbol["text-halo-color"]),"text-halo-width":new be(Et.paint_symbol["text-halo-width"]),"text-halo-blur":new be(Et.paint_symbol["text-halo-blur"]),"text-translate":new pe(Et.paint_symbol["text-translate"]),"text-translate-anchor":new pe(Et.paint_symbol["text-translate-anchor"])})},get layout(){return Dx=Dx||new f({"symbol-placement":new pe(Et.layout_symbol["symbol-placement"]),"symbol-spacing":new pe(Et.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new pe(Et.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new be(Et.layout_symbol["symbol-sort-key"]),"symbol-z-order":new pe(Et.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new pe(Et.layout_symbol["icon-allow-overlap"]),"icon-overlap":new pe(Et.layout_symbol["icon-overlap"]),"icon-ignore-placement":new pe(Et.layout_symbol["icon-ignore-placement"]),"icon-optional":new pe(Et.layout_symbol["icon-optional"]),"icon-rotation-alignment":new pe(Et.layout_symbol["icon-rotation-alignment"]),"icon-size":new be(Et.layout_symbol["icon-size"]),"icon-text-fit":new pe(Et.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new pe(Et.layout_symbol["icon-text-fit-padding"]),"icon-image":new be(Et.layout_symbol["icon-image"]),"icon-rotate":new be(Et.layout_symbol["icon-rotate"]),"icon-padding":new be(Et.layout_symbol["icon-padding"]),"icon-keep-upright":new pe(Et.layout_symbol["icon-keep-upright"]),"icon-offset":new be(Et.layout_symbol["icon-offset"]),"icon-anchor":new be(Et.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new pe(Et.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new pe(Et.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new pe(Et.layout_symbol["text-rotation-alignment"]),"text-field":new be(Et.layout_symbol["text-field"]),"text-font":new be(Et.layout_symbol["text-font"]),"text-size":new be(Et.layout_symbol["text-size"]),"text-max-width":new be(Et.layout_symbol["text-max-width"]),"text-line-height":new pe(Et.layout_symbol["text-line-height"]),"text-letter-spacing":new be(Et.layout_symbol["text-letter-spacing"]),"text-justify":new be(Et.layout_symbol["text-justify"]),"text-radial-offset":new be(Et.layout_symbol["text-radial-offset"]),"text-variable-anchor":new pe(Et.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new be(Et.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new be(Et.layout_symbol["text-anchor"]),"text-max-angle":new pe(Et.layout_symbol["text-max-angle"]),"text-writing-mode":new pe(Et.layout_symbol["text-writing-mode"]),"text-rotate":new be(Et.layout_symbol["text-rotate"]),"text-padding":new pe(Et.layout_symbol["text-padding"]),"text-keep-upright":new pe(Et.layout_symbol["text-keep-upright"]),"text-transform":new be(Et.layout_symbol["text-transform"]),"text-offset":new be(Et.layout_symbol["text-offset"]),"text-allow-overlap":new pe(Et.layout_symbol["text-allow-overlap"]),"text-overlap":new pe(Et.layout_symbol["text-overlap"]),"text-ignore-placement":new pe(Et.layout_symbol["text-ignore-placement"]),"text-optional":new pe(Et.layout_symbol["text-optional"])})}};class Rx{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:Hn,this.defaultValue=r}evaluate(r){if(r.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(r.formattedSection))return a.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}oe("FormatSectionOverride",Rx,{omit:["defaultValue"]});class Hp extends v{constructor(r){super(r,Kg)}recalculate(r,a){if(super.recalculate(r,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const m=[];for(const _ of p)m.indexOf(_)<0&&m.push(_);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,a,p,m){const _=this.layout.get(r).evaluate(a,{},p,m),x=this._unevaluatedLayout._values[r];return x.isDataDriven()||lc(x.value)||!_?_:function(w,T){return T.replace(/{([^{}]+)}/g,(I,D)=>w&&D in w?String(w[D]):"")}(a.properties,_)}createBucket(r){return new Ac(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of Kg.paint.overridableProperties){if(!Hp.hasPaintOverride(this.layout,r))continue;const a=this.paint.get(r),p=new Rx(a),m=new Fu(p,a.property.specification);let _=null;_=a.value.kind==="constant"||a.value.kind==="source"?new Ou("source",m):new Bu("composite",m,a.value.zoomStops),this.paint._values[r]=new fs(a.property,_,a.parameters)}}_handleOverridablePaintPropertyUpdate(r,a,p){return!(!this.layout||a.isDataDriven()||p.isDataDriven())&&Hp.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,a){const p=r.get("text-field"),m=Kg.paint.properties[a];let _=!1;const x=w=>{for(const T of w)if(m.overrides&&m.overrides.hasOverride(T))return void(_=!0)};if(p.value.kind==="constant"&&p.value.value instanceof $i)x(p.value.value.sections);else if(p.value.kind==="source"){const w=I=>{_||(I instanceof In&&Si(I.value)===qn?x(I.value.sections):I instanceof Yl?x(I.sections):I.eachChild(w))},T=p.value;T._styleExpression&&w(T._styleExpression.expression)}return _}}let Fx;var w4={get paint(){return Fx=Fx||new f({"background-color":new pe(Et.paint_background["background-color"]),"background-pattern":new n(Et.paint_background["background-pattern"]),"background-opacity":new pe(Et.paint_background["background-opacity"])})}};class S4 extends v{constructor(r){super(r,w4)}}let Ox;var k4={get paint(){return Ox=Ox||new f({"raster-opacity":new pe(Et.paint_raster["raster-opacity"]),"raster-hue-rotate":new pe(Et.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new pe(Et.paint_raster["raster-brightness-min"]),"raster-brightness-max":new pe(Et.paint_raster["raster-brightness-max"]),"raster-saturation":new pe(Et.paint_raster["raster-saturation"]),"raster-contrast":new pe(Et.paint_raster["raster-contrast"]),"raster-resampling":new pe(Et.paint_raster["raster-resampling"]),"raster-fade-duration":new pe(Et.paint_raster["raster-fade-duration"])})}};class T4 extends v{constructor(r){super(r,k4)}}class M4 extends v{constructor(r){super(r,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class C4{constructor(r){this._methodToThrottle=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Xg=63710088e-1;class _a{constructor(r,a){if(isNaN(r)||isNaN(a))throw new Error(`Invalid LngLat object: (${r}, ${a})`);if(this.lng=+r,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new _a(xt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const a=Math.PI/180,p=this.lat*a,m=r.lat*a,_=Math.sin(p)*Math.sin(m)+Math.cos(p)*Math.cos(m)*Math.cos((r.lng-this.lng)*a);return Xg*Math.acos(Math.min(_,1))}static convert(r){if(r instanceof _a)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new _a(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new _a(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Bx=2*Math.PI*Xg;function Vx(o){return Bx*Math.cos(o*Math.PI/180)}function $x(o){return(180+o)/360}function Nx(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function jx(o,r){return o/Vx(r)}function Jg(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}class Zp{constructor(r,a,p=0){this.x=+r,this.y=+a,this.z=+p}static fromLngLat(r,a=0){const p=_a.convert(r);return new Zp($x(p.lng),Nx(p.lat),jx(a,p.lat))}toLngLat(){return new _a(360*this.x-180,Jg(this.y))}toAltitude(){return this.z*Vx(Jg(this.y))}meterInMercatorCoordinateUnits(){return 1/Bx*(r=Jg(this.y),1/Math.cos(r*Math.PI/180));var r}}function Ux(o,r,a){var p=2*Math.PI*6378137/256/Math.pow(2,a);return[o*p-2*Math.PI*6378137/2,r*p-2*Math.PI*6378137/2]}class Qg{constructor(r,a,p){if(r<0||r>25||p<0||p>=Math.pow(2,r)||a<0||a>=Math.pow(2,r))throw new Error(`x=${a}, y=${p}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=a,this.y=p,this.key=_h(0,r,r,a,p)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,a,p){const m=(x=this.y,w=this.z,T=Ux(256*(_=this.x),256*(x=Math.pow(2,w)-x-1),w),I=Ux(256*(_+1),256*(x+1),w),T[0]+","+T[1]+","+I[0]+","+I[1]);var _,x,w,T,I;const D=function(L,O,j){let q,J="";for(let it=L;it>0;it--)q=1<<it-1,J+=(O&q?1:0)+(j&q?2:0);return J}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,m)}isChildOf(r){const a=this.z-r.z;return a>0&&r.x===this.x>>a&&r.y===this.y>>a}getTilePoint(r){const a=Math.pow(2,this.z);return new P((r.x*a-this.x)*Ji,(r.y*a-this.y)*Ji)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Hx{constructor(r,a){this.wrap=r,this.canonical=a,this.key=_h(r,a.z,a.z,a.x,a.y)}}class Qn{constructor(r,a,p,m,_){if(r<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${p}`);this.overscaledZ=r,this.wrap=a,this.canonical=new Qg(p,+m,+_),this.key=_h(a,r,p,m,_)}clone(){return new Qn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-r;return r>this.canonical.z?new Qn(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Qn(r,this.wrap,r,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(r,a){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-r;return r>this.canonical.z?_h(this.wrap*+a,r,this.canonical.z,this.canonical.x,this.canonical.y):_h(this.wrap*+a,r,r,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(r){if(r.wrap!==this.wrap)return!1;const a=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>a&&r.canonical.y===this.canonical.y>>a}children(r){if(this.overscaledZ>=r)return[new Qn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,p=2*this.canonical.x,m=2*this.canonical.y;return[new Qn(a,this.wrap,a,p,m),new Qn(a,this.wrap,a,p+1,m),new Qn(a,this.wrap,a,p,m+1),new Qn(a,this.wrap,a,p+1,m+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Qn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Qn(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Hx(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new Zp(r.x-this.wrap,r.y))}}function _h(o,r,a,p,m){(o*=2)<0&&(o=-1*o-1);const _=1<<a;return(_*_*o+_*m+p).toString(36)+a.toString(36)+r.toString(36)}oe("CanonicalTileID",Qg),oe("OverscaledTileID",Qn,{omit:["posMatrix"]});class Zx{constructor(r,a,p,m=1,_=1,x=1,w=0){if(this.uid=r,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(p&&!["mapbox","terrarium","custom"].includes(p))return void _e(`"${p}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const T=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),p){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=_,this.blueFactor=x,this.baseShift=w;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let I=0;I<T;I++)this.data[this._idx(-1,I)]=this.data[this._idx(0,I)],this.data[this._idx(T,I)]=this.data[this._idx(T-1,I)],this.data[this._idx(I,-1)]=this.data[this._idx(I,0)],this.data[this._idx(I,T)]=this.data[this._idx(I,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let I=0;I<T;I++)for(let D=0;D<T;D++){const L=this.get(I,D);L>this.max&&(this.max=L),L<this.min&&(this.min=L)}}get(r,a){const p=new Uint8Array(this.data.buffer),m=4*this._idx(r,a);return this.unpack(p[m],p[m+1],p[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,a){if(r<-1||r>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(r+1)}unpack(r,a,p){return r*this.redFactor+a*this.greenFactor+p*this.blueFactor-this.baseShift}getPixels(){return new Jn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,a,p){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let m=a*this.dim,_=a*this.dim+this.dim,x=p*this.dim,w=p*this.dim+this.dim;switch(a){case-1:m=_-1;break;case 1:_=m+1}switch(p){case-1:x=w-1;break;case 1:w=x+1}const T=-a*this.dim,I=-p*this.dim;for(let D=x;D<w;D++)for(let L=m;L<_;L++)this.data[this._idx(L,D)]=r.data[this._idx(L+T,D+I)]}}oe("DEMData",Zx);class qx{constructor(r){this._stringToNumber={},this._numberToString=[];for(let a=0;a<r.length;a++){const p=r[a];this._stringToNumber[p]=a,this._numberToString[a]=p}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class Gx{constructor(r,a,p,m,_){this.type="Feature",this._vectorTileFeature=r,r._z=a,r._x=p,r._y=m,this.properties=r.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(r[a]=this[a]);return r}}class Wx{constructor(r,a){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new hl(Ji,16,0),this.grid3D=new hl(Ji,16,0),this.featureIndexArray=new Kn,this.promoteId=a}insert(r,a,p,m,_,x){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,m,_);const T=x?this.grid3D:this.grid;for(let I=0;I<a.length;I++){const D=a[I],L=[1/0,1/0,-1/0,-1/0];for(let O=0;O<D.length;O++){const j=D[O];L[0]=Math.min(L[0],j.x),L[1]=Math.min(L[1],j.y),L[2]=Math.max(L[2],j.x),L[3]=Math.max(L[3],j.y)}L[0]<Ji&&L[1]<Ji&&L[2]>=0&&L[3]>=0&&T.insert(w,L[0],L[1],L[2],L[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ma.VectorTile(new Ng(this.rawTileData)).layers,this.sourceLayerCoder=new qx(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,a,p,m){this.loadVTLayers();const _=r.params||{},x=Ji/r.tileSize/r.scale,w=Vu(_.filter),T=r.queryGeometry,I=r.queryPadding*x,D=Kx(T),L=this.grid.query(D.minX-I,D.minY-I,D.maxX+I,D.maxY+I),O=Kx(r.cameraQueryGeometry),j=this.grid3D.query(O.minX-I,O.minY-I,O.maxX+I,O.maxY+I,(it,ct,wt,pt)=>function(vt,zt,Lt,ee,he){for(const Yt of vt)if(zt<=Yt.x&&Lt<=Yt.y&&ee>=Yt.x&&he>=Yt.y)return!0;const Jt=[new P(zt,Lt),new P(zt,he),new P(ee,he),new P(ee,Lt)];if(vt.length>2){for(const Yt of Jt)if(Tc(vt,Yt))return!0}for(let Yt=0;Yt<vt.length-1;Yt++)if(a3(vt[Yt],vt[Yt+1],Jt))return!0;return!1}(r.cameraQueryGeometry,it-I,ct-I,wt+I,pt+I));for(const it of j)L.push(it);L.sort(E4);const q={};let J;for(let it=0;it<L.length;it++){const ct=L[it];if(ct===J)continue;J=ct;const wt=this.featureIndexArray.get(ct);let pt=null;this.loadMatchingFeature(q,wt.bucketIndex,wt.sourceLayerIndex,wt.featureIndex,w,_.layers,_.availableImages,a,p,m,(vt,zt,Lt)=>(pt||(pt=gl(vt)),zt.queryIntersectsFeature(T,vt,Lt,pt,this.z,r.transform,x,r.pixelPosMatrix)))}return q}loadMatchingFeature(r,a,p,m,_,x,w,T,I,D,L){const O=this.bucketLayerIDs[a];if(x&&!function(it,ct){for(let wt=0;wt<it.length;wt++)if(ct.indexOf(it[wt])>=0)return!0;return!1}(x,O))return;const j=this.sourceLayerCoder.decode(p),q=this.vtLayers[j].feature(m);if(_.needGeometry){const it=yl(q,!0);if(!_.filter(new mi(this.tileID.overscaledZ),it,this.tileID.canonical))return}else if(!_.filter(new mi(this.tileID.overscaledZ),q))return;const J=this.getId(q,j);for(let it=0;it<O.length;it++){const ct=O[it];if(x&&x.indexOf(ct)<0)continue;const wt=T[ct];if(!wt)continue;let pt={};J&&D&&(pt=D.getState(wt.sourceLayer||"_geojsonTileLayer",J));const vt=Tt({},I[ct]);vt.paint=Yx(vt.paint,wt.paint,q,pt,w),vt.layout=Yx(vt.layout,wt.layout,q,pt,w);const zt=!L||L(q,wt,pt);if(!zt)continue;const Lt=new Gx(q,this.z,this.x,this.y,J);Lt.layer=vt;let ee=r[ct];ee===void 0&&(ee=r[ct]=[]),ee.push({featureIndex:m,feature:Lt,intersectionZ:zt})}}lookupSymbolFeatures(r,a,p,m,_,x,w,T){const I={};this.loadVTLayers();const D=Vu(_);for(const L of r)this.loadMatchingFeature(I,p,m,L,D,x,w,T,a);return I}hasLayer(r){for(const a of this.bucketLayerIDs)for(const p of a)if(r===p)return!0;return!1}getId(r,a){let p=r.id;return this.promoteId&&(p=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof p=="boolean"&&(p=Number(p))),p}}function Yx(o,r,a,p,m){return $t(o,(_,x)=>{const w=r instanceof _c?r.get(x):null;return w&&w.evaluate?w.evaluate(a,p,m):w})}function Kx(o){let r=1/0,a=1/0,p=-1/0,m=-1/0;for(const _ of o)r=Math.min(r,_.x),a=Math.min(a,_.y),p=Math.max(p,_.x),m=Math.max(m,_.y);return{minX:r,minY:a,maxX:p,maxY:m}}function E4(o,r){return r-o}function Xx(o,r,a,p,m){const _=[];for(let x=0;x<o.length;x++){const w=o[x];let T;for(let I=0;I<w.length-1;I++){let D=w[I],L=w[I+1];D.x<r&&L.x<r||(D.x<r?D=new P(r,D.y+(r-D.x)/(L.x-D.x)*(L.y-D.y))._round():L.x<r&&(L=new P(r,D.y+(r-D.x)/(L.x-D.x)*(L.y-D.y))._round()),D.y<a&&L.y<a||(D.y<a?D=new P(D.x+(a-D.y)/(L.y-D.y)*(L.x-D.x),a)._round():L.y<a&&(L=new P(D.x+(a-D.y)/(L.y-D.y)*(L.x-D.x),a)._round()),D.x>=p&&L.x>=p||(D.x>=p?D=new P(p,D.y+(p-D.x)/(L.x-D.x)*(L.y-D.y))._round():L.x>=p&&(L=new P(p,D.y+(p-D.x)/(L.x-D.x)*(L.y-D.y))._round()),D.y>=m&&L.y>=m||(D.y>=m?D=new P(D.x+(m-D.y)/(L.y-D.y)*(L.x-D.x),m)._round():L.y>=m&&(L=new P(D.x+(m-D.y)/(L.y-D.y)*(L.x-D.x),m)._round()),T&&D.equals(T[T.length-1])||(T=[D],_.push(T)),T.push(L)))))}}return _}oe("FeatureIndex",Wx,{omit:["rawTileData","sourceLayerCoder"]});class va extends P{constructor(r,a,p,m){super(r,a),this.angle=p,m!==void 0&&(this.segment=m)}clone(){return new va(this.x,this.y,this.angle,this.segment)}}function Jx(o,r,a,p,m){if(r.segment===void 0||a===0)return!0;let _=r,x=r.segment+1,w=0;for(;w>-a/2;){if(x--,x<0)return!1;w-=o[x].dist(_),_=o[x]}w+=o[x].dist(o[x+1]),x++;const T=[];let I=0;for(;w<a/2;){const D=o[x],L=o[x+1];if(!L)return!1;let O=o[x-1].angleTo(D)-D.angleTo(L);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:w,angleDelta:O}),I+=O;w-T[0].distance>p;)I-=T.shift().angleDelta;if(I>m)return!1;x++,w+=D.dist(L)}return!0}function Qx(o){let r=0;for(let a=0;a<o.length-1;a++)r+=o[a].dist(o[a+1]);return r}function t1(o,r,a){return o?.6*r*a:0}function e1(o,r){return Math.max(o?o.right-o.left:0,r?r.right-r.left:0)}function P4(o,r,a,p,m,_){const x=t1(a,m,_),w=e1(a,p)*_;let T=0;const I=Qx(o)/2;for(let D=0;D<o.length-1;D++){const L=o[D],O=o[D+1],j=L.dist(O);if(T+j>I){const q=(I-T)/j,J=Wr.number(L.x,O.x,q),it=Wr.number(L.y,O.y,q),ct=new va(J,it,O.angleTo(L),D);return ct._round(),!x||Jx(o,ct,w,x,r)?ct:void 0}T+=j}}function I4(o,r,a,p,m,_,x,w,T){const I=t1(p,_,x),D=e1(p,m),L=D*x,O=o[0].x===0||o[0].x===T||o[0].y===0||o[0].y===T;return r-L<r/4&&(r=L+r/4),i1(o,O?r/2*w%r:(D/2+2*_)*x*w%r,r,I,a,L,O,!1,T)}function i1(o,r,a,p,m,_,x,w,T){const I=_/2,D=Qx(o);let L=0,O=r-a,j=[];for(let q=0;q<o.length-1;q++){const J=o[q],it=o[q+1],ct=J.dist(it),wt=it.angleTo(J);for(;O+a<L+ct;){O+=a;const pt=(O-L)/ct,vt=Wr.number(J.x,it.x,pt),zt=Wr.number(J.y,it.y,pt);if(vt>=0&&vt<T&&zt>=0&&zt<T&&O-I>=0&&O+I<=D){const Lt=new va(vt,zt,wt,q);Lt._round(),p&&!Jx(o,Lt,_,p,m)||j.push(Lt)}}L+=ct}return w||j.length||x||(j=i1(o,L/2,a,p,m,_,x,!0,T)),j}oe("Anchor",va);const zc=bn;function r1(o,r,a,p){const m=[],_=o.image,x=_.pixelRatio,w=_.paddedRect.w-2*zc,T=_.paddedRect.h-2*zc;let I={x1:o.left,y1:o.top,x2:o.right,y2:o.bottom};const D=_.stretchX||[[0,w]],L=_.stretchY||[[0,T]],O=(Rt,ue)=>Rt+ue[1]-ue[0],j=D.reduce(O,0),q=L.reduce(O,0),J=w-j,it=T-q;let ct=0,wt=j,pt=0,vt=q,zt=0,Lt=J,ee=0,he=it;if(_.content&&p){const Rt=_.content,ue=Rt[2]-Rt[0],le=Rt[3]-Rt[1];(_.textFitWidth||_.textFitHeight)&&(I=Ix(o)),ct=qp(D,0,Rt[0]),pt=qp(L,0,Rt[1]),wt=qp(D,Rt[0],Rt[2]),vt=qp(L,Rt[1],Rt[3]),zt=Rt[0]-ct,ee=Rt[1]-pt,Lt=ue-wt,he=le-vt}const Jt=I.x1,Yt=I.y1,ae=I.x2-Jt,me=I.y2-Yt,Qt=(Rt,ue,le,ze)=>{const di=Gp(Rt.stretch-ct,wt,ae,Jt),pi=Wp(Rt.fixed-zt,Lt,Rt.stretch,j),Qi=Gp(ue.stretch-pt,vt,me,Yt),ts=Wp(ue.fixed-ee,he,ue.stretch,q),Kr=Gp(le.stretch-ct,wt,ae,Jt),lr=Wp(le.fixed-zt,Lt,le.stretch,j),Mr=Gp(ze.stretch-pt,vt,me,Yt),Xr=Wp(ze.fixed-ee,he,ze.stretch,q),ln=new P(di,Qi),Jr=new P(Kr,Qi),tr=new P(Kr,Mr),gr=new P(di,Mr),cn=new P(pi/x,ts/x),wn=new P(lr/x,Xr/x),Vr=r*Math.PI/180;if(Vr){const Ui=Math.sin(Vr),Be=Math.cos(Vr),er=[Be,-Ui,Ui,Be];ln._matMult(er),Jr._matMult(er),gr._matMult(er),tr._matMult(er)}const Sn=Rt.stretch+Rt.fixed,es=ue.stretch+ue.fixed;return{tl:ln,tr:Jr,bl:gr,br:tr,tex:{x:_.paddedRect.x+zc+Sn,y:_.paddedRect.y+zc+es,w:le.stretch+le.fixed-Sn,h:ze.stretch+ze.fixed-es},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:cn,pixelOffsetBR:wn,minFontScaleX:Lt/x/ae,minFontScaleY:he/x/me,isSDF:a}};if(p&&(_.stretchX||_.stretchY)){const Rt=n1(D,J,j),ue=n1(L,it,q);for(let le=0;le<Rt.length-1;le++){const ze=Rt[le],di=Rt[le+1];for(let pi=0;pi<ue.length-1;pi++)m.push(Qt(ze,ue[pi],di,ue[pi+1]))}}else m.push(Qt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:T+1}));return m}function qp(o,r,a){let p=0;for(const m of o)p+=Math.max(r,Math.min(a,m[1]))-Math.max(r,Math.min(a,m[0]));return p}function n1(o,r,a){const p=[{fixed:-zc,stretch:0}];for(const[m,_]of o){const x=p[p.length-1];p.push({fixed:m-x.stretch,stretch:x.stretch}),p.push({fixed:m-x.stretch,stretch:x.stretch+(_-m)})}return p.push({fixed:r+zc,stretch:a}),p}function Gp(o,r,a,p){return o/r*a+p}function Wp(o,r,a,p){return o-r*a/p}class Yp{constructor(r,a,p,m,_,x,w,T,I,D){var L;if(this.boxStartIndex=r.length,I){let O=x.top,j=x.bottom;const q=x.collisionPadding;q&&(O-=q[1],j+=q[3]);let J=j-O;J>0&&(J=Math.max(10,J),this.circleDiameter=J)}else{const O=!((L=x.image)===null||L===void 0)&&L.content&&(x.image.textFitWidth||x.image.textFitHeight)?Ix(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};O.y1=O.y1*w-T[0],O.y2=O.y2*w+T[2],O.x1=O.x1*w-T[3],O.x2=O.x2*w+T[1];const j=x.collisionPadding;if(j&&(O.x1-=j[0]*w,O.y1-=j[1]*w,O.x2+=j[2]*w,O.y2+=j[3]*w),D){const q=new P(O.x1,O.y1),J=new P(O.x2,O.y1),it=new P(O.x1,O.y2),ct=new P(O.x2,O.y2),wt=D*Math.PI/180;q._rotate(wt),J._rotate(wt),it._rotate(wt),ct._rotate(wt),O.x1=Math.min(q.x,J.x,it.x,ct.x),O.x2=Math.max(q.x,J.x,it.x,ct.x),O.y1=Math.min(q.y,J.y,it.y,ct.y),O.y2=Math.max(q.y,J.y,it.y,ct.y)}r.emplaceBack(a.x,a.y,O.x1,O.y1,O.x2,O.y2,p,m,_)}this.boxEndIndex=r.length}}class A4{constructor(r=[],a=z4){if(this.data=r,this.length=this.data.length,this.compare=a,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(r){this.data.push(r),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const r=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:a,compare:p}=this,m=a[r];for(;r>0;){const _=r-1>>1,x=a[_];if(p(m,x)>=0)break;a[r]=x,r=_}a[r]=m}_down(r){const{data:a,compare:p}=this,m=this.length>>1,_=a[r];for(;r<m;){let x=1+(r<<1),w=a[x];const T=x+1;if(T<this.length&&p(a[T],w)<0&&(x=T,w=a[T]),p(w,_)>=0)break;a[r]=w,r=x}a[r]=_}}function z4(o,r){return o<r?-1:o>r?1:0}function D4(o,r=1,a=!1){let p=1/0,m=1/0,_=-1/0,x=-1/0;const w=o[0];for(let j=0;j<w.length;j++){const q=w[j];(!j||q.x<p)&&(p=q.x),(!j||q.y<m)&&(m=q.y),(!j||q.x>_)&&(_=q.x),(!j||q.y>x)&&(x=q.y)}const T=Math.min(_-p,x-m);let I=T/2;const D=new A4([],L4);if(T===0)return new P(p,m);for(let j=p;j<_;j+=T)for(let q=m;q<x;q+=T)D.push(new Dc(j+I,q+I,I,o));let L=function(j){let q=0,J=0,it=0;const ct=j[0];for(let wt=0,pt=ct.length,vt=pt-1;wt<pt;vt=wt++){const zt=ct[wt],Lt=ct[vt],ee=zt.x*Lt.y-Lt.x*zt.y;J+=(zt.x+Lt.x)*ee,it+=(zt.y+Lt.y)*ee,q+=3*ee}return new Dc(J/q,it/q,0,j)}(o),O=D.length;for(;D.length;){const j=D.pop();(j.d>L.d||!L.d)&&(L=j,a&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,O)),j.max-L.d<=r||(I=j.h/2,D.push(new Dc(j.p.x-I,j.p.y-I,I,o)),D.push(new Dc(j.p.x+I,j.p.y-I,I,o)),D.push(new Dc(j.p.x-I,j.p.y+I,I,o)),D.push(new Dc(j.p.x+I,j.p.y+I,I,o)),O+=4)}return a&&(console.log(`num probes: ${O}`),console.log(`best distance: ${L.d}`)),L.p}function L4(o,r){return r.max-o.max}function Dc(o,r,a,p){this.p=new P(o,r),this.h=a,this.d=function(m,_){let x=!1,w=1/0;for(let T=0;T<_.length;T++){const I=_[T];for(let D=0,L=I.length,O=L-1;D<L;O=D++){const j=I[D],q=I[O];j.y>m.y!=q.y>m.y&&m.x<(q.x-j.x)*(m.y-j.y)/(q.y-j.y)+j.x&&(x=!x),w=Math.min(w,Nv(m,j,q))}}return(x?1:-1)*Math.sqrt(w)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}var Br;d.aq=void 0,(Br=d.aq||(d.aq={}))[Br.center=1]="center",Br[Br.left=2]="left",Br[Br.right=3]="right",Br[Br.top=4]="top",Br[Br.bottom=5]="bottom",Br[Br["top-left"]=6]="top-left",Br[Br["top-right"]=7]="top-right",Br[Br["bottom-left"]=8]="bottom-left",Br[Br["bottom-right"]=9]="bottom-right";const xa=7,t0=Number.POSITIVE_INFINITY;function s1(o,r){return r[1]!==t0?function(a,p,m){let _=0,x=0;switch(p=Math.abs(p),m=Math.abs(m),a){case"top-right":case"top-left":case"top":x=m-xa;break;case"bottom-right":case"bottom-left":case"bottom":x=-m+xa}switch(a){case"top-right":case"bottom-right":case"right":_=-p;break;case"top-left":case"bottom-left":case"left":_=p}return[_,x]}(o,r[0],r[1]):function(a,p){let m=0,_=0;p<0&&(p=0);const x=p/Math.SQRT2;switch(a){case"top-right":case"top-left":_=x-xa;break;case"bottom-right":case"bottom-left":_=-x+xa;break;case"bottom":_=-p+xa;break;case"top":_=p-xa}switch(a){case"top-right":case"bottom-right":m=-x;break;case"top-left":case"bottom-left":m=x;break;case"left":m=p;break;case"right":m=-p}return[m,_]}(o,r[0])}function o1(o,r,a){var p;const m=o.layout,_=(p=m.get("text-variable-anchor-offset"))===null||p===void 0?void 0:p.evaluate(r,{},a);if(_){const w=_.values,T=[];for(let I=0;I<w.length;I+=2){const D=T[I]=w[I],L=w[I+1].map(O=>O*ar);D.startsWith("top")?L[1]-=xa:D.startsWith("bottom")&&(L[1]+=xa),T[I+1]=L}return new wi(T)}const x=m.get("text-variable-anchor");if(x){let w;w=o._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(r,{},a)*ar,t0]:m.get("text-offset").evaluate(r,{},a).map(I=>I*ar);const T=[];for(const I of x)T.push(I,s1(I,w));return new wi(T)}return null}function e0(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function R4(o,r,a,p,m,_,x,w,T,I,D){let L=_.textMaxSize.evaluate(r,{});L===void 0&&(L=x);const O=o.layers[0].layout,j=O.get("icon-offset").evaluate(r,{},D),q=l1(a.horizontal),J=x/24,it=o.tilePixelRatio*J,ct=o.tilePixelRatio*L/24,wt=o.tilePixelRatio*w,pt=o.tilePixelRatio*O.get("symbol-spacing"),vt=O.get("text-padding")*o.tilePixelRatio,zt=function(Rt,ue,le,ze=1){const di=Rt.get("icon-padding").evaluate(ue,{},le),pi=di&&di.values;return[pi[0]*ze,pi[1]*ze,pi[2]*ze,pi[3]*ze]}(O,r,D,o.tilePixelRatio),Lt=O.get("text-max-angle")/180*Math.PI,ee=O.get("text-rotation-alignment")!=="viewport"&&O.get("symbol-placement")!=="point",he=O.get("icon-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",Jt=O.get("symbol-placement"),Yt=pt/2,ae=O.get("icon-text-fit");let me;p&&ae!=="none"&&(o.allowVerticalPlacement&&a.vertical&&(me=Ax(p,a.vertical,ae,O.get("icon-text-fit-padding"),j,J)),q&&(p=Ax(p,q,ae,O.get("icon-text-fit-padding"),j,J)));const Qt=(Rt,ue)=>{ue.x<0||ue.x>=Ji||ue.y<0||ue.y>=Ji||function(le,ze,di,pi,Qi,ts,Kr,lr,Mr,Xr,ln,Jr,tr,gr,cn,wn,Vr,Sn,es,Ui,Be,er,$r,cr,ms){const zs=le.addToLineVertexArray(ze,di);let Ds,zo,gs,is,kn=0,Do=0,bh=0,d1=0,c0=-1,u0=-1;const Lo={};let p1=Sc("");if(le.allowVerticalPlacement&&pi.vertical){const Qr=lr.layout.get("text-rotate").evaluate(Be,{},cr)+90;gs=new Yp(Mr,ze,Xr,ln,Jr,pi.vertical,tr,gr,cn,Qr),Kr&&(is=new Yp(Mr,ze,Xr,ln,Jr,Kr,Vr,Sn,cn,Qr))}if(Qi){const Qr=lr.layout.get("icon-rotate").evaluate(Be,{}),rs=lr.layout.get("icon-text-fit")!=="none",vl=r1(Qi,Qr,$r,rs),Rs=Kr?r1(Kr,Qr,$r,rs):void 0;zo=new Yp(Mr,ze,Xr,ln,Jr,Qi,Vr,Sn,!1,Qr),kn=4*vl.length;const xl=le.iconSizeData;let co=null;xl.kind==="source"?(co=[lo*lr.layout.get("icon-size").evaluate(Be,{})],co[0]>ya&&_e(`${le.layerIds[0]}: Value for "icon-size" is >= ${yh}. Reduce your "icon-size".`)):xl.kind==="composite"&&(co=[lo*er.compositeIconSizes[0].evaluate(Be,{},cr),lo*er.compositeIconSizes[1].evaluate(Be,{},cr)],(co[0]>ya||co[1]>ya)&&_e(`${le.layerIds[0]}: Value for "icon-size" is >= ${yh}. Reduce your "icon-size".`)),le.addSymbols(le.icon,vl,co,Ui,es,Be,d.ah.none,ze,zs.lineStartIndex,zs.lineLength,-1,cr),c0=le.icon.placedSymbolArray.length-1,Rs&&(Do=4*Rs.length,le.addSymbols(le.icon,Rs,co,Ui,es,Be,d.ah.vertical,ze,zs.lineStartIndex,zs.lineLength,-1,cr),u0=le.icon.placedSymbolArray.length-1)}const f1=Object.keys(pi.horizontal);for(const Qr of f1){const rs=pi.horizontal[Qr];if(!Ds){p1=Sc(rs.text);const Rs=lr.layout.get("text-rotate").evaluate(Be,{},cr);Ds=new Yp(Mr,ze,Xr,ln,Jr,rs,tr,gr,cn,Rs)}const vl=rs.positionedLines.length===1;if(bh+=a1(le,ze,rs,ts,lr,cn,Be,wn,zs,pi.vertical?d.ah.horizontal:d.ah.horizontalOnly,vl?f1:[Qr],Lo,c0,er,cr),vl)break}pi.vertical&&(d1+=a1(le,ze,pi.vertical,ts,lr,cn,Be,wn,zs,d.ah.vertical,["vertical"],Lo,u0,er,cr));const B4=Ds?Ds.boxStartIndex:le.collisionBoxArray.length,V4=Ds?Ds.boxEndIndex:le.collisionBoxArray.length,$4=gs?gs.boxStartIndex:le.collisionBoxArray.length,N4=gs?gs.boxEndIndex:le.collisionBoxArray.length,j4=zo?zo.boxStartIndex:le.collisionBoxArray.length,U4=zo?zo.boxEndIndex:le.collisionBoxArray.length,H4=is?is.boxStartIndex:le.collisionBoxArray.length,Z4=is?is.boxEndIndex:le.collisionBoxArray.length;let Ls=-1;const Xp=(Qr,rs)=>Qr&&Qr.circleDiameter?Math.max(Qr.circleDiameter,rs):rs;Ls=Xp(Ds,Ls),Ls=Xp(gs,Ls),Ls=Xp(zo,Ls),Ls=Xp(is,Ls);const m1=Ls>-1?1:0;m1&&(Ls*=ms/ar),le.glyphOffsetArray.length>=Ac.MAX_GLYPHS&&_e("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Be.sortKey!==void 0&&le.addToSortKeyRanges(le.symbolInstances.length,Be.sortKey);const q4=o1(lr,Be,cr),[G4,W4]=function(Qr,rs){const vl=Qr.length,Rs=rs==null?void 0:rs.values;if((Rs==null?void 0:Rs.length)>0)for(let xl=0;xl<Rs.length;xl+=2){const co=Rs[xl+1];Qr.emplaceBack(d.aq[Rs[xl]],co[0],co[1])}return[vl,Qr.length]}(le.textAnchorOffsets,q4);le.symbolInstances.emplaceBack(ze.x,ze.y,Lo.right>=0?Lo.right:-1,Lo.center>=0?Lo.center:-1,Lo.left>=0?Lo.left:-1,Lo.vertical||-1,c0,u0,p1,B4,V4,$4,N4,j4,U4,H4,Z4,Xr,bh,d1,kn,Do,m1,0,tr,Ls,G4,W4)}(o,ue,Rt,a,p,m,me,o.layers[0],o.collisionBoxArray,r.index,r.sourceLayerIndex,o.index,it,[vt,vt,vt,vt],ee,T,wt,zt,he,j,r,_,I,D,x)};if(Jt==="line")for(const Rt of Xx(r.geometry,0,0,Ji,Ji)){const ue=I4(Rt,pt,Lt,a.vertical||q,p,24,ct,o.overscaling,Ji);for(const le of ue)q&&F4(o,q.text,Yt,le)||Qt(Rt,le)}else if(Jt==="line-center"){for(const Rt of r.geometry)if(Rt.length>1){const ue=P4(Rt,Lt,a.vertical||q,p,24,ct);ue&&Qt(Rt,ue)}}else if(r.type==="Polygon")for(const Rt of Xl(r.geometry,0)){const ue=D4(Rt,16);Qt(Rt[0],new va(ue.x,ue.y,0))}else if(r.type==="LineString")for(const Rt of r.geometry)Qt(Rt,new va(Rt[0].x,Rt[0].y,0));else if(r.type==="Point")for(const Rt of r.geometry)for(const ue of Rt)Qt([ue],new va(ue.x,ue.y,0))}function a1(o,r,a,p,m,_,x,w,T,I,D,L,O,j,q){const J=function(wt,pt,vt,zt,Lt,ee,he,Jt){const Yt=zt.layout.get("text-rotate").evaluate(ee,{})*Math.PI/180,ae=[];for(const me of pt.positionedLines)for(const Qt of me.positionedGlyphs){if(!Qt.rect)continue;const Rt=Qt.rect||{};let ue=Sx+1,le=!0,ze=1,di=0;const pi=(Lt||Jt)&&Qt.vertical,Qi=Qt.metrics.advance*Qt.scale/2;if(Jt&&pt.verticalizable&&(di=me.lineOffset/2-(Qt.imageName?-(ar-Qt.metrics.width*Qt.scale)/2:(Qt.scale-1)*ar)),Qt.imageName){const Ui=he[Qt.imageName];le=Ui.sdf,ze=Ui.pixelRatio,ue=bn/ze}const ts=Lt?[Qt.x+Qi,Qt.y]:[0,0];let Kr=Lt?[0,0]:[Qt.x+Qi+vt[0],Qt.y+vt[1]-di],lr=[0,0];pi&&(lr=Kr,Kr=[0,0]);const Mr=Qt.metrics.isDoubleResolution?2:1,Xr=(Qt.metrics.left-ue)*Qt.scale-Qi+Kr[0],ln=(-Qt.metrics.top-ue)*Qt.scale+Kr[1],Jr=Xr+Rt.w/Mr*Qt.scale/ze,tr=ln+Rt.h/Mr*Qt.scale/ze,gr=new P(Xr,ln),cn=new P(Jr,ln),wn=new P(Xr,tr),Vr=new P(Jr,tr);if(pi){const Ui=new P(-Qi,Qi-mh),Be=-Math.PI/2,er=ar/2-Qi,$r=new P(5-mh-er,-(Qt.imageName?er:0)),cr=new P(...lr);gr._rotateAround(Be,Ui)._add($r)._add(cr),cn._rotateAround(Be,Ui)._add($r)._add(cr),wn._rotateAround(Be,Ui)._add($r)._add(cr),Vr._rotateAround(Be,Ui)._add($r)._add(cr)}if(Yt){const Ui=Math.sin(Yt),Be=Math.cos(Yt),er=[Be,-Ui,Ui,Be];gr._matMult(er),cn._matMult(er),wn._matMult(er),Vr._matMult(er)}const Sn=new P(0,0),es=new P(0,0);ae.push({tl:gr,tr:cn,bl:wn,br:Vr,tex:Rt,writingMode:pt.writingMode,glyphOffset:ts,sectionIndex:Qt.sectionIndex,isSDF:le,pixelOffsetTL:Sn,pixelOffsetBR:es,minFontScaleX:0,minFontScaleY:0})}return ae}(0,a,w,m,_,x,p,o.allowVerticalPlacement),it=o.textSizeData;let ct=null;it.kind==="source"?(ct=[lo*m.layout.get("text-size").evaluate(x,{})],ct[0]>ya&&_e(`${o.layerIds[0]}: Value for "text-size" is >= ${yh}. Reduce your "text-size".`)):it.kind==="composite"&&(ct=[lo*j.compositeTextSizes[0].evaluate(x,{},q),lo*j.compositeTextSizes[1].evaluate(x,{},q)],(ct[0]>ya||ct[1]>ya)&&_e(`${o.layerIds[0]}: Value for "text-size" is >= ${yh}. Reduce your "text-size".`)),o.addSymbols(o.text,J,ct,w,_,x,I,r,T.lineStartIndex,T.lineLength,O,q);for(const wt of D)L[wt]=o.text.placedSymbolArray.length-1;return 4*J.length}function l1(o){for(const r in o)return o[r];return null}function F4(o,r,a,p){const m=o.compareText;if(r in m){const _=m[r];for(let x=_.length-1;x>=0;x--)if(p.dist(_[x])<a)return!0}else m[r]=[];return m[r].push(p),!1}const c1=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class i0{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,p]=new Uint8Array(r,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=p>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const _=c1[15&p];if(!_)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(r,2,1),[w]=new Uint32Array(r,4,1);return new i0(w,x,_,r)}constructor(r,a=64,p=Float64Array,m){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=p,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const _=c1.indexOf(this.ArrayType),x=2*r*this.ArrayType.BYTES_PER_ELEMENT,w=r*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-w%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${p}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+w+T,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+x+w+T),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+w+T,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=r)}add(r,a){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=r,this.coords[this._pos++]=a,p}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return r0(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,a,p,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:x,nodeSize:w}=this,T=[0,_.length-1,0],I=[];for(;T.length;){const D=T.pop()||0,L=T.pop()||0,O=T.pop()||0;if(L-O<=w){for(let it=O;it<=L;it++){const ct=x[2*it],wt=x[2*it+1];ct>=r&&ct<=p&&wt>=a&&wt<=m&&I.push(_[it])}continue}const j=O+L>>1,q=x[2*j],J=x[2*j+1];q>=r&&q<=p&&J>=a&&J<=m&&I.push(_[j]),(D===0?r<=q:a<=J)&&(T.push(O),T.push(j-1),T.push(1-D)),(D===0?p>=q:m>=J)&&(T.push(j+1),T.push(L),T.push(1-D))}return I}within(r,a,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:_,nodeSize:x}=this,w=[0,m.length-1,0],T=[],I=p*p;for(;w.length;){const D=w.pop()||0,L=w.pop()||0,O=w.pop()||0;if(L-O<=x){for(let it=O;it<=L;it++)h1(_[2*it],_[2*it+1],r,a)<=I&&T.push(m[it]);continue}const j=O+L>>1,q=_[2*j],J=_[2*j+1];h1(q,J,r,a)<=I&&T.push(m[j]),(D===0?r-p<=q:a-p<=J)&&(w.push(O),w.push(j-1),w.push(1-D)),(D===0?r+p>=q:a+p>=J)&&(w.push(j+1),w.push(L),w.push(1-D))}return T}}function r0(o,r,a,p,m,_){if(m-p<=a)return;const x=p+m>>1;u1(o,r,x,p,m,_),r0(o,r,a,p,x-1,1-_),r0(o,r,a,x+1,m,1-_)}function u1(o,r,a,p,m,_){for(;m>p;){if(m-p>600){const I=m-p+1,D=a-p+1,L=Math.log(I),O=.5*Math.exp(2*L/3),j=.5*Math.sqrt(L*O*(I-O)/I)*(D-I/2<0?-1:1);u1(o,r,a,Math.max(p,Math.floor(a-D*O/I+j)),Math.min(m,Math.floor(a+(I-D)*O/I+j)),_)}const x=r[2*a+_];let w=p,T=m;for(vh(o,r,p,a),r[2*m+_]>x&&vh(o,r,p,m);w<T;){for(vh(o,r,w,T),w++,T--;r[2*w+_]<x;)w++;for(;r[2*T+_]>x;)T--}r[2*p+_]===x?vh(o,r,p,T):(T++,vh(o,r,T,m)),T<=a&&(p=T+1),a<=T&&(m=T-1)}}function vh(o,r,a,p){n0(o,a,p),n0(r,2*a,2*p),n0(r,2*a+1,2*p+1)}function n0(o,r,a){const p=o[r];o[r]=o[a],o[a]=p}function h1(o,r,a,p){const m=o-a,_=r-p;return m*m+_*_}var s0;d.be=void 0,(s0=d.be||(d.be={})).create="create",s0.load="load",s0.fullLoad="fullLoad";let Kp=null,xh=[];const o0=1e3/60,a0="loadTime",l0="fullLoadTime",O4={mark(o){performance.mark(o)},frame(o){const r=o;Kp!=null&&xh.push(r-Kp),Kp=r},clearMetrics(){Kp=null,xh=[],performance.clearMeasures(a0),performance.clearMeasures(l0);for(const o in d.be)performance.clearMarks(d.be[o])},getPerformanceMetrics(){performance.measure(a0,d.be.create,d.be.load),performance.measure(l0,d.be.create,d.be.fullLoad);const o=performance.getEntriesByName(a0)[0].duration,r=performance.getEntriesByName(l0)[0].duration,a=xh.length,p=1/(xh.reduce((_,x)=>_+x,0)/a/1e3),m=xh.filter(_=>_>o0).reduce((_,x)=>_+(x-o0)/o0,0);return{loadTime:o,fullLoadTime:r,fps:p,percentDroppedFrames:m/(a+m)*100,totalFrames:a}}};d.$=or,d.A=Mc,d.B=function(o){if(Ee==null){const r=o.navigator?o.navigator.userAgent:null;Ee=!!o.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return Ee},d.C=class{constructor(o,r){this.target=o,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new C4(()=>this.process()),this.subscription=function(a,p,m,_){return a.addEventListener(p,m,!1),{unsubscribe:()=>{a.removeEventListener(p,m,!1)}}}(this.target,"message",a=>this.receive(a)),this.globalScope=ve(self)?o:window}registerMessageHandler(o,r){this.messageHandlers[o]=r}sendAsync(o,r){return new Promise((a,p)=>{const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[m]={resolve:a,reject:p},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[m];const w={id:m,type:"<cancel>",origin:location.origin,targetMapId:o.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)},{once:!0});const _=[],x=Object.assign(Object.assign({},o),{id:m,sourceMapId:this.mapId,origin:location.origin,data:dl(o.data,_)});this.target.postMessage(x,{transfer:_})})}receive(o){const r=o.data,a=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!==location.origin||r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[a];const p=this.abortControllers[a];return delete this.abortControllers[a],void(p&&p.abort())}if(ve(self)||r.mustQueue)return this.tasks[a]=r,this.taskQueue.push(a),void this.invoker.trigger();this.processTask(a,r)}}process(){if(this.taskQueue.length===0)return;const o=this.taskQueue.shift(),r=this.tasks[o];delete this.tasks[o],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(o,r)}processTask(o,r){return c(this,void 0,void 0,function*(){if(r.type==="<response>"){const m=this.resolveRejects[o];return delete this.resolveRejects[o],m?void(r.error?m.reject(ps(r.error)):m.resolve(ps(r.data))):void 0}if(!this.messageHandlers[r.type])return void this.completeTask(o,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const a=ps(r.data),p=new AbortController;this.abortControllers[o]=p;try{const m=yield this.messageHandlers[r.type](r.sourceMapId,a,p);this.completeTask(o,null,m)}catch(m){this.completeTask(o,m)}})}completeTask(o,r,a){const p=[];delete this.abortControllers[o];const m={id:o,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?dl(r):null,data:dl(a,p)};this.target.postMessage(m,{transfer:p})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},d.D=pe,d.E=Hr,d.F=function(){var o=new Mc(16);return Mc!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},d.G=ni,d.H=function(o,r,a){var p,m,_,x,w,T,I,D,L,O,j,q,J=a[0],it=a[1],ct=a[2];return r===o?(o[12]=r[0]*J+r[4]*it+r[8]*ct+r[12],o[13]=r[1]*J+r[5]*it+r[9]*ct+r[13],o[14]=r[2]*J+r[6]*it+r[10]*ct+r[14],o[15]=r[3]*J+r[7]*it+r[11]*ct+r[15]):(m=r[1],_=r[2],x=r[3],w=r[4],T=r[5],I=r[6],D=r[7],L=r[8],O=r[9],j=r[10],q=r[11],o[0]=p=r[0],o[1]=m,o[2]=_,o[3]=x,o[4]=w,o[5]=T,o[6]=I,o[7]=D,o[8]=L,o[9]=O,o[10]=j,o[11]=q,o[12]=p*J+w*it+L*ct+r[12],o[13]=m*J+T*it+O*ct+r[13],o[14]=_*J+I*it+j*ct+r[14],o[15]=x*J+D*it+q*ct+r[15]),o},d.I=Ug,d.J=function(o,r,a){var p=a[0],m=a[1],_=a[2];return o[0]=r[0]*p,o[1]=r[1]*p,o[2]=r[2]*p,o[3]=r[3]*p,o[4]=r[4]*m,o[5]=r[5]*m,o[6]=r[6]*m,o[7]=r[7]*m,o[8]=r[8]*_,o[9]=r[9]*_,o[10]=r[10]*_,o[11]=r[11]*_,o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15],o},d.K=Zv,d.L=function(o,r){const a={};for(let p=0;p<r.length;p++){const m=r[p];m in o&&(a[m]=o[m])}return a},d.M=_a,d.N=$x,d.O=Nx,d.P=P,d.Q=Qn,d.R=Jn,d.S=H,d.T=ca,d.U=Y,d.V=re,d.W=Ji,d.X=z,d.Y=Zp,d.Z=class extends X{},d._=c,d.a=Qe,d.a$=function(o,r){return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15],o},d.a0=Qg,d.a1=Zt,d.a2=o=>{const r=window.document.createElement("video");return r.muted=!0,new Promise(a=>{r.onloadstart=()=>{a(r)};for(const p of o){const m=window.document.createElement("source");ti(p)||(r.crossOrigin="Anonymous"),m.src=p,r.appendChild(m)}})},d.a3=function(){return Mt++},d.a4=Re,d.a5=Ac,d.a6=Vu,d.a7=yl,d.a8=mi,d.a9=Gx,d.aA=function(o){if(o.type==="custom")return new M4(o);switch(o.type){case"background":return new S4(o);case"circle":return new u3(o);case"fill":return new C3(o);case"fill-extrusion":return new j3(o);case"heatmap":return new d3(o);case"hillshade":return new f3(o);case"line":return new K3(o);case"raster":return new T4(o);case"symbol":return new Hp(o)}},d.aB=Ot,d.aC=function(o,r){if(!o)return[{command:"setStyle",args:[r]}];let a=[];try{if(!Ke(o.version,r.version))return[{command:"setStyle",args:[r]}];Ke(o.center,r.center)||a.push({command:"setCenter",args:[r.center]}),Ke(o.zoom,r.zoom)||a.push({command:"setZoom",args:[r.zoom]}),Ke(o.bearing,r.bearing)||a.push({command:"setBearing",args:[r.bearing]}),Ke(o.pitch,r.pitch)||a.push({command:"setPitch",args:[r.pitch]}),Ke(o.sprite,r.sprite)||a.push({command:"setSprite",args:[r.sprite]}),Ke(o.glyphs,r.glyphs)||a.push({command:"setGlyphs",args:[r.glyphs]}),Ke(o.transition,r.transition)||a.push({command:"setTransition",args:[r.transition]}),Ke(o.light,r.light)||a.push({command:"setLight",args:[r.light]}),Ke(o.terrain,r.terrain)||a.push({command:"setTerrain",args:[r.terrain]}),Ke(o.sky,r.sky)||a.push({command:"setSky",args:[r.sky]});const p={},m=[];(function(x,w,T,I){let D;for(D in w=w||{},x=x||{})Object.prototype.hasOwnProperty.call(x,D)&&(Object.prototype.hasOwnProperty.call(w,D)||Ws(D,T,I));for(D in w)Object.prototype.hasOwnProperty.call(w,D)&&(Object.prototype.hasOwnProperty.call(x,D)?Ke(x[D],w[D])||(x[D].type==="geojson"&&w[D].type==="geojson"&&Ys(x,w,D)?li(T,{command:"setGeoJSONSourceData",args:[D,w[D].data]}):vo(D,w,T,I)):Vi(D,w,T))})(o.sources,r.sources,m,p);const _=[];o.layers&&o.layers.forEach(x=>{"source"in x&&p[x.source]?a.push({command:"removeLayer",args:[x.id]}):_.push(x)}),a=a.concat(m),function(x,w,T){w=w||[];const I=(x=x||[]).map(Ks),D=w.map(Ks),L=x.reduce(xo,{}),O=w.reduce(xo,{}),j=I.slice(),q=Object.create(null);let J,it,ct,wt,pt;for(let vt=0,zt=0;vt<I.length;vt++)J=I[vt],Object.prototype.hasOwnProperty.call(O,J)?zt++:(li(T,{command:"removeLayer",args:[J]}),j.splice(j.indexOf(J,zt),1));for(let vt=0,zt=0;vt<D.length;vt++)J=D[D.length-1-vt],j[j.length-1-vt]!==J&&(Object.prototype.hasOwnProperty.call(L,J)?(li(T,{command:"removeLayer",args:[J]}),j.splice(j.lastIndexOf(J,j.length-zt),1)):zt++,wt=j[j.length-vt],li(T,{command:"addLayer",args:[O[J],wt]}),j.splice(j.length-vt,0,J),q[J]=!0);for(let vt=0;vt<D.length;vt++)if(J=D[vt],it=L[J],ct=O[J],!q[J]&&!Ke(it,ct))if(Ke(it.source,ct.source)&&Ke(it["source-layer"],ct["source-layer"])&&Ke(it.type,ct.type)){for(pt in jn(it.layout,ct.layout,T,J,null,"setLayoutProperty"),jn(it.paint,ct.paint,T,J,null,"setPaintProperty"),Ke(it.filter,ct.filter)||li(T,{command:"setFilter",args:[J,ct.filter]}),Ke(it.minzoom,ct.minzoom)&&Ke(it.maxzoom,ct.maxzoom)||li(T,{command:"setLayerZoomRange",args:[J,ct.minzoom,ct.maxzoom]}),it)Object.prototype.hasOwnProperty.call(it,pt)&&pt!=="layout"&&pt!=="paint"&&pt!=="filter"&&pt!=="metadata"&&pt!=="minzoom"&&pt!=="maxzoom"&&(pt.indexOf("paint.")===0?jn(it[pt],ct[pt],T,J,pt.slice(6),"setPaintProperty"):Ke(it[pt],ct[pt])||li(T,{command:"setLayerProperty",args:[J,pt,ct[pt]]}));for(pt in ct)Object.prototype.hasOwnProperty.call(ct,pt)&&!Object.prototype.hasOwnProperty.call(it,pt)&&pt!=="layout"&&pt!=="paint"&&pt!=="filter"&&pt!=="metadata"&&pt!=="minzoom"&&pt!=="maxzoom"&&(pt.indexOf("paint.")===0?jn(it[pt],ct[pt],T,J,pt.slice(6),"setPaintProperty"):Ke(it[pt],ct[pt])||li(T,{command:"setLayerProperty",args:[J,pt,ct[pt]]}))}else li(T,{command:"removeLayer",args:[J]}),wt=j[j.lastIndexOf(J)+1],li(T,{command:"addLayer",args:[ct,wt]})}(_,r.layers,a)}catch(p){console.warn("Unable to compute style diff:",p),a=[{command:"setStyle",args:[r]}]}return a},d.aD=function(o){const r=[],a=o.id;return a===void 0&&r.push({message:`layers.${a}: missing required property "id"`}),o.render===void 0&&r.push({message:`layers.${a}: missing required method "render"`}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&r.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),r},d.aE=function o(r,a){if(Array.isArray(r)){if(!Array.isArray(a)||r.length!==a.length)return!1;for(let p=0;p<r.length;p++)if(!o(r[p],a[p]))return!1;return!0}if(typeof r=="object"&&r!==null&&a!==null){if(typeof a!="object"||Object.keys(r).length!==Object.keys(a).length)return!1;for(const p in r)if(!o(r[p],a[p]))return!1;return!0}return r===a},d.aF=$t,d.aG=Ft,d.aH=class extends fl{constructor(o,r){super(o,r),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},d.aI=Ip,d.aJ=class extends fl{constructor(o,r){super(o,r),this.current=i3}set(o){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let r=1;r<16;r++)if(o[r]!==this.current[r]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}},d.aK=Lv,d.aL=class extends fl{constructor(o,r){super(o,r),this.current=[0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2]))}},d.aM=class extends fl{constructor(o,r){super(o,r),this.current=[0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1]))}},d.aN=Rv,d.aO=function(o,r,a,p,m,_,x){var w=1/(r-a),T=1/(p-m),I=1/(_-x);return o[0]=-2*w,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*T,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*I,o[11]=0,o[12]=(r+a)*w,o[13]=(m+p)*T,o[14]=(x+_)*I,o[15]=1,o},d.aP=qe,d.aQ=c3,d.aR=class extends Dt{},d.aS=t4,d.aT=class extends ie{},d.aU=function(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))},d.aV=Kv,d.aW=Eo,d.aX=class extends Xt{},d.aY=mr,d.aZ=function(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]&&o[3]===r[3]&&o[4]===r[4]&&o[5]===r[5]&&o[6]===r[6]&&o[7]===r[7]&&o[8]===r[8]&&o[9]===r[9]&&o[10]===r[10]&&o[11]===r[11]&&o[12]===r[12]&&o[13]===r[13]&&o[14]===r[14]&&o[15]===r[15]},d.a_=function(o,r){var a=o[0],p=o[1],m=o[2],_=o[3],x=o[4],w=o[5],T=o[6],I=o[7],D=o[8],L=o[9],O=o[10],j=o[11],q=o[12],J=o[13],it=o[14],ct=o[15],wt=r[0],pt=r[1],vt=r[2],zt=r[3],Lt=r[4],ee=r[5],he=r[6],Jt=r[7],Yt=r[8],ae=r[9],me=r[10],Qt=r[11],Rt=r[12],ue=r[13],le=r[14],ze=r[15];return Math.abs(a-wt)<=an*Math.max(1,Math.abs(a),Math.abs(wt))&&Math.abs(p-pt)<=an*Math.max(1,Math.abs(p),Math.abs(pt))&&Math.abs(m-vt)<=an*Math.max(1,Math.abs(m),Math.abs(vt))&&Math.abs(_-zt)<=an*Math.max(1,Math.abs(_),Math.abs(zt))&&Math.abs(x-Lt)<=an*Math.max(1,Math.abs(x),Math.abs(Lt))&&Math.abs(w-ee)<=an*Math.max(1,Math.abs(w),Math.abs(ee))&&Math.abs(T-he)<=an*Math.max(1,Math.abs(T),Math.abs(he))&&Math.abs(I-Jt)<=an*Math.max(1,Math.abs(I),Math.abs(Jt))&&Math.abs(D-Yt)<=an*Math.max(1,Math.abs(D),Math.abs(Yt))&&Math.abs(L-ae)<=an*Math.max(1,Math.abs(L),Math.abs(ae))&&Math.abs(O-me)<=an*Math.max(1,Math.abs(O),Math.abs(me))&&Math.abs(j-Qt)<=an*Math.max(1,Math.abs(j),Math.abs(Qt))&&Math.abs(q-Rt)<=an*Math.max(1,Math.abs(q),Math.abs(Rt))&&Math.abs(J-ue)<=an*Math.max(1,Math.abs(J),Math.abs(ue))&&Math.abs(it-le)<=an*Math.max(1,Math.abs(it),Math.abs(le))&&Math.abs(ct-ze)<=an*Math.max(1,Math.abs(ct),Math.abs(ze))},d.aa=function(o){const r={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,p,m,_)=>{const x=m||_;return r[p]=!x||x.toLowerCase(),""}),r["max-age"]){const a=parseInt(r["max-age"],10);isNaN(a)?delete r["max-age"]:r["max-age"]=a}return r},d.ab=function(o,r){const a=[];for(const p in o)p in r||a.push(p);return a},d.ac=mt,d.ad=function(o,r,a){var p=Math.sin(a),m=Math.cos(a),_=r[0],x=r[1],w=r[2],T=r[3],I=r[4],D=r[5],L=r[6],O=r[7];return r!==o&&(o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[0]=_*m+I*p,o[1]=x*m+D*p,o[2]=w*m+L*p,o[3]=T*m+O*p,o[4]=I*m-_*p,o[5]=D*m-x*p,o[6]=L*m-w*p,o[7]=O*m-T*p,o},d.ae=function(o){var r=new Mc(16);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=o[3],r[4]=o[4],r[5]=o[5],r[6]=o[6],r[7]=o[7],r[8]=o[8],r[9]=o[9],r[10]=o[10],r[11]=o[11],r[12]=o[12],r[13]=o[13],r[14]=o[14],r[15]=o[15],r},d.af=Lp,d.ag=function(o,r){let a=0,p=0;if(o.kind==="constant")p=o.layoutSize;else if(o.kind!=="source"){const{interpolationType:m,minZoom:_,maxZoom:x}=o,w=m?mt(yn.interpolationFactor(m,r,_,x),0,1):0;o.kind==="camera"?p=Wr.number(o.minSize,o.maxSize,w):a=w}return{uSizeT:a,uSize:p}},d.ai=function(o,{uSize:r,uSizeT:a},{lowerSize:p,upperSize:m}){return o.kind==="source"?p/lo:o.kind==="composite"?Wr.number(p/lo,m/lo,a):r},d.aj=Gg,d.ak=function(o,r,a,p){const m=r.y-o.y,_=r.x-o.x,x=p.y-a.y,w=p.x-a.x,T=x*_-w*m;if(T===0)return null;const I=(w*(o.y-a.y)-x*(o.x-a.x))/T;return new P(o.x+I*_,o.y+I*m)},d.al=Xx,d.am=Vv,d.an=Cg,d.ao=function(o){let r=1/0,a=1/0,p=-1/0,m=-1/0;for(const _ of o)r=Math.min(r,_.x),a=Math.min(a,_.y),p=Math.max(p,_.x),m=Math.max(m,_.y);return[r,a,p,m]},d.ap=ar,d.ar=qg,d.as=function(o,r){var a=r[0],p=r[1],m=r[2],_=r[3],x=r[4],w=r[5],T=r[6],I=r[7],D=r[8],L=r[9],O=r[10],j=r[11],q=r[12],J=r[13],it=r[14],ct=r[15],wt=a*w-p*x,pt=a*T-m*x,vt=a*I-_*x,zt=p*T-m*w,Lt=p*I-_*w,ee=m*I-_*T,he=D*J-L*q,Jt=D*it-O*q,Yt=D*ct-j*q,ae=L*it-O*J,me=L*ct-j*J,Qt=O*ct-j*it,Rt=wt*Qt-pt*me+vt*ae+zt*Yt-Lt*Jt+ee*he;return Rt?(o[0]=(w*Qt-T*me+I*ae)*(Rt=1/Rt),o[1]=(m*me-p*Qt-_*ae)*Rt,o[2]=(J*ee-it*Lt+ct*zt)*Rt,o[3]=(O*Lt-L*ee-j*zt)*Rt,o[4]=(T*Yt-x*Qt-I*Jt)*Rt,o[5]=(a*Qt-m*Yt+_*Jt)*Rt,o[6]=(it*vt-q*ee-ct*pt)*Rt,o[7]=(D*ee-O*vt+j*pt)*Rt,o[8]=(x*me-w*Yt+I*he)*Rt,o[9]=(p*Yt-a*me-_*he)*Rt,o[10]=(q*Lt-J*vt+ct*wt)*Rt,o[11]=(L*vt-D*Lt-j*wt)*Rt,o[12]=(w*Jt-x*ae-T*he)*Rt,o[13]=(a*ae-p*Jt+m*he)*Rt,o[14]=(J*pt-q*zt-it*wt)*Rt,o[15]=(D*zt-L*pt+O*wt)*Rt,o):null},d.at=e0,d.au=Zg,d.av=i0,d.aw=function(){const o={},r=Et.$version;for(const a in Et.$root){const p=Et.$root[a];if(p.required){let m=null;m=a==="version"?r:p.type==="array"?[]:{},m!=null&&(o[a]=m)}}return o},d.ax=wp,d.ay=Mi,d.az=function(o){o=o.slice();const r=Object.create(null);for(let a=0;a<o.length;a++)r[o[a].id]=o[a];for(let a=0;a<o.length;a++)"ref"in o[a]&&(o[a]=nn(o[a],r[o[a].ref]));return o},d.b=$e,d.b0=function(o,r,a){return o[0]=r[0]*a[0],o[1]=r[1]*a[1],o[2]=r[2]*a[2],o[3]=r[3]*a[3],o},d.b1=function(o,r){return o[0]*r[0]+o[1]*r[1]+o[2]*r[2]+o[3]*r[3]},d.b2=xt,d.b3=Hx,d.b4=jx,d.b5=function(o,r,a,p,m){var _,x=1/Math.tan(r/2);return o[0]=x/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=x,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,m!=null&&m!==1/0?(o[10]=(m+p)*(_=1/(p-m)),o[14]=2*m*p*_):(o[10]=-1,o[14]=-2*p),o},d.b6=function(o,r,a){var p=Math.sin(a),m=Math.cos(a),_=r[4],x=r[5],w=r[6],T=r[7],I=r[8],D=r[9],L=r[10],O=r[11];return r!==o&&(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[4]=_*m+I*p,o[5]=x*m+D*p,o[6]=w*m+L*p,o[7]=T*m+O*p,o[8]=I*m-_*p,o[9]=D*m-x*p,o[10]=L*m-w*p,o[11]=O*m-T*p,o},d.b7=K,d.b8=at,d.b9=function(o){return o*Math.PI/180},d.bA=cc,d.bB=so,d.ba=function(o,r){return o[0]=r[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=r[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=r[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},d.bb=class extends Z{},d.bc=Xg,d.bd=O4,d.bf=Ue,d.bg=function(o,r){Qe.REGISTERED_PROTOCOLS[o]=r},d.bh=function(o){delete Qe.REGISTERED_PROTOCOLS[o]},d.bi=function(o,r){const a={};for(let m=0;m<o.length;m++){const _=r&&r[o[m].id]||_g(o[m]);r&&(r[o[m].id]=_);let x=a[_];x||(x=a[_]=[]),x.push(o[m])}const p=[];for(const m in a)p.push(a[m]);return p},d.bj=oe,d.bk=qx,d.bl=Wx,d.bm=Tx,d.bn=function(o){o.bucket.createArrays(),o.bucket.tilePixelRatio=Ji/(512*o.bucket.overscaling),o.bucket.compareText={},o.bucket.iconsNeedLinear=!1;const r=o.bucket.layers[0],a=r.layout,p=r._unevaluatedLayout._values,m={layoutIconSize:p["icon-size"].possiblyEvaluate(new mi(o.bucket.zoom+1),o.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new mi(o.bucket.zoom+1),o.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new mi(18))};if(o.bucket.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:D}=o.bucket.textSizeData;m.compositeTextSizes=[p["text-size"].possiblyEvaluate(new mi(I),o.canonical),p["text-size"].possiblyEvaluate(new mi(D),o.canonical)]}if(o.bucket.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:D}=o.bucket.iconSizeData;m.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new mi(I),o.canonical),p["icon-size"].possiblyEvaluate(new mi(D),o.canonical)]}const _=a.get("text-line-height")*ar,x=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",w=a.get("text-keep-upright"),T=a.get("text-size");for(const I of o.bucket.features){const D=a.get("text-font").evaluate(I,{},o.canonical).join(","),L=T.evaluate(I,{},o.canonical),O=m.layoutTextSize.evaluate(I,{},o.canonical),j=m.layoutIconSize.evaluate(I,{},o.canonical),q={horizontal:{},vertical:void 0},J=I.text;let it,ct=[0,0];if(J){const vt=J.toString(),zt=a.get("text-letter-spacing").evaluate(I,{},o.canonical)*ar,Lt=xg(vt)?zt:0,ee=a.get("text-anchor").evaluate(I,{},o.canonical),he=o1(r,I,o.canonical);if(!he){const Qt=a.get("text-radial-offset").evaluate(I,{},o.canonical);ct=Qt?s1(ee,[Qt*ar,t0]):a.get("text-offset").evaluate(I,{},o.canonical).map(Rt=>Rt*ar)}let Jt=x?"center":a.get("text-justify").evaluate(I,{},o.canonical);const Yt=a.get("symbol-placement"),ae=Yt==="point"?a.get("text-max-width").evaluate(I,{},o.canonical)*ar:0,me=()=>{o.bucket.allowVerticalPlacement&&Ku(vt)&&(q.vertical=Np(J,o.glyphMap,o.glyphPositions,o.imagePositions,D,ae,_,ee,"left",Lt,ct,d.ah.vertical,!0,Yt,O,L))};if(!x&&he){const Qt=new Set;if(Jt==="auto")for(let ue=0;ue<he.values.length;ue+=2)Qt.add(e0(he.values[ue]));else Qt.add(Jt);let Rt=!1;for(const ue of Qt)if(!q.horizontal[ue])if(Rt)q.horizontal[ue]=q.horizontal[0];else{const le=Np(J,o.glyphMap,o.glyphPositions,o.imagePositions,D,ae,_,"center",ue,Lt,ct,d.ah.horizontal,!1,Yt,O,L);le&&(q.horizontal[ue]=le,Rt=le.positionedLines.length===1)}me()}else{Jt==="auto"&&(Jt=e0(ee));const Qt=Np(J,o.glyphMap,o.glyphPositions,o.imagePositions,D,ae,_,ee,Jt,Lt,ct,d.ah.horizontal,!1,Yt,O,L);Qt&&(q.horizontal[Jt]=Qt),me(),Ku(vt)&&x&&w&&(q.vertical=Np(J,o.glyphMap,o.glyphPositions,o.imagePositions,D,ae,_,ee,Jt,Lt,ct,d.ah.vertical,!1,Yt,O,L))}}let wt=!1;if(I.icon&&I.icon.name){const vt=o.imageMap[I.icon.name];vt&&(it=_4(o.imagePositions[I.icon.name],a.get("icon-offset").evaluate(I,{},o.canonical),a.get("icon-anchor").evaluate(I,{},o.canonical)),wt=!!vt.sdf,o.bucket.sdfIcons===void 0?o.bucket.sdfIcons=wt:o.bucket.sdfIcons!==wt&&_e("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(vt.pixelRatio!==o.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(o.bucket.iconsNeedLinear=!0))}const pt=l1(q.horizontal)||q.vertical;o.bucket.iconsInText=!!pt&&pt.iconsInText,(pt||it)&&R4(o.bucket,I,q,it,o.imageMap,m,O,j,ct,wt,o.canonical)}o.showCollisionBoxes&&o.bucket.generateCollisionDebugBuffers()},d.bo=Vg,d.bp=Fg,d.bq=Bg,d.br=ma,d.bs=Ng,d.bt=class{constructor(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let o=performance.getEntriesByName(this._marks.measure);return o.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),o=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),o}},d.bu=function(o,r,a,p,m){return c(this,void 0,void 0,function*(){if(Y())try{return yield re(o,r,a,p,m)}catch{}return function(_,x,w,T,I){const D=_.width,L=_.height;Kt&&we||(Kt=new OffscreenCanvas(D,L),we=Kt.getContext("2d",{willReadFrequently:!0})),Kt.width=D,Kt.height=L,we.drawImage(_,0,0,D,L);const O=we.getImageData(x,w,T,I);return we.clearRect(0,0,D,L),O.data}(o,r,a,p,m)})},d.bv=Zx,d.bw=b,d.bx=S,d.by=gx,d.bz=function(o){return o.message===Se},d.c=ai,d.d=o=>c(void 0,void 0,void 0,function*(){if(o.byteLength===0)return createImageBitmap(new ImageData(1,1));const r=new Blob([new Uint8Array(o)],{type:"image/png"});try{return createImageBitmap(r)}catch(a){throw new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),d.e=Tt,d.f=o=>new Promise((r,a)=>{const p=new Image;p.onload=()=>{r(p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame(()=>{p.src=Vt})},p.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const m=new Blob([new Uint8Array(o)],{type:"image/png"});p.src=o.byteLength?URL.createObjectURL(m):Vt}),d.g=fi,d.h=(o,r)=>Ze(Tt(o,{type:"json"}),r),d.i=ve,d.j=ci,d.k=vr,d.l=(o,r)=>Ze(Tt(o,{type:"arrayBuffer"}),r),d.m=Ze,d.n=function(o){return new Ng(o).readFields(d4,[])},d.o=lh,d.p=kx,d.q=f,d.r=vg,d.s=ti,d.t=Yu,d.u=te,d.v=Et,d.w=_e,d.x=ul,d.y=function([o,r,a]){return r+=90,r*=Math.PI/180,a*=Math.PI/180,{x:o*Math.cos(r)*Math.sin(a),y:o*Math.sin(r)*Math.sin(a),z:o*Math.cos(a)}},d.z=Wr}),l("worker",["./shared"],function(d){class c{constructor(B){this.keyCache={},B&&this.replace(B)}replace(B){this._layerConfigs={},this._layers={},this.update(B,[])}update(B,N){for(const st of B){this._layerConfigs[st.id]=st;const dt=this._layers[st.id]=d.aA(st);dt._featureFilter=d.a6(dt.filter),this.keyCache[st.id]&&delete this.keyCache[st.id]}for(const st of N)delete this.keyCache[st],delete this._layerConfigs[st],delete this._layers[st];this.familiesBySource={};const G=d.bi(Object.values(this._layerConfigs),this.keyCache);for(const st of G){const dt=st.map(At=>this._layers[At.id]),yt=dt[0];if(yt.visibility==="none")continue;const bt=yt.source||"";let ht=this.familiesBySource[bt];ht||(ht=this.familiesBySource[bt]={});const St=yt.sourceLayer||"_geojsonTileLayer";let Bt=ht[St];Bt||(Bt=ht[St]=[]),Bt.push(dt)}}}class b{constructor(B){const N={},G=[];for(const bt in B){const ht=B[bt],St=N[bt]={};for(const Bt in ht){const At=ht[+Bt];if(!At||At.bitmap.width===0||At.bitmap.height===0)continue;const It={x:0,y:0,w:At.bitmap.width+2,h:At.bitmap.height+2};G.push(It),St[Bt]={rect:It,metrics:At.metrics}}}const{w:st,h:dt}=d.p(G),yt=new d.o({width:st||1,height:dt||1});for(const bt in B){const ht=B[bt];for(const St in ht){const Bt=ht[+St];if(!Bt||Bt.bitmap.width===0||Bt.bitmap.height===0)continue;const At=N[bt][St].rect;d.o.copy(Bt.bitmap,yt,{x:0,y:0},{x:At.x+1,y:At.y+1},Bt.bitmap)}}this.image=yt,this.positions=N}}d.bj("GlyphAtlas",b);class S{constructor(B){this.tileID=new d.Q(B.tileID.overscaledZ,B.tileID.wrap,B.tileID.canonical.z,B.tileID.canonical.x,B.tileID.canonical.y),this.uid=B.uid,this.zoom=B.zoom,this.pixelRatio=B.pixelRatio,this.tileSize=B.tileSize,this.source=B.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=B.showCollisionBoxes,this.collectResourceTiming=!!B.collectResourceTiming,this.returnDependencies=!!B.returnDependencies,this.promoteId=B.promoteId,this.inFlightDependencies=[]}parse(B,N,G,st){return d._(this,void 0,void 0,function*(){this.status="parsing",this.data=B,this.collisionBoxArray=new d.a4;const dt=new d.bk(Object.keys(B.layers).sort()),yt=new d.bl(this.tileID,this.promoteId);yt.bucketLayerIDs=[];const bt={},ht={featureIndex:yt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:G},St=N.familiesBySource[this.source];for(const Ie in St){const ii=B.layers[Ie];if(!ii)continue;ii.version===1&&d.w(`Vector tile source "${this.source}" layer "${Ie}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const bi=dt.encode(Ie),Xi=[];for(let pr=0;pr<ii.length;pr++){const zi=ii.feature(pr),Xs=yt.getId(zi,Ie);Xi.push({feature:zi,id:Xs,index:pr,sourceLayerIndex:bi})}for(const pr of St[Ie]){const zi=pr[0];zi.source!==this.source&&d.w(`layer.source = ${zi.source} does not equal this.source = ${this.source}`),zi.minzoom&&this.zoom<Math.floor(zi.minzoom)||zi.maxzoom&&this.zoom>=zi.maxzoom||zi.visibility!=="none"&&(C(pr,this.zoom,G),(bt[zi.id]=zi.createBucket({index:yt.bucketLayerIDs.length,layers:pr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:bi,sourceID:this.source})).populate(Xi,ht,this.tileID.canonical),yt.bucketLayerIDs.push(pr.map(Xs=>Xs.id)))}}const Bt=d.aF(ht.glyphDependencies,Ie=>Object.keys(Ie).map(Number));this.inFlightDependencies.forEach(Ie=>Ie==null?void 0:Ie.abort()),this.inFlightDependencies=[];let At=Promise.resolve({});if(Object.keys(Bt).length){const Ie=new AbortController;this.inFlightDependencies.push(Ie),At=st.sendAsync({type:"GG",data:{stacks:Bt,source:this.source,tileID:this.tileID,type:"glyphs"}},Ie)}const It=Object.keys(ht.iconDependencies);let de=Promise.resolve({});if(It.length){const Ie=new AbortController;this.inFlightDependencies.push(Ie),de=st.sendAsync({type:"GI",data:{icons:It,source:this.source,tileID:this.tileID,type:"icons"}},Ie)}const fe=Object.keys(ht.patternDependencies);let Fe=Promise.resolve({});if(fe.length){const Ie=new AbortController;this.inFlightDependencies.push(Ie),Fe=st.sendAsync({type:"GI",data:{icons:fe,source:this.source,tileID:this.tileID,type:"patterns"}},Ie)}const[ke,Ne,ei]=yield Promise.all([At,de,Fe]),ui=new b(ke),Ai=new d.bm(Ne,ei);for(const Ie in bt){const ii=bt[Ie];ii instanceof d.a5?(C(ii.layers,this.zoom,G),d.bn({bucket:ii,glyphMap:ke,glyphPositions:ui.positions,imageMap:Ne,imagePositions:Ai.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):ii.hasPattern&&(ii instanceof d.bo||ii instanceof d.bp||ii instanceof d.bq)&&(C(ii.layers,this.zoom,G),ii.addFeatures(ht,this.tileID.canonical,Ai.patternPositions))}return this.status="done",{buckets:Object.values(bt).filter(Ie=>!Ie.isEmpty()),featureIndex:yt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ui.image,imageAtlas:Ai,glyphMap:this.returnDependencies?ke:null,iconMap:this.returnDependencies?Ne:null,glyphPositions:this.returnDependencies?ui.positions:null}})}}function C(rt,B,N){const G=new d.a8(B);for(const st of rt)st.recalculate(G,N)}class P{constructor(B,N,G){this.actor=B,this.layerIndex=N,this.availableImages=G,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(B,N){return d._(this,void 0,void 0,function*(){const G=yield d.l(B.request,N);try{return{vectorTile:new d.br.VectorTile(new d.bs(G.data)),rawData:G.data,cacheControl:G.cacheControl,expires:G.expires}}catch(st){const dt=new Uint8Array(G.data);let yt=`Unable to parse the tile at ${B.request.url}, `;throw yt+=dt[0]===31&&dt[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${st.messge}`,new Error(yt)}})}loadTile(B){return d._(this,void 0,void 0,function*(){const N=B.uid,G=!!(B&&B.request&&B.request.collectResourceTiming)&&new d.bt(B.request),st=new S(B);this.loading[N]=st;const dt=new AbortController;st.abort=dt;try{const yt=yield this.loadVectorTile(B,dt);if(delete this.loading[N],!yt)return null;const bt=yt.rawData,ht={};yt.expires&&(ht.expires=yt.expires),yt.cacheControl&&(ht.cacheControl=yt.cacheControl);const St={};if(G){const At=G.finish();At&&(St.resourceTiming=JSON.parse(JSON.stringify(At)))}st.vectorTile=yt.vectorTile;const Bt=st.parse(yt.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[N]=st,this.fetching[N]={rawTileData:bt,cacheControl:ht,resourceTiming:St};try{const At=yield Bt;return d.e({rawTileData:bt.slice(0)},At,ht,St)}finally{delete this.fetching[N]}}catch(yt){throw delete this.loading[N],st.status="done",this.loaded[N]=st,yt}})}reloadTile(B){return d._(this,void 0,void 0,function*(){const N=B.uid;if(!this.loaded||!this.loaded[N])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const G=this.loaded[N];if(G.showCollisionBoxes=B.showCollisionBoxes,G.status==="parsing"){const st=yield G.parse(G.vectorTile,this.layerIndex,this.availableImages,this.actor);let dt;if(this.fetching[N]){const{rawTileData:yt,cacheControl:bt,resourceTiming:ht}=this.fetching[N];delete this.fetching[N],dt=d.e({rawTileData:yt.slice(0)},st,bt,ht)}else dt=st;return dt}if(G.status==="done"&&G.vectorTile)return G.parse(G.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(B){return d._(this,void 0,void 0,function*(){const N=this.loading,G=B.uid;N&&N[G]&&N[G].abort&&(N[G].abort.abort(),delete N[G])})}removeTile(B){return d._(this,void 0,void 0,function*(){this.loaded&&this.loaded[B.uid]&&delete this.loaded[B.uid]})}}class A{constructor(){this.loaded={}}loadTile(B){return d._(this,void 0,void 0,function*(){const{uid:N,encoding:G,rawImageData:st,redFactor:dt,greenFactor:yt,blueFactor:bt,baseShift:ht}=B,St=st.width+2,Bt=st.height+2,At=d.b(st)?new d.R({width:St,height:Bt},yield d.bu(st,-1,-1,St,Bt)):st,It=new d.bv(N,At,G,dt,yt,bt,ht);return this.loaded=this.loaded||{},this.loaded[N]=It,It})}removeTile(B){const N=this.loaded,G=B.uid;N&&N[G]&&delete N[G]}}function V(rt,B){if(rt.length!==0){W(rt[0],B);for(var N=1;N<rt.length;N++)W(rt[N],!B)}}function W(rt,B){for(var N=0,G=0,st=0,dt=rt.length,yt=dt-1;st<dt;yt=st++){var bt=(rt[st][0]-rt[yt][0])*(rt[yt][1]+rt[st][1]),ht=N+bt;G+=Math.abs(N)>=Math.abs(bt)?N-ht+bt:bt-ht+N,N=ht}N+G>=0!=!!B&&rt.reverse()}var $=d.bw(function rt(B,N){var G,st=B&&B.type;if(st==="FeatureCollection")for(G=0;G<B.features.length;G++)rt(B.features[G],N);else if(st==="GeometryCollection")for(G=0;G<B.geometries.length;G++)rt(B.geometries[G],N);else if(st==="Feature")rt(B.geometry,N);else if(st==="Polygon")V(B.coordinates,N);else if(st==="MultiPolygon")for(G=0;G<B.coordinates.length;G++)V(B.coordinates[G],N);return B});const nt=d.br.VectorTileFeature.prototype.toGeoJSON;var H={exports:{}},Y=d.bx,K=d.br.VectorTileFeature,at=mt;function mt(rt,B){this.options=B||{},this.features=rt,this.length=rt.length}function xt(rt,B){this.id=typeof rt.id=="number"?rt.id:void 0,this.type=rt.type,this.rawGeometry=rt.type===1?[rt.geometry]:rt.geometry,this.properties=rt.tags,this.extent=B||4096}mt.prototype.feature=function(rt){return new xt(this.features[rt],this.options.extent)},xt.prototype.loadGeometry=function(){var rt=this.rawGeometry;this.geometry=[];for(var B=0;B<rt.length;B++){for(var N=rt[B],G=[],st=0;st<N.length;st++)G.push(new Y(N[st][0],N[st][1]));this.geometry.push(G)}return this.geometry},xt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var rt=this.geometry,B=1/0,N=-1/0,G=1/0,st=-1/0,dt=0;dt<rt.length;dt++)for(var yt=rt[dt],bt=0;bt<yt.length;bt++){var ht=yt[bt];B=Math.min(B,ht.x),N=Math.max(N,ht.x),G=Math.min(G,ht.y),st=Math.max(st,ht.y)}return[B,G,N,st]},xt.prototype.toGeoJSON=K.prototype.toGeoJSON;var Tt=d.by,Mt=at;function $t(rt){var B=new Tt;return function(N,G){for(var st in N.layers)G.writeMessage(3,Ft,N.layers[st])}(rt,B),B.finish()}function Ft(rt,B){var N;B.writeVarintField(15,rt.version||1),B.writeStringField(1,rt.name||""),B.writeVarintField(5,rt.extent||4096);var G={keys:[],values:[],keycache:{},valuecache:{}};for(N=0;N<rt.length;N++)G.feature=rt.feature(N),B.writeMessage(2,Ot,G);var st=G.keys;for(N=0;N<st.length;N++)B.writeStringField(3,st[N]);var dt=G.values;for(N=0;N<dt.length;N++)B.writeMessage(4,Ee,dt[N])}function Ot(rt,B){var N=rt.feature;N.id!==void 0&&B.writeVarintField(1,N.id),B.writeMessage(2,ge,rt),B.writeVarintField(3,N.type),B.writeMessage(4,ve,N)}function ge(rt,B){var N=rt.feature,G=rt.keys,st=rt.values,dt=rt.keycache,yt=rt.valuecache;for(var bt in N.properties){var ht=N.properties[bt],St=dt[bt];if(ht!==null){St===void 0&&(G.push(bt),dt[bt]=St=G.length-1),B.writeVarint(St);var Bt=typeof ht;Bt!=="string"&&Bt!=="boolean"&&Bt!=="number"&&(ht=JSON.stringify(ht));var At=Bt+":"+ht,It=yt[At];It===void 0&&(st.push(ht),yt[At]=It=st.length-1),B.writeVarint(It)}}}function _e(rt,B){return(B<<3)+(7&rt)}function Ae(rt){return rt<<1^rt>>31}function ve(rt,B){for(var N=rt.loadGeometry(),G=rt.type,st=0,dt=0,yt=N.length,bt=0;bt<yt;bt++){var ht=N[bt],St=1;G===1&&(St=ht.length),B.writeVarint(_e(1,St));for(var Bt=G===3?ht.length-1:ht.length,At=0;At<Bt;At++){At===1&&G!==1&&B.writeVarint(_e(2,Bt-1));var It=ht[At].x-st,de=ht[At].y-dt;B.writeVarint(Ae(It)),B.writeVarint(Ae(de)),st+=It,dt+=de}G===3&&B.writeVarint(_e(7,1))}}function Ee(rt,B){var N=typeof rt;N==="string"?B.writeStringField(1,rt):N==="boolean"?B.writeBooleanField(7,rt):N==="number"&&(rt%1!=0?B.writeDoubleField(3,rt):rt<0?B.writeSVarintField(6,rt):B.writeVarintField(5,rt))}H.exports=$t,H.exports.fromVectorTileJs=$t,H.exports.fromGeojsonVt=function(rt,B){B=B||{};var N={};for(var G in rt)N[G]=new Mt(rt[G].features,B),N[G].name=G,N[G].version=B.version,N[G].extent=B.extent;return $t({layers:N})},H.exports.GeoJSONWrapper=Mt;var $e=d.bw(H.exports);const Vt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:rt=>rt},re=Math.fround||(Kt=new Float32Array(1),rt=>(Kt[0]=+rt,Kt[0]));var Kt;const we=3,Se=5,ai=6;class Qe{constructor(B){this.options=Object.assign(Object.create(Vt),B),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(B){const{log:N,minZoom:G,maxZoom:st}=this.options;N&&console.time("total time");const dt=`prepare ${B.length} points`;N&&console.time(dt),this.points=B;const yt=[];for(let ht=0;ht<B.length;ht++){const St=B[ht];if(!St.geometry)continue;const[Bt,At]=St.geometry.coordinates,It=re(Ue(Bt)),de=re(Mi(At));yt.push(It,de,1/0,ht,-1,1),this.options.reduce&&yt.push(0)}let bt=this.trees[st+1]=this._createTree(yt);N&&console.timeEnd(dt);for(let ht=st;ht>=G;ht--){const St=+Date.now();bt=this.trees[ht]=this._createTree(this._cluster(bt,ht)),N&&console.log("z%d: %d clusters in %dms",ht,bt.numItems,+Date.now()-St)}return N&&console.timeEnd("total time"),this}getClusters(B,N){let G=((B[0]+180)%360+360)%360-180;const st=Math.max(-90,Math.min(90,B[1]));let dt=B[2]===180?180:((B[2]+180)%360+360)%360-180;const yt=Math.max(-90,Math.min(90,B[3]));if(B[2]-B[0]>=360)G=-180,dt=180;else if(G>dt){const At=this.getClusters([G,st,180,yt],N),It=this.getClusters([-180,st,dt,yt],N);return At.concat(It)}const bt=this.trees[this._limitZoom(N)],ht=bt.range(Ue(G),Mi(yt),Ue(dt),Mi(st)),St=bt.data,Bt=[];for(const At of ht){const It=this.stride*At;Bt.push(St[It+Se]>1?fi(St,It,this.clusterProps):this.points[St[It+we]])}return Bt}getChildren(B){const N=this._getOriginId(B),G=this._getOriginZoom(B),st="No cluster with the specified id.",dt=this.trees[G];if(!dt)throw new Error(st);const yt=dt.data;if(N*this.stride>=yt.length)throw new Error(st);const bt=this.options.radius/(this.options.extent*Math.pow(2,G-1)),ht=dt.within(yt[N*this.stride],yt[N*this.stride+1],bt),St=[];for(const Bt of ht){const At=Bt*this.stride;yt[At+4]===B&&St.push(yt[At+Se]>1?fi(yt,At,this.clusterProps):this.points[yt[At+we]])}if(St.length===0)throw new Error(st);return St}getLeaves(B,N,G){const st=[];return this._appendLeaves(st,B,N=N||10,G=G||0,0),st}getTile(B,N,G){const st=this.trees[this._limitZoom(B)],dt=Math.pow(2,B),{extent:yt,radius:bt}=this.options,ht=bt/yt,St=(G-ht)/dt,Bt=(G+1+ht)/dt,At={features:[]};return this._addTileFeatures(st.range((N-ht)/dt,St,(N+1+ht)/dt,Bt),st.data,N,G,dt,At),N===0&&this._addTileFeatures(st.range(1-ht/dt,St,1,Bt),st.data,dt,G,dt,At),N===dt-1&&this._addTileFeatures(st.range(0,St,ht/dt,Bt),st.data,-1,G,dt,At),At.features.length?At:null}getClusterExpansionZoom(B){let N=this._getOriginZoom(B)-1;for(;N<=this.options.maxZoom;){const G=this.getChildren(B);if(N++,G.length!==1)break;B=G[0].properties.cluster_id}return N}_appendLeaves(B,N,G,st,dt){const yt=this.getChildren(N);for(const bt of yt){const ht=bt.properties;if(ht&&ht.cluster?dt+ht.point_count<=st?dt+=ht.point_count:dt=this._appendLeaves(B,ht.cluster_id,G,st,dt):dt<st?dt++:B.push(bt),B.length===G)break}return dt}_createTree(B){const N=new d.av(B.length/this.stride|0,this.options.nodeSize,Float32Array);for(let G=0;G<B.length;G+=this.stride)N.add(B[G],B[G+1]);return N.finish(),N.data=B,N}_addTileFeatures(B,N,G,st,dt,yt){for(const bt of B){const ht=bt*this.stride,St=N[ht+Se]>1;let Bt,At,It;if(St)Bt=ni(N,ht,this.clusterProps),At=N[ht],It=N[ht+1];else{const Fe=this.points[N[ht+we]];Bt=Fe.properties;const[ke,Ne]=Fe.geometry.coordinates;At=Ue(ke),It=Mi(Ne)}const de={type:1,geometry:[[Math.round(this.options.extent*(At*dt-G)),Math.round(this.options.extent*(It*dt-st))]],tags:Bt};let fe;fe=St||this.options.generateId?N[ht+we]:this.points[N[ht+we]].id,fe!==void 0&&(de.id=fe),yt.features.push(de)}}_limitZoom(B){return Math.max(this.options.minZoom,Math.min(Math.floor(+B),this.options.maxZoom+1))}_cluster(B,N){const{radius:G,extent:st,reduce:dt,minPoints:yt}=this.options,bt=G/(st*Math.pow(2,N)),ht=B.data,St=[],Bt=this.stride;for(let At=0;At<ht.length;At+=Bt){if(ht[At+2]<=N)continue;ht[At+2]=N;const It=ht[At],de=ht[At+1],fe=B.within(ht[At],ht[At+1],bt),Fe=ht[At+Se];let ke=Fe;for(const Ne of fe){const ei=Ne*Bt;ht[ei+2]>N&&(ke+=ht[ei+Se])}if(ke>Fe&&ke>=yt){let Ne,ei=It*Fe,ui=de*Fe,Ai=-1;const Ie=((At/Bt|0)<<5)+(N+1)+this.points.length;for(const ii of fe){const bi=ii*Bt;if(ht[bi+2]<=N)continue;ht[bi+2]=N;const Xi=ht[bi+Se];ei+=ht[bi]*Xi,ui+=ht[bi+1]*Xi,ht[bi+4]=Ie,dt&&(Ne||(Ne=this._map(ht,At,!0),Ai=this.clusterProps.length,this.clusterProps.push(Ne)),dt(Ne,this._map(ht,bi)))}ht[At+4]=Ie,St.push(ei/ke,ui/ke,1/0,Ie,-1,ke),dt&&St.push(Ai)}else{for(let Ne=0;Ne<Bt;Ne++)St.push(ht[At+Ne]);if(ke>1)for(const Ne of fe){const ei=Ne*Bt;if(!(ht[ei+2]<=N)){ht[ei+2]=N;for(let ui=0;ui<Bt;ui++)St.push(ht[ei+ui])}}}}return St}_getOriginId(B){return B-this.points.length>>5}_getOriginZoom(B){return(B-this.points.length)%32}_map(B,N,G){if(B[N+Se]>1){const yt=this.clusterProps[B[N+ai]];return G?Object.assign({},yt):yt}const st=this.points[B[N+we]].properties,dt=this.options.map(st);return G&&dt===st?Object.assign({},dt):dt}}function fi(rt,B,N){return{type:"Feature",id:rt[B+we],properties:ni(rt,B,N),geometry:{type:"Point",coordinates:[(G=rt[B],360*(G-.5)),Ze(rt[B+1])]}};var G}function ni(rt,B,N){const G=rt[B+Se],st=G>=1e4?`${Math.round(G/1e3)}k`:G>=1e3?Math.round(G/100)/10+"k":G,dt=rt[B+ai],yt=dt===-1?{}:Object.assign({},N[dt]);return Object.assign(yt,{cluster:!0,cluster_id:rt[B+we],point_count:G,point_count_abbreviated:st})}function Ue(rt){return rt/360+.5}function Mi(rt){const B=Math.sin(rt*Math.PI/180),N=.5-.25*Math.log((1+B)/(1-B))/Math.PI;return N<0?0:N>1?1:N}function Ze(rt){const B=(180-360*rt)*Math.PI/180;return 360*Math.atan(Math.exp(B))/Math.PI-90}function ti(rt,B,N,G){for(var st,dt=G,yt=N-B>>1,bt=N-B,ht=rt[B],St=rt[B+1],Bt=rt[N],At=rt[N+1],It=B+3;It<N;It+=3){var de=_r(rt[It],rt[It+1],ht,St,Bt,At);if(de>dt)st=It,dt=de;else if(de===dt){var fe=Math.abs(It-yt);fe<bt&&(st=It,bt=fe)}}dt>G&&(st-B>3&&ti(rt,B,st,G),rt[st+2]=dt,N-st>3&&ti(rt,st,N,G))}function _r(rt,B,N,G,st,dt){var yt=st-N,bt=dt-G;if(yt!==0||bt!==0){var ht=((rt-N)*yt+(B-G)*bt)/(yt*yt+bt*bt);ht>1?(N=st,G=dt):ht>0&&(N+=yt*ht,G+=bt*ht)}return(yt=rt-N)*yt+(bt=B-G)*bt}function sr(rt,B,N,G){var st={id:rt===void 0?null:rt,type:B,geometry:N,tags:G,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(dt){var yt=dt.geometry,bt=dt.type;if(bt==="Point"||bt==="MultiPoint"||bt==="LineString")vr(dt,yt);else if(bt==="Polygon"||bt==="MultiLineString")for(var ht=0;ht<yt.length;ht++)vr(dt,yt[ht]);else if(bt==="MultiPolygon")for(ht=0;ht<yt.length;ht++)for(var St=0;St<yt[ht].length;St++)vr(dt,yt[ht][St])}(st),st}function vr(rt,B){for(var N=0;N<B.length;N+=3)rt.minX=Math.min(rt.minX,B[N]),rt.minY=Math.min(rt.minY,B[N+1]),rt.maxX=Math.max(rt.maxX,B[N]),rt.maxY=Math.max(rt.maxY,B[N+1])}function ci(rt,B,N,G){if(B.geometry){var st=B.geometry.coordinates,dt=B.geometry.type,yt=Math.pow(N.tolerance/((1<<N.maxZoom)*N.extent),2),bt=[],ht=B.id;if(N.promoteId?ht=B.properties[N.promoteId]:N.generateId&&(ht=G||0),dt==="Point")Hr(st,bt);else if(dt==="MultiPoint")for(var St=0;St<st.length;St++)Hr(st[St],bt);else if(dt==="LineString")Et(st,bt,yt,!1);else if(dt==="MultiLineString"){if(N.lineMetrics){for(St=0;St<st.length;St++)Et(st[St],bt=[],yt,!1),rt.push(sr(ht,"LineString",bt,B.properties));return}Bi(st,bt,yt,!1)}else if(dt==="Polygon")Bi(st,bt,yt,!0);else{if(dt!=="MultiPolygon"){if(dt==="GeometryCollection"){for(St=0;St<B.geometry.geometries.length;St++)ci(rt,{id:ht,geometry:B.geometry.geometries[St],properties:B.properties},N,G);return}throw new Error("Input data is not a valid GeoJSON object.")}for(St=0;St<st.length;St++){var Bt=[];Bi(st[St],Bt,yt,!0),bt.push(Bt)}}rt.push(sr(ht,dt,bt,B.properties))}}function Hr(rt,B){B.push(nn(rt[0])),B.push(Ke(rt[1])),B.push(0)}function Et(rt,B,N,G){for(var st,dt,yt=0,bt=0;bt<rt.length;bt++){var ht=nn(rt[bt][0]),St=Ke(rt[bt][1]);B.push(ht),B.push(St),B.push(0),bt>0&&(yt+=G?(st*St-ht*dt)/2:Math.sqrt(Math.pow(ht-st,2)+Math.pow(St-dt,2))),st=ht,dt=St}var Bt=B.length-3;B[2]=1,ti(B,0,Bt,N),B[Bt+2]=1,B.size=Math.abs(yt),B.start=0,B.end=B.size}function Bi(rt,B,N,G){for(var st=0;st<rt.length;st++){var dt=[];Et(rt[st],dt,N,G),B.push(dt)}}function nn(rt){return rt/360+.5}function Ke(rt){var B=Math.sin(rt*Math.PI/180),N=.5-.25*Math.log((1+B)/(1-B))/Math.PI;return N<0?0:N>1?1:N}function li(rt,B,N,G,st,dt,yt,bt){if(G/=B,dt>=(N/=B)&&yt<G)return rt;if(yt<N||dt>=G)return null;for(var ht=[],St=0;St<rt.length;St++){var Bt=rt[St],At=Bt.geometry,It=Bt.type,de=st===0?Bt.minX:Bt.minY,fe=st===0?Bt.maxX:Bt.maxY;if(de>=N&&fe<G)ht.push(Bt);else if(!(fe<N||de>=G)){var Fe=[];if(It==="Point"||It==="MultiPoint")Vi(At,Fe,N,G,st);else if(It==="LineString")Ws(At,Fe,N,G,st,!1,bt.lineMetrics);else if(It==="MultiLineString")Ys(At,Fe,N,G,st,!1);else if(It==="Polygon")Ys(At,Fe,N,G,st,!0);else if(It==="MultiPolygon")for(var ke=0;ke<At.length;ke++){var Ne=[];Ys(At[ke],Ne,N,G,st,!0),Ne.length&&Fe.push(Ne)}if(Fe.length){if(bt.lineMetrics&&It==="LineString"){for(ke=0;ke<Fe.length;ke++)ht.push(sr(Bt.id,It,Fe[ke],Bt.tags));continue}It!=="LineString"&&It!=="MultiLineString"||(Fe.length===1?(It="LineString",Fe=Fe[0]):It="MultiLineString"),It!=="Point"&&It!=="MultiPoint"||(It=Fe.length===3?"Point":"MultiPoint"),ht.push(sr(Bt.id,It,Fe,Bt.tags))}}}return ht.length?ht:null}function Vi(rt,B,N,G,st){for(var dt=0;dt<rt.length;dt+=3){var yt=rt[dt+st];yt>=N&&yt<=G&&(B.push(rt[dt]),B.push(rt[dt+1]),B.push(rt[dt+2]))}}function Ws(rt,B,N,G,st,dt,yt){for(var bt,ht,St=vo(rt),Bt=st===0?Ks:xo,At=rt.start,It=0;It<rt.length-3;It+=3){var de=rt[It],fe=rt[It+1],Fe=rt[It+2],ke=rt[It+3],Ne=rt[It+4],ei=st===0?de:fe,ui=st===0?ke:Ne,Ai=!1;yt&&(bt=Math.sqrt(Math.pow(de-ke,2)+Math.pow(fe-Ne,2))),ei<N?ui>N&&(ht=Bt(St,de,fe,ke,Ne,N),yt&&(St.start=At+bt*ht)):ei>G?ui<G&&(ht=Bt(St,de,fe,ke,Ne,G),yt&&(St.start=At+bt*ht)):jn(St,de,fe,Fe),ui<N&&ei>=N&&(ht=Bt(St,de,fe,ke,Ne,N),Ai=!0),ui>G&&ei<=G&&(ht=Bt(St,de,fe,ke,Ne,G),Ai=!0),!dt&&Ai&&(yt&&(St.end=At+bt*ht),B.push(St),St=vo(rt)),yt&&(At+=bt)}var Ie=rt.length-3;de=rt[Ie],fe=rt[Ie+1],Fe=rt[Ie+2],(ei=st===0?de:fe)>=N&&ei<=G&&jn(St,de,fe,Fe),Ie=St.length-3,dt&&Ie>=3&&(St[Ie]!==St[0]||St[Ie+1]!==St[1])&&jn(St,St[0],St[1],St[2]),St.length&&B.push(St)}function vo(rt){var B=[];return B.size=rt.size,B.start=rt.start,B.end=rt.end,B}function Ys(rt,B,N,G,st,dt){for(var yt=0;yt<rt.length;yt++)Ws(rt[yt],B,N,G,st,dt,!1)}function jn(rt,B,N,G){rt.push(B),rt.push(N),rt.push(G)}function Ks(rt,B,N,G,st,dt){var yt=(dt-B)/(G-B);return rt.push(dt),rt.push(N+(st-N)*yt),rt.push(1),yt}function xo(rt,B,N,G,st,dt){var yt=(dt-N)/(st-N);return rt.push(B+(G-B)*yt),rt.push(dt),rt.push(1),yt}function Zt(rt,B){for(var N=[],G=0;G<rt.length;G++){var st,dt=rt[G],yt=dt.type;if(yt==="Point"||yt==="MultiPoint"||yt==="LineString")st=xr(dt.geometry,B);else if(yt==="MultiLineString"||yt==="Polygon"){st=[];for(var bt=0;bt<dt.geometry.length;bt++)st.push(xr(dt.geometry[bt],B))}else if(yt==="MultiPolygon")for(st=[],bt=0;bt<dt.geometry.length;bt++){for(var ht=[],St=0;St<dt.geometry[bt].length;St++)ht.push(xr(dt.geometry[bt][St],B));st.push(ht)}N.push(sr(dt.id,yt,st,dt.tags))}return N}function xr(rt,B){var N=[];N.size=rt.size,rt.start!==void 0&&(N.start=rt.start,N.end=rt.end);for(var G=0;G<rt.length;G+=3)N.push(rt[G]+B,rt[G+1],rt[G+2]);return N}function br(rt,B){if(rt.transformed)return rt;var N,G,st,dt=1<<rt.z,yt=rt.x,bt=rt.y;for(N=0;N<rt.features.length;N++){var ht=rt.features[N],St=ht.geometry,Bt=ht.type;if(ht.geometry=[],Bt===1)for(G=0;G<St.length;G+=2)ht.geometry.push(Un(St[G],St[G+1],B,dt,yt,bt));else for(G=0;G<St.length;G++){var At=[];for(st=0;st<St[G].length;st+=2)At.push(Un(St[G][st],St[G][st+1],B,dt,yt,bt));ht.geometry.push(At)}}return rt.transformed=!0,rt}function Un(rt,B,N,G,st,dt){return[Math.round(N*(rt*G-st)),Math.round(N*(B*G-dt))]}function Hn(rt,B,N,G,st){for(var dt=B===st.maxZoom?0:st.tolerance/((1<<B)*st.extent),yt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:N,y:G,z:B,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},bt=0;bt<rt.length;bt++){yt.numFeatures++,Ht(yt,rt[bt],dt,st);var ht=rt[bt].minX,St=rt[bt].minY,Bt=rt[bt].maxX,At=rt[bt].maxY;ht<yt.minX&&(yt.minX=ht),St<yt.minY&&(yt.minY=St),Bt>yt.maxX&&(yt.maxX=Bt),At>yt.maxY&&(yt.maxY=At)}return yt}function Ht(rt,B,N,G){var st=B.geometry,dt=B.type,yt=[];if(dt==="Point"||dt==="MultiPoint")for(var bt=0;bt<st.length;bt+=3)yt.push(st[bt]),yt.push(st[bt+1]),rt.numPoints++,rt.numSimplified++;else if(dt==="LineString")De(yt,st,rt,N,!1,!1);else if(dt==="MultiLineString"||dt==="Polygon")for(bt=0;bt<st.length;bt++)De(yt,st[bt],rt,N,dt==="Polygon",bt===0);else if(dt==="MultiPolygon")for(var ht=0;ht<st.length;ht++){var St=st[ht];for(bt=0;bt<St.length;bt++)De(yt,St[bt],rt,N,!0,bt===0)}if(yt.length){var Bt=B.tags||null;if(dt==="LineString"&&G.lineMetrics){for(var At in Bt={},B.tags)Bt[At]=B.tags[At];Bt.mapbox_clip_start=st.start/st.size,Bt.mapbox_clip_end=st.end/st.size}var It={geometry:yt,type:dt==="Polygon"||dt==="MultiPolygon"?3:dt==="LineString"||dt==="MultiLineString"?2:1,tags:Bt};B.id!==null&&(It.id=B.id),rt.features.push(It)}}function De(rt,B,N,G,st,dt){var yt=G*G;if(G>0&&B.size<(st?yt:G))N.numPoints+=B.length/3;else{for(var bt=[],ht=0;ht<B.length;ht+=3)(G===0||B[ht+2]>yt)&&(N.numSimplified++,bt.push(B[ht]),bt.push(B[ht+1])),N.numPoints++;st&&function(St,Bt){for(var At=0,It=0,de=St.length,fe=de-2;It<de;fe=It,It+=2)At+=(St[It]-St[fe])*(St[It+1]+St[fe+1]);if(At>0===Bt)for(It=0,de=St.length;It<de/2;It+=2){var Fe=St[It],ke=St[It+1];St[It]=St[de-2-It],St[It+1]=St[de-1-It],St[de-2-It]=Fe,St[de-1-It]=ke}}(bt,dt),rt.push(bt)}}function Pe(rt,B){var N=(B=this.options=function(st,dt){for(var yt in dt)st[yt]=dt[yt];return st}(Object.create(this.options),B)).debug;if(N&&console.time("preprocess data"),B.maxZoom<0||B.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(B.promoteId&&B.generateId)throw new Error("promoteId and generateId cannot be used together.");var G=function(st,dt){var yt=[];if(st.type==="FeatureCollection")for(var bt=0;bt<st.features.length;bt++)ci(yt,st.features[bt],dt,bt);else ci(yt,st.type==="Feature"?st:{geometry:st},dt);return yt}(rt,B);this.tiles={},this.tileCoords=[],N&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",B.indexMaxZoom,B.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),G=function(st,dt){var yt=dt.buffer/dt.extent,bt=st,ht=li(st,1,-1-yt,yt,0,-1,2,dt),St=li(st,1,1-yt,2+yt,0,-1,2,dt);return(ht||St)&&(bt=li(st,1,-yt,1+yt,0,-1,2,dt)||[],ht&&(bt=Zt(ht,1).concat(bt)),St&&(bt=bt.concat(Zt(St,-1)))),bt}(G,B),G.length&&this.splitTile(G,0,0,0),N&&(G.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function wr(rt,B,N){return 32*((1<<rt)*N+B)+rt}function Sr(rt,B){return B?rt.properties[B]:rt.id}function Me(rt,B){if(rt==null)return!0;if(rt.type==="Feature")return Sr(rt,B)!=null;if(rt.type==="FeatureCollection"){const N=new Set;for(const G of rt.features){const st=Sr(G,B);if(st==null||N.has(st))return!1;N.add(st)}return!0}return!1}function Zn(rt,B){const N=new Map;if(rt!=null)if(rt.type==="Feature")N.set(Sr(rt,B),rt);else for(const G of rt.features)N.set(Sr(G,B),G);return N}Pe.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Pe.prototype.splitTile=function(rt,B,N,G,st,dt,yt){for(var bt=[rt,B,N,G],ht=this.options,St=ht.debug;bt.length;){G=bt.pop(),N=bt.pop(),B=bt.pop(),rt=bt.pop();var Bt=1<<B,At=wr(B,N,G),It=this.tiles[At];if(!It&&(St>1&&console.time("creation"),It=this.tiles[At]=Hn(rt,B,N,G,ht),this.tileCoords.push({z:B,x:N,y:G}),St)){St>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",B,N,G,It.numFeatures,It.numPoints,It.numSimplified),console.timeEnd("creation"));var de="z"+B;this.stats[de]=(this.stats[de]||0)+1,this.total++}if(It.source=rt,st){if(B===ht.maxZoom||B===st)continue;var fe=1<<st-B;if(N!==Math.floor(dt/fe)||G!==Math.floor(yt/fe))continue}else if(B===ht.indexMaxZoom||It.numPoints<=ht.indexMaxPoints)continue;if(It.source=null,rt.length!==0){St>1&&console.time("clipping");var Fe,ke,Ne,ei,ui,Ai,Ie=.5*ht.buffer/ht.extent,ii=.5-Ie,bi=.5+Ie,Xi=1+Ie;Fe=ke=Ne=ei=null,ui=li(rt,Bt,N-Ie,N+bi,0,It.minX,It.maxX,ht),Ai=li(rt,Bt,N+ii,N+Xi,0,It.minX,It.maxX,ht),rt=null,ui&&(Fe=li(ui,Bt,G-Ie,G+bi,1,It.minY,It.maxY,ht),ke=li(ui,Bt,G+ii,G+Xi,1,It.minY,It.maxY,ht),ui=null),Ai&&(Ne=li(Ai,Bt,G-Ie,G+bi,1,It.minY,It.maxY,ht),ei=li(Ai,Bt,G+ii,G+Xi,1,It.minY,It.maxY,ht),Ai=null),St>1&&console.timeEnd("clipping"),bt.push(Fe||[],B+1,2*N,2*G),bt.push(ke||[],B+1,2*N,2*G+1),bt.push(Ne||[],B+1,2*N+1,2*G),bt.push(ei||[],B+1,2*N+1,2*G+1)}}},Pe.prototype.getTile=function(rt,B,N){var G=this.options,st=G.extent,dt=G.debug;if(rt<0||rt>24)return null;var yt=1<<rt,bt=wr(rt,B=(B%yt+yt)%yt,N);if(this.tiles[bt])return br(this.tiles[bt],st);dt>1&&console.log("drilling down to z%d-%d-%d",rt,B,N);for(var ht,St=rt,Bt=B,At=N;!ht&&St>0;)St--,Bt=Math.floor(Bt/2),At=Math.floor(At/2),ht=this.tiles[wr(St,Bt,At)];return ht&&ht.source?(dt>1&&console.log("found parent tile z%d-%d-%d",St,Bt,At),dt>1&&console.time("drilling down"),this.splitTile(ht.source,St,Bt,At,rt,B,N),dt>1&&console.timeEnd("drilling down"),this.tiles[bt]?br(this.tiles[bt],st):null):null};class qn extends P{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(B,N){return d._(this,void 0,void 0,function*(){const G=B.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const st=this._geoJSONIndex.getTile(G.z,G.x,G.y);if(!st)return null;const dt=new class{constructor(bt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=d.W,this.length=bt.length,this._features=bt}feature(bt){return new class{constructor(ht){this._feature=ht,this.extent=d.W,this.type=ht.type,this.properties=ht.tags,"id"in ht&&!isNaN(ht.id)&&(this.id=parseInt(ht.id,10))}loadGeometry(){if(this._feature.type===1){const ht=[];for(const St of this._feature.geometry)ht.push([new d.P(St[0],St[1])]);return ht}{const ht=[];for(const St of this._feature.geometry){const Bt=[];for(const At of St)Bt.push(new d.P(At[0],At[1]));ht.push(Bt)}return ht}}toGeoJSON(ht,St,Bt){return nt.call(this,ht,St,Bt)}}(this._features[bt])}}(st.features);let yt=$e(dt);return yt.byteOffset===0&&yt.byteLength===yt.buffer.byteLength||(yt=new Uint8Array(yt)),{vectorTile:dt,rawData:yt.buffer}})}loadData(B){return d._(this,void 0,void 0,function*(){var N;(N=this._pendingRequest)===null||N===void 0||N.abort();const G=!!(B&&B.request&&B.request.collectResourceTiming)&&new d.bt(B.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(B,this._pendingRequest),this._geoJSONIndex=B.cluster?new Qe(function({superclusterOptions:dt,clusterProperties:yt}){if(!yt||!dt)return dt;const bt={},ht={},St={accumulated:null,zoom:0},Bt={properties:null},At=Object.keys(yt);for(const It of At){const[de,fe]=yt[It],Fe=d.bA(fe),ke=d.bA(typeof de=="string"?[de,["accumulated"],["get",It]]:de);bt[It]=Fe.value,ht[It]=ke.value}return dt.map=It=>{Bt.properties=It;const de={};for(const fe of At)de[fe]=bt[fe].evaluate(St,Bt);return de},dt.reduce=(It,de)=>{Bt.properties=de;for(const fe of At)St.accumulated=It[fe],It[fe]=ht[fe].evaluate(St,Bt)},dt}(B)).load((yield this._pendingData).features):new Pe(yield this._pendingData,B.geojsonVtOptions),this.loaded={};const st={};if(G){const dt=G.finish();dt&&(st.resourceTiming={},st.resourceTiming[B.source]=JSON.parse(JSON.stringify(dt)))}return st}catch(st){if(delete this._pendingRequest,d.bz(st))return{abandoned:!0};throw st}})}getData(){return d._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(B){const N=this.loaded;return N&&N[B.uid]?super.reloadTile(B):this.loadTile(B)}loadAndProcessGeoJSON(B,N){return d._(this,void 0,void 0,function*(){let G=yield this.loadGeoJSON(B,N);if(delete this._pendingRequest,typeof G!="object")throw new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`);if($(G,!0),B.filter){const st=d.bA(B.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(st.result==="error")throw new Error(st.value.map(dt=>`${dt.key}: ${dt.message}`).join(", "));G={type:"FeatureCollection",features:G.features.filter(dt=>st.value.evaluate({zoom:0},dt))}}return G})}loadGeoJSON(B,N){return d._(this,void 0,void 0,function*(){const{promoteId:G}=B;if(B.request){const st=yield d.h(B.request,N);return this._dataUpdateable=Me(st.data,G)?Zn(st.data,G):void 0,st.data}if(typeof B.data=="string")try{const st=JSON.parse(B.data);return this._dataUpdateable=Me(st,G)?Zn(st,G):void 0,st}catch{throw new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`)}if(!B.dataDiff)throw new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${B.source}`);return function(st,dt,yt){var bt,ht,St,Bt;if(dt.removeAll&&st.clear(),dt.remove)for(const At of dt.remove)st.delete(At);if(dt.add)for(const At of dt.add){const It=Sr(At,yt);It!=null&&st.set(It,At)}if(dt.update)for(const At of dt.update){let It=st.get(At.id);if(It==null)continue;const de=!At.removeAllProperties&&(((bt=At.removeProperties)===null||bt===void 0?void 0:bt.length)>0||((ht=At.addOrUpdateProperties)===null||ht===void 0?void 0:ht.length)>0);if((At.newGeometry||At.removeAllProperties||de)&&(It=Object.assign({},It),st.set(At.id,It),de&&(It.properties=Object.assign({},It.properties))),At.newGeometry&&(It.geometry=At.newGeometry),At.removeAllProperties)It.properties={};else if(((St=At.removeProperties)===null||St===void 0?void 0:St.length)>0)for(const fe of At.removeProperties)Object.prototype.hasOwnProperty.call(It.properties,fe)&&delete It.properties[fe];if(((Bt=At.addOrUpdateProperties)===null||Bt===void 0?void 0:Bt.length)>0)for(const{key:fe,value:Fe}of At.addOrUpdateProperties)It.properties[fe]=Fe}}(this._dataUpdateable,B.dataDiff,G),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(B){return d._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(B){return this._geoJSONIndex.getClusterExpansionZoom(B.clusterId)}getClusterChildren(B){return this._geoJSONIndex.getChildren(B.clusterId)}getClusterLeaves(B){return this._geoJSONIndex.getLeaves(B.clusterId,B.limit,B.offset)}}class qi{constructor(B){this.self=B,this.actor=new d.C(B),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(N,G)=>{if(this.externalWorkerSourceTypes[N])throw new Error(`Worker source with name "${N}" already registered.`);this.externalWorkerSourceTypes[N]=G},this.self.addProtocol=d.bg,this.self.removeProtocol=d.bh,this.self.registerRTLTextPlugin=N=>{if(d.bB.isParsed())throw new Error("RTL text plugin already registered.");d.bB.setMethods(N)},this.actor.registerMessageHandler("LDT",(N,G)=>this._getDEMWorkerSource(N,G.source).loadTile(G)),this.actor.registerMessageHandler("RDT",(N,G)=>d._(this,void 0,void 0,function*(){this._getDEMWorkerSource(N,G.source).removeTile(G)})),this.actor.registerMessageHandler("GCEZ",(N,G)=>d._(this,void 0,void 0,function*(){return this._getWorkerSource(N,G.type,G.source).getClusterExpansionZoom(G)})),this.actor.registerMessageHandler("GCC",(N,G)=>d._(this,void 0,void 0,function*(){return this._getWorkerSource(N,G.type,G.source).getClusterChildren(G)})),this.actor.registerMessageHandler("GCL",(N,G)=>d._(this,void 0,void 0,function*(){return this._getWorkerSource(N,G.type,G.source).getClusterLeaves(G)})),this.actor.registerMessageHandler("LD",(N,G)=>this._getWorkerSource(N,G.type,G.source).loadData(G)),this.actor.registerMessageHandler("GD",(N,G)=>this._getWorkerSource(N,G.type,G.source).getData()),this.actor.registerMessageHandler("LT",(N,G)=>this._getWorkerSource(N,G.type,G.source).loadTile(G)),this.actor.registerMessageHandler("RT",(N,G)=>this._getWorkerSource(N,G.type,G.source).reloadTile(G)),this.actor.registerMessageHandler("AT",(N,G)=>this._getWorkerSource(N,G.type,G.source).abortTile(G)),this.actor.registerMessageHandler("RMT",(N,G)=>this._getWorkerSource(N,G.type,G.source).removeTile(G)),this.actor.registerMessageHandler("RS",(N,G)=>d._(this,void 0,void 0,function*(){if(!this.workerSources[N]||!this.workerSources[N][G.type]||!this.workerSources[N][G.type][G.source])return;const st=this.workerSources[N][G.type][G.source];delete this.workerSources[N][G.type][G.source],st.removeSource!==void 0&&st.removeSource(G)})),this.actor.registerMessageHandler("RM",N=>d._(this,void 0,void 0,function*(){delete this.layerIndexes[N],delete this.availableImages[N],delete this.workerSources[N],delete this.demWorkerSources[N]})),this.actor.registerMessageHandler("SR",(N,G)=>d._(this,void 0,void 0,function*(){this.referrer=G})),this.actor.registerMessageHandler("SRPS",(N,G)=>this._syncRTLPluginState(N,G)),this.actor.registerMessageHandler("IS",(N,G)=>d._(this,void 0,void 0,function*(){this.self.importScripts(G)})),this.actor.registerMessageHandler("SI",(N,G)=>this._setImages(N,G)),this.actor.registerMessageHandler("UL",(N,G)=>d._(this,void 0,void 0,function*(){this._getLayerIndex(N).update(G.layers,G.removedIds)})),this.actor.registerMessageHandler("SL",(N,G)=>d._(this,void 0,void 0,function*(){this._getLayerIndex(N).replace(G)}))}_setImages(B,N){return d._(this,void 0,void 0,function*(){this.availableImages[B]=N;for(const G in this.workerSources[B]){const st=this.workerSources[B][G];for(const dt in st)st[dt].availableImages=N}})}_syncRTLPluginState(B,N){return d._(this,void 0,void 0,function*(){if(d.bB.isParsed())return d.bB.getState();if(N.pluginStatus!=="loading")return d.bB.setState(N),N;const G=N.pluginURL;if(this.self.importScripts(G),d.bB.isParsed()){const st={pluginStatus:"loaded",pluginURL:G};return d.bB.setState(st),st}throw d.bB.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${G}`)})}_getAvailableImages(B){let N=this.availableImages[B];return N||(N=[]),N}_getLayerIndex(B){let N=this.layerIndexes[B];return N||(N=this.layerIndexes[B]=new c),N}_getWorkerSource(B,N,G){if(this.workerSources[B]||(this.workerSources[B]={}),this.workerSources[B][N]||(this.workerSources[B][N]={}),!this.workerSources[B][N][G]){const st={sendAsync:(dt,yt)=>(dt.targetMapId=B,this.actor.sendAsync(dt,yt))};switch(N){case"vector":this.workerSources[B][N][G]=new P(st,this._getLayerIndex(B),this._getAvailableImages(B));break;case"geojson":this.workerSources[B][N][G]=new qn(st,this._getLayerIndex(B),this._getAvailableImages(B));break;default:this.workerSources[B][N][G]=new this.externalWorkerSourceTypes[N](st,this._getLayerIndex(B),this._getAvailableImages(B))}}return this.workerSources[B][N][G]}_getDEMWorkerSource(B,N){return this.demWorkerSources[B]||(this.demWorkerSources[B]={}),this.demWorkerSources[B][N]||(this.demWorkerSources[B][N]=new A),this.demWorkerSources[B][N]}}return d.i(self)&&(self.worker=new qi(self)),qi}),l("index",["exports","./shared"],function(d,c){var b="4.3.2";let S,C;const P={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:y=>new Promise((n,u)=>{const f=requestAnimationFrame(n);y.signal.addEventListener("abort",()=>{cancelAnimationFrame(f),u(c.c())})}),getImageData(y,n=0){return this.getImageCanvasContext(y).getImageData(-n,-n,y.width+2*n,y.height+2*n)},getImageCanvasContext(y){const n=window.document.createElement("canvas"),u=n.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return n.width=y.width,n.height=y.height,u.drawImage(y,0,0,y.width,y.height),u},resolveURL:y=>(S||(S=document.createElement("a")),S.href=y,S.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(C==null&&(C=matchMedia("(prefers-reduced-motion: reduce)")),C.matches)}};class A{static testProp(n){if(!A.docStyle)return n[0];for(let u=0;u<n.length;u++)if(n[u]in A.docStyle)return n[u];return n[0]}static create(n,u,f){const g=window.document.createElement(n);return u!==void 0&&(g.className=u),f&&f.appendChild(g),g}static createNS(n,u){return window.document.createElementNS(n,u)}static disableDrag(){A.docStyle&&A.selectProp&&(A.userSelect=A.docStyle[A.selectProp],A.docStyle[A.selectProp]="none")}static enableDrag(){A.docStyle&&A.selectProp&&(A.docStyle[A.selectProp]=A.userSelect)}static setTransform(n,u){n.style[A.transformProp]=u}static addEventListener(n,u,f,g={}){n.addEventListener(u,f,"passive"in g?g:g.capture)}static removeEventListener(n,u,f,g={}){n.removeEventListener(u,f,"passive"in g?g:g.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",A.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",A.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",A.suppressClickInternal,!0)},0)}static getScale(n){const u=n.getBoundingClientRect();return{x:u.width/n.offsetWidth||1,y:u.height/n.offsetHeight||1,boundingClientRect:u}}static getPoint(n,u,f){const g=u.boundingClientRect;return new c.P((f.clientX-g.left)/u.x-n.clientLeft,(f.clientY-g.top)/u.y-n.clientTop)}static mousePos(n,u){const f=A.getScale(n);return A.getPoint(n,f,u)}static touchPos(n,u){const f=[],g=A.getScale(n);for(let v=0;v<u.length;v++)f.push(A.getPoint(n,g,u[v]));return f}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}}A.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,A.selectProp=A.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),A.transformProp=A.testProp(["transform","WebkitTransform"]);const V={supported:!1,testSupport:function(y){!nt&&$&&(H?Y(y):W=y)}};let W,$,nt=!1,H=!1;function Y(y){const n=y.createTexture();y.bindTexture(y.TEXTURE_2D,n);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,$),y.isContextLost())return;V.supported=!0}catch{}y.deleteTexture(n),nt=!0}var K;typeof document<"u"&&($=document.createElement("img"),$.onload=()=>{W&&Y(W),W=null,H=!0},$.onerror=()=>{nt=!0,W=null},$.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let n,u,f,g;y.resetRequestQueue=()=>{n=[],u=0,f=0,g={}},y.addThrottleControl=E=>{const z=f++;return g[z]=E,z},y.removeThrottleControl=E=>{delete g[E],k()},y.getImage=(E,z,F=!0)=>new Promise((R,Z)=>{V.supported&&(E.headers||(E.headers={}),E.headers.accept="image/webp,*/*"),c.e(E,{type:"image"}),n.push({abortController:z,requestParameters:E,supportImageRefresh:F,state:"queued",onError:X=>{Z(X)},onSuccess:X=>{R(X)}}),k()});const v=E=>c._(this,void 0,void 0,function*(){E.state="running";const{requestParameters:z,supportImageRefresh:F,onError:R,onSuccess:Z,abortController:X}=E,tt=F===!1&&!c.i(self)&&!c.g(z.url)&&(!z.headers||Object.keys(z.headers).reduce((ut,gt)=>ut&&gt==="accept",!0));u++;const lt=tt?M(z,X):c.m(z,X);try{const ut=yield lt;delete E.abortController,E.state="completed",ut.data instanceof HTMLImageElement||c.b(ut.data)?Z(ut):ut.data&&Z({data:yield(et=ut.data,typeof createImageBitmap=="function"?c.d(et):c.f(et)),cacheControl:ut.cacheControl,expires:ut.expires})}catch(ut){delete E.abortController,R(ut)}finally{u--,k()}var et}),k=()=>{const E=(()=>{for(const z of Object.keys(g))if(g[z]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let z=u;z<E&&n.length>0;z++){const F=n.shift();F.abortController.signal.aborted?z--:v(F)}},M=(E,z)=>new Promise((F,R)=>{const Z=new Image,X=E.url,tt=E.credentials;tt&&tt==="include"?Z.crossOrigin="use-credentials":(tt&&tt==="same-origin"||!c.s(X))&&(Z.crossOrigin="anonymous"),z.signal.addEventListener("abort",()=>{Z.src="",R(c.c())}),Z.fetchPriority="high",Z.onload=()=>{Z.onerror=Z.onload=null,F({data:Z})},Z.onerror=()=>{Z.onerror=Z.onload=null,z.signal.aborted||R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Z.src=X})}(K||(K={})),K.resetRequestQueue();class at{constructor(n){this._transformRequestFn=n}transformRequest(n,u){return this._transformRequestFn&&this._transformRequestFn(n,u)||{url:n}}setTransformRequest(n){this._transformRequestFn=n}}function mt(y){var n=new c.A(3);return n[0]=y[0],n[1]=y[1],n[2]=y[2],n}var xt,Tt=function(y,n,u){return y[0]=n[0]-u[0],y[1]=n[1]-u[1],y[2]=n[2]-u[2],y};xt=new c.A(3),c.A!=Float32Array&&(xt[0]=0,xt[1]=0,xt[2]=0);var Mt=function(y){var n=y[0],u=y[1];return n*n+u*u};function $t(y){const n=[];if(typeof y=="string")n.push({id:"default",url:y});else if(y&&y.length>0){const u=[];for(const{id:f,url:g}of y){const v=`${f}${g}`;u.indexOf(v)===-1&&(u.push(v),n.push({id:f,url:g}))}}return n}function Ft(y,n,u){const f=y.split("?");return f[0]+=`${n}${u}`,f.join("?")}(function(){var y=new c.A(2);c.A!=Float32Array&&(y[0]=0,y[1]=0)})();class Ot{constructor(n,u,f,g){this.context=n,this.format=f,this.texture=n.gl.createTexture(),this.update(u,g)}update(n,u,f){const{width:g,height:v}=n,k=!(this.size&&this.size[0]===g&&this.size[1]===v||f),{context:M}=this,{gl:E}=M;if(this.useMipmap=!!(u&&u.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),M.pixelStoreUnpackFlipY.set(!1),M.pixelStoreUnpack.set(1),M.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!u||u.premultiply!==!1)),k)this.size=[g,v],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||c.b(n)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,n):E.texImage2D(E.TEXTURE_2D,0,this.format,g,v,0,this.format,E.UNSIGNED_BYTE,n.data);else{const{x:z,y:F}=f||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||c.b(n)?E.texSubImage2D(E.TEXTURE_2D,0,z,F,E.RGBA,E.UNSIGNED_BYTE,n):E.texSubImage2D(E.TEXTURE_2D,0,z,F,g,v,E.RGBA,E.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)}bind(n,u,f){const{context:g}=this,{gl:v}=g;v.bindTexture(v.TEXTURE_2D,this.texture),f!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=v.LINEAR),n!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,n),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,f||n),this.filter=n),u!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,u),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}function ge(y){const{userImage:n}=y;return!!(n&&n.render&&n.render())&&(y.data.replace(new Uint8Array(n.data.buffer)),!0)}class _e extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:u,promiseResolve:f}of this.requestors)f(this._getImagesForIds(u));this.requestors=[]}}getImage(n){const u=this.images[n];if(u&&!u.data&&u.spriteData){const f=u.spriteData;u.data=new c.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),u.spriteData=null}return u}addImage(n,u){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,u)&&(this.images[n]=u)}_validate(n,u){let f=!0;const g=u.data||u.spriteData;return this._validateStretch(u.stretchX,g&&g.width)||(this.fire(new c.j(new Error(`Image "${n}" has invalid "stretchX" value`))),f=!1),this._validateStretch(u.stretchY,g&&g.height)||(this.fire(new c.j(new Error(`Image "${n}" has invalid "stretchY" value`))),f=!1),this._validateContent(u.content,u)||(this.fire(new c.j(new Error(`Image "${n}" has invalid "content" value`))),f=!1),f}_validateStretch(n,u){if(!n)return!0;let f=0;for(const g of n){if(g[0]<f||g[1]<g[0]||u<g[1])return!1;f=g[1]}return!0}_validateContent(n,u){if(!n)return!0;if(n.length!==4)return!1;const f=u.spriteData,g=f&&f.width||u.data.width,v=f&&f.height||u.data.height;return!(n[0]<0||g<n[0]||n[1]<0||v<n[1]||n[2]<0||g<n[2]||n[3]<0||v<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,u,f=!0){const g=this.getImage(n);if(f&&(g.data.width!==u.data.width||g.data.height!==u.data.height))throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=g.version+1,this.images[n]=u,this.updatedImages[n]=!0}removeImage(n){const u=this.images[n];delete this.images[n],delete this.patterns[n],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n){return new Promise((u,f)=>{let g=!0;if(!this.isLoaded())for(const v of n)this.images[v]||(g=!1);this.isLoaded()||g?u(this._getImagesForIds(n)):this.requestors.push({ids:n,promiseResolve:u})})}_getImagesForIds(n){const u={};for(const f of n){let g=this.getImage(f);g||(this.fire(new c.k("styleimagemissing",{id:f})),g=this.getImage(f)),g?u[f]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,textFitWidth:g.textFitWidth,textFitHeight:g.textFitHeight,hasRenderCallback:!!(g.userImage&&g.userImage.render)}:c.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:n,height:u}=this.atlasImage;return{width:n,height:u}}getPattern(n){const u=this.patterns[n],f=this.getImage(n);if(!f)return null;if(u&&u.position.version===f.version)return u.position;if(u)u.position.version=f.version;else{const g={w:f.data.width+2,h:f.data.height+2,x:0,y:0},v=new c.I(g,f);this.patterns[n]={bin:g,position:v}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const u=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ot(n,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const v in this.patterns)n.push(this.patterns[v].bin);const{w:u,h:f}=c.p(n),g=this.atlasImage;g.resize({width:u||1,height:f||1});for(const v in this.patterns){const{bin:k}=this.patterns[v],M=k.x+1,E=k.y+1,z=this.getImage(v).data,F=z.width,R=z.height;c.R.copy(z,g,{x:0,y:0},{x:M,y:E},{width:F,height:R}),c.R.copy(z,g,{x:0,y:R-1},{x:M,y:E-1},{width:F,height:1}),c.R.copy(z,g,{x:0,y:0},{x:M,y:E+R},{width:F,height:1}),c.R.copy(z,g,{x:F-1,y:0},{x:M-1,y:E},{width:1,height:R}),c.R.copy(z,g,{x:0,y:0},{x:M+F,y:E},{width:1,height:R})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const u of n){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const f=this.getImage(u);f||c.w(`Image with ID: "${u}" was not found`),ge(f)&&this.updateImage(u,f)}}}const Ae=1e20;function ve(y,n,u,f,g,v,k,M,E){for(let z=n;z<n+f;z++)Ee(y,u*v+z,v,g,k,M,E);for(let z=u;z<u+g;z++)Ee(y,z*v+n,1,f,k,M,E)}function Ee(y,n,u,f,g,v,k){v[0]=0,k[0]=-Ae,k[1]=Ae,g[0]=y[n];for(let M=1,E=0,z=0;M<f;M++){g[M]=y[n+M*u];const F=M*M;do{const R=v[E];z=(g[M]-g[R]+F-R*R)/(M-R)/2}while(z<=k[E]&&--E>-1);E++,v[E]=M,k[E]=z,k[E+1]=Ae}for(let M=0,E=0;M<f;M++){for(;k[E+1]<M;)E++;const z=v[E],F=M-z;y[n+M*u]=g[z]+F*F}}class $e{constructor(n,u){this.requestManager=n,this.localIdeographFontFamily=u,this.entries={}}setURL(n){this.url=n}getGlyphs(n){return c._(this,void 0,void 0,function*(){const u=[];for(const v in n)for(const k of n[v])u.push(this._getAndCacheGlyphsPromise(v,k));const f=yield Promise.all(u),g={};for(const{stack:v,id:k,glyph:M}of f)g[v]||(g[v]={}),g[v][k]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics};return g})}_getAndCacheGlyphsPromise(n,u){return c._(this,void 0,void 0,function*(){let f=this.entries[n];f||(f=this.entries[n]={glyphs:{},requests:{},ranges:{}});let g=f.glyphs[u];if(g!==void 0)return{stack:n,id:u,glyph:g};if(g=this._tinySDF(f,n,u),g)return f.glyphs[u]=g,{stack:n,id:u,glyph:g};const v=Math.floor(u/256);if(256*v>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[v])return{stack:n,id:u,glyph:g};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[v]){const M=$e.loadGlyphRange(n,v,this.url,this.requestManager);f.requests[v]=M}const k=yield f.requests[v];for(const M in k)this._doesCharSupportLocalGlyph(+M)||(f.glyphs[+M]=k[+M]);return f.ranges[v]=!0,{stack:n,id:u,glyph:k[u]||null}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&(c.u["CJK Unified Ideographs"](n)||c.u["Hangul Syllables"](n)||c.u.Hiragana(n)||c.u.Katakana(n))}_tinySDF(n,u,f){const g=this.localIdeographFontFamily;if(!g||!this._doesCharSupportLocalGlyph(f))return;let v=n.tinySDF;if(!v){let M="400";/bold/i.test(u)?M="900":/medium/i.test(u)?M="500":/light/i.test(u)&&(M="200"),v=n.tinySDF=new $e.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:g,fontWeight:M})}const k=v.draw(String.fromCharCode(f));return{id:f,bitmap:new c.o({width:k.width||60,height:k.height||60},k.data),metrics:{width:k.glyphWidth/2||24,height:k.glyphHeight/2||24,left:k.glyphLeft/2+.5||0,top:k.glyphTop/2-27.5||-8,advance:k.glyphAdvance/2||24,isDoubleResolution:!0}}}}$e.loadGlyphRange=function(y,n,u,f){return c._(this,void 0,void 0,function*(){const g=256*n,v=g+255,k=f.transformRequest(u.replace("{fontstack}",y).replace("{range}",`${g}-${v}`),"Glyphs"),M=yield c.l(k,new AbortController);if(!M||!M.data)throw new Error(`Could not load glyph range. range: ${n}, ${g}-${v}`);const E={};for(const z of c.n(M.data))E[z.id]=z;return E})},$e.TinySDF=class{constructor({fontSize:y=24,buffer:n=3,radius:u=8,cutoff:f=.25,fontFamily:g="sans-serif",fontWeight:v="normal",fontStyle:k="normal"}={}){this.buffer=n,this.cutoff=f,this.radius=u;const M=this.size=y+4*n,E=this._createCanvas(M),z=this.ctx=E.getContext("2d",{willReadFrequently:!0});z.font=`${k} ${v} ${y}px ${g}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(y){const n=document.createElement("canvas");return n.width=n.height=y,n}draw(y){const{width:n,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:g,actualBoundingBoxRight:v}=this.ctx.measureText(y),k=Math.ceil(u),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-g))),E=Math.min(this.size-this.buffer,k+Math.ceil(f)),z=M+2*this.buffer,F=E+2*this.buffer,R=Math.max(z*F,0),Z=new Uint8ClampedArray(R),X={data:Z,width:z,height:F,glyphWidth:M,glyphHeight:E,glyphTop:k,glyphLeft:0,glyphAdvance:n};if(M===0||E===0)return X;const{ctx:tt,buffer:lt,gridInner:et,gridOuter:ut}=this;tt.clearRect(lt,lt,M,E),tt.fillText(y,lt,lt+k);const gt=tt.getImageData(lt,lt,M,E);ut.fill(Ae,0,R),et.fill(0,0,R);for(let ot=0;ot<E;ot++)for(let _t=0;_t<M;_t++){const kt=gt.data[4*(ot*M+_t)+3]/255;if(kt===0)continue;const Ct=(ot+lt)*z+_t+lt;if(kt===1)ut[Ct]=0,et[Ct]=Ae;else{const Dt=.5-kt;ut[Ct]=Dt>0?Dt*Dt:0,et[Ct]=Dt<0?Dt*Dt:0}}ve(ut,0,0,z,F,z,this.f,this.v,this.z),ve(et,lt,lt,M,E,z,this.f,this.v,this.z);for(let ot=0;ot<R;ot++){const _t=Math.sqrt(ut[ot])-Math.sqrt(et[ot]);Z[ot]=Math.round(255-255*(_t/this.radius+this.cutoff))}return X}};class Vt{constructor(){this.specification=c.v.light.position}possiblyEvaluate(n,u){return c.y(n.expression.evaluate(u))}interpolate(n,u,f){return{x:c.z.number(n.x,u.x,f),y:c.z.number(n.y,u.y,f),z:c.z.number(n.z,u.z,f)}}}let re;class Kt extends c.E{constructor(n){super(),re=re||new c.q({anchor:new c.D(c.v.light.anchor),position:new Vt,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(re),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,u={}){if(!this._validate(c.r,n,u))for(const f in n){const g=n[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),g):this._transitionable.setValue(f,g)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,f){return(!f||f.validate!==!1)&&c.t(this,n.call(c.x,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}class we{constructor(n,u){this.width=n,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,u){const f=n.join(",")+String(u);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(n,u)),this.dashEntry[f]}getDashRanges(n,u,f){const g=[];let v=n.length%2==1?-n[n.length-1]*f:0,k=n[0]*f,M=!0;g.push({left:v,right:k,isDash:M,zeroLength:n[0]===0});let E=n[0];for(let z=1;z<n.length;z++){M=!M;const F=n[z];v=E*f,E+=F,k=E*f,g.push({left:v,right:k,isDash:M,zeroLength:F===0})}return g}addRoundDash(n,u,f){const g=u/2;for(let v=-f;v<=f;v++){const k=this.width*(this.nextRow+f+v);let M=0,E=n[M];for(let z=0;z<this.width;z++){z/E.right>1&&(E=n[++M]);const F=Math.abs(z-E.left),R=Math.abs(z-E.right),Z=Math.min(F,R);let X;const tt=v/f*(g+1);if(E.isDash){const lt=g-Math.abs(tt);X=Math.sqrt(Z*Z+lt*lt)}else X=g-Math.sqrt(Z*Z+tt*tt);this.data[k+z]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(n){for(let M=n.length-1;M>=0;--M){const E=n[M],z=n[M+1];E.zeroLength?n.splice(M,1):z&&z.isDash===E.isDash&&(z.left=E.left,n.splice(M,1))}const u=n[0],f=n[n.length-1];u.isDash===f.isDash&&(u.left=f.left-this.width,f.right=u.right+this.width);const g=this.width*this.nextRow;let v=0,k=n[v];for(let M=0;M<this.width;M++){M/k.right>1&&(k=n[++v]);const E=Math.abs(M-k.left),z=Math.abs(M-k.right),F=Math.min(E,z);this.data[g+M]=Math.max(0,Math.min(255,(k.isDash?F:-F)+128))}}addDash(n,u){const f=u?7:0,g=2*f+1;if(this.nextRow+g>this.height)return c.w("LineAtlas out of space"),null;let v=0;for(let M=0;M<n.length;M++)v+=n[M];if(v!==0){const M=this.width/v,E=this.getDashRanges(n,this.width,M);u?this.addRoundDash(E,M,f):this.addRegularDash(E)}const k={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:v};return this.nextRow+=g,this.dirty=!0,k}bind(n){const u=n.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const Se="maplibre_preloaded_worker_pool";class ai{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<ai.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Se]}numActive(){return Object.keys(this.active).length}}const Qe=Math.floor(P.hardwareConcurrency/2);let fi,ni;function Ue(){return fi||(fi=new ai),fi}ai.workerCount=c.B(globalThis)?Math.max(Math.min(Qe,3),1):1;class Mi{constructor(n,u){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=u;const f=this.workerPool.acquire(u);for(let g=0;g<f.length;g++){const v=new c.C(f[g],u);v.name=`Worker ${g}`,this.actors.push(v)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,u){const f=[];for(const g of this.actors)f.push(g.sendAsync({type:n,data:u}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],n&&this.workerPool.release(this.id)}registerMessageHandler(n,u){for(const f of this.actors)f.registerMessageHandler(n,u)}}function Ze(){return ni||(ni=new Mi(Ue(),c.G),ni.registerMessageHandler("GR",(y,n,u)=>c.m(n,u))),ni}function ti(y,n){const u=c.F();return c.H(u,u,[1,1,0]),c.J(u,u,[.5*y.width,.5*y.height,1]),c.K(u,u,y.calculatePosMatrix(n.toUnwrapped()))}function _r(y,n,u,f,g,v){const k=function(R,Z,X){if(R)for(const tt of R){const lt=Z[tt];if(lt&&lt.source===X&&lt.type==="fill-extrusion")return!0}else for(const tt in Z){const lt=Z[tt];if(lt.source===X&&lt.type==="fill-extrusion")return!0}return!1}(g&&g.layers,n,y.id),M=v.maxPitchScaleFactor(),E=y.tilesIn(f,M,k);E.sort(sr);const z=[];for(const R of E)z.push({wrappedTileID:R.tileID.wrapped().key,queryResults:R.tile.queryRenderedFeatures(n,u,y._state,R.queryGeometry,R.cameraQueryGeometry,R.scale,g,v,M,ti(y.transform,R.tileID))});const F=function(R){const Z={},X={};for(const tt of R){const lt=tt.queryResults,et=tt.wrappedTileID,ut=X[et]=X[et]||{};for(const gt in lt){const ot=lt[gt],_t=ut[gt]=ut[gt]||{},kt=Z[gt]=Z[gt]||[];for(const Ct of ot)_t[Ct.featureIndex]||(_t[Ct.featureIndex]=!0,kt.push(Ct))}}return Z}(z);for(const R in F)F[R].forEach(Z=>{const X=Z.feature,tt=y.getFeatureState(X.layer["source-layer"],X.id);X.source=X.layer.source,X.layer["source-layer"]&&(X.sourceLayer=X.layer["source-layer"]),X.state=tt});return F}function sr(y,n){const u=y.tileID,f=n.tileID;return u.overscaledZ-f.overscaledZ||u.canonical.y-f.canonical.y||u.wrap-f.wrap||u.canonical.x-f.canonical.x}function vr(y,n,u){return c._(this,void 0,void 0,function*(){let f=y;if(y.url?f=(yield c.h(n.transformRequest(y.url,"Source"),u)).data:yield P.frameAsync(u),!f)return null;const g=c.L(c.e(f,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(g.vectorLayerIds=f.vector_layers.map(v=>v.id)),g})}class ci{constructor(n,u){n&&(u?this.setSouthWest(n).setNorthEast(u):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof c.M?new c.M(n.lng,n.lat):c.M.convert(n),this}setSouthWest(n){return this._sw=n instanceof c.M?new c.M(n.lng,n.lat):c.M.convert(n),this}extend(n){const u=this._sw,f=this._ne;let g,v;if(n instanceof c.M)g=n,v=n;else{if(!(n instanceof ci))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(ci.convert(n)):this.extend(c.M.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(c.M.convert(n)):this;if(g=n._sw,v=n._ne,!g||!v)return this}return u||f?(u.lng=Math.min(g.lng,u.lng),u.lat=Math.min(g.lat,u.lat),f.lng=Math.max(v.lng,f.lng),f.lat=Math.max(v.lat,f.lat)):(this._sw=new c.M(g.lng,g.lat),this._ne=new c.M(v.lng,v.lat)),this}getCenter(){return new c.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.M(this.getWest(),this.getNorth())}getSouthEast(){return new c.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:u,lat:f}=c.M.convert(n);let g=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&g}static convert(n){return n instanceof ci?n:n&&new ci(n)}static fromLngLat(n,u=0){const f=360*u/40075017,g=f/Math.cos(Math.PI/180*n.lat);return new ci(new c.M(n.lng-g,n.lat-f),new c.M(n.lng+g,n.lat+f))}}class Hr{constructor(n,u,f){this.bounds=ci.convert(this.validateBounds(n)),this.minzoom=u||0,this.maxzoom=f||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const u=Math.pow(2,n.z),f=Math.floor(c.N(this.bounds.getWest())*u),g=Math.floor(c.O(this.bounds.getNorth())*u),v=Math.ceil(c.N(this.bounds.getEast())*u),k=Math.ceil(c.O(this.bounds.getSouth())*u);return n.x>=f&&n.x<v&&n.y>=g&&n.y<k}}class Et extends c.E{constructor(n,u,f,g){if(super(),this.id=n,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.L(u,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield vr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n&&(c.e(this,n),n.bounds&&(this.tileBounds=new Hr(n.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new c.j(n))}})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.abort(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(n){return c._(this,void 0,void 0,function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(u,"Tile"),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};f.request.collectResourceTiming=this._collectResourceTiming;let g="RT";if(n.actor&&n.state!=="expired"){if(n.state==="loading")return new Promise((v,k)=>{n.reloadPromise={resolve:v,reject:k}})}else n.actor=this.dispatcher.getActor(),g="LT";n.abortController=new AbortController;try{const v=yield n.actor.sendAsync({type:g,data:f},n.abortController);if(delete n.abortController,n.aborted)return;this._afterTileLoadWorkerResponse(n,v)}catch(v){if(delete n.abortController,n.aborted)return;if(v&&v.status!==404)throw v;this._afterTileLoadWorkerResponse(n,null)}})}_afterTileLoadWorkerResponse(n,u){if(u&&u.resourceTiming&&(n.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&n.setExpiryData(u),n.loadVectorData(u,this.map.painter),n.reloadPromise){const f=n.reloadPromise;n.reloadPromise=null,this.loadTile(n).then(f.resolve).catch(f.reject)}}abortTile(n){return c._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.actor&&(yield n.actor.sendAsync({type:"AT",data:{uid:n.uid,type:this.type,source:this.id}}))})}unloadTile(n){return c._(this,void 0,void 0,function*(){n.unloadVectorData(),n.actor&&(yield n.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Bi extends c.E{constructor(n,u,f,g){super(),this.id=n,this.dispatcher=f,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},u),c.e(this,c.L(u,["url","scheme","tileSize"]))}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield vr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(c.e(this,n),n.bounds&&(this.tileBounds=new Hr(n.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new c.j(n))}})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}serialize(){return c.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n){return c._(this,void 0,void 0,function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.abortController=new AbortController;try{const f=yield K.getImage(this.map._requestManager.transformRequest(u,"Tile"),n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&f.cacheControl&&f.expires&&n.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const g=this.map.painter.context,v=g.gl,k=f.data;n.texture=this.map.painter.getTileTexture(k.width),n.texture?n.texture.update(k,{useMipmap:!0}):(n.texture=new Ot(g,k,v.RGBA,{useMipmap:!0}),n.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE,v.LINEAR_MIPMAP_NEAREST),g.extTextureFilterAnisotropic&&v.texParameterf(v.TEXTURE_2D,g.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,g.extTextureFilterAnisotropicMax)),n.state="loaded"}}catch(f){if(delete n.abortController,n.aborted)n.state="unloaded";else if(f)throw n.state="errored",f}})}abortTile(n){return c._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController)})}unloadTile(n){return c._(this,void 0,void 0,function*(){n.texture&&this.map.painter.saveTileTexture(n.texture)})}hasTransition(){return!1}}class nn extends Bi{constructor(n,u,f,g){super(n,u,f,g),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(n){return c._(this,void 0,void 0,function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(u,"Tile");n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.abortController=new AbortController;try{const g=yield K.getImage(f,n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(g&&g.data){const v=g.data;this.map._refreshExpiredTiles&&g.cacheControl&&g.expires&&n.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const k=c.b(v)&&c.S()?v:yield this.readImageNow(v),M={type:this.type,uid:n.uid,source:this.id,rawImageData:k,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!n.actor||n.state==="expired"){n.actor=this.dispatcher.getActor();const E=yield n.actor.sendAsync({type:"LDT",data:M});n.dem=E,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded"}}}catch(g){if(delete n.abortController,n.aborted)n.state="unloaded";else if(g)throw n.state="errored",g}})}readImageNow(n){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.U()){const u=n.width+2,f=n.height+2;try{return new c.R({width:u,height:f},yield c.V(n,-1,-1,u,f))}catch{}}return P.getImageData(n,1)})}_getNeighboringTiles(n){const u=n.canonical,f=Math.pow(2,u.z),g=(u.x-1+f)%f,v=u.x===0?n.wrap-1:n.wrap,k=(u.x+1+f)%f,M=u.x+1===f?n.wrap+1:n.wrap,E={};return E[new c.Q(n.overscaledZ,v,u.z,g,u.y).key]={backfilled:!1},E[new c.Q(n.overscaledZ,M,u.z,k,u.y).key]={backfilled:!1},u.y>0&&(E[new c.Q(n.overscaledZ,v,u.z,g,u.y-1).key]={backfilled:!1},E[new c.Q(n.overscaledZ,n.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},E[new c.Q(n.overscaledZ,M,u.z,k,u.y-1).key]={backfilled:!1}),u.y+1<f&&(E[new c.Q(n.overscaledZ,v,u.z,g,u.y+1).key]={backfilled:!1},E[new c.Q(n.overscaledZ,n.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},E[new c.Q(n.overscaledZ,M,u.z,k,u.y+1).key]={backfilled:!1}),E}unloadTile(n){return c._(this,void 0,void 0,function*(){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&(yield n.actor.sendAsync({type:"RDT",data:{type:this.type,uid:n.uid,source:this.id}}))})}}class Ke extends c.E{constructor(n,u,f,g){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=f.getActor(),this.setEventedParent(g),this._data=u.data,this._options=c.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const v=c.W/this.tileSize;this.workerOptions=c.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*v,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*v,extent:c.W,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:c.W,radius:(u.clusterRadius||50)*v,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData(),this}updateData(n){return this._updateWorkerData(n),this}getData(){return c._(this,void 0,void 0,function*(){const n=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:n})})}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=n.clusterRadius),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=n.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(n){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:n,source:this.id}})}getClusterChildren(n){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:n,source:this.id}})}getClusterLeaves(n,u,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:n,limit:u,offset:f}})}_updateWorkerData(n){return c._(this,void 0,void 0,function*(){const u=c.e({type:this.type},this.workerOptions);n?u.dataDiff=n:typeof this._data=="string"?(u.request=this.map._requestManager.transformRequest(P.resolveURL(this._data),"Source"),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const f=yield this.actor.sendAsync({type:"LD",data:u});if(this._pendingLoads--,this._removed||f.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let g=null;f.resourceTiming&&f.resourceTiming[this.id]&&(g=f.resourceTiming[this.id].slice(0));const v={dataType:"source"};this._collectResourceTiming&&g&&g.length>0&&c.e(v,{resourceTiming:g}),this.fire(new c.k("data",Object.assign(Object.assign({},v),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},v),{sourceDataType:"content"})))}catch(f){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(f))}})}loaded(){return this._pendingLoads===0}loadTile(n){return c._(this,void 0,void 0,function*(){const u=n.actor?"RT":"LT";n.actor=this.actor;const f={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.abortController=new AbortController;const g=yield this.actor.sendAsync({type:u,data:f},n.abortController);delete n.abortController,n.unloadVectorData(),n.aborted||n.loadVectorData(g,this.map.painter,u==="RT")})}abortTile(n){return c._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.aborted=!0})}unloadTile(n){return c._(this,void 0,void 0,function*(){n.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var li=c.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Vi extends c.E{constructor(n,u,f,g){super(),this.id=n,this.dispatcher=f,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=u}load(n){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield K.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,n&&(this.coordinates=n),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new c.j(u))}})}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=n.url,this.load(n.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(n){this.coordinates=n;const u=n.map(c.Y.fromLngLat);this.tileID=function(g){let v=1/0,k=1/0,M=-1/0,E=-1/0;for(const Z of g)v=Math.min(v,Z.x),k=Math.min(k,Z.y),M=Math.max(M,Z.x),E=Math.max(E,Z.y);const z=Math.max(M-v,E-k),F=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),R=Math.pow(2,F);return new c.a0(F,Math.floor((v+M)/2*R),Math.floor((k+E)/2*R))}(u),this.minzoom=this.maxzoom=this.tileID.z;const f=u.map(g=>this.tileID.getTilePoint(g)._round());return this._boundsArray=new c.Z,this._boundsArray.emplaceBack(f[0].x,f[0].y,0,0),this._boundsArray.emplaceBack(f[1].x,f[1].y,c.W,0),this._boundsArray.emplaceBack(f[3].x,f[3].y,0,c.W),this._boundsArray.emplaceBack(f[2].x,f[2].y,c.W,c.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,u=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,li.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Ot(n,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(const g in this.tiles){const v=this.tiles[g];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,f=!0)}f&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={}):n.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Ws extends Vi{constructor(n,u,f,g){super(n,u,f,g),this.roundZoom=!0,this.type="video",this.options=u}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const n=this.options;this.urls=[];for(const u of n.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield c.a2(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new c.j(u))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const u=this.video.seekable;n<u.start(0)||n>u.end(0)?this.fire(new c.j(new c.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,u=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,li.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new Ot(n,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(const g in this.tiles){const v=this.tiles[g];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,f=!0)}f&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class vo extends Vi{constructor(n,u,f,g){super(n,u,f,g),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(k=>typeof k!="number"))||this.fire(new c.j(new c.a1(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.a1(`sources.${n}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new c.j(new c.a1(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.a1(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.a1(`sources.${n}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,f=u.gl;this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,li.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ot(u,this.canvas,f.RGBA,{premultiply:!0});let g=!1;for(const v in this.tiles){const k=this.tiles[v];k.state!=="loaded"&&(k.state="loaded",k.texture=this.texture,g=!0)}g&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const Ys={},jn=y=>{switch(y){case"geojson":return Ke;case"image":return Vi;case"raster":return Bi;case"raster-dem":return nn;case"vector":return Et;case"video":return Ws;case"canvas":return vo}return Ys[y]},Ks="RTLPluginLoaded";class xo extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Ze()}_syncState(n){return this.status=n,this.dispatcher.broadcast("SRPS",{pluginStatus:n,pluginURL:this.url}).catch(u=>{throw this.status="error",u})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(n){return c._(this,arguments,void 0,function*(u,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=P.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.k(Ks))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Zt=null;function xr(){return Zt||(Zt=new xo),Zt}class br{constructor(n,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=c.a3(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const u=n+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,u,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(g,v){const k={};if(!v)return k;for(const M of g){const E=M.layerIds.map(z=>v.getLayer(z)).filter(Boolean);if(E.length!==0){M.layers=E,M.stateDependentLayerIds&&(M.stateDependentLayers=M.stateDependentLayerIds.map(z=>E.filter(F=>F.id===z)[0]));for(const z of E)k[z.id]=M}}return k}(n.buckets,u.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const v=this.buckets[g];if(v instanceof c.a5){if(this.hasSymbolBuckets=!0,!f)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const v=this.buckets[g];if(v instanceof c.a5&&v.hasRTLText){this.hasRTLText=!0,xr().lazyLoad();break}}this.queryPadding=0;for(const g in this.buckets){const v=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(g).queryRadius(v))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new c.a4}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const f in this.buckets){const g=this.buckets[f];g.uploadPending()&&g.upload(n)}const u=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ot(n,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ot(n,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,u,f,g,v,k,M,E,z,F){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:v,scale:k,tileSize:this.tileSize,pixelPosMatrix:F,transform:E,params:M,queryPadding:this.queryPadding*z},n,u,f):{}}querySourceFeatures(n,u){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const g=f.loadVTLayers(),v=u&&u.sourceLayer?u.sourceLayer:"",k=g._geojsonTileLayer||g[v];if(!k)return;const M=c.a6(u&&u.filter),{z:E,x:z,y:F}=this.tileID.canonical,R={z:E,x:z,y:F};for(let Z=0;Z<k.length;Z++){const X=k.feature(Z);if(M.needGeometry){const et=c.a7(X,!0);if(!M.filter(new c.a8(this.tileID.overscaledZ),et,this.tileID.canonical))continue}else if(!M.filter(new c.a8(this.tileID.overscaledZ),X))continue;const tt=f.getId(X,v),lt=new c.a9(X,E,z,F,tt);lt.tile=R,n.push(lt)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const u=this.expirationTime;if(n.cacheControl){const f=c.aa(n.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const f=Date.now();let g=!1;if(this.expirationTime>f)g=!1;else if(u)if(this.expirationTime<u)g=!0;else{const v=this.expirationTime-u;v?this.expirationTime=f+Math.max(v,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const g in this.buckets){if(!u.style.hasLayer(g))continue;const v=this.buckets[g],k=v.layers[0].sourceLayer||"_geojsonTileLayer",M=f[k],E=n[k];if(!M||!E||Object.keys(E).length===0)continue;v.update(E,M,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=u&&u.style&&u.style.getLayer(g);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<P.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=P.now()+n}setDependencies(n,u){const f={};for(const g of u)f[g]=!0;this.dependencies[n]=f}hasDependency(n,u){for(const f of n){const g=this.dependencies[f];if(g){for(const v of u)if(g[v])return!0}}return!1}}class Un{constructor(n,u){this.max=n,this.onRemove=u,this.reset()}reset(){for(const n in this.data)for(const u of this.data[n])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(n,u,f){const g=n.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const v={value:u,timeout:void 0};if(f!==void 0&&(v.timeout=setTimeout(()=>{this.remove(n,v)},f)),this.data[g].push(v),this.order.push(g),this.order.length>this.max){const k=this._getAndRemoveByKey(this.order[0]);k&&this.onRemove(k)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const u=this.data[n].shift();return u.timeout&&clearTimeout(u.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),u.value}getByKey(n){const u=this.data[n];return u?u[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,u){if(!this.has(n))return this;const f=n.wrapped().key,g=u===void 0?0:this.data[f].indexOf(u),v=this.data[f][g];return this.data[f].splice(g,1),v.timeout&&clearTimeout(v.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(v.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(n){const u=[];for(const f in this.data)for(const g of this.data[f])n(g.value)||u.push(g);for(const f of u)this.remove(f.value.tileID,f)}}class Hn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,u,f){const g=String(u);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][g]=this.stateChanges[n][g]||{},c.e(this.stateChanges[n][g],f),this.deletedStates[n]===null){this.deletedStates[n]={};for(const v in this.state[n])v!==g&&(this.deletedStates[n][v]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][g]===null){this.deletedStates[n][g]={};for(const v in this.state[n][g])f[v]||(this.deletedStates[n][g][v]=null)}else for(const v in f)this.deletedStates[n]&&this.deletedStates[n][g]&&this.deletedStates[n][g][v]===null&&delete this.deletedStates[n][g][v]}removeFeatureState(n,u,f){if(this.deletedStates[n]===null)return;const g=String(u);if(this.deletedStates[n]=this.deletedStates[n]||{},f&&u!==void 0)this.deletedStates[n][g]!==null&&(this.deletedStates[n][g]=this.deletedStates[n][g]||{},this.deletedStates[n][g][f]=null);else if(u!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][g])for(f in this.deletedStates[n][g]={},this.stateChanges[n][g])this.deletedStates[n][g][f]=null;else this.deletedStates[n][g]=null;else this.deletedStates[n]=null}getState(n,u){const f=String(u),g=c.e({},(this.state[n]||{})[f],(this.stateChanges[n]||{})[f]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const v=this.deletedStates[n][u];if(v===null)return{};for(const k in v)delete g[k]}return g}initializeTileState(n,u){n.setFeatureState(this.state,u)}coalesceChanges(n,u){const f={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const v={};for(const k in this.stateChanges[g])this.state[g][k]||(this.state[g][k]={}),c.e(this.state[g][k],this.stateChanges[g][k]),v[k]=this.state[g][k];f[g]=v}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const v={};if(this.deletedStates[g]===null)for(const k in this.state[g])v[k]={},this.state[g][k]={};else for(const k in this.deletedStates[g]){if(this.deletedStates[g][k]===null)this.state[g][k]={};else for(const M of Object.keys(this.deletedStates[g][k]))delete this.state[g][k][M];v[k]=this.state[g][k]}f[g]=f[g]||{},c.e(f[g],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const g in n)n[g].setFeatureState(f,u)}}class Ht extends c.E{constructor(n,u,f){super(),this.id=n,this.dispatcher=f,this.on("data",g=>this._dataHandler(g)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((g,v,k,M)=>{const E=new(jn(v.type))(g,v,k,M);if(E.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${E.id}`);return E})(n,u,f,this),this._tiles={},this._cache=new Un(0,g=>this._unloadTile(g)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Hn,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n in this._tiles){const u=this._tiles[n];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,u,f){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(n),this._tileLoaded(n,u,f)}catch(g){n.state="errored",g.status!==404?this._source.fire(new c.j(g,{tile:n})):this.update(this.transform,this.terrain)}})}_unloadTile(n){this._source.unloadTile&&this._source.unloadTile(n)}_abortTile(n){this._source.abortTile&&this._source.abortTile(n),this._source.fire(new c.k("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const f=this._tiles[u];f.upload(n),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(De).map(n=>n.key)}getRenderableIds(n){const u=[];for(const f in this._tiles)this._isIdRenderable(f,n)&&u.push(this._tiles[f]);return n?u.sort((f,g)=>{const v=f.tileID,k=g.tileID,M=new c.P(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),E=new c.P(k.canonical.x,k.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-k.overscaledZ||E.y-M.y||E.x-M.x}).map(f=>f.tileID.key):u.map(f=>f.tileID).sort(De).map(f=>f.key)}hasRenderableParent(n){const u=this.findLoadedParent(n,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(n,u){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(u||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")}}_reloadTile(n,u){return c._(this,void 0,void 0,function*(){const f=this._tiles[n];f&&(f.state!=="loading"&&(f.state=u),yield this._loadTile(f,n,u))})}_tileLoaded(n,u,f){n.timeAdded=P.now(),f==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(u,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const u=this.getRenderableIds();for(let g=0;g<u.length;g++){const v=u[g];if(n.neighboringTiles&&n.neighboringTiles[v]){const k=this.getTileByID(v);f(n,k),f(k,n)}}function f(g,v){g.needsHillshadePrepare=!0,g.needsTerrainPrepare=!0;let k=v.tileID.canonical.x-g.tileID.canonical.x;const M=v.tileID.canonical.y-g.tileID.canonical.y,E=Math.pow(2,g.tileID.canonical.z),z=v.tileID.key;k===0&&M===0||Math.abs(M)>1||(Math.abs(k)>1&&(Math.abs(k+E)===1?k+=E:Math.abs(k-E)===1&&(k-=E)),v.dem&&g.dem&&(g.dem.backfillBorder(v.dem,k,M),g.neighboringTiles&&g.neighboringTiles[z]&&(g.neighboringTiles[z].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,u,f,g){for(const v in this._tiles){let k=this._tiles[v];if(g[v]||!k.hasData()||k.tileID.overscaledZ<=u||k.tileID.overscaledZ>f)continue;let M=k.tileID;for(;k&&k.tileID.overscaledZ>u+1;){const z=k.tileID.scaledTo(k.tileID.overscaledZ-1);k=this._tiles[z.key],k&&k.hasData()&&(M=z)}let E=M;for(;E.overscaledZ>u;)if(E=E.scaledTo(E.overscaledZ-1),n[E.key]){g[M.key]=M;break}}}findLoadedParent(n,u){if(n.key in this._loadedParentTiles){const f=this._loadedParentTiles[n.key];return f&&f.tileID.overscaledZ>=u?f:null}for(let f=n.overscaledZ-1;f>=u;f--){const g=n.scaledTo(f),v=this._getLoadedTile(g);if(v)return v}}findLoadedSibling(n){return this._getLoadedTile(n)}_getLoadedTile(n){const u=this._tiles[n.key];return u&&u.hasData()?u:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const u=Math.ceil(n.width/this._source.tileSize)+1,f=Math.ceil(n.height/this._source.tileSize)+1,g=Math.floor(u*f*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(v)}handleWrapJump(n){const u=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,u){const f={};for(const g in this._tiles){const v=this._tiles[g];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+u),f[v.tileID.key]=v}this._tiles=f;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(g,this._tiles[g])}}_updateCoveredAndRetainedTiles(n,u,f,g,v,k){const M={},E={},z=Object.keys(n),F=P.now();for(const R of z){const Z=n[R],X=this._tiles[R];if(!X||X.fadeEndTime!==0&&X.fadeEndTime<=F)continue;const tt=this.findLoadedParent(Z,u),lt=this.findLoadedSibling(Z),et=tt||lt||null;et&&(this._addTile(et.tileID),M[et.tileID.key]=et.tileID),E[R]=Z}this._retainLoadedChildren(E,g,f,n);for(const R in M)n[R]||(this._coveredTiles[R]=!0,n[R]=M[R]);if(k){const R={},Z={};for(const X of v)this._tiles[X.key].hasData()?R[X.key]=X:Z[X.key]=X;for(const X in Z){const tt=Z[X].children(this._source.maxzoom);this._tiles[tt[0].key]&&this._tiles[tt[1].key]&&this._tiles[tt[2].key]&&this._tiles[tt[3].key]&&(R[tt[0].key]=n[tt[0].key]=tt[0],R[tt[1].key]=n[tt[1].key]=tt[1],R[tt[2].key]=n[tt[2].key]=tt[2],R[tt[3].key]=n[tt[3].key]=tt[3],delete Z[X])}for(const X in Z){const tt=Z[X],lt=this.findLoadedParent(tt,this._source.minzoom),et=this.findLoadedSibling(tt),ut=lt||et||null;if(ut){R[ut.tileID.key]=n[ut.tileID.key]=ut.tileID;for(const gt in R)R[gt].isChildOf(ut.tileID)&&delete R[gt]}}for(const X in this._tiles)R[X]||(this._coveredTiles[X]=!0)}}update(n,u){if(!this._sourceLoaded||this._paused)return;let f;this.transform=n,this.terrain=u,this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(F=>new c.Q(F.canonical.z,F.wrap,F.canonical.z,F.canonical.x,F.canonical.y)):(f=n.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u}),this._source.hasTile&&(f=f.filter(F=>this._source.hasTile(F)))):f=[];const g=n.coveringZoomLevel(this._source),v=Math.max(g-Ht.maxOverzooming,this._source.minzoom),k=Math.max(g+Ht.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const F={};for(const R of f)if(R.canonical.z>this._source.minzoom){const Z=R.scaledTo(R.canonical.z-1);F[Z.key]=Z;const X=R.scaledTo(Math.max(this._source.minzoom,Math.min(R.canonical.z,5)));F[X.key]=X}f=f.concat(Object.values(F))}const M=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,M&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const E=this._updateRetainedTiles(f,g);Pe(this._source.type)&&this._updateCoveredAndRetainedTiles(E,v,k,g,f,u);for(const F in E)this._tiles[F].clearFadeHold();const z=c.ab(this._tiles,E);for(const F of z){const R=this._tiles[F];R.hasSymbolBuckets&&!R.holdingForFade()?R.setHoldDuration(this.map._fadeDuration):R.hasSymbolBuckets&&!R.symbolFadeFinished()||this._removeTile(F)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,u){var f;const g={},v={},k=Math.max(u-Ht.maxOverzooming,this._source.minzoom),M=Math.max(u+Ht.maxUnderzooming,this._source.minzoom),E={};for(const z of n){const F=this._addTile(z);g[z.key]=z,F.hasData()||u<this._source.maxzoom&&(E[z.key]=z)}this._retainLoadedChildren(E,u,M,g);for(const z of n){let F=this._tiles[z.key];if(F.hasData())continue;if(u+1>this._source.maxzoom){const Z=z.children(this._source.maxzoom)[0],X=this.getTile(Z);if(X&&X.hasData()){g[Z.key]=Z;continue}}else{const Z=z.children(this._source.maxzoom);if(g[Z[0].key]&&g[Z[1].key]&&g[Z[2].key]&&g[Z[3].key])continue}let R=F.wasRequested();for(let Z=z.overscaledZ-1;Z>=k;--Z){const X=z.scaledTo(Z);if(v[X.key])break;if(v[X.key]=!0,F=this.getTile(X),!F&&R&&(F=this._addTile(X)),F){const tt=F.hasData();if((tt||!(!((f=this.map)===null||f===void 0)&&f.cancelPendingTileRequestsWhileZooming)||R)&&(g[X.key]=X),R=F.wasRequested(),tt)break}}}return g}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const u=[];let f,g=this._tiles[n].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){f=this._loadedParentTiles[g.key];break}u.push(g.key);const v=g.scaledTo(g.overscaledZ-1);if(f=this._getLoadedTile(v),f)break;g=v}for(const v of u)this._loadedParentTiles[v]=f}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const n in this._tiles){const u=this._tiles[n].tileID,f=this._getLoadedTile(u);this._loadedSiblingTiles[u.key]=f}}_addTile(n){let u=this._tiles[n.key];if(u)return u;u=this._cache.getAndRemove(n),u&&(this._setTileReloadTimer(n.key,u),u.tileID=n,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,u)));const f=u;return u||(u=new br(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(u,n.key,u.state)),u.uses++,this._tiles[n.key]=u,f||this._source.fire(new c.k("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(n,u){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const f=u.getExpiryTimeout();f&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},f))}_removeTile(n){const u=this._tiles[n];u&&(u.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(n){const u=n.sourceDataType;n.dataType==="source"&&u==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&n.dataType==="source"&&u==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,u,f){const g=[],v=this.transform;if(!v)return g;const k=f?v.getCameraQueryGeometry(n):n,M=n.map(tt=>v.pointCoordinate(tt,this.terrain)),E=k.map(tt=>v.pointCoordinate(tt,this.terrain)),z=this.getIds();let F=1/0,R=1/0,Z=-1/0,X=-1/0;for(const tt of E)F=Math.min(F,tt.x),R=Math.min(R,tt.y),Z=Math.max(Z,tt.x),X=Math.max(X,tt.y);for(let tt=0;tt<z.length;tt++){const lt=this._tiles[z[tt]];if(lt.holdingForFade())continue;const et=lt.tileID,ut=Math.pow(2,v.zoom-lt.tileID.overscaledZ),gt=u*lt.queryPadding*c.W/lt.tileSize/ut,ot=[et.getTilePoint(new c.Y(F,R)),et.getTilePoint(new c.Y(Z,X))];if(ot[0].x-gt<c.W&&ot[0].y-gt<c.W&&ot[1].x+gt>=0&&ot[1].y+gt>=0){const _t=M.map(Ct=>et.getTilePoint(Ct)),kt=E.map(Ct=>et.getTilePoint(Ct));g.push({tile:lt,tileID:et,queryGeometry:_t,cameraQueryGeometry:kt,scale:ut})}}return g}getVisibleCoordinates(n){const u=this.getRenderableIds(n).map(f=>this._tiles[f].tileID);for(const f of u)f.posMatrix=this.transform.calculatePosMatrix(f.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(Pe(this._source.type)){const n=P.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=n)return!0}return!1}setFeatureState(n,u,f){this._state.updateState(n=n||"_geojsonTileLayer",u,f)}removeFeatureState(n,u,f){this._state.removeFeatureState(n=n||"_geojsonTileLayer",u,f)}getFeatureState(n,u){return this._state.getState(n=n||"_geojsonTileLayer",u)}setDependencies(n,u,f){const g=this._tiles[n];g&&g.setDependencies(u,f)}reloadTilesForDependencies(n,u){for(const f in this._tiles)this._tiles[f].hasDependency(n,u)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(n,u))}}function De(y,n){const u=Math.abs(2*y.wrap)-+(y.wrap<0),f=Math.abs(2*n.wrap)-+(n.wrap<0);return y.overscaledZ-n.overscaledZ||f-u||n.canonical.y-y.canonical.y||n.canonical.x-y.canonical.x}function Pe(y){return y==="raster"||y==="image"||y==="video"}Ht.maxOverzooming=10,Ht.maxUnderzooming=3;class wr{constructor(n,u){this.reset(n,u)}reset(n,u){this.points=n||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=c.ac(n,0,1);let u=1,f=this._distances[u];const g=n*this.paddedLength+this.padding;for(;f<g&&u<this._distances.length;)f=this._distances[++u];const v=u-1,k=this._distances[v],M=f-k,E=M>0?(g-k)/M:0;return this.points[v].mult(1-E).add(this.points[u].mult(E))}}function Sr(y,n){let u=!0;return y==="always"||y!=="never"&&n!=="never"||(u=!1),u}class Me{constructor(n,u,f){const g=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(n/f),this.yCellCount=Math.ceil(u/f);for(let k=0;k<this.xCellCount*this.yCellCount;k++)g.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=u,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,u,f,g,v){this._forEachCell(u,f,g,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(v)}insertCircle(n,u,f,g){this._forEachCell(u-g,f-g,u+g,f+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(u),this.circles.push(f),this.circles.push(g)}_insertBoxCell(n,u,f,g,v,k){this.boxCells[v].push(k)}_insertCircleCell(n,u,f,g,v,k){this.circleCells[v].push(k)}_query(n,u,f,g,v,k,M){if(f<0||n>this.width||g<0||u>this.height)return[];const E=[];if(n<=0&&u<=0&&this.width<=f&&this.height<=g){if(v)return[{key:null,x1:n,y1:u,x2:f,y2:g}];for(let z=0;z<this.boxKeys.length;z++)E.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const F=this.circles[3*z],R=this.circles[3*z+1],Z=this.circles[3*z+2];E.push({key:this.circleKeys[z],x1:F-Z,y1:R-Z,x2:F+Z,y2:R+Z})}}else this._forEachCell(n,u,f,g,this._queryCell,E,{hitTest:v,overlapMode:k,seenUids:{box:{},circle:{}}},M);return E}query(n,u,f,g){return this._query(n,u,f,g,!1,null)}hitTest(n,u,f,g,v,k){return this._query(n,u,f,g,!0,v,k).length>0}hitTestCircle(n,u,f,g,v){const k=n-f,M=n+f,E=u-f,z=u+f;if(M<0||k>this.width||z<0||E>this.height)return!1;const F=[];return this._forEachCell(k,E,M,z,this._queryCellCircle,F,{hitTest:!0,overlapMode:g,circle:{x:n,y:u,radius:f},seenUids:{box:{},circle:{}}},v),F.length>0}_queryCell(n,u,f,g,v,k,M,E){const{seenUids:z,hitTest:F,overlapMode:R}=M,Z=this.boxCells[v];if(Z!==null){const tt=this.bboxes;for(const lt of Z)if(!z.box[lt]){z.box[lt]=!0;const et=4*lt,ut=this.boxKeys[lt];if(n<=tt[et+2]&&u<=tt[et+3]&&f>=tt[et+0]&&g>=tt[et+1]&&(!E||E(ut))&&(!F||!Sr(R,ut.overlapMode))&&(k.push({key:ut,x1:tt[et],y1:tt[et+1],x2:tt[et+2],y2:tt[et+3]}),F))return!0}}const X=this.circleCells[v];if(X!==null){const tt=this.circles;for(const lt of X)if(!z.circle[lt]){z.circle[lt]=!0;const et=3*lt,ut=this.circleKeys[lt];if(this._circleAndRectCollide(tt[et],tt[et+1],tt[et+2],n,u,f,g)&&(!E||E(ut))&&(!F||!Sr(R,ut.overlapMode))){const gt=tt[et],ot=tt[et+1],_t=tt[et+2];if(k.push({key:ut,x1:gt-_t,y1:ot-_t,x2:gt+_t,y2:ot+_t}),F)return!0}}}return!1}_queryCellCircle(n,u,f,g,v,k,M,E){const{circle:z,seenUids:F,overlapMode:R}=M,Z=this.boxCells[v];if(Z!==null){const tt=this.bboxes;for(const lt of Z)if(!F.box[lt]){F.box[lt]=!0;const et=4*lt,ut=this.boxKeys[lt];if(this._circleAndRectCollide(z.x,z.y,z.radius,tt[et+0],tt[et+1],tt[et+2],tt[et+3])&&(!E||E(ut))&&!Sr(R,ut.overlapMode))return k.push(!0),!0}}const X=this.circleCells[v];if(X!==null){const tt=this.circles;for(const lt of X)if(!F.circle[lt]){F.circle[lt]=!0;const et=3*lt,ut=this.circleKeys[lt];if(this._circlesCollide(tt[et],tt[et+1],tt[et+2],z.x,z.y,z.radius)&&(!E||E(ut))&&!Sr(R,ut.overlapMode))return k.push(!0),!0}}}_forEachCell(n,u,f,g,v,k,M,E){const z=this._convertToXCellCoord(n),F=this._convertToYCellCoord(u),R=this._convertToXCellCoord(f),Z=this._convertToYCellCoord(g);for(let X=z;X<=R;X++)for(let tt=F;tt<=Z;tt++)if(v.call(this,n,u,f,g,this.xCellCount*tt+X,k,M,E))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,u,f,g,v,k){const M=g-n,E=v-u,z=f+k;return z*z>M*M+E*E}_circleAndRectCollide(n,u,f,g,v,k,M){const E=(k-g)/2,z=Math.abs(n-(g+E));if(z>E+f)return!1;const F=(M-v)/2,R=Math.abs(u-(v+F));if(R>F+f)return!1;if(z<=E||R<=F)return!0;const Z=z-E,X=R-F;return Z*Z+X*X<=f*f}}function Zn(y,n,u,f,g){const v=c.F();return n?(c.J(v,v,[1/g,1/g,1]),u||c.ad(v,v,f.angle)):c.K(v,f.labelPlaneMatrix,y),v}function qn(y,n,u,f,g){if(n){const v=c.ae(y);return c.J(v,v,[g,g,1]),u||c.ad(v,v,-f.angle),v}return f.glCoordMatrix}function qi(y,n,u){let f;u?(f=[y.x,y.y,u(y.x,y.y),1],c.af(f,f,n)):(f=[y.x,y.y,0,1],function(v,k,M){const E=k[0],z=k[1];v[0]=M[0]*E+M[4]*z+M[12],v[1]=M[1]*E+M[5]*z+M[13],v[3]=M[3]*E+M[7]*z+M[15]}(f,f,n));const g=f[3];return{point:new c.P(f[0]/g,f[1]/g),signedDistanceFromCamera:g,isOccluded:!1}}function rt(y,n){return .5+y/n*.5}function B(y,n){return y.x>=-n[0]&&y.x<=n[0]&&y.y>=-n[1]&&y.y<=n[1]}function N(y,n,u,f,g,v,k,M,E,z,F,R,Z,X,tt){const lt=f?y.textSizeData:y.iconSizeData,et=c.ag(lt,u.transform.zoom),ut=[256/u.width*2+1,256/u.height*2+1],gt=f?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;gt.clear();const ot=y.lineVertexArray,_t=f?y.text.placedSymbolArray:y.icon.placedSymbolArray,kt=u.transform.width/u.transform.height;let Ct=!1;for(let Dt=0;Dt<_t.length;Dt++){const jt=_t.get(Dt);if(jt.hidden||jt.writingMode===c.ah.vertical&&!Ct){de(jt.numGlyphs,gt);continue}Ct=!1;const ie=qi(new c.P(jt.anchorX,jt.anchorY),n,tt);if(!B(ie.point,ut)){de(jt.numGlyphs,gt);continue}const ne=rt(u.transform.cameraToCenterDistance,ie.signedDistanceFromCamera),Ut=c.ai(lt,et,jt),qt=k?Ut/ne:Ut*ne,ce={getElevation:tt,labelPlaneMatrix:g,lineVertexArray:ot,pitchWithMap:k,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:z,tileAnchorPoint:new c.P(jt.anchorX,jt.anchorY),unwrappedTileID:F,width:R,height:Z,translation:X},Ce=dt(ce,jt,qt,!1,M,n,v,y.glyphOffsetArray,gt,kt,E);Ct=Ce.useVertical,(Ce.notEnoughRoom||Ct||Ce.needsFlipping&&dt(ce,jt,qt,!0,M,n,v,y.glyphOffsetArray,gt,kt,E).notEnoughRoom)&&de(jt.numGlyphs,gt)}f?y.text.dynamicLayoutVertexBuffer.updateData(gt):y.icon.dynamicLayoutVertexBuffer.updateData(gt)}function G(y,n,u,f,g,v,k,M){const E=v.glyphStartIndex+v.numGlyphs,z=v.lineStartIndex,F=v.lineStartIndex+v.lineLength,R=n.getoffsetX(v.glyphStartIndex),Z=n.getoffsetX(E-1),X=At(y*R,u,f,g,v.segment,z,F,M,k);if(!X)return null;const tt=At(y*Z,u,f,g,v.segment,z,F,M,k);return tt?M.projectionCache.anyProjectionOccluded?null:{first:X,last:tt}:null}function st(y,n,u,f){return y===c.ah.horizontal&&Math.abs(u.y-n.y)>Math.abs(u.x-n.x)*f?{useVertical:!0}:(y===c.ah.vertical?n.y<u.y:n.x>u.x)?{needsFlipping:!0}:null}function dt(y,n,u,f,g,v,k,M,E,z,F){const R=u/24,Z=n.lineOffsetX*R,X=n.lineOffsetY*R;let tt;if(n.numGlyphs>1){const lt=n.glyphStartIndex+n.numGlyphs,et=n.lineStartIndex,ut=n.lineStartIndex+n.lineLength,gt=G(R,M,Z,X,f,n,F,y);if(!gt)return{notEnoughRoom:!0};const ot=qi(gt.first.point,k,y.getElevation).point,_t=qi(gt.last.point,k,y.getElevation).point;if(g&&!f){const kt=st(n.writingMode,ot,_t,z);if(kt)return kt}tt=[gt.first];for(let kt=n.glyphStartIndex+1;kt<lt-1;kt++)tt.push(At(R*M.getoffsetX(kt),Z,X,f,n.segment,et,ut,y,F));tt.push(gt.last)}else{if(g&&!f){const et=qi(y.tileAnchorPoint,v,y.getElevation).point,ut=n.lineStartIndex+n.segment+1,gt=new c.P(y.lineVertexArray.getx(ut),y.lineVertexArray.gety(ut)),ot=qi(gt,v,y.getElevation),_t=ot.signedDistanceFromCamera>0?ot.point:function(Ct,Dt,jt,ie,ne,Ut){return yt(Ct,Dt,jt,1,ne,Ut)}(y.tileAnchorPoint,gt,et,0,v,y),kt=st(n.writingMode,et,_t,z);if(kt)return kt}const lt=At(R*M.getoffsetX(n.glyphStartIndex),Z,X,f,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,y,F);if(!lt||y.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};tt=[lt]}for(const lt of tt)c.aj(E,lt.point,lt.angle);return{}}function yt(y,n,u,f,g,v){const k=y.add(y.sub(n)._unit()),M=g!==void 0?qi(k,g,v.getElevation).point:ht(k.x,k.y,v).point,E=u.sub(M);return u.add(E._mult(f/E.mag()))}function bt(y,n,u){const f=n.projectionCache;if(f.projections[y])return f.projections[y];const g=new c.P(n.lineVertexArray.getx(y),n.lineVertexArray.gety(y)),v=ht(g.x,g.y,n);if(v.signedDistanceFromCamera>0)return f.projections[y]=v.point,f.anyProjectionOccluded=f.anyProjectionOccluded||v.isOccluded,v.point;const k=y-u.direction;return function(M,E,z,F,R){return yt(M,E,z,F,void 0,R)}(u.distanceFromAnchor===0?n.tileAnchorPoint:new c.P(n.lineVertexArray.getx(k),n.lineVertexArray.gety(k)),g,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,n)}function ht(y,n,u){const f=y+u.translation[0],g=n+u.translation[1];let v;return!u.pitchWithMap&&u.projection.useSpecialProjectionForSymbols?(v=u.projection.projectTileCoordinates(f,g,u.unwrappedTileID,u.getElevation),v.point.x=(.5*v.point.x+.5)*u.width,v.point.y=(.5*-v.point.y+.5)*u.height):(v=qi(new c.P(f,g),u.labelPlaneMatrix,u.getElevation),v.isOccluded=!1),v}function St(y,n,u){return y._unit()._perp()._mult(n*u)}function Bt(y,n,u,f,g,v,k,M,E){if(M.projectionCache.offsets[y])return M.projectionCache.offsets[y];const z=u.add(n);if(y+E.direction<f||y+E.direction>=g)return M.projectionCache.offsets[y]=z,z;const F=bt(y+E.direction,M,E),R=St(F.sub(u),k,E.direction),Z=u.add(R),X=F.add(R);return M.projectionCache.offsets[y]=c.ak(v,z,Z,X)||z,M.projectionCache.offsets[y]}function At(y,n,u,f,g,v,k,M,E){const z=f?y-n:y+n;let F=z>0?1:-1,R=0;f&&(F*=-1,R=Math.PI),F<0&&(R+=Math.PI);let Z,X=F>0?v+g:v+g+1;M.projectionCache.cachedAnchorPoint?Z=M.projectionCache.cachedAnchorPoint:(Z=ht(M.tileAnchorPoint.x,M.tileAnchorPoint.y,M).point,M.projectionCache.cachedAnchorPoint=Z);let tt,lt,et=Z,ut=Z,gt=0,ot=0;const _t=Math.abs(z),kt=[];let Ct;for(;gt+ot<=_t;){if(X+=F,X<v||X>=k)return null;gt+=ot,ut=et,lt=tt;const ie={absOffsetX:_t,direction:F,distanceFromAnchor:gt,previousVertex:ut};if(et=bt(X,M,ie),u===0)kt.push(ut),Ct=et.sub(ut);else{let ne;const Ut=et.sub(ut);ne=Ut.mag()===0?St(bt(X+F,M,ie).sub(et),u,F):St(Ut,u,F),lt||(lt=ut.add(ne)),tt=Bt(X,ne,et,v,k,lt,u,M,ie),kt.push(lt),Ct=tt.sub(lt)}ot=Ct.mag()}const Dt=Ct._mult((_t-gt)/ot)._add(lt||ut),jt=R+Math.atan2(et.y-ut.y,et.x-ut.x);return kt.push(Dt),{point:Dt,angle:E?jt:0,path:kt}}const It=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function de(y,n){for(let u=0;u<y;u++){const f=n.length;n.resize(f+4),n.float32.set(It,3*f)}}const fe=100;class Fe{constructor(n,u,f=new Me(n.width+200,n.height+200,25),g=new Me(n.width+200,n.height+200,25)){this.transform=n,this.mapProjection=u,this.grid=f,this.ignoredGrid=g,this.pitchFactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+fe,this.screenBottomBoundary=n.height+fe,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,u,f,g,v,k,M,E,z,F,R){const Z=n.anchorPointX+E[0],X=n.anchorPointY+E[1],tt=this.projectAndGetPerspectiveRatio(g,Z,X,v,F),lt=this._projectCollisionBox(n,f,g,v,k,M,E,tt,F,R),[et,ut,gt,ot]=lt.box;return this.mapProjection.useSpecialProjectionForSymbols&&(k?lt.allPointsOccluded:this.mapProjection.isOccluded(Z,X,v))||tt.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(et,ut,gt,ot)||u!=="always"&&this.grid.hitTest(et,ut,gt,ot,u,z)?{box:[et,ut,gt,ot],placeable:!1,offscreen:!1}:{box:[et,ut,gt,ot],placeable:!0,offscreen:this.isOffscreen(et,ut,gt,ot)}}placeCollisionCircles(n,u,f,g,v,k,M,E,z,F,R,Z,X,tt,lt,et){const ut=[],gt=new c.P(u.anchorX,u.anchorY),ot=this.getPerspectiveRatio(k,gt.x,gt.y,M,et),_t=(R?v/ot:v*ot)/c.ap,kt={getElevation:et,labelPlaneMatrix:E,lineVertexArray:f,pitchWithMap:R,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:gt,unwrappedTileID:M,width:this.transform.width,height:this.transform.height,translation:lt},Ct=G(_t,g,u.lineOffsetX*_t,u.lineOffsetY*_t,!1,u,!1,kt);let Dt=!1,jt=!1,ie=!0;if(Ct){const ne=.5*X*ot+tt,Ut=new c.P(-100,-100),qt=new c.P(this.screenRightBoundary,this.screenBottomBoundary),ce=new wr,Ce=Ct.first,Wt=Ct.last;let Xt=[];for(let Re=Ce.path.length-1;Re>=1;Re--)Xt.push(Ce.path[Re]);for(let Re=1;Re<Wt.path.length;Re++)Xt.push(Wt.path[Re]);const Te=2.5*ne;if(z){const Re=this.projectPathToScreenSpace(Xt,kt,z);Xt=Re.some(je=>je.signedDistanceFromCamera<=0)?[]:Re.map(je=>je.point)}let _i=[];if(Xt.length>0){const Re=Xt[0].clone(),je=Xt[0].clone();for(let vi=1;vi<Xt.length;vi++)Re.x=Math.min(Re.x,Xt[vi].x),Re.y=Math.min(Re.y,Xt[vi].y),je.x=Math.max(je.x,Xt[vi].x),je.y=Math.max(je.y,Xt[vi].y);_i=Re.x>=Ut.x&&je.x<=qt.x&&Re.y>=Ut.y&&je.y<=qt.y?[Xt]:je.x<Ut.x||Re.x>qt.x||je.y<Ut.y||Re.y>qt.y?[]:c.al([Xt],Ut.x,Ut.y,qt.x,qt.y)}for(const Re of _i){ce.reset(Re,.25*ne);let je=0;je=ce.length<=.5*ne?1:Math.ceil(ce.paddedLength/Te)+1;for(let vi=0;vi<je;vi++){const Dr=vi/Math.max(je-1,1),Yn=ce.lerp(Dr),xi=Yn.x+fe,on=Yn.y+fe;ut.push(xi,on,ne,0);const Yr=xi-ne,Lr=on-ne,Rr=xi+ne,Kn=on+ne;if(ie=ie&&this.isOffscreen(Yr,Lr,Rr,Kn),jt=jt||this.isInsideGrid(Yr,Lr,Rr,Kn),n!=="always"&&this.grid.hitTestCircle(xi,on,ne,n,Z)&&(Dt=!0,!F))return{circles:[],offscreen:!1,collisionDetected:Dt}}}}return{circles:!F&&Dt||!jt||ot<this.perspectiveRatioCutoff?[]:ut,offscreen:ie,collisionDetected:Dt}}projectPathToScreenSpace(n,u,f){return n.map(g=>qi(g,f,u.getElevation))}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let f=1/0,g=1/0,v=-1/0,k=-1/0;for(const F of n){const R=new c.P(F.x+fe,F.y+fe);f=Math.min(f,R.x),g=Math.min(g,R.y),v=Math.max(v,R.x),k=Math.max(k,R.y),u.push(R)}const M=this.grid.query(f,g,v,k).concat(this.ignoredGrid.query(f,g,v,k)),E={},z={};for(const F of M){const R=F.key;if(E[R.bucketInstanceId]===void 0&&(E[R.bucketInstanceId]={}),E[R.bucketInstanceId][R.featureIndex])continue;const Z=[new c.P(F.x1,F.y1),new c.P(F.x2,F.y1),new c.P(F.x2,F.y2),new c.P(F.x1,F.y2)];c.am(u,Z)&&(E[R.bucketInstanceId][R.featureIndex]=!0,z[R.bucketInstanceId]===void 0&&(z[R.bucketInstanceId]=[]),z[R.bucketInstanceId].push(R.featureIndex))}return z}insertCollisionBox(n,u,f,g,v,k){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:v,collisionGroupID:k,overlapMode:u},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,u,f,g,v,k){const M=f?this.ignoredGrid:this.grid,E={bucketInstanceId:g,featureIndex:v,collisionGroupID:k,overlapMode:u};for(let z=0;z<n.length;z+=4)M.insertCircle(E,n[z],n[z+1],n[z+2])}projectAndGetPerspectiveRatio(n,u,f,g,v){const k=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(u,f,g,v):qi(new c.P(u,f),n,v);return{point:new c.P((k.point.x+1)/2*this.transform.width+fe,(1-k.point.y)/2*this.transform.height+fe),perspectiveRatio:.5+this.transform.cameraToCenterDistance/k.signedDistanceFromCamera*.5,isOccluded:k.isOccluded,signedDistanceFromCamera:k.signedDistanceFromCamera}}getPerspectiveRatio(n,u,f,g,v){const k=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(u,f,g,v):qi(new c.P(u,f),n,v);return .5+this.transform.cameraToCenterDistance/k.signedDistanceFromCamera*.5}isOffscreen(n,u,f,g){return f<fe||n>=this.screenRightBoundary||g<fe||u>this.screenBottomBoundary}isInsideGrid(n,u,f,g){return f>=0&&n<this.gridRightBoundary&&g>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const n=c.an([]);return c.H(n,n,[-100,-100,0]),n}_projectCollisionBox(n,u,f,g,v,k,M,E,z,F){const R=u*E.perspectiveRatio;let Z=new c.P(1,0),X=new c.P(0,1);const tt=new c.P(n.anchorPointX+M[0],n.anchorPointY+M[1]);if(k&&!v){const ne=this.projectAndGetPerspectiveRatio(f,tt.x+1,tt.y,g,z).point.sub(E.point).unit(),Ut=Math.atan(ne.y/ne.x)+(ne.x<0?Math.PI:0),qt=Math.sin(Ut),ce=Math.cos(Ut);Z=new c.P(ce,qt),X=new c.P(-qt,ce)}else if(!k&&v){const ne=-this.transform.angle,Ut=Math.sin(ne),qt=Math.cos(ne);Z=new c.P(qt,Ut),X=new c.P(-Ut,qt)}let lt=E.point,et=R;if(v){lt=tt;const ne=this.transform.zoom-Math.floor(this.transform.zoom);et=Math.pow(2,-ne),et*=this.mapProjection.getPitchedTextCorrection(this.transform,tt,g),F||(et*=c.ac(.5+E.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}F&&(lt=lt.add(Z.mult(F.x*et)).add(X.mult(F.y*et)));const ut=n.x1*et,gt=n.x2*et,ot=(ut+gt)/2,_t=n.y1*et,kt=n.y2*et,Ct=(_t+kt)/2,Dt=[{offsetX:ut,offsetY:_t},{offsetX:ot,offsetY:_t},{offsetX:gt,offsetY:_t},{offsetX:gt,offsetY:Ct},{offsetX:gt,offsetY:kt},{offsetX:ot,offsetY:kt},{offsetX:ut,offsetY:kt},{offsetX:ut,offsetY:Ct}];let jt=[];for(const{offsetX:ne,offsetY:Ut}of Dt)jt.push(new c.P(lt.x+Z.x*ne+X.x*Ut,lt.y+Z.y*ne+X.y*Ut));let ie=!1;if(v){const ne=jt.map(Ut=>this.projectAndGetPerspectiveRatio(f,Ut.x,Ut.y,g,z));ie=ne.some(Ut=>!Ut.isOccluded),jt=ne.map(Ut=>Ut.point)}else ie=!0;return{box:c.ao(jt),allPointsOccluded:!ie}}}function ke(y,n,u){return n*(c.W/(y.tileSize*Math.pow(2,u-y.tileID.overscaledZ)))}class Ne{constructor(n,u,f,g){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?u:-u))):g&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class ei{constructor(n,u,f,g,v){this.text=new Ne(n?n.text:null,u,f,v),this.icon=new Ne(n?n.icon:null,u,g,v)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ui{constructor(n,u,f){this.text=n,this.icon=u,this.skipFade=f}}class Ai{constructor(){this.invProjMatrix=c.F(),this.viewportMatrix=c.F(),this.circles=[]}}class Ie{constructor(n,u,f,g,v){this.bucketInstanceId=n,this.featureIndex=u,this.sourceLayerIndex=f,this.bucketIndex=g,this.tileID=v}}class ii{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const u=++this.maxGroupID;this.collisionGroups[n]={ID:u,predicate:f=>f.collisionGroupID===u}}return this.collisionGroups[n]}}function bi(y,n,u,f,g){const{horizontalAlign:v,verticalAlign:k}=c.au(y);return new c.P(-(v-.5)*n+f[0]*g,-(k-.5)*u+f[1]*g)}class Xi{constructor(n,u,f,g,v,k){this.transform=n.clone(),this.terrain=f,this.collisionIndex=new Fe(this.transform,u),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new ii(v),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=k,k&&(k.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(n){const u=this.terrain;return u?(f,g)=>u.getElevation(n,f,g):null}getBucketParts(n,u,f,g){const v=f.getBucket(u),k=f.latestFeatureIndex;if(!v||!k||u.id!==v.layerIds[0])return;const M=f.collisionBoxArray,E=v.layers[0].layout,z=v.layers[0].paint,F=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),R=f.tileSize/c.W,Z=f.tileID.toUnwrapped(),X=this.transform.calculatePosMatrix(Z),tt=E.get("text-pitch-alignment")==="map",lt=E.get("text-rotation-alignment")==="map",et=ke(f,1,this.transform.zoom),ut=this.collisionIndex.mapProjection.translatePosition(this.transform,f,z.get("text-translate"),z.get("text-translate-anchor")),gt=this.collisionIndex.mapProjection.translatePosition(this.transform,f,z.get("icon-translate"),z.get("icon-translate-anchor")),ot=Zn(X,tt,lt,this.transform,et);let _t=null;if(tt){const Ct=qn(X,tt,lt,this.transform,et);_t=c.K([],this.transform.labelPlaneMatrix,Ct)}this.retainedQueryData[v.bucketInstanceId]=new Ie(v.bucketInstanceId,k,v.sourceLayerIndex,v.index,f.tileID);const kt={bucket:v,layout:E,translationText:ut,translationIcon:gt,posMatrix:X,unwrappedTileID:Z,textLabelPlaneMatrix:ot,labelToScreenMatrix:_t,scale:F,textPixelRatio:R,holdingForFade:f.holdingForFade(),collisionBoxArray:M,partiallyEvaluatedTextSize:c.ag(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(g)for(const Ct of v.sortKeyRanges){const{sortKey:Dt,symbolInstanceStart:jt,symbolInstanceEnd:ie}=Ct;n.push({sortKey:Dt,symbolInstanceStart:jt,symbolInstanceEnd:ie,parameters:kt})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:kt})}attemptAnchorPlacement(n,u,f,g,v,k,M,E,z,F,R,Z,X,tt,lt,et,ut,gt,ot){const _t=c.aq[n.textAnchor],kt=[n.textOffset0,n.textOffset1],Ct=bi(_t,f,g,kt,v),Dt=this.collisionIndex.placeCollisionBox(u,Z,E,z,F,M,k,et,R.predicate,ot,Ct);if((!gt||this.collisionIndex.placeCollisionBox(gt,Z,E,z,F,M,k,ut,R.predicate,ot,Ct).placeable)&&Dt.placeable){let jt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(jt=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:kt,width:f,height:g,anchor:_t,textBoxScale:v,prevAnchor:jt},this.markUsedJustification(tt,_t,X,lt),tt.allowVerticalPlacement&&(this.markUsedOrientation(tt,lt,X),this.placedOrientations[X.crossTileID]=lt),{shift:Ct,placedGlyphBoxes:Dt}}}placeLayerBucketPart(n,u,f){const{bucket:g,layout:v,translationText:k,translationIcon:M,posMatrix:E,unwrappedTileID:z,textLabelPlaneMatrix:F,labelToScreenMatrix:R,textPixelRatio:Z,holdingForFade:X,collisionBoxArray:tt,partiallyEvaluatedTextSize:lt,collisionGroup:et}=n.parameters,ut=v.get("text-optional"),gt=v.get("icon-optional"),ot=c.ar(v,"text-overlap","text-allow-overlap"),_t=ot==="always",kt=c.ar(v,"icon-overlap","icon-allow-overlap"),Ct=kt==="always",Dt=v.get("text-rotation-alignment")==="map",jt=v.get("text-pitch-alignment")==="map",ie=v.get("icon-text-fit")!=="none",ne=v.get("symbol-z-order")==="viewport-y",Ut=_t&&(Ct||!g.hasIconData()||gt),qt=Ct&&(_t||!g.hasTextData()||ut);!g.collisionArrays&&tt&&g.deserializeCollisionBoxes(tt);const ce=this._getTerrainElevationFunc(this.retainedQueryData[g.bucketInstanceId].tileID),Ce=(Wt,Xt,Te)=>{var _i,Re;if(u[Wt.crossTileID])return;if(X)return void(this.placements[Wt.crossTileID]=new ui(!1,!1,!1));let je=!1,vi=!1,Dr=!0,Yn=null,xi={box:null,placeable:!1,offscreen:null},on={box:null,placeable:!1,offscreen:null},Yr=null,Lr=null,Rr=null,Kn=0,Eo=0,vc=0;Xt.textFeatureIndex?Kn=Xt.textFeatureIndex:Wt.useRuntimeCollisionCircles&&(Kn=Wt.featureIndex),Xt.verticalTextFeatureIndex&&(Eo=Xt.verticalTextFeatureIndex);const ua=Xt.textBox;if(ua){const Tr=Fr=>{let Or=c.ah.horizontal;if(g.allowVerticalPlacement&&!Fr&&this.prevPlacement){const mr=this.prevPlacement.placedOrientations[Wt.crossTileID];mr&&(this.placedOrientations[Wt.crossTileID]=mr,Or=mr,this.markUsedOrientation(g,Or,Wt))}return Or},Xn=(Fr,Or)=>{if(g.allowVerticalPlacement&&Wt.numVerticalGlyphVertices>0&&Xt.verticalTextBox){for(const mr of g.writingModes)if(mr===c.ah.vertical?(xi=Or(),on=xi):xi=Fr(),xi&&xi.placeable)break}else xi=Fr()},oo=Wt.textAnchorOffsetStartIndex,ha=Wt.textAnchorOffsetEndIndex;if(ha===oo){const Fr=(Or,mr)=>{const Pi=this.collisionIndex.placeCollisionBox(Or,ot,Z,E,z,jt,Dt,k,et.predicate,ce);return Pi&&Pi.placeable&&(this.markUsedOrientation(g,mr,Wt),this.placedOrientations[Wt.crossTileID]=mr),Pi};Xn(()=>Fr(ua,c.ah.horizontal),()=>{const Or=Xt.verticalTextBox;return g.allowVerticalPlacement&&Wt.numVerticalGlyphVertices>0&&Or?Fr(Or,c.ah.vertical):{box:null,offscreen:null}}),Tr(xi&&xi.placeable)}else{let Fr=c.aq[(Re=(_i=this.prevPlacement)===null||_i===void 0?void 0:_i.variableOffsets[Wt.crossTileID])===null||Re===void 0?void 0:Re.anchor];const Or=(Pi,da,eh)=>{const or=Pi.x2-Pi.x1,Cp=Pi.y2-Pi.y1,bc=Wt.textBoxScale,wc=ie&&kt==="never"?da:null;let ao=null,Ep=ot==="never"?1:2,ih="never";Fr&&Ep++;for(let rh=0;rh<Ep;rh++){for(let nh=oo;nh<ha;nh++){const Sc=g.textAnchorOffsets.get(nh);if(Fr&&Sc.textAnchor!==Fr)continue;const pa=this.attemptAnchorPlacement(Sc,Pi,or,Cp,bc,Dt,jt,Z,E,z,et,ih,Wt,g,eh,k,M,wc,ce);if(pa&&(ao=pa.placedGlyphBoxes,ao&&ao.placeable))return je=!0,Yn=pa.shift,ao}Fr?Fr=null:ih=ot}return f&&!ao&&(ao={box:this.collisionIndex.placeCollisionBox(ua,"always",Z,E,z,jt,Dt,k,et.predicate,ce,new c.P(0,0)).box,offscreen:!1,placeable:!1}),ao};Xn(()=>Or(ua,Xt.iconBox,c.ah.horizontal),()=>{const Pi=Xt.verticalTextBox;return g.allowVerticalPlacement&&(!xi||!xi.placeable)&&Wt.numVerticalGlyphVertices>0&&Pi?Or(Pi,Xt.verticalIconBox,c.ah.vertical):{box:null,occluded:!0,offscreen:null}}),xi&&(je=xi.placeable,Dr=xi.offscreen);const mr=Tr(xi&&xi.placeable);if(!je&&this.prevPlacement){const Pi=this.prevPlacement.variableOffsets[Wt.crossTileID];Pi&&(this.variableOffsets[Wt.crossTileID]=Pi,this.markUsedJustification(g,Pi.anchor,Wt,mr))}}}if(Yr=xi,je=Yr&&Yr.placeable,Dr=Yr&&Yr.offscreen,Wt.useRuntimeCollisionCircles){const Tr=g.text.placedSymbolArray.get(Wt.centerJustifiedTextSymbolIndex),Xn=c.ai(g.textSizeData,lt,Tr),oo=v.get("text-padding");Lr=this.collisionIndex.placeCollisionCircles(ot,Tr,g.lineVertexArray,g.glyphOffsetArray,Xn,E,z,F,R,f,jt,et.predicate,Wt.collisionCircleDiameter,oo,k,ce),Lr.circles.length&&Lr.collisionDetected&&!f&&c.w("Collisions detected, but collision boxes are not shown"),je=_t||Lr.circles.length>0&&!Lr.collisionDetected,Dr=Dr&&Lr.offscreen}if(Xt.iconFeatureIndex&&(vc=Xt.iconFeatureIndex),Xt.iconBox){const Tr=Xn=>this.collisionIndex.placeCollisionBox(Xn,kt,Z,E,z,jt,Dt,M,et.predicate,ce,ie&&Yn?Yn:void 0);on&&on.placeable&&Xt.verticalIconBox?(Rr=Tr(Xt.verticalIconBox),vi=Rr.placeable):(Rr=Tr(Xt.iconBox),vi=Rr.placeable),Dr=Dr&&Rr.offscreen}const Po=ut||Wt.numHorizontalGlyphVertices===0&&Wt.numVerticalGlyphVertices===0,xc=gt||Wt.numIconVertices===0;Po||xc?xc?Po||(vi=vi&&je):je=vi&&je:vi=je=vi&&je;const th=vi&&Rr.placeable;if(je&&Yr.placeable&&this.collisionIndex.insertCollisionBox(Yr.box,ot,v.get("text-ignore-placement"),g.bucketInstanceId,on&&on.placeable&&Eo?Eo:Kn,et.ID),th&&this.collisionIndex.insertCollisionBox(Rr.box,kt,v.get("icon-ignore-placement"),g.bucketInstanceId,vc,et.ID),Lr&&je&&this.collisionIndex.insertCollisionCircles(Lr.circles,ot,v.get("text-ignore-placement"),g.bucketInstanceId,Kn,et.ID),f&&this.storeCollisionData(g.bucketInstanceId,Te,Xt,Yr,Rr,Lr),Wt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(g.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Wt.crossTileID]=new ui(je||Ut,vi||qt,Dr||g.justReloaded),u[Wt.crossTileID]=!0};if(ne){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Wt=g.getSortedSymbolIndexes(this.transform.angle);for(let Xt=Wt.length-1;Xt>=0;--Xt){const Te=Wt[Xt];Ce(g.symbolInstances.get(Te),g.collisionArrays[Te],Te)}}else for(let Wt=n.symbolInstanceStart;Wt<n.symbolInstanceEnd;Wt++)Ce(g.symbolInstances.get(Wt),g.collisionArrays[Wt],Wt);if(f&&g.bucketInstanceId in this.collisionCircleArrays){const Wt=this.collisionCircleArrays[g.bucketInstanceId];c.as(Wt.invProjMatrix,E),Wt.viewportMatrix=this.collisionIndex.getViewportMatrix()}g.justReloaded=!1}storeCollisionData(n,u,f,g,v,k){if(f.textBox||f.iconBox){let M,E;this.collisionBoxArrays.has(n)?M=this.collisionBoxArrays.get(n):(M=new Map,this.collisionBoxArrays.set(n,M)),M.has(u)?E=M.get(u):(E={text:null,icon:null},M.set(u,E)),f.textBox&&(E.text=g.box),f.iconBox&&(E.icon=v.box)}if(k){let M=this.collisionCircleArrays[n];M===void 0&&(M=this.collisionCircleArrays[n]=new Ai);for(let E=0;E<k.circles.length;E+=4)M.circles.push(k.circles[E+0]),M.circles.push(k.circles[E+1]),M.circles.push(k.circles[E+2]),M.circles.push(k.collisionDetected?1:0)}}markUsedJustification(n,u,f,g){let v;v=g===c.ah.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[c.at(u)];const k=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const M of k)M>=0&&(n.text.placedSymbolArray.get(M).crossTileID=v>=0&&M!==v?0:f.crossTileID)}markUsedOrientation(n,u,f){const g=u===c.ah.horizontal||u===c.ah.horizontalOnly?u:0,v=u===c.ah.vertical?u:0,k=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const M of k)n.text.placedSymbolArray.get(M).placedOrientation=g;f.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let f=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const g=u?u.symbolFadeChange(n):1,v=u?u.opacities:{},k=u?u.variableOffsets:{},M=u?u.placedOrientations:{};for(const E in this.placements){const z=this.placements[E],F=v[E];F?(this.opacities[E]=new ei(F,g,z.text,z.icon),f=f||z.text!==F.text.placed||z.icon!==F.icon.placed):(this.opacities[E]=new ei(null,g,z.text,z.icon,z.skipFade),f=f||z.text||z.icon)}for(const E in v){const z=v[E];if(!this.opacities[E]){const F=new ei(z,g,!1,!1);F.isHidden()||(this.opacities[E]=F,f=f||z.text.placed||z.icon.placed)}}for(const E in k)this.variableOffsets[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.variableOffsets[E]=k[E]);for(const E in M)this.placedOrientations[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.placedOrientations[E]=M[E]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:n)}updateLayerOpacities(n,u){const f={};for(const g of u){const v=g.getBucket(n);v&&g.latestFeatureIndex&&n.id===v.layerIds[0]&&this.updateBucketOpacities(v,g.tileID,f,g.collisionBoxArray)}}updateBucketOpacities(n,u,f,g){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const v=n.layers[0],k=v.layout,M=new ei(null,0,!1,!1,!0),E=k.get("text-allow-overlap"),z=k.get("icon-allow-overlap"),F=v._unevaluatedLayout.hasValue("text-variable-anchor")||v._unevaluatedLayout.hasValue("text-variable-anchor-offset"),R=k.get("text-rotation-alignment")==="map",Z=k.get("text-pitch-alignment")==="map",X=k.get("icon-text-fit")!=="none",tt=new ei(null,0,E&&(z||!n.hasIconData()||k.get("icon-optional")),z&&(E||!n.hasTextData()||k.get("text-optional")),!0);!n.collisionArrays&&g&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(g);const lt=(ut,gt,ot)=>{for(let _t=0;_t<gt/4;_t++)ut.opacityVertexArray.emplaceBack(ot);ut.hasVisibleVertices=ut.hasVisibleVertices||ot!==Gn},et=this.collisionBoxArrays.get(n.bucketInstanceId);for(let ut=0;ut<n.symbolInstances.length;ut++){const gt=n.symbolInstances.get(ut),{numHorizontalGlyphVertices:ot,numVerticalGlyphVertices:_t,crossTileID:kt}=gt;let Ct=this.opacities[kt];f[kt]?Ct=M:Ct||(Ct=tt,this.opacities[kt]=Ct),f[kt]=!0;const Dt=gt.numIconVertices>0,jt=this.placedOrientations[gt.crossTileID],ie=jt===c.ah.vertical,ne=jt===c.ah.horizontal||jt===c.ah.horizontalOnly;if(ot>0||_t>0){const qt=Ci(Ct.text);lt(n.text,ot,ie?Gn:qt),lt(n.text,_t,ne?Gn:qt);const ce=Ct.text.isHidden();[gt.rightJustifiedTextSymbolIndex,gt.centerJustifiedTextSymbolIndex,gt.leftJustifiedTextSymbolIndex].forEach(Xt=>{Xt>=0&&(n.text.placedSymbolArray.get(Xt).hidden=ce||ie?1:0)}),gt.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(gt.verticalPlacedTextSymbolIndex).hidden=ce||ne?1:0);const Ce=this.variableOffsets[gt.crossTileID];Ce&&this.markUsedJustification(n,Ce.anchor,gt,jt);const Wt=this.placedOrientations[gt.crossTileID];Wt&&(this.markUsedJustification(n,"left",gt,Wt),this.markUsedOrientation(n,Wt,gt))}if(Dt){const qt=Ci(Ct.icon),ce=!(X&&gt.verticalPlacedIconSymbolIndex&&ie);gt.placedIconSymbolIndex>=0&&(lt(n.icon,gt.numIconVertices,ce?qt:Gn),n.icon.placedSymbolArray.get(gt.placedIconSymbolIndex).hidden=Ct.icon.isHidden()),gt.verticalPlacedIconSymbolIndex>=0&&(lt(n.icon,gt.numVerticalIconVertices,ce?Gn:qt),n.icon.placedSymbolArray.get(gt.verticalPlacedIconSymbolIndex).hidden=Ct.icon.isHidden())}const Ut=et&&et.has(ut)?et.get(ut):{text:null,icon:null};if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const qt=n.collisionArrays[ut];if(qt){let ce=new c.P(0,0);if(qt.textBox||qt.verticalTextBox){let Ce=!0;if(F){const Wt=this.variableOffsets[kt];Wt?(ce=bi(Wt.anchor,Wt.width,Wt.height,Wt.textOffset,Wt.textBoxScale),R&&ce._rotate(Z?this.transform.angle:-this.transform.angle)):Ce=!1}if(qt.textBox||qt.verticalTextBox){let Wt;qt.textBox&&(Wt=ie),qt.verticalTextBox&&(Wt=ne),pr(n.textCollisionBox.collisionVertexArray,Ct.text.placed,!Ce||Wt,Ut.text,ce.x,ce.y)}}if(qt.iconBox||qt.verticalIconBox){const Ce=!!(!ne&&qt.verticalIconBox);let Wt;qt.iconBox&&(Wt=Ce),qt.verticalIconBox&&(Wt=!Ce),pr(n.iconCollisionBox.collisionVertexArray,Ct.icon.placed,Wt,Ut.icon,X?ce.x:0,X?ce.y:0)}}}}if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);if(n.bucketInstanceId in this.collisionCircleArrays){const ut=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=ut.invProjMatrix,n.placementViewportMatrix=ut.viewportMatrix,n.collisionCircleArray=ut.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,u){const f=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*f>n}setStale(){this.stale=!0}}function pr(y,n,u,f,g,v){f&&f.length!==0||(f=[0,0,0,0]);const k=f[0]-fe,M=f[1]-fe,E=f[2]-fe,z=f[3]-fe;y.emplaceBack(n?1:0,u?1:0,g||0,v||0,k,M),y.emplaceBack(n?1:0,u?1:0,g||0,v||0,E,M),y.emplaceBack(n?1:0,u?1:0,g||0,v||0,E,z),y.emplaceBack(n?1:0,u?1:0,g||0,v||0,k,z)}const zi=Math.pow(2,25),Xs=Math.pow(2,24),_u=Math.pow(2,17),qe=Math.pow(2,16),Ir=Math.pow(2,9),ds=Math.pow(2,8),$i=Math.pow(2,1);function Ci(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const n=y.placed?1:0,u=Math.floor(127*y.opacity);return u*zi+n*Xs+u*_u+n*qe+u*Ir+n*ds+u*$i+n}const Gn=0;function wi(){return{isOccluded:(y,n,u)=>!1,getPitchedTextCorrection:(y,n,u)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(y,n,u,f){throw new Error("Not implemented.")},translatePosition:(y,n,u,f)=>function(g,v,k,M,E=!1){if(!k[0]&&!k[1])return[0,0];const z=E?M==="map"?g.angle:0:M==="viewport"?-g.angle:0;if(z){const F=Math.sin(z),R=Math.cos(z);k=[k[0]*R-k[1]*F,k[0]*F+k[1]*R]}return[E?k[0]:ke(v,k[0],g.zoom),E?k[1]:ke(v,k[1],g.zoom)]}(y,n,u,f),getCircleRadiusCorrection:y=>1}}class Ni{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,u,f,g,v){const k=this._bucketParts;for(;this._currentTileIndex<n.length;)if(u.getBucketParts(k,g,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,k.sort((M,E)=>M.sortKey-E.sortKey));this._currentPartIndex<k.length;)if(u.placeLayerBucketPart(k[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,v())return!0;return!1}}class Xa{constructor(n,u,f,g,v,k,M,E){this.placement=new Xi(n,wi(),u,k,M,E),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(n,u,f){const g=P.now(),v=()=>!this._forceFullPlacement&&P.now()-g>2;for(;this._currentPlacementIndex>=0;){const k=u[n[this._currentPlacementIndex]],M=this.placement.collisionIndex.transform.zoom;if(k.type==="symbol"&&(!k.minzoom||k.minzoom<=M)&&(!k.maxzoom||k.maxzoom>M)){if(this._inProgressLayer||(this._inProgressLayer=new Ni(k)),this._inProgressLayer.continuePlacement(f[k.source],this.placement,this._showCollisionBoxes,k,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Pn=512/c.W/2;class Si{constructor(n,u,f){this.tileID=n,this.bucketInstanceId=f,this._symbolsByKey={};const g=new Map;for(let v=0;v<u.length;v++){const k=u.get(v),M=k.key,E=g.get(M);E?E.push(k):g.set(M,[k])}for(const[v,k]of g){const M={positions:k.map(E=>({x:Math.floor(E.anchorX*Pn),y:Math.floor(E.anchorY*Pn)})),crossTileIDs:k.map(E=>E.crossTileID)};if(M.positions.length>128){const E=new c.av(M.positions.length,16,Uint16Array);for(const{x:z,y:F}of M.positions)E.add(z,F);E.finish(),delete M.positions,M.index=E}this._symbolsByKey[v]=M}}getScaledCoordinates(n,u){const{x:f,y:g,z:v}=this.tileID.canonical,{x:k,y:M,z:E}=u.canonical,z=Pn/Math.pow(2,E-v),F=(M*c.W+n.anchorY)*z,R=g*c.W*Pn;return{x:Math.floor((k*c.W+n.anchorX)*z-f*c.W*Pn),y:Math.floor(F-R)}}findMatches(n,u,f){const g=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let v=0;v<n.length;v++){const k=n.get(v);if(k.crossTileID)continue;const M=this._symbolsByKey[k.key];if(!M)continue;const E=this.getScaledCoordinates(k,u);if(M.index){const z=M.index.range(E.x-g,E.y-g,E.x+g,E.y+g).sort();for(const F of z){const R=M.crossTileIDs[F];if(!f[R]){f[R]=!0,k.crossTileID=R;break}}}else if(M.positions)for(let z=0;z<M.positions.length;z++){const F=M.positions[z],R=M.crossTileIDs[z];if(Math.abs(F.x-E.x)<=g&&Math.abs(F.y-E.y)<=g&&!f[R]){f[R]=!0,k.crossTileID=R;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:n})=>n)}}class kr{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class In{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const u=Math.round((n-this.lng)/360);if(u!==0)for(const f in this.indexes){const g=this.indexes[f],v={};for(const k in g){const M=g[k];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+u),v[M.tileID.key]=M}this.indexes[f]=v}this.lng=n}addBucket(n,u,f){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let v=0;v<u.symbolInstances.length;v++)u.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const g=this.usedCrossTileIDs[n.overscaledZ];for(const v in this.indexes){const k=this.indexes[v];if(Number(v)>n.overscaledZ)for(const M in k){const E=k[M];E.tileID.isChildOf(n)&&E.findMatches(u.symbolInstances,n,g)}else{const M=k[n.scaledTo(Number(v)).key];M&&M.findMatches(u.symbolInstances,n,g)}}for(let v=0;v<u.symbolInstances.length;v++){const k=u.symbolInstances.get(v);k.crossTileID||(k.crossTileID=f.generate(),g[k.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Si(n,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(n,u){for(const f of u.getCrossTileIDsLists())for(const g of f)delete this.usedCrossTileIDs[n][g]}removeStaleBuckets(n){let u=!1;for(const f in this.indexes){const g=this.indexes[f];for(const v in g)n[g[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,g[v]),delete g[v],u=!0)}return u}}class yi{constructor(){this.layerIndexes={},this.crossTileIDs=new kr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,u,f){let g=this.layerIndexes[n.id];g===void 0&&(g=this.layerIndexes[n.id]=new In);let v=!1;const k={};g.handleWrapJump(f);for(const M of u){const E=M.getBucket(n);E&&n.id===E.layerIds[0]&&(E.bucketInstanceId||(E.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(M.tileID,E,this.crossTileIDs)&&(v=!0),k[E.bucketInstanceId]=!0)}return g.removeStaleBuckets(k)&&(v=!0),v}pruneUnusedLayers(n){const u={};n.forEach(f=>{u[f]=!0});for(const f in this.layerIndexes)u[f]||delete this.layerIndexes[f]}}const Wn=(y,n)=>c.t(y,n&&n.filter(u=>u.identifier!=="source.canvas")),Zr=c.aw();class Js extends c.E{constructor(n,u={}){super(),this._rtlPluginLoaded=()=>{for(const f in this.sourceCaches){const g=this.sourceCaches[f].getSource().type;g!=="vector"&&g!=="geojson"||this.sourceCaches[f].reload()}},this.map=n,this.dispatcher=new Mi(Ue(),n._getMapId()),this.dispatcher.registerMessageHandler("GG",(f,g)=>this.getGlyphs(f,g)),this.dispatcher.registerMessageHandler("GI",(f,g)=>this.getImages(f,g)),this.imageManager=new _e,this.imageManager.setEventedParent(this),this.glyphManager=new $e(n._requestManager,u.localIdeographFontFamily),this.lineAtlas=new we(256,512),this.crossTileSymbolIndex=new yi,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.ay()),xr().on(Ks,this._rtlPluginLoaded),this.on("data",f=>{if(f.dataType!=="source"||f.sourceDataType!=="metadata")return;const g=this.sourceCaches[f.sourceId];if(!g)return;const v=g.getSource();if(v&&v.vectorLayerIds)for(const k in this._layers){const M=this._layers[k];M.source===v.id&&this._validateLayer(M)}})}loadURL(n,u={},f){this.fire(new c.k("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const g=this.map._requestManager.transformRequest(n,"Style");this._loadStyleRequest=new AbortController,c.h(g,this._loadStyleRequest).then(v=>{this._loadStyleRequest=null,this._load(v.data,u,f)}).catch(v=>{this._loadStyleRequest=null,v&&this.fire(new c.j(v))})}loadJSON(n,u={},f){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,P.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(n,u,f)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(Zr,{validate:!1})}_load(n,u,f){var g;const v=u.transformStyle?u.transformStyle(f,n):n;if(!u.validate||!Wn(this,c.x(v))){this._loaded=!0,this.stylesheet=v;for(const k in v.sources)this.addSource(k,v.sources[k],{validate:!1});v.sprite?this._loadSprite(v.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(v.glyphs),this._createLayers(),this.light=new Kt(this.stylesheet.light),this.map.setTerrain((g=this.stylesheet.terrain)!==null&&g!==void 0?g:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const n=c.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",n),this._order=n.map(u=>u.id),this._layers={},this._serializedLayers=null;for(const u of n){const f=c.aA(u);f.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=f}}_loadSprite(n,u=!1,f=void 0){let g;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(v,k,M,E){return c._(this,void 0,void 0,function*(){const z=$t(v),F=M>1?"@2x":"",R={},Z={};for(const{id:X,url:tt}of z){const lt=k.transformRequest(Ft(tt,F,".json"),"SpriteJSON");R[X]=c.h(lt,E);const et=k.transformRequest(Ft(tt,F,".png"),"SpriteImage");Z[X]=K.getImage(et,E)}return yield Promise.all([...Object.values(R),...Object.values(Z)]),function(X,tt){return c._(this,void 0,void 0,function*(){const lt={};for(const et in X){lt[et]={};const ut=P.getImageCanvasContext((yield tt[et]).data),gt=(yield X[et]).data;for(const ot in gt){const{width:_t,height:kt,x:Ct,y:Dt,sdf:jt,pixelRatio:ie,stretchX:ne,stretchY:Ut,content:qt,textFitWidth:ce,textFitHeight:Ce}=gt[ot];lt[et][ot]={data:null,pixelRatio:ie,sdf:jt,stretchX:ne,stretchY:Ut,content:qt,textFitWidth:ce,textFitHeight:Ce,spriteData:{width:_t,height:kt,x:Ct,y:Dt,context:ut}}}}return lt})}(R,Z)})}(n,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(v=>{if(this._spriteRequest=null,v)for(const k in v){this._spritesImagesIds[k]=[];const M=this._spritesImagesIds[k]?this._spritesImagesIds[k].filter(E=>!(E in v)):[];for(const E of M)this.imageManager.removeImage(E),this._changedImages[E]=!0;for(const E in v[k]){const z=k==="default"?E:`${k}:${E}`;this._spritesImagesIds[k].push(z),z in this.imageManager.images?this.imageManager.updateImage(z,v[k][E],!1):this.imageManager.addImage(z,v[k][E]),u&&(this._changedImages[z]=!0)}}}).catch(v=>{this._spriteRequest=null,g=v,this.fire(new c.j(g))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),f&&f(g)})}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(n){const u=this.sourceCaches[n.source];if(!u)return;const f=n.sourceLayer;if(!f)return;const g=u.getSource();(g.type==="geojson"||g.vectorLayerIds&&g.vectorLayerIds.indexOf(f)===-1)&&this.fire(new c.j(new Error(`Source layer "${f}" does not exist on source "${g.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n){const u=this._serializedAllLayers();if(!n||n.length===0)return Object.values(u);const f=[];for(const g of n)u[g]&&f.push(u[g]);return f}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const u=Object.keys(this._layers);for(const f of u){const g=this._layers[f];g.type!=="custom"&&(n[f]=g.serialize())}return n}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const u=this._changed;if(u){const g=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(g.length||v.length)&&this._updateWorkerLayers(g,v);for(const k in this._updatedSources){const M=this._updatedSources[k];if(M==="reload")this._reloadSource(k);else{if(M!=="clear")throw new Error(`Invalid action ${M}`);this._clearSource(k)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const k in this._updatedPaintProps)this._layers[k].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}const f={};for(const g in this.sourceCaches){const v=this.sourceCaches[g];f[g]=v.used,v.used=!1}for(const g of this._order){const v=this._layers[g];v.recalculate(n,this._availableImages),!v.isHidden(n.zoom)&&v.source&&(this.sourceCaches[v.source].used=!0)}for(const g in f){const v=this.sourceCaches[g];!!f[g]!=!!v.used&&v.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:g}))}this.light.recalculate(n),this.z=n.zoom,u&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(n),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,u={}){var f;this._checkLoaded();const g=this.serialize();if(n=u.transformStyle?u.transformStyle(g,n):n,((f=u.validate)===null||f===void 0||f)&&Wn(this,c.x(n)))return!1;(n=c.aB(n)).layers=c.az(n.layers);const v=c.aC(g,n),k=this._getOperationsToPerform(v);if(k.unimplemented.length>0)throw new Error(`Unimplemented: ${k.unimplemented.join(", ")}.`);if(k.operations.length===0)return!1;for(const M of k.operations)M();return this.stylesheet=n,this._serializedLayers=null,!0}_getOperationsToPerform(n){const u=[],f=[];for(const g of n)switch(g.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":u.push(()=>this.addLayer.apply(this,g.args));break;case"removeLayer":u.push(()=>this.removeLayer.apply(this,g.args));break;case"setPaintProperty":u.push(()=>this.setPaintProperty.apply(this,g.args));break;case"setLayoutProperty":u.push(()=>this.setLayoutProperty.apply(this,g.args));break;case"setFilter":u.push(()=>this.setFilter.apply(this,g.args));break;case"addSource":u.push(()=>this.addSource.apply(this,g.args));break;case"removeSource":u.push(()=>this.removeSource.apply(this,g.args));break;case"setLayerZoomRange":u.push(()=>this.setLayerZoomRange.apply(this,g.args));break;case"setLight":u.push(()=>this.setLight.apply(this,g.args));break;case"setGeoJSONSourceData":u.push(()=>this.setGeoJSONSourceData.apply(this,g.args));break;case"setGlyphs":u.push(()=>this.setGlyphs.apply(this,g.args));break;case"setSprite":u.push(()=>this.setSprite.apply(this,g.args));break;case"setTerrain":u.push(()=>this.map.setTerrain.apply(this,g.args));break;case"setTransition":u.push(()=>{});break;default:f.push(g.command)}return{operations:u,unimplemented:f}}addImage(n,u){if(this.getImage(n))return this.fire(new c.j(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,u),this._afterImageUpdated(n)}updateImage(n,u){this.imageManager.updateImage(n,u)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new c.j(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,u,f={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(c.x.source,`sources.${n}`,u,null,f))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const g=this.sourceCaches[n]=new Ht(n,u,this.dispatcher);g.style=this,g.setEventedParent(this,()=>({isSourceLoaded:g.loaded(),source:g.serialize(),sourceId:n})),g.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===n)return this.fire(new c.j(new Error(`Source "${n}" cannot be removed while layer "${f}" is using it.`)));const u=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],u.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,u){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const f=this.sourceCaches[n].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(u),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,u,f={}){this._checkLoaded();const g=n.id;if(this.getLayer(g))return void this.fire(new c.j(new Error(`Layer "${g}" already exists on this map.`)));let v;if(n.type==="custom"){if(Wn(this,c.aD(n)))return;v=c.aA(n)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(g,n.source),n=c.aB(n),n=c.e(n,{source:g})),this._validate(c.x.layer,`layers.${g}`,n,{arrayIndex:-1},f))return;v=c.aA(n),this._validateLayer(v),v.setEventedParent(this,{layer:{id:g}})}const k=u?this._order.indexOf(u):this._order.length;if(u&&k===-1)this.fire(new c.j(new Error(`Cannot add layer "${g}" before non-existing layer "${u}".`)));else{if(this._order.splice(k,0,g),this._layerOrderChanged=!0,this._layers[g]=v,this._removedLayers[g]&&v.source&&v.type!=="custom"){const M=this._removedLayers[g];delete this._removedLayers[g],M.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",this.sourceCaches[v.source].pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map)}}moveLayer(n,u){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new c.j(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===u)return;const f=this._order.indexOf(n);this._order.splice(f,1);const g=u?this._order.indexOf(u):this._order.length;u&&g===-1?this.fire(new c.j(new Error(`Cannot move layer "${n}" before non-existing layer "${u}".`))):(this._order.splice(g,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const u=this._layers[n];if(!u)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${n}".`)));u.setEventedParent(null);const f=this._order.indexOf(n);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=u,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],u.onRemove&&u.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,u,f){this._checkLoaded();const g=this.getLayer(n);g?g.minzoom===u&&g.maxzoom===f||(u!=null&&(g.minzoom=u),f!=null&&(g.maxzoom=f),this._updateLayer(g)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,u,f={}){this._checkLoaded();const g=this.getLayer(n);if(g){if(!c.aE(g.filter,u))return u==null?(g.filter=void 0,void this._updateLayer(g)):void(this._validate(c.x.filter,`layers.${g.id}.filter`,u,null,f)||(g.filter=c.aB(u),this._updateLayer(g)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return c.aB(this.getLayer(n).filter)}setLayoutProperty(n,u,f,g={}){this._checkLoaded();const v=this.getLayer(n);v?c.aE(v.getLayoutProperty(u),f)||(v.setLayoutProperty(u,f,g),this._updateLayer(v)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,u){const f=this.getLayer(n);if(f)return f.getLayoutProperty(u);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,u,f,g={}){this._checkLoaded();const v=this.getLayer(n);v?c.aE(v.getPaintProperty(u),f)||(v.setPaintProperty(u,f,g)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[n]=!0,this._serializedLayers=null):this.fire(new c.j(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,u){return this.getLayer(n).getPaintProperty(u)}setFeatureState(n,u){this._checkLoaded();const f=n.source,g=n.sourceLayer,v=this.sourceCaches[f];if(v===void 0)return void this.fire(new c.j(new Error(`The source '${f}' does not exist in the map's style.`)));const k=v.getSource().type;k==="geojson"&&g?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):k!=="vector"||g?(n.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),v.setFeatureState(g,n.id,u)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,u){this._checkLoaded();const f=n.source,g=this.sourceCaches[f];if(g===void 0)return void this.fire(new c.j(new Error(`The source '${f}' does not exist in the map's style.`)));const v=g.getSource().type,k=v==="vector"?n.sourceLayer:void 0;v!=="vector"||k?u&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):g.removeFeatureState(k,n.id,u):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const u=n.source,f=n.sourceLayer,g=this.sourceCaches[u];if(g!==void 0)return g.getSource().type!=="vector"||f?(n.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),g.getFeatureState(f,n.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const n=c.aF(this.sourceCaches,v=>v.serialize()),u=this._serializeByIds(this._order),f=this.map.getTerrain()||void 0,g=this.stylesheet;return c.aG({version:g.version,name:g.name,metadata:g.metadata,light:g.light,center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,sprite:g.sprite,glyphs:g.glyphs,transition:g.transition,sources:n,layers:u,terrain:f},v=>v!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const u=k=>this._layers[k].type==="fill-extrusion",f={},g=[];for(let k=this._order.length-1;k>=0;k--){const M=this._order[k];if(u(M)){f[M]=k;for(const E of n){const z=E[M];if(z)for(const F of z)g.push(F)}}}g.sort((k,M)=>M.intersectionZ-k.intersectionZ);const v=[];for(let k=this._order.length-1;k>=0;k--){const M=this._order[k];if(u(M))for(let E=g.length-1;E>=0;E--){const z=g[E].feature;if(f[z.layer.id]<k)break;v.push(z),g.pop()}else for(const E of n){const z=E[M];if(z)for(const F of z)v.push(F.feature)}}return v}queryRenderedFeatures(n,u,f){u&&u.filter&&this._validate(c.x.filter,"queryRenderedFeatures.filter",u.filter,null,u);const g={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const M of u.layers){const E=this._layers[M];if(!E)return this.fire(new c.j(new Error(`The layer '${M}' does not exist in the map's style and cannot be queried for features.`))),[];g[E.source]=!0}}const v=[];u.availableImages=this._availableImages;const k=this._serializedAllLayers();for(const M in this.sourceCaches)u.layers&&!g[M]||v.push(_r(this.sourceCaches[M],this._layers,k,n,u,f));return this.placement&&v.push(function(M,E,z,F,R,Z,X){const tt={},lt=Z.queryRenderedSymbols(F),et=[];for(const ut of Object.keys(lt).map(Number))et.push(X[ut]);et.sort(sr);for(const ut of et){const gt=ut.featureIndex.lookupSymbolFeatures(lt[ut.bucketInstanceId],E,ut.bucketIndex,ut.sourceLayerIndex,R.filter,R.layers,R.availableImages,M);for(const ot in gt){const _t=tt[ot]=tt[ot]||[],kt=gt[ot];kt.sort((Ct,Dt)=>{const jt=ut.featureSortOrder;if(jt){const ie=jt.indexOf(Ct.featureIndex);return jt.indexOf(Dt.featureIndex)-ie}return Dt.featureIndex-Ct.featureIndex});for(const Ct of kt)_t.push(Ct)}}for(const ut in tt)tt[ut].forEach(gt=>{const ot=gt.feature,_t=z[M[ut].source].getFeatureState(ot.layer["source-layer"],ot.id);ot.source=ot.layer.source,ot.layer["source-layer"]&&(ot.sourceLayer=ot.layer["source-layer"]),ot.state=_t});return tt}(this._layers,k,this.sourceCaches,n,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(n,u){u&&u.filter&&this._validate(c.x.filter,"querySourceFeatures.filter",u.filter,null,u);const f=this.sourceCaches[n];return f?function(g,v){const k=g.getRenderableIds().map(z=>g.getTileByID(z)),M=[],E={};for(let z=0;z<k.length;z++){const F=k[z],R=F.tileID.canonical.key;E[R]||(E[R]=!0,F.querySourceFeatures(M,v))}return M}(f,u):[]}getLight(){return this.light.getLight()}setLight(n,u={}){this._checkLoaded();const f=this.light.getLight();let g=!1;for(const k in n)if(!c.aE(n[k],f[k])){g=!0;break}if(!g)return;const v={now:P.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,u),this.light.updateTransitions(v)}_validate(n,u,f,g,v={}){return(!v||v.validate!==!1)&&Wn(this,n.call(c.x,c.e({key:u,style:this.serialize(),value:f,styleSpec:c.v},g)))}_remove(n=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),xr().off(Ks,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const f=this.sourceCaches[u];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),n&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const u in this.sourceCaches)this.sourceCaches[u].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,u,f,g,v=!1){let k=!1,M=!1;const E={};for(const z of this._order){const F=this._layers[z];if(F.type!=="symbol")continue;if(!E[F.source]){const Z=this.sourceCaches[F.source];E[F.source]=Z.getRenderableIds(!0).map(X=>Z.getTileByID(X)).sort((X,tt)=>tt.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(tt.tileID)?-1:1))}const R=this.crossTileSymbolIndex.addLayer(F,E[F.source],n.center.lng);k=k||R}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((v=v||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(P.now(),n.zoom))&&(this.pauseablePlacement=new Xa(n,this.map.terrain,this._order,v,u,f,g,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,E),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(P.now()),M=!0),k&&this.pauseablePlacement.placement.setStale()),M||k)for(const z of this._order){const F=this._layers[z];F.type==="symbol"&&this.placement.updateLayerOpacities(F,E[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(P.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,u){return c._(this,void 0,void 0,function*(){const f=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const g=this.sourceCaches[u.source];return g&&g.setDependencies(u.tileID.key,u.type,u.icons),f})}getGlyphs(n,u){return c._(this,void 0,void 0,function*(){const f=yield this.glyphManager.getGlyphs(u.stacks),g=this.sourceCaches[u.source];return g&&g.setDependencies(u.tileID.key,u.type,[""]),f})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,u={}){this._checkLoaded(),n&&this._validate(c.x.glyphs,"glyphs",n,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,u,f={},g){this._checkLoaded();const v=[{id:n,url:u}],k=[...$t(this.stylesheet.sprite),...v];this._validate(c.x.sprite,"sprite",k,null,f)||(this.stylesheet.sprite=k,this._loadSprite(v,!0,g))}removeSprite(n){this._checkLoaded();const u=$t(this.stylesheet.sprite);if(u.find(f=>f.id===n)){if(this._spritesImagesIds[n])for(const f of this._spritesImagesIds[n])this.imageManager.removeImage(f),this._changedImages[f]=!0;u.splice(u.findIndex(f=>f.id===n),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return $t(this.stylesheet.sprite)}setSprite(n,u={},f){this._checkLoaded(),n&&this._validate(c.x.sprite,"sprite",n,null,u)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,f):(this._unloadSprite(),f&&f(null)))}}var qr=c.X([{name:"a_pos",type:"Int16",components:2}]),An="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Qs={prelude:Ge(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Ge(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Ge(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ge(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ge("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ge(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Ge(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ge("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ge("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ge("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Ge(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Ge(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Ge(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Ge(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ge(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ge(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ge(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ge(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Ge(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ge(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ge(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ge(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ge(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Ge(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ge(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ge(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ge("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",An),terrainDepth:Ge("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",An),terrainCoords:Ge("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",An)};function Ge(y,n){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=n.match(/attribute ([\w]+) ([\w]+)/g),g=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),k=v?v.concat(g):g,M={};return{fragmentSource:y=y.replace(u,(E,z,F,R,Z)=>(M[Z]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
varying ${F} ${R} ${Z};
#else
uniform ${F} ${R} u_${Z};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Z}
    ${F} ${R} ${Z} = u_${Z};
#endif
`)),vertexSource:n=n.replace(u,(E,z,F,R,Z)=>{const X=R==="float"?"vec2":"vec4",tt=Z.match(/color/)?"color":X;return M[Z]?z==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
attribute ${F} ${X} a_${Z};
varying ${F} ${R} ${Z};
#else
uniform ${F} ${R} u_${Z};
#endif
`:tt==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = a_${Z};
#else
    ${F} ${R} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = unpack_mix_${tt}(a_${Z}, u_${Z}_t);
#else
    ${F} ${R} ${Z} = u_${Z};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
attribute ${F} ${X} a_${Z};
#else
uniform ${F} ${R} u_${Z};
#endif
`:tt==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${F} ${R} ${Z} = a_${Z};
#else
    ${F} ${R} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${F} ${R} ${Z} = unpack_mix_${tt}(a_${Z}, u_${Z}_t);
#else
    ${F} ${R} ${Z} = u_${Z};
#endif
`}),staticAttributes:f,staticUniforms:k}}class to{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,u,f,g,v,k,M,E,z){this.context=n;let F=this.boundPaintVertexBuffers.length!==g.length;for(let R=0;!F&&R<g.length;R++)this.boundPaintVertexBuffers[R]!==g[R]&&(F=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==f||F||this.boundIndexBuffer!==v||this.boundVertexOffset!==k||this.boundDynamicVertexBuffer!==M||this.boundDynamicVertexBuffer2!==E||this.boundDynamicVertexBuffer3!==z?this.freshBind(u,f,g,v,k,M,E,z):(n.bindVertexArray.set(this.vao),M&&M.bind(),v&&v.dynamicDraw&&v.bind(),E&&E.bind(),z&&z.bind())}freshBind(n,u,f,g,v,k,M,E){const z=n.numAttributes,F=this.context,R=F.gl;this.vao&&this.destroy(),this.vao=F.createVertexArray(),F.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=g,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=k,this.boundDynamicVertexBuffer2=M,this.boundDynamicVertexBuffer3=E,u.enableAttributes(R,n);for(const Z of f)Z.enableAttributes(R,n);k&&k.enableAttributes(R,n),M&&M.enableAttributes(R,n),E&&E.enableAttributes(R,n),u.bind(),u.setVertexAttribPointers(R,n,v);for(const Z of f)Z.bind(),Z.setVertexAttribPointers(R,n,v);k&&(k.bind(),k.setVertexAttribPointers(R,n,v)),g&&g.bind(),M&&(M.bind(),M.setVertexAttribPointers(R,n,v)),E&&(E.bind(),E.setVertexAttribPointers(R,n,v)),F.currentNumAttributes=z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Ms(y){const n=[];for(let u=0;u<y.length;u++){if(y[u]===null)continue;const f=y[u].split(" ");n.push(f.pop())}return n}class Ja{constructor(n,u,f,g,v,k){const M=n.gl;this.program=M.createProgram();const E=Ms(u.staticAttributes),z=f?f.getBinderAttributes():[],F=E.concat(z),R=Qs.prelude.staticUniforms?Ms(Qs.prelude.staticUniforms):[],Z=u.staticUniforms?Ms(u.staticUniforms):[],X=f?f.getBinderUniforms():[],tt=R.concat(Z).concat(X),lt=[];for(const Ct of tt)lt.indexOf(Ct)<0&&lt.push(Ct);const et=f?f.defines():[];v&&et.push("#define OVERDRAW_INSPECTOR;"),k&&et.push("#define TERRAIN3D;");const ut=et.concat(Qs.prelude.fragmentSource,u.fragmentSource).join(`
`),gt=et.concat(Qs.prelude.vertexSource,u.vertexSource).join(`
`),ot=M.createShader(M.FRAGMENT_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);if(M.shaderSource(ot,ut),M.compileShader(ot),!M.getShaderParameter(ot,M.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${M.getShaderInfoLog(ot)}`);M.attachShader(this.program,ot);const _t=M.createShader(M.VERTEX_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);if(M.shaderSource(_t,gt),M.compileShader(_t),!M.getShaderParameter(_t,M.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${M.getShaderInfoLog(_t)}`);M.attachShader(this.program,_t),this.attributes={};const kt={};this.numAttributes=F.length;for(let Ct=0;Ct<this.numAttributes;Ct++)F[Ct]&&(M.bindAttribLocation(this.program,Ct,F[Ct]),this.attributes[F[Ct]]=Ct);if(M.linkProgram(this.program),!M.getProgramParameter(this.program,M.LINK_STATUS))throw new Error(`Program failed to link: ${M.getProgramInfoLog(this.program)}`);M.deleteShader(_t),M.deleteShader(ot);for(let Ct=0;Ct<lt.length;Ct++){const Dt=lt[Ct];if(Dt&&!kt[Dt]){const jt=M.getUniformLocation(this.program,Dt);jt&&(kt[Dt]=jt)}}this.fixedUniforms=g(n,kt),this.terrainUniforms=((Ct,Dt)=>({u_depth:new c.aH(Ct,Dt.u_depth),u_terrain:new c.aH(Ct,Dt.u_terrain),u_terrain_dim:new c.aI(Ct,Dt.u_terrain_dim),u_terrain_matrix:new c.aJ(Ct,Dt.u_terrain_matrix),u_terrain_unpack:new c.aK(Ct,Dt.u_terrain_unpack),u_terrain_exaggeration:new c.aI(Ct,Dt.u_terrain_exaggeration)}))(n,kt),this.binderUniforms=f?f.getUniforms(n,kt):[]}draw(n,u,f,g,v,k,M,E,z,F,R,Z,X,tt,lt,et,ut,gt){const ot=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(f),n.setStencilMode(g),n.setColorMode(v),n.setCullFace(k),E){n.activeTexture.set(ot.TEXTURE2),ot.bindTexture(ot.TEXTURE_2D,E.depthTexture),n.activeTexture.set(ot.TEXTURE3),ot.bindTexture(ot.TEXTURE_2D,E.texture);for(const kt in this.terrainUniforms)this.terrainUniforms[kt].set(E[kt])}for(const kt in this.fixedUniforms)this.fixedUniforms[kt].set(M[kt]);lt&&lt.setUniforms(n,this.binderUniforms,X,{zoom:tt});let _t=0;switch(u){case ot.LINES:_t=2;break;case ot.TRIANGLES:_t=3;break;case ot.LINE_STRIP:_t=1}for(const kt of Z.get()){const Ct=kt.vaos||(kt.vaos={});(Ct[z]||(Ct[z]=new to)).bind(n,this,F,lt?lt.getPaintVertexBuffers():[],R,kt.vertexOffset,et,ut,gt),ot.drawElements(u,kt.primitiveLength*_t,ot.UNSIGNED_SHORT,kt.primitiveOffset*_t*2)}}}function Qo(y,n,u){const f=1/ke(u,1,n.transform.tileZoom),g=Math.pow(2,u.tileID.overscaledZ),v=u.tileSize*Math.pow(2,n.transform.tileZoom)/g,k=v*(u.tileID.canonical.x+u.tileID.wrap*g),M=v*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[f,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[k>>16,M>>16],u_pixel_coord_lower:[65535&k,65535&M]}}const U=(y,n,u,f)=>{const g=n.style.light,v=g.properties.get("position"),k=[v.x,v.y,v.z],M=function(){var z=new c.A(9);return c.A!=Float32Array&&(z[1]=0,z[2]=0,z[3]=0,z[5]=0,z[6]=0,z[7]=0),z[0]=1,z[4]=1,z[8]=1,z}();g.properties.get("anchor")==="viewport"&&function(z,F){var R=Math.sin(F),Z=Math.cos(F);z[0]=Z,z[1]=R,z[2]=0,z[3]=-R,z[4]=Z,z[5]=0,z[6]=0,z[7]=0,z[8]=1}(M,-n.transform.angle),function(z,F,R){var Z=F[0],X=F[1],tt=F[2];z[0]=Z*R[0]+X*R[3]+tt*R[6],z[1]=Z*R[1]+X*R[4]+tt*R[7],z[2]=Z*R[2]+X*R[5]+tt*R[8]}(k,k,M);const E=g.properties.get("color");return{u_matrix:y,u_lightpos:k,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+u,u_opacity:f}},Q=(y,n,u,f,g,v,k)=>c.e(U(y,n,u,f),Qo(v,n,k),{u_height_factor:-Math.pow(2,g.overscaledZ)/k.tileSize/8}),ft=y=>({u_matrix:y}),Pt=(y,n,u,f)=>c.e(ft(y),Qo(u,n,f)),Nt=(y,n)=>({u_matrix:y,u_world:n}),xe=(y,n,u,f,g)=>c.e(Pt(y,n,u,f),{u_world:g}),He=(y,n,u,f)=>{const g=y.transform;let v,k;if(f.paint.get("circle-pitch-alignment")==="map"){const M=ke(u,1,g.zoom);v=!0,k=[M,M]}else v=!1,k=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+(f.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(n.posMatrix,u,f.paint.get("circle-translate"),f.paint.get("circle-translate-anchor")),u_pitch_with_map:+v,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:k}},ki=(y,n,u)=>({u_matrix:y,u_inv_matrix:n,u_camera_to_center_distance:u.cameraToCenterDistance,u_viewport_size:[u.width,u.height]}),Gr=(y,n,u=1)=>({u_matrix:y,u_color:n,u_overlay:0,u_overlay_scale:u}),Ar=y=>({u_matrix:y}),fr=(y,n,u,f)=>({u_matrix:y,u_extrude_scale:ke(n,1,u),u_intensity:f});function ql(y,n){const u=Math.pow(2,n.canonical.z),f=n.canonical.y;return[new c.Y(0,f/u).toLngLat().lat,new c.Y(0,(f+1)/u).toLngLat().lat]}const Wr=(y,n,u,f)=>{const g=y.transform;return{u_matrix:bu(y,n,u,f),u_ratio:1/ke(n,1,g.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},yn=(y,n,u,f,g)=>c.e(Wr(y,n,u,g),{u_image:0,u_image_height:f}),vu=(y,n,u,f,g)=>{const v=y.transform,k=xu(n,v);return{u_matrix:bu(y,n,u,g),u_texsize:n.imageAtlasTexture.size,u_ratio:1/ke(n,1,v.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[k,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Gl=(y,n,u,f,g,v)=>{const k=y.lineAtlas,M=xu(n,y.transform),E=u.layout.get("line-cap")==="round",z=k.getDash(f.from,E),F=k.getDash(f.to,E),R=z.width*g.fromScale,Z=F.width*g.toScale;return c.e(Wr(y,n,u,v),{u_patternscale_a:[M/R,-z.height/2],u_patternscale_b:[M/Z,-F.height/2],u_sdfgamma:k.width/(256*Math.min(R,Z)*y.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:F.y,u_mix:g.t})};function xu(y,n){return 1/ke(y,1,n.tileZoom)}function bu(y,n,u,f){return y.translatePosMatrix(f?f.posMatrix:n.tileID.posMatrix,n,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const ta=(y,n,u,f,g)=>{return{u_matrix:y,u_tl_parent:n,u_scale_parent:u,u_buffer_scale:1,u_fade_t:f.mix,u_opacity:f.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(k=g.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(v=g.paint.get("raster-contrast"),v>0?1/(1-v):1+v),u_spin_weights:rg(g.paint.get("raster-hue-rotate"))};var v,k};function rg(y){y*=Math.PI/180;const n=Math.sin(y),u=Math.cos(y);return[(2*u+1)/3,(-Math.sqrt(3)*n-u+1)/3,(Math.sqrt(3)*n-u+1)/3]}const qd=(y,n,u,f,g,v,k,M,E,z,F,R,Z,X)=>{const tt=k.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:tt.cameraToCenterDistance,u_pitch:tt.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:tt.width/tt.height,u_fade_change:k.options.fadeDuration?k.symbolFadeChange:1,u_matrix:M,u_label_plane_matrix:E,u_coord_matrix:z,u_is_text:+R,u_pitch_with_map:+f,u_is_along_line:g,u_is_variable_anchor:v,u_texsize:Z,u_texture:0,u_translation:F,u_pitched_scale:X}},Gd=(y,n,u,f,g,v,k,M,E,z,F,R,Z,X,tt)=>{const lt=k.transform;return c.e(qd(y,n,u,f,g,v,k,M,E,z,F,R,Z,tt),{u_gamma_scale:f?Math.cos(lt._pitch)*lt.cameraToCenterDistance:1,u_device_pixel_ratio:k.pixelRatio,u_is_halo:+X})},ng=(y,n,u,f,g,v,k,M,E,z,F,R,Z,X)=>c.e(Gd(y,n,u,f,g,v,k,M,E,z,F,!0,R,!0,X),{u_texsize_icon:Z,u_texture_icon:1}),sg=(y,n,u)=>({u_matrix:y,u_opacity:n,u_color:u}),og=(y,n,u,f,g,v)=>c.e(function(k,M,E,z){const F=E.imageManager.getPattern(k.from.toString()),R=E.imageManager.getPattern(k.to.toString()),{width:Z,height:X}=E.imageManager.getPixelSize(),tt=Math.pow(2,z.tileID.overscaledZ),lt=z.tileSize*Math.pow(2,E.transform.tileZoom)/tt,et=lt*(z.tileID.canonical.x+z.tileID.wrap*tt),ut=lt*z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:F.tl,u_pattern_br_a:F.br,u_pattern_tl_b:R.tl,u_pattern_br_b:R.br,u_texsize:[Z,X],u_mix:M.t,u_pattern_size_a:F.displaySize,u_pattern_size_b:R.displaySize,u_scale_a:M.fromScale,u_scale_b:M.toScale,u_tile_units_to_pixels:1/ke(z,1,E.transform.tileZoom),u_pixel_coord_upper:[et>>16,ut>>16],u_pixel_coord_lower:[65535&et,65535&ut]}}(f,v,u,g),{u_matrix:y,u_opacity:n}),Wl={fillExtrusion:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_lightpos:new c.aL(y,n.u_lightpos),u_lightintensity:new c.aI(y,n.u_lightintensity),u_lightcolor:new c.aL(y,n.u_lightcolor),u_vertical_gradient:new c.aI(y,n.u_vertical_gradient),u_opacity:new c.aI(y,n.u_opacity)}),fillExtrusionPattern:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_lightpos:new c.aL(y,n.u_lightpos),u_lightintensity:new c.aI(y,n.u_lightintensity),u_lightcolor:new c.aL(y,n.u_lightcolor),u_vertical_gradient:new c.aI(y,n.u_vertical_gradient),u_height_factor:new c.aI(y,n.u_height_factor),u_image:new c.aH(y,n.u_image),u_texsize:new c.aM(y,n.u_texsize),u_pixel_coord_upper:new c.aM(y,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(y,n.u_pixel_coord_lower),u_scale:new c.aL(y,n.u_scale),u_fade:new c.aI(y,n.u_fade),u_opacity:new c.aI(y,n.u_opacity)}),fill:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix)}),fillPattern:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_image:new c.aH(y,n.u_image),u_texsize:new c.aM(y,n.u_texsize),u_pixel_coord_upper:new c.aM(y,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(y,n.u_pixel_coord_lower),u_scale:new c.aL(y,n.u_scale),u_fade:new c.aI(y,n.u_fade)}),fillOutline:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_world:new c.aM(y,n.u_world)}),fillOutlinePattern:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_world:new c.aM(y,n.u_world),u_image:new c.aH(y,n.u_image),u_texsize:new c.aM(y,n.u_texsize),u_pixel_coord_upper:new c.aM(y,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(y,n.u_pixel_coord_lower),u_scale:new c.aL(y,n.u_scale),u_fade:new c.aI(y,n.u_fade)}),circle:(y,n)=>({u_camera_to_center_distance:new c.aI(y,n.u_camera_to_center_distance),u_scale_with_map:new c.aH(y,n.u_scale_with_map),u_pitch_with_map:new c.aH(y,n.u_pitch_with_map),u_extrude_scale:new c.aM(y,n.u_extrude_scale),u_device_pixel_ratio:new c.aI(y,n.u_device_pixel_ratio),u_matrix:new c.aJ(y,n.u_matrix)}),collisionBox:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_pixel_extrude_scale:new c.aM(y,n.u_pixel_extrude_scale)}),collisionCircle:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_inv_matrix:new c.aJ(y,n.u_inv_matrix),u_camera_to_center_distance:new c.aI(y,n.u_camera_to_center_distance),u_viewport_size:new c.aM(y,n.u_viewport_size)}),debug:(y,n)=>({u_color:new c.aN(y,n.u_color),u_matrix:new c.aJ(y,n.u_matrix),u_overlay:new c.aH(y,n.u_overlay),u_overlay_scale:new c.aI(y,n.u_overlay_scale)}),clippingMask:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix)}),heatmap:(y,n)=>({u_extrude_scale:new c.aI(y,n.u_extrude_scale),u_intensity:new c.aI(y,n.u_intensity),u_matrix:new c.aJ(y,n.u_matrix)}),heatmapTexture:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_world:new c.aM(y,n.u_world),u_image:new c.aH(y,n.u_image),u_color_ramp:new c.aH(y,n.u_color_ramp),u_opacity:new c.aI(y,n.u_opacity)}),hillshade:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_image:new c.aH(y,n.u_image),u_latrange:new c.aM(y,n.u_latrange),u_light:new c.aM(y,n.u_light),u_shadow:new c.aN(y,n.u_shadow),u_highlight:new c.aN(y,n.u_highlight),u_accent:new c.aN(y,n.u_accent)}),hillshadePrepare:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_image:new c.aH(y,n.u_image),u_dimension:new c.aM(y,n.u_dimension),u_zoom:new c.aI(y,n.u_zoom),u_unpack:new c.aK(y,n.u_unpack)}),line:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_ratio:new c.aI(y,n.u_ratio),u_device_pixel_ratio:new c.aI(y,n.u_device_pixel_ratio),u_units_to_pixels:new c.aM(y,n.u_units_to_pixels)}),lineGradient:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_ratio:new c.aI(y,n.u_ratio),u_device_pixel_ratio:new c.aI(y,n.u_device_pixel_ratio),u_units_to_pixels:new c.aM(y,n.u_units_to_pixels),u_image:new c.aH(y,n.u_image),u_image_height:new c.aI(y,n.u_image_height)}),linePattern:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_texsize:new c.aM(y,n.u_texsize),u_ratio:new c.aI(y,n.u_ratio),u_device_pixel_ratio:new c.aI(y,n.u_device_pixel_ratio),u_image:new c.aH(y,n.u_image),u_units_to_pixels:new c.aM(y,n.u_units_to_pixels),u_scale:new c.aL(y,n.u_scale),u_fade:new c.aI(y,n.u_fade)}),lineSDF:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_ratio:new c.aI(y,n.u_ratio),u_device_pixel_ratio:new c.aI(y,n.u_device_pixel_ratio),u_units_to_pixels:new c.aM(y,n.u_units_to_pixels),u_patternscale_a:new c.aM(y,n.u_patternscale_a),u_patternscale_b:new c.aM(y,n.u_patternscale_b),u_sdfgamma:new c.aI(y,n.u_sdfgamma),u_image:new c.aH(y,n.u_image),u_tex_y_a:new c.aI(y,n.u_tex_y_a),u_tex_y_b:new c.aI(y,n.u_tex_y_b),u_mix:new c.aI(y,n.u_mix)}),raster:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_tl_parent:new c.aM(y,n.u_tl_parent),u_scale_parent:new c.aI(y,n.u_scale_parent),u_buffer_scale:new c.aI(y,n.u_buffer_scale),u_fade_t:new c.aI(y,n.u_fade_t),u_opacity:new c.aI(y,n.u_opacity),u_image0:new c.aH(y,n.u_image0),u_image1:new c.aH(y,n.u_image1),u_brightness_low:new c.aI(y,n.u_brightness_low),u_brightness_high:new c.aI(y,n.u_brightness_high),u_saturation_factor:new c.aI(y,n.u_saturation_factor),u_contrast_factor:new c.aI(y,n.u_contrast_factor),u_spin_weights:new c.aL(y,n.u_spin_weights)}),symbolIcon:(y,n)=>({u_is_size_zoom_constant:new c.aH(y,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(y,n.u_is_size_feature_constant),u_size_t:new c.aI(y,n.u_size_t),u_size:new c.aI(y,n.u_size),u_camera_to_center_distance:new c.aI(y,n.u_camera_to_center_distance),u_pitch:new c.aI(y,n.u_pitch),u_rotate_symbol:new c.aH(y,n.u_rotate_symbol),u_aspect_ratio:new c.aI(y,n.u_aspect_ratio),u_fade_change:new c.aI(y,n.u_fade_change),u_matrix:new c.aJ(y,n.u_matrix),u_label_plane_matrix:new c.aJ(y,n.u_label_plane_matrix),u_coord_matrix:new c.aJ(y,n.u_coord_matrix),u_is_text:new c.aH(y,n.u_is_text),u_pitch_with_map:new c.aH(y,n.u_pitch_with_map),u_is_along_line:new c.aH(y,n.u_is_along_line),u_is_variable_anchor:new c.aH(y,n.u_is_variable_anchor),u_texsize:new c.aM(y,n.u_texsize),u_texture:new c.aH(y,n.u_texture),u_translation:new c.aM(y,n.u_translation),u_pitched_scale:new c.aI(y,n.u_pitched_scale)}),symbolSDF:(y,n)=>({u_is_size_zoom_constant:new c.aH(y,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(y,n.u_is_size_feature_constant),u_size_t:new c.aI(y,n.u_size_t),u_size:new c.aI(y,n.u_size),u_camera_to_center_distance:new c.aI(y,n.u_camera_to_center_distance),u_pitch:new c.aI(y,n.u_pitch),u_rotate_symbol:new c.aH(y,n.u_rotate_symbol),u_aspect_ratio:new c.aI(y,n.u_aspect_ratio),u_fade_change:new c.aI(y,n.u_fade_change),u_matrix:new c.aJ(y,n.u_matrix),u_label_plane_matrix:new c.aJ(y,n.u_label_plane_matrix),u_coord_matrix:new c.aJ(y,n.u_coord_matrix),u_is_text:new c.aH(y,n.u_is_text),u_pitch_with_map:new c.aH(y,n.u_pitch_with_map),u_is_along_line:new c.aH(y,n.u_is_along_line),u_is_variable_anchor:new c.aH(y,n.u_is_variable_anchor),u_texsize:new c.aM(y,n.u_texsize),u_texture:new c.aH(y,n.u_texture),u_gamma_scale:new c.aI(y,n.u_gamma_scale),u_device_pixel_ratio:new c.aI(y,n.u_device_pixel_ratio),u_is_halo:new c.aH(y,n.u_is_halo),u_translation:new c.aM(y,n.u_translation),u_pitched_scale:new c.aI(y,n.u_pitched_scale)}),symbolTextAndIcon:(y,n)=>({u_is_size_zoom_constant:new c.aH(y,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(y,n.u_is_size_feature_constant),u_size_t:new c.aI(y,n.u_size_t),u_size:new c.aI(y,n.u_size),u_camera_to_center_distance:new c.aI(y,n.u_camera_to_center_distance),u_pitch:new c.aI(y,n.u_pitch),u_rotate_symbol:new c.aH(y,n.u_rotate_symbol),u_aspect_ratio:new c.aI(y,n.u_aspect_ratio),u_fade_change:new c.aI(y,n.u_fade_change),u_matrix:new c.aJ(y,n.u_matrix),u_label_plane_matrix:new c.aJ(y,n.u_label_plane_matrix),u_coord_matrix:new c.aJ(y,n.u_coord_matrix),u_is_text:new c.aH(y,n.u_is_text),u_pitch_with_map:new c.aH(y,n.u_pitch_with_map),u_is_along_line:new c.aH(y,n.u_is_along_line),u_is_variable_anchor:new c.aH(y,n.u_is_variable_anchor),u_texsize:new c.aM(y,n.u_texsize),u_texsize_icon:new c.aM(y,n.u_texsize_icon),u_texture:new c.aH(y,n.u_texture),u_texture_icon:new c.aH(y,n.u_texture_icon),u_gamma_scale:new c.aI(y,n.u_gamma_scale),u_device_pixel_ratio:new c.aI(y,n.u_device_pixel_ratio),u_is_halo:new c.aH(y,n.u_is_halo),u_translation:new c.aM(y,n.u_translation),u_pitched_scale:new c.aI(y,n.u_pitched_scale)}),background:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_opacity:new c.aI(y,n.u_opacity),u_color:new c.aN(y,n.u_color)}),backgroundPattern:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_opacity:new c.aI(y,n.u_opacity),u_image:new c.aH(y,n.u_image),u_pattern_tl_a:new c.aM(y,n.u_pattern_tl_a),u_pattern_br_a:new c.aM(y,n.u_pattern_br_a),u_pattern_tl_b:new c.aM(y,n.u_pattern_tl_b),u_pattern_br_b:new c.aM(y,n.u_pattern_br_b),u_texsize:new c.aM(y,n.u_texsize),u_mix:new c.aI(y,n.u_mix),u_pattern_size_a:new c.aM(y,n.u_pattern_size_a),u_pattern_size_b:new c.aM(y,n.u_pattern_size_b),u_scale_a:new c.aI(y,n.u_scale_a),u_scale_b:new c.aI(y,n.u_scale_b),u_pixel_coord_upper:new c.aM(y,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(y,n.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aI(y,n.u_tile_units_to_pixels)}),terrain:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_texture:new c.aH(y,n.u_texture),u_ele_delta:new c.aI(y,n.u_ele_delta)}),terrainDepth:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_ele_delta:new c.aI(y,n.u_ele_delta)}),terrainCoords:(y,n)=>({u_matrix:new c.aJ(y,n.u_matrix),u_texture:new c.aH(y,n.u_texture),u_terrain_coords_id:new c.aI(y,n.u_terrain_coords_id),u_ele_delta:new c.aI(y,n.u_ele_delta)})};class wu{constructor(n,u,f){this.context=n;const g=n.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Yl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Su{constructor(n,u,f,g){this.length=u.length,this.attributes=f,this.itemSize=u.bytesPerElement,this.dynamicDraw=g,this.context=n;const v=n.gl;this.buffer=v.createBuffer(),n.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,u){for(let f=0;f<this.attributes.length;f++){const g=u.attributes[this.attributes[f].name];g!==void 0&&n.enableVertexAttribArray(g)}}setVertexAttribPointers(n,u,f){for(let g=0;g<this.attributes.length;g++){const v=this.attributes[g],k=u.attributes[v.name];k!==void 0&&n.vertexAttribPointer(k,v.components,n[Yl[v.type]],!1,this.itemSize,v.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Qa=new WeakMap;function _n(y){var n;if(Qa.has(y))return Qa.get(y);{const u=(n=y.getParameter(y.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return Qa.set(y,u),u}}class ri{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ku extends ri{getDefault(){return c.aP.transparent}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class tl extends ri{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class el extends ri{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class ag extends ri{getDefault(){return[!0,!0,!0,!0]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Kl extends ri{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class lg extends ri{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class ea extends ri{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const u=this.current;(n.func!==u.func||n.ref!==u.ref||n.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class cg extends ri{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Wd extends ri{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=n,this.dirty=!1}}class ug extends ri{getDefault(){return[0,1]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Yd extends ri{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=n,this.dirty=!1}}class Tu extends ri{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Kd extends ri{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.BLEND):u.disable(u.BLEND),this.current=n,this.dirty=!1}}class Xd extends ri{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Jd extends ri{getDefault(){return c.aP.transparent}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Qd extends ri{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class bo extends ri{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=n,this.dirty=!1}}class tp extends ri{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class hg extends ri{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class dg extends ri{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class ep extends ri{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class il extends ri{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class pg extends ri{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Xl extends ri{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class fg extends ri{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class mg extends ri{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class ip extends ri{getDefault(){return null}set(n){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class rp extends ri{getDefault(){return null}set(n){var u;if(n===this.current&&!this.dirty)return;const f=this.gl;_n(f)?f.bindVertexArray(n):(u=f.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class np extends ri{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Mu extends ri{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class sp extends ri{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class ia extends ri{constructor(n,u){super(n),this.context=n,this.parent=u}getDefault(){return null}}class Cs extends ia{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Cu extends ia{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Eu extends ia{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Pu{constructor(n,u,f,g,v){this.context=n,this.width=u,this.height=f;const k=n.gl,M=this.framebuffer=k.createFramebuffer();if(this.colorAttachment=new Cs(n,M),g)this.depthAttachment=v?new Eu(n,M):new Cu(n,M);else if(v)throw new Error("Stencil cannot be set without depth");if(k.checkFramebufferStatus(k.FRAMEBUFFER)!==k.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const n=this.context.gl,u=this.colorAttachment.get();if(u&&n.deleteTexture(u),this.depthAttachment){const f=this.depthAttachment.get();f&&n.deleteRenderbuffer(f)}n.deleteFramebuffer(this.framebuffer)}}class ji{constructor(n,u,f){this.blendFunction=n,this.blendColor=u,this.mask=f}}ji.Replace=[1,0],ji.disabled=new ji(ji.Replace,c.aP.transparent,[!1,!1,!1,!1]),ji.unblended=new ji(ji.Replace,c.aP.transparent,[!0,!0,!0,!0]),ji.alphaBlended=new ji([1,771],c.aP.transparent,[!0,!0,!0,!0]);class Iu{constructor(n){var u,f;if(this.gl=n,this.clearColor=new ku(this),this.clearDepth=new tl(this),this.clearStencil=new el(this),this.colorMask=new ag(this),this.depthMask=new Kl(this),this.stencilMask=new lg(this),this.stencilFunc=new ea(this),this.stencilOp=new cg(this),this.stencilTest=new Wd(this),this.depthRange=new ug(this),this.depthTest=new Yd(this),this.depthFunc=new Tu(this),this.blend=new Kd(this),this.blendFunc=new Xd(this),this.blendColor=new Jd(this),this.blendEquation=new Qd(this),this.cullFace=new bo(this),this.cullFaceSide=new tp(this),this.frontFace=new hg(this),this.program=new dg(this),this.activeTexture=new ep(this),this.viewport=new il(this),this.bindFramebuffer=new pg(this),this.bindRenderbuffer=new Xl(this),this.bindTexture=new fg(this),this.bindVertexBuffer=new mg(this),this.bindElementBuffer=new ip(this),this.bindVertexArray=new rp(this),this.pixelStoreUnpack=new np(this),this.pixelStoreUnpackPremultiplyAlpha=new Mu(this),this.pixelStoreUnpackFlipY=new sp(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),_n(n)){this.HALF_FLOAT=n.HALF_FLOAT;const g=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=n.RGBA16F)!==null&&u!==void 0?u:g==null?void 0:g.RGBA16F_EXT,this.RGB16F=(f=n.RGB16F)!==null&&f!==void 0?f:g==null?void 0:g.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const g=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=g==null?void 0:g.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,u){return new wu(this,n,u)}createVertexBuffer(n,u,f){return new Su(this,n,u,f)}createRenderbuffer(n,u,f){const g=this.gl,v=g.createRenderbuffer();return this.bindRenderbuffer.set(v),g.renderbufferStorage(g.RENDERBUFFER,n,u,f),this.bindRenderbuffer.set(null),v}createFramebuffer(n,u,f,g){return new Pu(this,n,u,f,g)}clear({color:n,depth:u,stencil:f}){const g=this.gl;let v=0;n&&(v|=g.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(v|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),f!==void 0&&(v|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),g.clear(v)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){c.aE(n.blendFunction,ji.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return _n(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var u;return _n(this.gl)?this.gl.deleteVertexArray(n):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}class Oe{constructor(n,u,f){this.func=n,this.mask=u,this.range=f}}Oe.ReadOnly=!1,Oe.ReadWrite=!0,Oe.disabled=new Oe(519,Oe.ReadOnly,[0,1]);const rl=7680;class Ei{constructor(n,u,f,g,v,k){this.test=n,this.ref=u,this.mask=f,this.fail=g,this.depthFail=v,this.pass=k}}Ei.disabled=new Ei({func:519,mask:0},0,0,rl,rl,rl);class Ti{constructor(n,u,f){this.enable=n,this.mode=u,this.frontFace=f}}let Jl;function op(y,n,u,f,g){const v=y.context,k=v.gl,M=y.useProgram("collisionBox"),E=[];let z=0,F=0;for(let ut=0;ut<f.length;ut++){const gt=f[ut],ot=n.getTile(gt).getBucket(u);if(!ot)continue;const _t=g?ot.textCollisionBox:ot.iconCollisionBox,kt=ot.collisionCircleArray;if(kt.length>0){const Ct=c.F();c.aQ(Ct,ot.placementInvProjMatrix,y.transform.glCoordMatrix),c.aQ(Ct,Ct,ot.placementViewportMatrix),E.push({circleArray:kt,circleOffset:F,transform:gt.posMatrix,invTransform:Ct,coord:gt}),z+=kt.length/4,F=z}_t&&M.draw(v,k.LINES,Oe.disabled,Ei.disabled,y.colorModeForRenderPass(),Ti.disabled,{u_matrix:gt.posMatrix,u_pixel_extrude_scale:[1/(R=y.transform).width,1/R.height]},y.style.map.terrain&&y.style.map.terrain.getTerrainData(gt),u.id,_t.layoutVertexBuffer,_t.indexBuffer,_t.segments,null,y.transform.zoom,null,null,_t.collisionVertexBuffer)}var R;if(!g||!E.length)return;const Z=y.useProgram("collisionCircle"),X=new c.aR;X.resize(4*z),X._trim();let tt=0;for(const ut of E)for(let gt=0;gt<ut.circleArray.length/4;gt++){const ot=4*gt,_t=ut.circleArray[ot+0],kt=ut.circleArray[ot+1],Ct=ut.circleArray[ot+2],Dt=ut.circleArray[ot+3];X.emplace(tt++,_t,kt,Ct,Dt,0),X.emplace(tt++,_t,kt,Ct,Dt,1),X.emplace(tt++,_t,kt,Ct,Dt,2),X.emplace(tt++,_t,kt,Ct,Dt,3)}(!Jl||Jl.length<2*z)&&(Jl=function(ut){const gt=2*ut,ot=new c.aT;ot.resize(gt),ot._trim();for(let _t=0;_t<gt;_t++){const kt=6*_t;ot.uint16[kt+0]=4*_t+0,ot.uint16[kt+1]=4*_t+1,ot.uint16[kt+2]=4*_t+2,ot.uint16[kt+3]=4*_t+2,ot.uint16[kt+4]=4*_t+3,ot.uint16[kt+5]=4*_t+0}return ot}(z));const lt=v.createIndexBuffer(Jl,!0),et=v.createVertexBuffer(X,c.aS.members,!0);for(const ut of E){const gt=ki(ut.transform,ut.invTransform,y.transform);Z.draw(v,k.TRIANGLES,Oe.disabled,Ei.disabled,y.colorModeForRenderPass(),Ti.disabled,gt,y.style.map.terrain&&y.style.map.terrain.getTerrainData(ut.coord),u.id,et,lt,c.$.simpleSegment(0,2*ut.circleOffset,ut.circleArray.length,ut.circleArray.length/2),null,y.transform.zoom,null,null,null)}et.destroy(),lt.destroy()}Ti.disabled=new Ti(!1,1029,2305),Ti.backCCW=new Ti(!0,1029,2305);const Au=c.an(new Float32Array(16));function gg(y,n,u,f,g,v){const{horizontalAlign:k,verticalAlign:M}=c.au(y);return new c.P((-(k-.5)*n/g+f[0])*v,(-(M-.5)*u/g+f[1])*v)}function ap(y,n,u,f,g,v){const k=n.tileAnchorPoint.add(new c.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let M=f.mult(v);return u||(M=M.rotate(-g)),qi(k.add(M),n.labelPlaneMatrix,n.getElevation).point}if(u){const M=ht(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(y),E=Math.atan(M.y/M.x)+(M.x<0?Math.PI:0);return y.add(f.rotate(E))}return y.add(f)}function Ql(y,n,u,f,g,v,k,M,E,z,F,R,Z,X){const tt=y.text.placedSymbolArray,lt=y.text.dynamicLayoutVertexArray,et=y.icon.dynamicLayoutVertexArray,ut={};lt.clear();for(let gt=0;gt<tt.length;gt++){const ot=tt.get(gt),_t=ot.hidden||!ot.crossTileID||y.allowVerticalPlacement&&!ot.placedOrientation?null:f[ot.crossTileID];if(_t){const kt=new c.P(ot.anchorX,ot.anchorY),Ct={getElevation:X,width:g.width,height:g.height,labelPlaneMatrix:v,lineVertexArray:null,pitchWithMap:u,projection:F,projectionCache:null,tileAnchorPoint:kt,translation:R,unwrappedTileID:Z},Dt=u?qi(kt,k,X):ht(kt.x,kt.y,Ct),jt=rt(g.cameraToCenterDistance,Dt.signedDistanceFromCamera);let ie=c.ai(y.textSizeData,E,ot)*jt/c.ap;u&&(ie*=y.tilePixelRatio/M);const{width:ne,height:Ut,anchor:qt,textOffset:ce,textBoxScale:Ce}=_t,Wt=gg(qt,ne,Ut,ce,Ce,ie),Xt=F.getPitchedTextCorrection(g,kt.add(new c.P(R[0],R[1])),Z),Te=ap(Dt.point,Ct,n,Wt,g.angle,Xt),_i=y.allowVerticalPlacement&&ot.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let Re=0;Re<ot.numGlyphs;Re++)c.aj(lt,Te,_i);z&&ot.associatedIconIndex>=0&&(ut[ot.associatedIconIndex]={shiftedAnchor:Te,angle:_i})}else de(ot.numGlyphs,lt)}if(z){et.clear();const gt=y.icon.placedSymbolArray;for(let ot=0;ot<gt.length;ot++){const _t=gt.get(ot);if(_t.hidden)de(_t.numGlyphs,et);else{const kt=ut[ot];if(kt)for(let Ct=0;Ct<_t.numGlyphs;Ct++)c.aj(et,kt.shiftedAnchor,kt.angle);else de(_t.numGlyphs,et)}}y.icon.dynamicLayoutVertexBuffer.updateData(et)}y.text.dynamicLayoutVertexBuffer.updateData(lt)}function tc(y,n,u){return u.iconsInText&&n?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function nl(y,n,u,f,g,v,k,M,E,z,F,R){const Z=y.context,X=Z.gl,tt=y.transform,lt=wi(),et=M==="map",ut=E==="map",gt=M!=="viewport"&&u.layout.get("symbol-placement")!=="point",ot=et&&!ut&&!gt,_t=!ut&&gt,kt=!u.layout.get("symbol-sort-key").isConstant();let Ct=!1;const Dt=y.depthModeForSublayer(0,Oe.ReadOnly),jt=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ie=[],ne=lt.getCircleRadiusCorrection(tt);for(const Ut of f){const qt=n.getTile(Ut),ce=qt.getBucket(u);if(!ce)continue;const Ce=g?ce.text:ce.icon;if(!Ce||!Ce.segments.get().length||!Ce.hasVisibleVertices)continue;const Wt=Ce.programConfigurations.get(u.id),Xt=g||ce.sdfIcons,Te=g?ce.textSizeData:ce.iconSizeData,_i=ut||tt.pitch!==0,Re=y.useProgram(tc(Xt,g,ce),Wt),je=c.ag(Te,tt.zoom),vi=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Ut);let Dr,Yn,xi,on,Yr=[0,0],Lr=null;if(g)Yn=qt.glyphAtlasTexture,xi=X.LINEAR,Dr=qt.glyphAtlasTexture.size,ce.iconsInText&&(Yr=qt.imageAtlasTexture.size,Lr=qt.imageAtlasTexture,on=_i||y.options.rotating||y.options.zooming||Te.kind==="composite"||Te.kind==="camera"?X.LINEAR:X.NEAREST);else{const Pi=u.layout.get("icon-size").constantOr(0)!==1||ce.iconsNeedLinear;Yn=qt.imageAtlasTexture,xi=Xt||y.options.rotating||y.options.zooming||Pi||_i?X.LINEAR:X.NEAREST,Dr=qt.imageAtlasTexture.size}const Rr=ke(qt,1,y.transform.zoom),Kn=_t?Ut.posMatrix:Au,Eo=Zn(Kn,ut,et,y.transform,Rr),vc=qn(Kn,ut,et,y.transform,Rr),ua=qn(Ut.posMatrix,ut,et,y.transform,Rr),Po=lt.translatePosition(y.transform,qt,v,k),xc=jt&&ce.hasTextData(),th=u.layout.get("icon-text-fit")!=="none"&&xc&&ce.hasIconData();if(gt){const Pi=y.style.map.terrain?(eh,or)=>y.style.map.terrain.getElevation(Ut,eh,or):null,da=u.layout.get("text-rotation-alignment")==="map";N(ce,Ut.posMatrix,y,g,Eo,ua,ut,z,da,lt,Ut.toUnwrapped(),tt.width,tt.height,Po,Pi)}const Tr=Ut.posMatrix,Xn=g&&jt||th,oo=gt||Xn?Au:Eo,ha=vc,Fr=Xt&&u.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Or;Or=Xt?ce.iconsInText?ng(Te.kind,je,ot,ut,gt,Xn,y,Tr,oo,ha,Po,Dr,Yr,ne):Gd(Te.kind,je,ot,ut,gt,Xn,y,Tr,oo,ha,Po,g,Dr,!0,ne):qd(Te.kind,je,ot,ut,gt,Xn,y,Tr,oo,ha,Po,g,Dr,ne);const mr={program:Re,buffers:Ce,uniformValues:Or,atlasTexture:Yn,atlasTextureIcon:Lr,atlasInterpolation:xi,atlasInterpolationIcon:on,isSDF:Xt,hasHalo:Fr};if(kt&&ce.canOverlap){Ct=!0;const Pi=Ce.segments.get();for(const da of Pi)ie.push({segments:new c.$([da]),sortKey:da.sortKey,state:mr,terrainData:vi})}else ie.push({segments:Ce.segments,sortKey:0,state:mr,terrainData:vi})}Ct&&ie.sort((Ut,qt)=>Ut.sortKey-qt.sortKey);for(const Ut of ie){const qt=Ut.state;if(Z.activeTexture.set(X.TEXTURE0),qt.atlasTexture.bind(qt.atlasInterpolation,X.CLAMP_TO_EDGE),qt.atlasTextureIcon&&(Z.activeTexture.set(X.TEXTURE1),qt.atlasTextureIcon&&qt.atlasTextureIcon.bind(qt.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),qt.isSDF){const ce=qt.uniformValues;qt.hasHalo&&(ce.u_is_halo=1,ec(qt.buffers,Ut.segments,u,y,qt.program,Dt,F,R,ce,Ut.terrainData)),ce.u_is_halo=0}ec(qt.buffers,Ut.segments,u,y,qt.program,Dt,F,R,qt.uniformValues,Ut.terrainData)}}function ec(y,n,u,f,g,v,k,M,E,z){const F=f.context;g.draw(F,F.gl.TRIANGLES,v,k,M,Ti.disabled,E,z,u.id,y.layoutVertexBuffer,y.indexBuffer,n,u.paint,f.transform.zoom,y.programConfigurations.get(u.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function eo(y,n,u,f,g){if(!u||!f||!f.imageAtlas)return;const v=f.imageAtlas.patternPositions;let k=v[u.to.toString()],M=v[u.from.toString()];if(!k&&M&&(k=M),!M&&k&&(M=k),!k||!M){const E=g.getPaintProperty(n);k=v[E],M=v[E]}k&&M&&y.setConstantPatternPositions(k,M)}function wo(y,n,u,f,g,v,k){const M=y.context.gl,E="fill-pattern",z=u.paint.get(E),F=z&&z.constantOr(1),R=u.getCrossfadeParameters();let Z,X,tt,lt,et;k?(X=F&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Z=M.LINES):(X=F?"fillPattern":"fill",Z=M.TRIANGLES);const ut=z.constantOr(null);for(const gt of f){const ot=n.getTile(gt);if(F&&!ot.patternsLoaded())continue;const _t=ot.getBucket(u);if(!_t)continue;const kt=_t.programConfigurations.get(u.id),Ct=y.useProgram(X,kt),Dt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(gt);F&&(y.context.activeTexture.set(M.TEXTURE0),ot.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),kt.updatePaintBuffers(R)),eo(kt,E,ut,ot,u);const jt=Dt?gt:null,ie=y.translatePosMatrix(jt?jt.posMatrix:gt.posMatrix,ot,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(k){lt=_t.indexBuffer2,et=_t.segments2;const ne=[M.drawingBufferWidth,M.drawingBufferHeight];tt=X==="fillOutlinePattern"&&F?xe(ie,y,R,ot,ne):Nt(ie,ne)}else lt=_t.indexBuffer,et=_t.segments,tt=F?Pt(ie,y,R,ot):ft(ie);Ct.draw(y.context,Z,g,y.stencilModeForClipping(gt),v,Ti.disabled,tt,Dt,u.id,_t.layoutVertexBuffer,lt,et,u.paint,y.transform.zoom,kt)}}function sn(y,n,u,f,g,v,k){const M=y.context,E=M.gl,z="fill-extrusion-pattern",F=u.paint.get(z),R=F.constantOr(1),Z=u.getCrossfadeParameters(),X=u.paint.get("fill-extrusion-opacity"),tt=F.constantOr(null);for(const lt of f){const et=n.getTile(lt),ut=et.getBucket(u);if(!ut)continue;const gt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(lt),ot=ut.programConfigurations.get(u.id),_t=y.useProgram(R?"fillExtrusionPattern":"fillExtrusion",ot);R&&(y.context.activeTexture.set(E.TEXTURE0),et.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),ot.updatePaintBuffers(Z)),eo(ot,z,tt,et,u);const kt=y.translatePosMatrix(lt.posMatrix,et,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Ct=u.paint.get("fill-extrusion-vertical-gradient"),Dt=R?Q(kt,y,Ct,X,lt,Z,et):U(kt,y,Ct,X);_t.draw(M,M.gl.TRIANGLES,g,v,k,Ti.backCCW,Dt,gt,u.id,ut.layoutVertexBuffer,ut.indexBuffer,ut.segments,u.paint,y.transform.zoom,ot,y.style.map.terrain&&ut.centroidVertexBuffer)}}function lp(y,n,u,f,g,v,k){const M=y.context,E=M.gl,z=u.fbo;if(!z)return;const F=y.useProgram("hillshade"),R=y.style.map.terrain&&y.style.map.terrain.getTerrainData(n);M.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,z.colorAttachment.get()),F.draw(M,E.TRIANGLES,g,v,k,Ti.disabled,((Z,X,tt,lt)=>{const et=tt.paint.get("hillshade-shadow-color"),ut=tt.paint.get("hillshade-highlight-color"),gt=tt.paint.get("hillshade-accent-color");let ot=tt.paint.get("hillshade-illumination-direction")*(Math.PI/180);tt.paint.get("hillshade-illumination-anchor")==="viewport"&&(ot-=Z.transform.angle);const _t=!Z.options.moving;return{u_matrix:lt?lt.posMatrix:Z.transform.calculatePosMatrix(X.tileID.toUnwrapped(),_t),u_image:0,u_latrange:ql(0,X.tileID),u_light:[tt.paint.get("hillshade-exaggeration"),ot],u_shadow:et,u_highlight:ut,u_accent:gt}})(y,u,f,R?n:null),R,f.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}function cp(y,n,u,f,g,v){const k=y.context,M=k.gl,E=n.dem;if(E&&E.data){const z=E.dim,F=E.stride,R=E.getPixels();if(k.activeTexture.set(M.TEXTURE1),k.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||y.getTileTexture(F),n.demTexture){const X=n.demTexture;X.update(R,{premultiply:!1}),X.bind(M.NEAREST,M.CLAMP_TO_EDGE)}else n.demTexture=new Ot(k,R,M.RGBA,{premultiply:!1}),n.demTexture.bind(M.NEAREST,M.CLAMP_TO_EDGE);k.activeTexture.set(M.TEXTURE0);let Z=n.fbo;if(!Z){const X=new Ot(k,{width:z,height:z,data:null},M.RGBA);X.bind(M.LINEAR,M.CLAMP_TO_EDGE),Z=n.fbo=k.createFramebuffer(z,z,!0,!1),Z.colorAttachment.set(X.texture)}k.bindFramebuffer.set(Z.framebuffer),k.viewport.set([0,0,z,z]),y.useProgram("hillshadePrepare").draw(k,M.TRIANGLES,f,g,v,Ti.disabled,((X,tt)=>{const lt=tt.stride,et=c.F();return c.aO(et,0,c.W,-c.W,0,0,1),c.H(et,et,[0,-c.W,0]),{u_matrix:et,u_image:1,u_dimension:[lt,lt],u_zoom:X.overscaledZ,u_unpack:tt.getUnpackVector()}})(n.tileID,E),null,u.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function zu(y,n,u,f,g,v){const k=f.paint.get("raster-fade-duration");if(!v&&k>0){const M=P.now(),E=(M-y.timeAdded)/k,z=n?(M-n.timeAdded)/k:-1,F=u.getSource(),R=g.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),Z=!n||Math.abs(n.tileID.overscaledZ-R)>Math.abs(y.tileID.overscaledZ-R),X=Z&&y.refreshedUponExpiration?1:c.ac(Z?E:1-z,0,1);return y.refreshedUponExpiration&&E>=1&&(y.refreshedUponExpiration=!1),n?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}const So=new c.aP(1,0,0,1),ic=new c.aP(0,1,0,1),rc=new c.aP(0,0,1,1),sl=new c.aP(1,0,1,1),nc=new c.aP(0,1,1,1);function Du(y,n,u,f){Es(y,0,n+u/2,y.transform.width,u,f)}function ko(y,n,u,f){Es(y,n-u/2,0,u,y.transform.height,f)}function Es(y,n,u,f,g,v){const k=y.context,M=k.gl;M.enable(M.SCISSOR_TEST),M.scissor(n*y.pixelRatio,u*y.pixelRatio,f*y.pixelRatio,g*y.pixelRatio),k.clear({color:v}),M.disable(M.SCISSOR_TEST)}function up(y,n,u){const f=y.context,g=f.gl,v=u.posMatrix,k=y.useProgram("debug"),M=Oe.disabled,E=Ei.disabled,z=y.colorModeForRenderPass(),F="$debug",R=y.style.map.terrain&&y.style.map.terrain.getTerrainData(u);f.activeTexture.set(g.TEXTURE0);const Z=n.getTileByID(u.key).latestRawTileData,X=Math.floor((Z&&Z.byteLength||0)/1024),tt=n.getTile(u).tileSize,lt=512/Math.min(tt,512)*(u.overscaledZ/y.transform.zoom)*.5;let et=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(et+=` => ${u.overscaledZ}`),function(ut,gt){ut.initDebugOverlayCanvas();const ot=ut.debugOverlayCanvas,_t=ut.context.gl,kt=ut.debugOverlayCanvas.getContext("2d");kt.clearRect(0,0,ot.width,ot.height),kt.shadowColor="white",kt.shadowBlur=2,kt.lineWidth=1.5,kt.strokeStyle="white",kt.textBaseline="top",kt.font="bold 36px Open Sans, sans-serif",kt.fillText(gt,5,5),kt.strokeText(gt,5,5),ut.debugOverlayTexture.update(ot),ut.debugOverlayTexture.bind(_t.LINEAR,_t.CLAMP_TO_EDGE)}(y,`${et} ${X}kB`),k.draw(f,g.TRIANGLES,M,E,ji.alphaBlended,Ti.disabled,Gr(v,c.aP.transparent,lt),null,F,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),k.draw(f,g.LINE_STRIP,M,E,z,Ti.disabled,Gr(v,c.aP.red),R,F,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function sc(y,n,u){const f=y.context,g=f.gl,v=y.colorModeForRenderPass(),k=new Oe(g.LEQUAL,Oe.ReadWrite,y.depthRangeFor3D),M=y.useProgram("terrain"),E=n.getTerrainMesh();f.bindFramebuffer.set(null),f.viewport.set([0,0,y.width,y.height]);for(const z of u){const F=y.renderToTexture.getTexture(z),R=n.getTerrainData(z.tileID);f.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,F.texture);const Z={u_matrix:y.transform.calculatePosMatrix(z.tileID.toUnwrapped()),u_texture:0,u_ele_delta:n.getMeshFrameDelta(y.transform.zoom)};M.draw(f,g.TRIANGLES,k,Ei.disabled,v,Ti.backCCW,Z,R,"terrain",E.vertexBuffer,E.indexBuffer,E.segments)}}class Je{constructor(n,u){this.context=new Iu(n),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ht.maxUnderzooming+Ht.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new yi}resize(n,u,f){if(this.width=Math.floor(n*f),this.height=Math.floor(u*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style._order)this.style._layers[g].resize()}setup(){const n=this.context,u=new c.aW;u.emplaceBack(0,0),u.emplaceBack(c.W,0),u.emplaceBack(0,c.W),u.emplaceBack(c.W,c.W),this.tileExtentBuffer=n.createVertexBuffer(u,qr.members),this.tileExtentSegments=c.$.simpleSegment(0,0,4,2);const f=new c.aW;f.emplaceBack(0,0),f.emplaceBack(c.W,0),f.emplaceBack(0,c.W),f.emplaceBack(c.W,c.W),this.debugBuffer=n.createVertexBuffer(f,qr.members),this.debugSegments=c.$.simpleSegment(0,0,4,5);const g=new c.Z;g.emplaceBack(0,0,0,0),g.emplaceBack(c.W,0,c.W,0),g.emplaceBack(0,c.W,0,c.W),g.emplaceBack(c.W,c.W,c.W,c.W),this.rasterBoundsBuffer=n.createVertexBuffer(g,li.members),this.rasterBoundsSegments=c.$.simpleSegment(0,0,4,2);const v=new c.aW;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(v,qr.members),this.viewportSegments=c.$.simpleSegment(0,0,4,2);const k=new c.aX;k.emplaceBack(0),k.emplaceBack(1),k.emplaceBack(3),k.emplaceBack(2),k.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(k);const M=new c.aY;M.emplaceBack(0,1,2),M.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(M);const E=this.context.gl;this.stencilClearMode=new Ei({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)}clearStencil(){const n=this.context,u=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=c.F();c.aO(f,0,this.width,this.height,0,0,1),c.J(f,f,[u.drawingBufferWidth,u.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,u.TRIANGLES,Oe.disabled,this.stencilClearMode,ji.disabled,Ti.disabled,Ar(f),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,u){if(this.currentStencilSource===n.source||!n.isTileClipped()||!u||!u.length)return;this.currentStencilSource=n.source;const f=this.context,g=f.gl;this.nextStencilID+u.length>256&&this.clearStencil(),f.setColorMode(ji.disabled),f.setDepthMode(Oe.disabled);const v=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const k of u){const M=this._tileClippingMaskIDs[k.key]=this.nextStencilID++,E=this.style.map.terrain&&this.style.map.terrain.getTerrainData(k);v.draw(f,g.TRIANGLES,Oe.disabled,new Ei({func:g.ALWAYS,mask:0},M,255,g.KEEP,g.KEEP,g.REPLACE),ji.disabled,Ti.disabled,Ar(k.posMatrix),E,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,u=this.context.gl;return new Ei({func:u.NOTEQUAL,mask:255},n,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(n){const u=this.context.gl;return new Ei({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(n){const u=this.context.gl,f=n.sort((k,M)=>M.overscaledZ-k.overscaledZ),g=f[f.length-1].overscaledZ,v=f[0].overscaledZ-g+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const k={};for(let M=0;M<v;M++)k[M+g]=new Ei({func:u.GEQUAL,mask:255},M+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=v,[k,f]}return[{[g]:Ei.disabled},f]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new ji([n.CONSTANT_COLOR,n.ONE],new c.aP(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ji.unblended:ji.alphaBlended}depthModeForSublayer(n,u,f){if(!this.opaquePassEnabledForLayer())return Oe.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Oe(f||this.context.gl.LEQUAL,u,[g,g])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,u){this.style=n,this.options=u,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(P.now()),this.imageManager.beginFrame();const f=this.style._order,g=this.style.sourceCaches,v={},k={},M={};for(const E in g){const z=g[E];z.used&&z.prepare(this.context),v[E]=z.getVisibleCoordinates(),k[E]=v[E].slice().reverse(),M[E]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let E=0;E<f.length;E++)if(this.style._layers[f[E]].is3D()){this.opaquePassCutoff=E;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const E of f){const z=this.style._layers[E];if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const F=k[z.source];(z.type==="custom"||F.length)&&this.renderLayer(this,g[z.source],z,F)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?c.aP.black:c.aP.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=f.length-1;this.currentLayer>=0;this.currentLayer--){const E=this.style._layers[f[this.currentLayer]],z=g[E.source],F=v[E.source];this._renderTileClippingMasks(E,F),this.renderLayer(this,z,E,F)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<f.length;this.currentLayer++){const E=this.style._layers[f[this.currentLayer]],z=g[E.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(E))continue;const F=(E.type==="symbol"?M:k)[E.source];this._renderTileClippingMasks(E,v[E.source]),this.renderLayer(this,z,E,F)}if(this.options.showTileBoundaries){const E=function(z,F){let R=null;const Z=Object.values(z._layers).flatMap(et=>et.source&&!et.isHidden(F)?[z.sourceCaches[et.source]]:[]),X=Z.filter(et=>et.getSource().type==="vector"),tt=Z.filter(et=>et.getSource().type!=="vector"),lt=et=>{(!R||R.getSource().maxzoom<et.getSource().maxzoom)&&(R=et)};return X.forEach(et=>lt(et)),R||tt.forEach(et=>lt(et)),R}(this.style,this.transform.zoom);E&&function(z,F,R){for(let Z=0;Z<R.length;Z++)up(z,F,R[Z])}(this,E,E.getVisibleCoordinates())}this.options.showPadding&&function(E){const z=E.transform.padding;Du(E,E.transform.height-(z.top||0),3,So),Du(E,z.bottom||0,3,ic),ko(E,z.left||0,3,rc),ko(E,E.transform.width-(z.right||0),3,sl);const F=E.transform.centerPoint;(function(R,Z,X,tt){Es(R,Z-1,X-10,2,20,tt),Es(R,Z-10,X-1,20,2,tt)})(E,F.x,E.transform.height-F.y,nc)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(n){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,f=this.transform.projMatrix;let g=this.terrainFacilitator.dirty;g||(g=n?!c.aZ(u,f):!c.a_(u,f)),g||(g=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),g&&(c.a$(u,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(v,k){const M=v.context,E=M.gl,z=ji.unblended,F=new Oe(E.LEQUAL,Oe.ReadWrite,[0,1]),R=k.getTerrainMesh(),Z=k.sourceCache.getRenderableTiles(),X=v.useProgram("terrainDepth");M.bindFramebuffer.set(k.getFramebuffer("depth").framebuffer),M.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),M.clear({color:c.aP.transparent,depth:1});for(const tt of Z){const lt=k.getTerrainData(tt.tileID),et={u_matrix:v.transform.calculatePosMatrix(tt.tileID.toUnwrapped()),u_ele_delta:k.getMeshFrameDelta(v.transform.zoom)};X.draw(M,E.TRIANGLES,F,Ei.disabled,z,Ti.backCCW,et,lt,"terrain",R.vertexBuffer,R.indexBuffer,R.segments)}M.bindFramebuffer.set(null),M.viewport.set([0,0,v.width,v.height])}(this,this.style.map.terrain),function(v,k){const M=v.context,E=M.gl,z=ji.unblended,F=new Oe(E.LEQUAL,Oe.ReadWrite,[0,1]),R=k.getTerrainMesh(),Z=k.getCoordsTexture(),X=k.sourceCache.getRenderableTiles(),tt=v.useProgram("terrainCoords");M.bindFramebuffer.set(k.getFramebuffer("coords").framebuffer),M.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),M.clear({color:c.aP.transparent,depth:1}),k.coordsIndex=[];for(const lt of X){const et=k.getTerrainData(lt.tileID);M.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,Z.texture);const ut={u_matrix:v.transform.calculatePosMatrix(lt.tileID.toUnwrapped()),u_terrain_coords_id:(255-k.coordsIndex.length)/255,u_texture:0,u_ele_delta:k.getMeshFrameDelta(v.transform.zoom)};tt.draw(M,E.TRIANGLES,F,Ei.disabled,z,Ti.backCCW,ut,et,"terrain",R.vertexBuffer,R.indexBuffer,R.segments),k.coordsIndex.push(lt.tileID.key)}M.bindFramebuffer.set(null),M.viewport.set([0,0,v.width,v.height])}(this,this.style.map.terrain))}renderLayer(n,u,f,g){if(!f.isHidden(this.transform.zoom)&&(f.type==="background"||f.type==="custom"||(g||[]).length))switch(this.id=f.id,f.type){case"symbol":(function(v,k,M,E,z){if(v.renderPass!=="translucent")return;const F=Ei.disabled,R=v.colorModeForRenderPass();(M._unevaluatedLayout.hasValue("text-variable-anchor")||M._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Z,X,tt,lt,et,ut,gt,ot,_t){const kt=X.transform,Ct=wi(),Dt=et==="map",jt=ut==="map";for(const ie of Z){const ne=lt.getTile(ie),Ut=ne.getBucket(tt);if(!Ut||!Ut.text||!Ut.text.segments.get().length)continue;const qt=c.ag(Ut.textSizeData,kt.zoom),ce=ke(ne,1,X.transform.zoom),Ce=Zn(ie.posMatrix,jt,Dt,X.transform,ce),Wt=tt.layout.get("icon-text-fit")!=="none"&&Ut.hasIconData();if(qt){const Xt=Math.pow(2,kt.zoom-ne.tileID.overscaledZ),Te=X.style.map.terrain?(Re,je)=>X.style.map.terrain.getElevation(ie,Re,je):null,_i=Ct.translatePosition(kt,ne,gt,ot);Ql(Ut,Dt,jt,_t,kt,Ce,ie.posMatrix,Xt,qt,Wt,Ct,_i,ie.toUnwrapped(),Te)}}}(E,v,M,k,M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),z),M.paint.get("icon-opacity").constantOr(1)!==0&&nl(v,k,M,E,!1,M.paint.get("icon-translate"),M.paint.get("icon-translate-anchor"),M.layout.get("icon-rotation-alignment"),M.layout.get("icon-pitch-alignment"),M.layout.get("icon-keep-upright"),F,R),M.paint.get("text-opacity").constantOr(1)!==0&&nl(v,k,M,E,!0,M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.layout.get("text-keep-upright"),F,R),k.map.showCollisionBoxes&&(op(v,k,M,E,!0),op(v,k,M,E,!1))})(n,u,f,g,this.style.placement.variableOffsets);break;case"circle":(function(v,k,M,E){if(v.renderPass!=="translucent")return;const z=M.paint.get("circle-opacity"),F=M.paint.get("circle-stroke-width"),R=M.paint.get("circle-stroke-opacity"),Z=!M.layout.get("circle-sort-key").isConstant();if(z.constantOr(1)===0&&(F.constantOr(1)===0||R.constantOr(1)===0))return;const X=v.context,tt=X.gl,lt=v.depthModeForSublayer(0,Oe.ReadOnly),et=Ei.disabled,ut=v.colorModeForRenderPass(),gt=[];for(let ot=0;ot<E.length;ot++){const _t=E[ot],kt=k.getTile(_t),Ct=kt.getBucket(M);if(!Ct)continue;const Dt=Ct.programConfigurations.get(M.id),jt=v.useProgram("circle",Dt),ie=Ct.layoutVertexBuffer,ne=Ct.indexBuffer,Ut=v.style.map.terrain&&v.style.map.terrain.getTerrainData(_t),qt={programConfiguration:Dt,program:jt,layoutVertexBuffer:ie,indexBuffer:ne,uniformValues:He(v,_t,kt,M),terrainData:Ut};if(Z){const ce=Ct.segments.get();for(const Ce of ce)gt.push({segments:new c.$([Ce]),sortKey:Ce.sortKey,state:qt})}else gt.push({segments:Ct.segments,sortKey:0,state:qt})}Z&&gt.sort((ot,_t)=>ot.sortKey-_t.sortKey);for(const ot of gt){const{programConfiguration:_t,program:kt,layoutVertexBuffer:Ct,indexBuffer:Dt,uniformValues:jt,terrainData:ie}=ot.state;kt.draw(X,tt.TRIANGLES,lt,et,ut,Ti.disabled,jt,ie,M.id,Ct,Dt,ot.segments,M.paint,v.transform.zoom,_t)}})(n,u,f,g);break;case"heatmap":(function(v,k,M,E){if(M.paint.get("heatmap-opacity")!==0)if(v.renderPass==="offscreen"){const z=v.context,F=z.gl,R=Ei.disabled,Z=new ji([F.ONE,F.ONE],c.aP.transparent,[!0,!0,!0,!0]);(function(X,tt,lt){const et=X.gl;X.activeTexture.set(et.TEXTURE1),X.viewport.set([0,0,tt.width/4,tt.height/4]);let ut=lt.heatmapFbo;if(ut)et.bindTexture(et.TEXTURE_2D,ut.colorAttachment.get()),X.bindFramebuffer.set(ut.framebuffer);else{const gt=et.createTexture();et.bindTexture(et.TEXTURE_2D,gt),et.texParameteri(et.TEXTURE_2D,et.TEXTURE_WRAP_S,et.CLAMP_TO_EDGE),et.texParameteri(et.TEXTURE_2D,et.TEXTURE_WRAP_T,et.CLAMP_TO_EDGE),et.texParameteri(et.TEXTURE_2D,et.TEXTURE_MIN_FILTER,et.LINEAR),et.texParameteri(et.TEXTURE_2D,et.TEXTURE_MAG_FILTER,et.LINEAR),ut=lt.heatmapFbo=X.createFramebuffer(tt.width/4,tt.height/4,!1,!1),function(ot,_t,kt,Ct){var Dt,jt;const ie=ot.gl,ne=(Dt=ot.HALF_FLOAT)!==null&&Dt!==void 0?Dt:ie.UNSIGNED_BYTE,Ut=(jt=ot.RGBA16F)!==null&&jt!==void 0?jt:ie.RGBA;ie.texImage2D(ie.TEXTURE_2D,0,Ut,_t.width/4,_t.height/4,0,ie.RGBA,ne,null),Ct.colorAttachment.set(kt)}(X,tt,gt,ut)}})(z,v,M),z.clear({color:c.aP.transparent});for(let X=0;X<E.length;X++){const tt=E[X];if(k.hasRenderableParent(tt))continue;const lt=k.getTile(tt),et=lt.getBucket(M);if(!et)continue;const ut=et.programConfigurations.get(M.id),gt=v.useProgram("heatmap",ut),{zoom:ot}=v.transform;gt.draw(z,F.TRIANGLES,Oe.disabled,R,Z,Ti.disabled,fr(tt.posMatrix,lt,ot,M.paint.get("heatmap-intensity")),null,M.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,M.paint,v.transform.zoom,ut)}z.viewport.set([0,0,v.width,v.height])}else v.renderPass==="translucent"&&(v.context.setColorMode(v.colorModeForRenderPass()),function(z,F){const R=z.context,Z=R.gl,X=F.heatmapFbo;if(!X)return;R.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,X.colorAttachment.get()),R.activeTexture.set(Z.TEXTURE1);let tt=F.colorRampTexture;tt||(tt=F.colorRampTexture=new Ot(R,F.colorRamp,Z.RGBA)),tt.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),z.useProgram("heatmapTexture").draw(R,Z.TRIANGLES,Oe.disabled,Ei.disabled,z.colorModeForRenderPass(),Ti.disabled,((lt,et,ut,gt)=>{const ot=c.F();c.aO(ot,0,lt.width,lt.height,0,0,1);const _t=lt.context.gl;return{u_matrix:ot,u_world:[_t.drawingBufferWidth,_t.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:et.paint.get("heatmap-opacity")}})(z,F),null,F.id,z.viewportBuffer,z.quadTriangleIndexBuffer,z.viewportSegments,F.paint,z.transform.zoom)}(v,M))})(n,u,f,g);break;case"line":(function(v,k,M,E){if(v.renderPass!=="translucent")return;const z=M.paint.get("line-opacity"),F=M.paint.get("line-width");if(z.constantOr(1)===0||F.constantOr(1)===0)return;const R=v.depthModeForSublayer(0,Oe.ReadOnly),Z=v.colorModeForRenderPass(),X=M.paint.get("line-dasharray"),tt=M.paint.get("line-pattern"),lt=tt.constantOr(1),et=M.paint.get("line-gradient"),ut=M.getCrossfadeParameters(),gt=lt?"linePattern":X?"lineSDF":et?"lineGradient":"line",ot=v.context,_t=ot.gl;let kt=!0;for(const Ct of E){const Dt=k.getTile(Ct);if(lt&&!Dt.patternsLoaded())continue;const jt=Dt.getBucket(M);if(!jt)continue;const ie=jt.programConfigurations.get(M.id),ne=v.context.program.get(),Ut=v.useProgram(gt,ie),qt=kt||Ut.program!==ne,ce=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ct),Ce=tt.constantOr(null);if(Ce&&Dt.imageAtlas){const Te=Dt.imageAtlas,_i=Te.patternPositions[Ce.to.toString()],Re=Te.patternPositions[Ce.from.toString()];_i&&Re&&ie.setConstantPatternPositions(_i,Re)}const Wt=ce?Ct:null,Xt=lt?vu(v,Dt,M,ut,Wt):X?Gl(v,Dt,M,X,ut,Wt):et?yn(v,Dt,M,jt.lineClipsArray.length,Wt):Wr(v,Dt,M,Wt);if(lt)ot.activeTexture.set(_t.TEXTURE0),Dt.imageAtlasTexture.bind(_t.LINEAR,_t.CLAMP_TO_EDGE),ie.updatePaintBuffers(ut);else if(X&&(qt||v.lineAtlas.dirty))ot.activeTexture.set(_t.TEXTURE0),v.lineAtlas.bind(ot);else if(et){const Te=jt.gradients[M.id];let _i=Te.texture;if(M.gradientVersion!==Te.version){let Re=256;if(M.stepInterpolant){const je=k.getSource().maxzoom,vi=Ct.canonical.z===je?Math.ceil(1<<v.transform.maxZoom-Ct.canonical.z):1;Re=c.ac(c.aU(jt.maxLineLength/c.W*1024*vi),256,ot.maxTextureSize)}Te.gradient=c.aV({expression:M.gradientExpression(),evaluationKey:"lineProgress",resolution:Re,image:Te.gradient||void 0,clips:jt.lineClipsArray}),Te.texture?Te.texture.update(Te.gradient):Te.texture=new Ot(ot,Te.gradient,_t.RGBA),Te.version=M.gradientVersion,_i=Te.texture}ot.activeTexture.set(_t.TEXTURE0),_i.bind(M.stepInterpolant?_t.NEAREST:_t.LINEAR,_t.CLAMP_TO_EDGE)}Ut.draw(ot,_t.TRIANGLES,R,v.stencilModeForClipping(Ct),Z,Ti.disabled,Xt,ce,M.id,jt.layoutVertexBuffer,jt.indexBuffer,jt.segments,M.paint,v.transform.zoom,ie,jt.layoutVertexBuffer2),kt=!1}})(n,u,f,g);break;case"fill":(function(v,k,M,E){const z=M.paint.get("fill-color"),F=M.paint.get("fill-opacity");if(F.constantOr(1)===0)return;const R=v.colorModeForRenderPass(),Z=M.paint.get("fill-pattern"),X=v.opaquePassEnabledForLayer()&&!Z.constantOr(1)&&z.constantOr(c.aP.transparent).a===1&&F.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===X){const tt=v.depthModeForSublayer(1,v.renderPass==="opaque"?Oe.ReadWrite:Oe.ReadOnly);wo(v,k,M,E,tt,R,!1)}if(v.renderPass==="translucent"&&M.paint.get("fill-antialias")){const tt=v.depthModeForSublayer(M.getPaintProperty("fill-outline-color")?2:0,Oe.ReadOnly);wo(v,k,M,E,tt,R,!0)}})(n,u,f,g);break;case"fill-extrusion":(function(v,k,M,E){const z=M.paint.get("fill-extrusion-opacity");if(z!==0&&v.renderPass==="translucent"){const F=new Oe(v.context.gl.LEQUAL,Oe.ReadWrite,v.depthRangeFor3D);if(z!==1||M.paint.get("fill-extrusion-pattern").constantOr(1))sn(v,k,M,E,F,Ei.disabled,ji.disabled),sn(v,k,M,E,F,v.stencilModeFor3D(),v.colorModeForRenderPass());else{const R=v.colorModeForRenderPass();sn(v,k,M,E,F,Ei.disabled,R)}}})(n,u,f,g);break;case"hillshade":(function(v,k,M,E){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const z=v.context,F=v.depthModeForSublayer(0,Oe.ReadOnly),R=v.colorModeForRenderPass(),[Z,X]=v.renderPass==="translucent"?v.stencilConfigForOverlap(E):[{},E];for(const tt of X){const lt=k.getTile(tt);lt.needsHillshadePrepare!==void 0&&lt.needsHillshadePrepare&&v.renderPass==="offscreen"?cp(v,lt,M,F,Ei.disabled,R):v.renderPass==="translucent"&&lp(v,tt,lt,M,F,Z[tt.overscaledZ],R)}z.viewport.set([0,0,v.width,v.height])})(n,u,f,g);break;case"raster":(function(v,k,M,E){if(v.renderPass!=="translucent"||M.paint.get("raster-opacity")===0||!E.length)return;const z=v.context,F=z.gl,R=k.getSource(),Z=v.useProgram("raster"),X=v.colorModeForRenderPass(),[tt,lt]=R instanceof Vi?[{},E]:v.stencilConfigForOverlap(E),et=lt[lt.length-1].overscaledZ,ut=!v.options.moving;for(const gt of lt){const ot=v.depthModeForSublayer(gt.overscaledZ-et,M.paint.get("raster-opacity")===1?Oe.ReadWrite:Oe.ReadOnly,F.LESS),_t=k.getTile(gt);_t.registerFadeDuration(M.paint.get("raster-fade-duration"));const kt=k.findLoadedParent(gt,0),Ct=k.findLoadedSibling(gt),Dt=zu(_t,kt||Ct||null,k,M,v.transform,v.style.map.terrain);let jt,ie;const ne=M.paint.get("raster-resampling")==="nearest"?F.NEAREST:F.LINEAR;z.activeTexture.set(F.TEXTURE0),_t.texture.bind(ne,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),z.activeTexture.set(F.TEXTURE1),kt?(kt.texture.bind(ne,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),jt=Math.pow(2,kt.tileID.overscaledZ-_t.tileID.overscaledZ),ie=[_t.tileID.canonical.x*jt%1,_t.tileID.canonical.y*jt%1]):_t.texture.bind(ne,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST);const Ut=v.style.map.terrain&&v.style.map.terrain.getTerrainData(gt),qt=Ut?gt:null,ce=qt?qt.posMatrix:v.transform.calculatePosMatrix(gt.toUnwrapped(),ut),Ce=ta(ce,ie||[0,0],jt||1,Dt,M);R instanceof Vi?Z.draw(z,F.TRIANGLES,ot,Ei.disabled,X,Ti.disabled,Ce,Ut,M.id,R.boundsBuffer,v.quadTriangleIndexBuffer,R.boundsSegments):Z.draw(z,F.TRIANGLES,ot,tt[gt.overscaledZ],X,Ti.disabled,Ce,Ut,M.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}})(n,u,f,g);break;case"background":(function(v,k,M,E){const z=M.paint.get("background-color"),F=M.paint.get("background-opacity");if(F===0)return;const R=v.context,Z=R.gl,X=v.transform,tt=X.tileSize,lt=M.paint.get("background-pattern");if(v.isPatternMissing(lt))return;const et=!lt&&z.a===1&&F===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==et)return;const ut=Ei.disabled,gt=v.depthModeForSublayer(0,et==="opaque"?Oe.ReadWrite:Oe.ReadOnly),ot=v.colorModeForRenderPass(),_t=v.useProgram(lt?"backgroundPattern":"background"),kt=E||X.coveringTiles({tileSize:tt,terrain:v.style.map.terrain});lt&&(R.activeTexture.set(Z.TEXTURE0),v.imageManager.bind(v.context));const Ct=M.getCrossfadeParameters();for(const Dt of kt){const jt=E?Dt.posMatrix:v.transform.calculatePosMatrix(Dt.toUnwrapped()),ie=lt?og(jt,F,v,lt,{tileID:Dt,tileSize:tt},Ct):sg(jt,F,z),ne=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Dt);_t.draw(R,Z.TRIANGLES,gt,ut,ot,Ti.disabled,ie,ne,M.id,v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}})(n,0,f,g);break;case"custom":(function(v,k,M){const E=v.context,z=M.implementation;if(v.renderPass==="offscreen"){const F=z.prerender;F&&(v.setCustomLayerDefaults(),E.setColorMode(v.colorModeForRenderPass()),F.call(z,E.gl,v.transform.customLayerMatrix()),E.setDirty(),v.setBaseState())}else if(v.renderPass==="translucent"){v.setCustomLayerDefaults(),E.setColorMode(v.colorModeForRenderPass()),E.setStencilMode(Ei.disabled);const F=z.renderingMode==="3d"?new Oe(v.context.gl.LEQUAL,Oe.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,Oe.ReadOnly);E.setDepthMode(F),z.render(E.gl,v.transform.customLayerMatrix()),E.setDirty(),v.setBaseState(),E.bindFramebuffer.set(null)}})(n,0,f)}}translatePosMatrix(n,u,f,g,v){if(!f[0]&&!f[1])return n;const k=v?g==="map"?this.transform.angle:0:g==="viewport"?-this.transform.angle:0;if(k){const z=Math.sin(k),F=Math.cos(k);f=[f[0]*F-f[1]*z,f[0]*z+f[1]*F]}const M=[v?f[0]:ke(u,f[0],this.transform.zoom),v?f[1]:ke(u,f[1],this.transform.zoom),0],E=new Float32Array(16);return c.H(E,n,M),E}saveTileTexture(n){const u=this._tileTextures[n.size[0]];u?u.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const u=this._tileTextures[n];return u&&u.length>0?u.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const u=this.imageManager.getPattern(n.from.toString()),f=this.imageManager.getPattern(n.to.toString());return!u||!f}useProgram(n,u){this.cache=this.cache||{};const f=n+(u?u.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[f]||(this.cache[f]=new Ja(this.context,Qs[n],u,Wl[n],this._showOverdrawInspector,this.style.map.terrain)),this.cache[f]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ot(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:n,drawingBufferHeight:u}=this.context.gl;return this.width!==n||this.height!==u}}class ra{constructor(n,u){this.points=n,this.planes=u}static fromInvProjectionMatrix(n,u,f){const g=Math.pow(2,f),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(M=>{const E=1/(M=c.af([],M,n))[3]/u*g;return c.b0(M,M,[E,E,1/M[3],E])}),k=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(M=>{const E=function(Z,X){var tt=X[0],lt=X[1],et=X[2],ut=tt*tt+lt*lt+et*et;return ut>0&&(ut=1/Math.sqrt(ut)),Z[0]=X[0]*ut,Z[1]=X[1]*ut,Z[2]=X[2]*ut,Z}([],function(Z,X,tt){var lt=X[0],et=X[1],ut=X[2],gt=tt[0],ot=tt[1],_t=tt[2];return Z[0]=et*_t-ut*ot,Z[1]=ut*gt-lt*_t,Z[2]=lt*ot-et*gt,Z}([],Tt([],v[M[0]],v[M[1]]),Tt([],v[M[2]],v[M[1]]))),z=-((F=E)[0]*(R=v[M[1]])[0]+F[1]*R[1]+F[2]*R[2]);var F,R;return E.concat(z)});return new ra(v,k)}}class oc{constructor(n,u){this.min=n,this.max=u,this.center=function(f,g,v){return f[0]=.5*g[0],f[1]=.5*g[1],f[2]=.5*g[2],f}([],function(f,g,v){return f[0]=g[0]+v[0],f[1]=g[1]+v[1],f[2]=g[2]+v[2],f}([],this.min,this.max))}quadrant(n){const u=[n%2==0,n<2],f=mt(this.min),g=mt(this.max);for(let v=0;v<u.length;v++)f[v]=u[v]?this.min[v]:this.center[v],g[v]=u[v]?this.center[v]:this.max[v];return g[2]=this.max[2],new oc(f,g)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersects(n){const u=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let f=!0;for(let g=0;g<n.planes.length;g++){const v=n.planes[g];let k=0;for(let M=0;M<u.length;M++)c.b1(v,u[M])>=0&&k++;if(k===0)return 0;k!==u.length&&(f=!1)}if(f)return 2;for(let g=0;g<3;g++){let v=Number.MAX_VALUE,k=-Number.MAX_VALUE;for(let M=0;M<n.points.length;M++){const E=n.points[M][g]-this.min[g];v=Math.min(v,E),k=Math.max(k,E)}if(k<0||v>this.max[g]-this.min[g])return 0}return 1}}class ol{constructor(n=0,u=0,f=0,g=0){if(isNaN(n)||n<0||isNaN(u)||u<0||isNaN(f)||f<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=u,this.left=f,this.right=g}interpolate(n,u,f){return u.top!=null&&n.top!=null&&(this.top=c.z.number(n.top,u.top,f)),u.bottom!=null&&n.bottom!=null&&(this.bottom=c.z.number(n.bottom,u.bottom,f)),u.left!=null&&n.left!=null&&(this.left=c.z.number(n.left,u.left,f)),u.right!=null&&n.right!=null&&(this.right=c.z.number(n.right,u.right,f)),this}getCenter(n,u){const f=c.ac((this.left+n-this.right)/2,0,n),g=c.ac((this.top+u-this.bottom)/2,0,u);return new c.P(f,g)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new ol(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const na=85.051129;class Lu{constructor(n,u,f,g,v){this.tileSize=512,this._renderWorldCopies=v===void 0||!!v,this._minZoom=n||0,this._maxZoom=u||22,this._minPitch=f??0,this._maxPitch=g??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ol,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const n=new Lu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.apply(this),n}apply(n){this.tileSize=n.tileSize,this.latRange=n.latRange,this.width=n.width,this.height=n.height,this._center=n._center,this._elevation=n._elevation,this.minElevationForCurrentTile=n.minElevationForCurrentTile,this.zoom=n.zoom,this.angle=n.angle,this._fov=n._fov,this._pitch=n._pitch,this._unmodified=n._unmodified,this._edgeInsets=n._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(n){const u=-c.b2(n,-180,180)*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=function(){var f=new c.A(4);return c.A!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}(),function(f,g,v){var k=g[0],M=g[1],E=g[2],z=g[3],F=Math.sin(v),R=Math.cos(v);f[0]=k*R+E*F,f[1]=M*R+z*F,f[2]=k*-F+E*R,f[3]=M*-F+z*R}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const u=c.ac(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(n){const u=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this.tileZoom=Math.max(0,Math.floor(u)),this.scale=this.zoomScale(u),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,u,f){this._unmodified=!1,this._edgeInsets.interpolate(n,u,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const u=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(n){const u=[new c.b3(0,n)];if(this._renderWorldCopies){const f=this.pointCoordinate(new c.P(0,0)),g=this.pointCoordinate(new c.P(this.width,0)),v=this.pointCoordinate(new c.P(this.width,this.height)),k=this.pointCoordinate(new c.P(0,this.height)),M=Math.floor(Math.min(f.x,g.x,v.x,k.x)),E=Math.floor(Math.max(f.x,g.x,v.x,k.x)),z=1;for(let F=M-z;F<=E+z;F++)F!==0&&u.push(new c.b3(F,n))}return u}coveringTiles(n){var u,f;let g=this.coveringZoomLevel(n);const v=g;if(n.minzoom!==void 0&&g<n.minzoom)return[];n.maxzoom!==void 0&&g>n.maxzoom&&(g=n.maxzoom);const k=this.pointCoordinate(this.getCameraPoint()),M=c.Y.fromLngLat(this.center),E=Math.pow(2,g),z=[E*k.x,E*k.y,0],F=[E*M.x,E*M.y,0],R=ra.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,g);let Z=n.minzoom||0;!n.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(Z=g);const X=n.terrain?2/Math.min(this.tileSize,n.tileSize)*this.tileSize:3,tt=ot=>({aabb:new oc([ot*E,0,0],[(ot+1)*E,E,0]),zoom:0,x:0,y:0,wrap:ot,fullyVisible:!1}),lt=[],et=[],ut=g,gt=n.reparseOverscaled?v:g;if(this._renderWorldCopies)for(let ot=1;ot<=3;ot++)lt.push(tt(-ot)),lt.push(tt(ot));for(lt.push(tt(0));lt.length>0;){const ot=lt.pop(),_t=ot.x,kt=ot.y;let Ct=ot.fullyVisible;if(!Ct){const Ut=ot.aabb.intersects(R);if(Ut===0)continue;Ct=Ut===2}const Dt=n.terrain?z:F,jt=ot.aabb.distanceX(Dt),ie=ot.aabb.distanceY(Dt),ne=Math.max(Math.abs(jt),Math.abs(ie));if(ot.zoom===ut||ne>X+(1<<ut-ot.zoom)-2&&ot.zoom>=Z){const Ut=ut-ot.zoom,qt=z[0]-.5-(_t<<Ut),ce=z[1]-.5-(kt<<Ut);et.push({tileID:new c.Q(ot.zoom===ut?gt:ot.zoom,ot.wrap,ot.zoom,_t,kt),distanceSq:Mt([F[0]-.5-_t,F[1]-.5-kt]),tileDistanceToCamera:Math.sqrt(qt*qt+ce*ce)})}else for(let Ut=0;Ut<4;Ut++){const qt=(_t<<1)+Ut%2,ce=(kt<<1)+(Ut>>1),Ce=ot.zoom+1;let Wt=ot.aabb.quadrant(Ut);if(n.terrain){const Xt=new c.Q(Ce,ot.wrap,Ce,qt,ce),Te=n.terrain.getMinMaxElevation(Xt),_i=(u=Te.minElevation)!==null&&u!==void 0?u:this.elevation,Re=(f=Te.maxElevation)!==null&&f!==void 0?f:this.elevation;Wt=new oc([Wt.min[0],Wt.min[1],_i],[Wt.max[0],Wt.max[1],Re])}lt.push({aabb:Wt,zoom:Ce,x:qt,y:ce,wrap:ot.wrap,fullyVisible:Ct})}}return et.sort((ot,_t)=>ot.distanceSq-_t.distanceSq).map(ot=>ot.tileID)}resize(n,u){this.width=n,this.height=u,this.pixelsToGLUnits=[2/n,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const u=c.ac(n.lat,-85.051129,na);return new c.P(c.N(n.lng)*this.worldSize,c.O(u)*this.worldSize)}unproject(n){return new c.Y(n.x/this.worldSize,n.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(n){const u=this.elevation,f=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,g=this.pointLocation(this.centerPoint,n),v=n.getElevationForLngLatZoom(g,this.tileZoom);if(!(this.elevation-v))return;const k=f+u-v,M=Math.cos(this._pitch)*this.cameraToCenterDistance/k/c.b4(1,g.lat),E=this.scaleZoom(M/this.tileSize);this._elevation=v,this._center=g,this.zoom=E}setLocationAtPoint(n,u){const f=this.pointCoordinate(u),g=this.pointCoordinate(this.centerPoint),v=this.locationCoordinate(n),k=new c.Y(v.x-(f.x-g.x),v.y-(f.y-g.y));this.center=this.coordinateLocation(k),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(n,u){return u?this.coordinatePoint(this.locationCoordinate(n),u.getElevationForLngLatZoom(n,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(n))}pointLocation(n,u){return this.coordinateLocation(this.pointCoordinate(n,u))}locationCoordinate(n){return c.Y.fromLngLat(n)}coordinateLocation(n){return n&&n.toLngLat()}pointCoordinate(n,u){if(u){const Z=u.pointCoordinate(n);if(Z!=null)return Z}const f=[n.x,n.y,0,1],g=[n.x,n.y,1,1];c.af(f,f,this.pixelMatrixInverse),c.af(g,g,this.pixelMatrixInverse);const v=f[3],k=g[3],M=f[1]/v,E=g[1]/k,z=f[2]/v,F=g[2]/k,R=z===F?0:(0-z)/(F-z);return new c.Y(c.z.number(f[0]/v,g[0]/k,R)/this.worldSize,c.z.number(M,E,R)/this.worldSize)}coordinatePoint(n,u=0,f=this.pixelMatrix){const g=[n.x*this.worldSize,n.y*this.worldSize,u,1];return c.af(g,g,f),new c.P(g[0]/g[3],g[1]/g[3])}getBounds(){const n=Math.max(0,this.height/2-this.getHorizon());return new ci().extend(this.pointLocation(new c.P(0,n))).extend(this.pointLocation(new c.P(this.width,n))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ci([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,na])}calculatePosMatrix(n,u=!1){const f=n.key,g=u?this._alignedPosMatrixCache:this._posMatrixCache;if(g[f])return g[f];const v=n.canonical,k=this.worldSize/this.zoomScale(v.z),M=v.x+Math.pow(2,v.z)*n.wrap,E=c.an(new Float64Array(16));return c.H(E,E,[M*k,v.y*k,0]),c.J(E,E,[k/c.W,k/c.W,1]),c.K(E,u?this.alignedProjMatrix:this.projMatrix,E),g[f]=new Float32Array(E),g[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(n,u){u=c.ac(+u,this.minZoom,this.maxZoom);const f={center:new c.M(n.lng,n.lat),zoom:u};let g=this.lngRange;if(!this._renderWorldCopies&&g===null){const ot=179.9999999999;g=[-ot,ot]}const v=this.tileSize*this.zoomScale(f.zoom);let k=0,M=v,E=0,z=v,F=0,R=0;const{x:Z,y:X}=this.size;if(this.latRange){const ot=this.latRange;k=c.O(ot[1])*v,M=c.O(ot[0])*v,M-k<X&&(F=X/(M-k))}g&&(E=c.b2(c.N(g[0])*v,0,v),z=c.b2(c.N(g[1])*v,0,v),z<E&&(z+=v),z-E<Z&&(R=Z/(z-E)));const{x:tt,y:lt}=this.project.call({worldSize:v},n);let et,ut;const gt=Math.max(R||0,F||0);if(gt){const ot=new c.P(R?(z+E)/2:tt,F?(M+k)/2:lt);return f.center=this.unproject.call({worldSize:v},ot).wrap(),f.zoom+=this.scaleZoom(gt),f}if(this.latRange){const ot=X/2;lt-ot<k&&(ut=k+ot),lt+ot>M&&(ut=M-ot)}if(g){const ot=(E+z)/2;let _t=tt;this._renderWorldCopies&&(_t=c.b2(tt,ot-v/2,ot+v/2));const kt=Z/2;_t-kt<E&&(et=E+kt),_t+kt>z&&(et=z-kt)}if(et!==void 0||ut!==void 0){const ot=new c.P(et??tt,ut??lt);f.center=this.unproject.call({worldSize:v},ot).wrap()}return f}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this._unmodified,{center:u,zoom:f}=this.getConstrained(this.center,this.zoom);this.center=u,this.zoom=f,this._unmodified=n,this._constraining=!1}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,u=this.point.x,f=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b4(1,this.center.lat)*this.worldSize;let g=c.an(new Float64Array(16));c.J(g,g,[this.width/2,-this.height/2,1]),c.H(g,g,[1,-1,0]),this.labelPlaneMatrix=g,g=c.an(new Float64Array(16)),c.J(g,g,[1,-1,1]),c.H(g,g,[-1,-1,0]),c.J(g,g,[2/this.width,2/this.height,1]),this.glCoordMatrix=g;const v=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),k=Math.min(this.elevation,this.minElevationForCurrentTile),M=v-k*this._pixelPerMeter/Math.cos(this._pitch),E=k<0?M:v,z=Math.PI/2+this._pitch,F=this._fov*(.5+n.y/this.height),R=Math.sin(F)*E/Math.sin(c.ac(Math.PI-z-F,.01,Math.PI-.01)),Z=this.getHorizon(),X=2*Math.atan(Z/this.cameraToCenterDistance)*(.5+n.y/(2*Z)),tt=Math.sin(X)*E/Math.sin(c.ac(Math.PI-z-X,.01,Math.PI-.01)),lt=Math.min(R,tt),et=1.01*(Math.cos(Math.PI/2-this._pitch)*lt+E),ut=this.height/50;g=new Float64Array(16),c.b5(g,this._fov,this.width/this.height,ut,et),g[8]=2*-n.x/this.width,g[9]=2*n.y/this.height,c.J(g,g,[1,-1,1]),c.H(g,g,[0,0,-this.cameraToCenterDistance]),c.b6(g,g,this._pitch),c.ad(g,g,this.angle),c.H(g,g,[-u,-f,0]),this.mercatorMatrix=c.J([],g,[this.worldSize,this.worldSize,this.worldSize]),c.J(g,g,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.K(new Float64Array(16),this.labelPlaneMatrix,g),c.H(g,g,[0,0,-this.elevation]),this.projMatrix=g,this.invProjMatrix=c.as([],g),this.pixelMatrix3D=c.K(new Float64Array(16),this.labelPlaneMatrix,g);const gt=this.width%2/2,ot=this.height%2/2,_t=Math.cos(this.angle),kt=Math.sin(this.angle),Ct=u-Math.round(u)+_t*gt+kt*ot,Dt=f-Math.round(f)+_t*ot+kt*gt,jt=new Float64Array(g);if(c.H(jt,jt,[Ct>.5?Ct-1:Ct,Dt>.5?Dt-1:Dt,0]),this.alignedProjMatrix=jt,g=c.as(new Float64Array(16),this.pixelMatrix),!g)throw new Error("failed to invert matrix");this.pixelMatrixInverse=g,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const n=this.pointCoordinate(new c.P(0,0)),u=[n.x*this.worldSize,n.y*this.worldSize,0,1];return c.af(u,u,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,n))}getCameraQueryGeometry(n){const u=this.getCameraPoint();if(n.length===1)return[n[0],u];{let f=u.x,g=u.y,v=u.x,k=u.y;for(const M of n)f=Math.min(f,M.x),g=Math.min(g,M.y),v=Math.max(v,M.x),k=Math.max(k,M.y);return[new c.P(f,g),new c.P(v,g),new c.P(v,k),new c.P(f,k),new c.P(f,g)]}}lngLatToCameraDepth(n,u){const f=this.locationCoordinate(n),g=[f.x*this.worldSize,f.y*this.worldSize,u,1];return c.af(g,g,this.projMatrix),g[2]/g[3]}}function hp(y,n){let u,f=!1,g=null,v=null;const k=()=>{g=null,f&&(y.apply(v,u),g=setTimeout(k,n),f=!1)};return(...M)=>(f=!0,v=this,u=M,g||k(),g)}class Ru{constructor(n){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let f;return u.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(f=g)}),(f&&f[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(u.length>=3&&!u.some(f=>isNaN(f))){const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:f,pitch:+(u[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,u)}catch{}},this._updateHash=hp(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(n){const u=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,g=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,g),k=Math.round(u.lng*v)/v,M=Math.round(u.lat*v)/v,E=this._map.getBearing(),z=this._map.getPitch();let F="";if(F+=n?`/${k}/${M}/${f}`:`${f}/${M}/${k}`,(E||z)&&(F+="/"+Math.round(10*E)/10),z&&(F+=`/${Math.round(z)}`),this._hashName){const R=this._hashName;let Z=!1;const X=window.location.hash.slice(1).split("&").map(tt=>{const lt=tt.split("=")[0];return lt===R?(Z=!0,`${lt}=${F}`):tt}).filter(tt=>tt);return Z||X.push(`${R}=${F}`),`#${X.join("&")}`}return`#${F}`}}const ac={linearity:.3,easing:c.b7(0,0,.3,1)},Fu=c.e({deceleration:2500,maxSpeed:1400},ac),lc=c.e({deceleration:20,maxSpeed:1400},ac),cc=c.e({deceleration:1e3,maxSpeed:360},ac),Ou=c.e({deceleration:1e3,maxSpeed:90},ac);class Bu{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:P.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,u=P.now();for(;n.length>0&&u-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)u.zoom+=v.zoomDelta||0,u.bearing+=v.bearingDelta||0,u.pitch+=v.pitchDelta||0,v.panDelta&&u.pan._add(v.panDelta),v.around&&(u.around=v.around),v.pinchAround&&(u.pinchAround=v.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(u.pan.mag()){const v=To(u.pan.mag(),f,c.e({},Fu,n||{}));g.offset=u.pan.mult(v.amount/u.pan.mag()),g.center=this._map.transform.center,al(g,v)}if(u.zoom){const v=To(u.zoom,f,lc);g.zoom=this._map.transform.zoom+v.amount,al(g,v)}if(u.bearing){const v=To(u.bearing,f,cc);g.bearing=this._map.transform.bearing+c.ac(v.amount,-179,179),al(g,v)}if(u.pitch){const v=To(u.pitch,f,Ou);g.pitch=this._map.transform.pitch+v.amount,al(g,v)}if(g.zoom||g.bearing){const v=u.pinchAround===void 0?u.around:u.pinchAround;g.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),c.e(g,{noMoveStart:!0})}}function al(y,n){(!y.duration||y.duration<n.duration)&&(y.duration=n.duration,y.easing=n.easing)}function To(y,n,u){const{maxSpeed:f,linearity:g,deceleration:v}=u,k=c.ac(y*g/(n/1e3),-f,f),M=Math.abs(k)/(v*g);return{easing:u.easing,duration:1e3*M,amount:k*(M/2)}}class zr extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,f,g={}){const v=A.mousePos(u.getCanvas(),f),k=u.unproject(v);super(n,c.e({point:v,lngLat:k,originalEvent:f},g)),this._defaultPrevented=!1,this.target=u}}class Mo extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,f){const g=n==="touchend"?f.changedTouches:f.touches,v=A.touchPos(u.getCanvasContainer(),g),k=v.map(E=>u.unproject(E)),M=v.reduce((E,z,F,R)=>E.add(z.div(R.length)),new c.P(0,0));super(n,{points:v,point:M,lngLats:k,lngLat:u.unproject(M),originalEvent:f}),this._defaultPrevented=!1}}class dp extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,f){super(n,{originalEvent:f}),this._defaultPrevented=!1}}class Vu{constructor(n,u){this._map=n,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new dp(n.type,this._map,n))}mousedown(n,u){return this._mousedownPos=u,this._firePreventable(new zr(n.type,this._map,n))}mouseup(n){this._map.fire(new zr(n.type,this._map,n))}click(n,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new zr(n.type,this._map,n))}dblclick(n){return this._firePreventable(new zr(n.type,this._map,n))}mouseover(n){this._map.fire(new zr(n.type,this._map,n))}mouseout(n){this._map.fire(new zr(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Mo(n.type,this._map,n))}touchmove(n){this._map.fire(new Mo(n.type,this._map,n))}touchend(n){this._map.fire(new Mo(n.type,this._map,n))}touchcancel(n){this._map.fire(new Mo(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class yg{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new zr(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new zr(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class sa{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.pointLocation(c.P.convert(n),this._map.terrain)}}class ll{constructor(n,u){this._map=n,this._tr=new sa(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,u){this.isEnabled()&&n.shiftKey&&n.button===0&&(A.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(n,u){if(!this._active)return;const f=u;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=f,this._box||(this._box=A.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const v=Math.min(g.x,f.x),k=Math.max(g.x,f.x),M=Math.min(g.y,f.y),E=Math.max(g.y,f.y);A.setTransform(this._box,`translate(${v}px,${M}px)`),this._box.style.width=k-v+"px",this._box.style.height=E-M+"px"}mouseupWindow(n,u){if(!this._active||n.button!==0)return;const f=this._startPos,g=u;if(this.reset(),A.suppressClick(),f.x!==g.x||f.y!==g.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:n})),{cameraAnimation:v=>v.fitScreenCoordinates(f,g,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(A.remove(this._box),this._box=null),A.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,u){return this._map.fire(new c.k(n,{originalEvent:u}))}}function cl(y,n){if(y.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${n.length}`);const u={};for(let f=0;f<y.length;f++)u[y[f].identifier]=n[f];return u}class pp{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,u,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),f.length===this.numTouches&&(this.centroid=function(g){const v=new c.P(0,0);for(const k of g)v._add(k);return v.div(g.length)}(u),this.touches=cl(f,u)))}touchmove(n,u,f){if(this.aborted||!this.centroid)return;const g=cl(f,u);for(const v in this.touches){const k=g[v];(!k||k.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(n,u,f){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class uc{constructor(n){this.singleTap=new pp(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,u,f){this.singleTap.touchstart(n,u,f)}touchmove(n,u,f){this.singleTap.touchmove(n,u,f)}touchend(n,u,f){const g=this.singleTap.touchend(n,u,f);if(g){const v=n.timeStamp-this.lastTime<500,k=!this.lastTap||this.lastTap.dist(g)<30;if(v&&k||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class hc{constructor(n){this._tr=new sa(n),this._zoomIn=new uc({numTouches:1,numTaps:2}),this._zoomOut=new uc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,u,f){this._zoomIn.touchstart(n,u,f),this._zoomOut.touchstart(n,u,f)}touchmove(n,u,f){this._zoomIn.touchmove(n,u,f),this._zoomOut.touchmove(n,u,f)}touchend(n,u,f){const g=this._zoomIn.touchend(n,u,f),v=this._zoomOut.touchend(n,u,f),k=this._tr;return g?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:k.zoom+1,around:k.unproject(g)},{originalEvent:n})}):v?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:k.zoom-1,around:k.unproject(v)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Co{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const u=this._moveFunction(...n);if(u.bearingDelta||u.pitchDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(n,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=u.length?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,u){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const g=u.length?u[0]:u;return!this._moved&&g.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=g,this._move(f,g))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&A.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const _g={0:1,2:2};class dc{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const u=A.mouseButton(n);this._eventButton=u}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!function(u,f){const g=_g[f];return u.buttons===void 0||(u.buttons&g)!==g}(n,this._eventButton)}isValidEndEvent(n){return A.mouseButton(n)===this._eventButton}}class Di{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}const Ps=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=n=>{n.preventDefault()}},vn=({enable:y,clickTolerance:n,bearingDegreesPerPixelMoved:u=.8})=>{const f=new dc({checkCorrectEvent:g=>A.mouseButton(g)===0&&g.ctrlKey||A.mouseButton(g)===2});return new Co({clickTolerance:n,move:(g,v)=>({bearingDelta:(v.x-g.x)*u}),moveStateManager:f,enable:y,assignEvents:Ps})},pc=({enable:y,clickTolerance:n,pitchDegreesPerPixelMoved:u=-.5})=>{const f=new dc({checkCorrectEvent:g=>A.mouseButton(g)===0&&g.ctrlKey||A.mouseButton(g)===2});return new Co({clickTolerance:n,move:(g,v)=>({pitchDelta:(v.y-g.y)*u}),moveStateManager:f,enable:y,assignEvents:Ps})};class $u{constructor(n,u){this._clickTolerance=n.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(n,u,f){return this._calculateTransform(n,u,f)}touchmove(n,u,f){if(this._active&&!(f.length<this.minTouchs()))return n.preventDefault(),this._calculateTransform(n,u,f)}touchend(n,u,f){this._calculateTransform(n,u,f),this._active&&f.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,u,f){f.length>0&&(this._active=!0);const g=cl(f,u),v=new c.P(0,0),k=new c.P(0,0);let M=0;for(const z in g){const F=g[z],R=this._touches[z];R&&(v._add(F),k._add(F.sub(R)),M++,g[z]=F)}if(this._touches=g,M<this.minTouchs()||!k.mag())return;const E=k.div(M);return this._sum._add(E),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(M),panDelta:E}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,u,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([u[0],u[1]]))}touchmove(n,u,f){if(!this._firstTwoTouches)return;n.preventDefault();const[g,v]=this._firstTwoTouches,k=Is(f,u,g),M=Is(f,u,v);if(!k||!M)return;const E=this._aroundCenter?null:k.add(M).div(2);return this._move([k,M],E,n)}touchend(n,u,f){if(!this._firstTwoTouches)return;const[g,v]=this._firstTwoTouches,k=Is(f,u,g),M=Is(f,u,v);k&&M||(this._active&&A.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Is(y,n,u){for(let f=0;f<y.length;f++)if(y[f].identifier===u)return n[f]}function oa(y,n){return Math.log(y/n)/Math.LN2}class mc extends fc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,u){const f=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(oa(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:oa(this._distance,f),pinchAround:u}}}function Nu(y,n){return 180*y.angleWith(n)/Math.PI}class ju extends fc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,u,f){const g=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Nu(this._vector,g),pinchAround:u}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const u=25/(Math.PI*this._minDiameter)*360,f=Nu(n,this._startVector);return Math.abs(f)<u}}function gc(y){return Math.abs(y.y)>Math.abs(y.x)}class Uu extends fc{constructor(n){super(),this._currentTouchCount=0,this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,u,f){super.touchstart(n,u,f),this._currentTouchCount=f.length}_start(n){this._lastPoints=n,gc(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,u,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const g=n[0].sub(this._lastPoints[0]),v=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(g,v,f.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(g.y+v.y)/2*-.5}):void 0}gestureBeginsVertically(n,u,f){if(this._valid!==void 0)return this._valid;const g=n.mag()>=2,v=u.mag()>=2;if(!g&&!v)return;if(!g||!v)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const k=n.y>0==u.y>0;return gc(n)&&gc(u)&&k}}const fp={panStep:100,bearingStep:15,pitchStep:10};class io{constructor(n){this._tr=new sa(n);const u=fp;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let u=0,f=0,g=0,v=0,k=0;switch(n.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:n.shiftKey?f=-1:(n.preventDefault(),v=-1);break;case 39:n.shiftKey?f=1:(n.preventDefault(),v=1);break;case 38:n.shiftKey?g=1:(n.preventDefault(),k=-1);break;case 40:n.shiftKey?g=-1:(n.preventDefault(),k=1);break;default:return}return this._rotationDisabled&&(f=0,g=0),{cameraAnimation:M=>{const E=this._tr;M.easeTo({duration:300,easeId:"keyboardHandler",easing:mp,zoom:u?Math.round(E.zoom)+u*(n.shiftKey?2:1):E.zoom,bearing:E.bearing+f*this._bearingStep,pitch:E.pitch+g*this._pitchStep,offset:[-v*this._panStep,-k*this._panStep],center:E.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function mp(y){return y*(2-y)}const Hu=4.000244140625;class Zu{constructor(n,u){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=n,this._tr=new sa(n),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(n){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!n[this._map.cooperativeGestures._bypassKey])return;let u=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const f=P.now(),g=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,u!==0&&u%Hu==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(g*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),n.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=n,this._delta-=u,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=A.mousePos(this._map.getCanvas(),n),f=this._tr;this._around=u.y>f.transform.height/2-f.transform.getHorizon()?c.M.convert(this._aroundCenter?f.center:f.unproject(u)):c.M.convert(f.center),this._aroundPoint=f.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(this._delta!==0){const M=this._type==="wheel"&&Math.abs(this._delta)>Hu?this._wheelZoomRate:this._defaultZoomRate;let E=2/(1+Math.exp(-Math.abs(this._delta*M)));this._delta<0&&E!==0&&(E=1/E);const z=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(z*E))),this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom=="number"?this._targetZoom:n.zoom,f=this._startZoom,g=this._easing;let v,k=!1;if(this._type==="wheel"&&f&&g){const M=Math.min((P.now()-this._lastWheelEventTime)/200,1),E=g(M);v=c.z.number(f,u,E),M<1?this._frameId||(this._frameId=!0):k=!0}else v=u,k=!0;return this._active=!0,k&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!k,zoomDelta:v-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let u=c.b8;if(this._prevEase){const f=this._prevEase,g=(P.now()-f.start)/f.duration,v=f.easing(g+.01)-f.easing(g),k=.27/Math.sqrt(v*v+1e-4)*.01,M=Math.sqrt(.0729-k*k);u=c.b7(k,M,.25,1)}return this._prevEase={start:P.now(),duration:n,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class qu{constructor(n,u){this._clickZoom=n,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class gp{constructor(n){this._tr=new sa(n),this.reset()}reset(){this._active=!1}dblclick(n,u){return n.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yp{constructor(){this._tap=new uc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,u,f){if(!this._swipePoint)if(this._tapTime){const g=u[0],v=n.timeStamp-this._tapTime<500,k=this._tapPoint.dist(g)<30;v&&k?f.length>0&&(this._swipePoint=g,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(n,u,f)}touchmove(n,u,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const g=u[0],v=g.y-this._swipePoint.y;return this._swipePoint=g,n.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(n,u,f)}touchend(n,u,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const g=this._tap.touchend(n,u,f);g&&(this._tapTime=n.timeStamp,this._tapPoint=g)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gu{constructor(n,u,f){this._el=n,this._mousePan=u,this._touchPan=f}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class aa{constructor(n,u,f){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=u,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Wu{constructor(n,u,f,g){this._el=n,this._touchZoom=u,this._touchRotate=f,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class zn{constructor(n,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=n,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const n=this._map.getCanvasContainer();n.classList.add("maplibregl-cooperative-gestures"),this._container=A.create("div","maplibregl-cooperative-gesture-screen",n);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),g=document.createElement("div");g.className="maplibregl-desktop-message",g.textContent=u,this._container.appendChild(g);const v=document.createElement("div");v.className="maplibregl-mobile-message",v.textContent=f,this._container.appendChild(v),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(A.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(n){this._onCooperativeGesture(n.touches.length===1)}wheel(n){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!n[this._bypassKey])}_onCooperativeGesture(n){this._enabled&&n&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const xn=y=>y.zoom||y.drag||y.pitch||y.rotate;class _p extends c.k{}function Dn(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class ul{constructor(n,u){this.handleWindowEvent=g=>{this.handleEvent(g,`${g.type}Window`)},this.handleEvent=(g,v)=>{if(g.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const k=g.type==="renderFrame"?void 0:g,M={needsRenderFrame:!1},E={},z={},F=g.touches,R=F?this._getMapTouches(F):void 0,Z=R?A.touchPos(this._map.getCanvas(),R):A.mousePos(this._map.getCanvas(),g);for(const{handlerName:lt,handler:et,allowed:ut}of this._handlers){if(!et.isEnabled())continue;let gt;this._blockedByActive(z,ut,lt)?et.reset():et[v||g.type]&&(gt=et[v||g.type](g,Z,R),this.mergeHandlerResult(M,E,gt,lt,k),gt&&gt.needsRenderFrame&&this._triggerRenderFrame()),(gt||et.isActive())&&(z[lt]=et)}const X={};for(const lt in this._previousActiveHandlers)z[lt]||(X[lt]=k);this._previousActiveHandlers=z,(Object.keys(X).length||Dn(M))&&(this._changes.push([M,E,X]),this._triggerRenderFrame()),(Object.keys(z).length||Dn(M))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:tt}=M;tt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],tt(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Bu(n),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[g,v,k]of this._listeners)A.addEventListener(g,v,g===document?this.handleWindowEvent:this.handleEvent,k)}destroy(){for(const[n,u,f]of this._listeners)A.removeEventListener(n,u,n===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(n){const u=this._map,f=u.getCanvasContainer();this._add("mapEvent",new Vu(u,n));const g=u.boxZoom=new ll(u,n);this._add("boxZoom",g),n.interactive&&n.boxZoom&&g.enable();const v=u.cooperativeGestures=new zn(u,n.cooperativeGestures);this._add("cooperativeGestures",v),n.cooperativeGestures&&v.enable();const k=new hc(u),M=new gp(u);u.doubleClickZoom=new qu(M,k),this._add("tapZoom",k),this._add("clickZoom",M),n.interactive&&n.doubleClickZoom&&u.doubleClickZoom.enable();const E=new yp;this._add("tapDragZoom",E);const z=u.touchPitch=new Uu(u);this._add("touchPitch",z),n.interactive&&n.touchPitch&&u.touchPitch.enable(n.touchPitch);const F=vn(n),R=pc(n);u.dragRotate=new aa(n,F,R),this._add("mouseRotate",F,["mousePitch"]),this._add("mousePitch",R,["mouseRotate"]),n.interactive&&n.dragRotate&&u.dragRotate.enable();const Z=(({enable:gt,clickTolerance:ot})=>{const _t=new dc({checkCorrectEvent:kt=>A.mouseButton(kt)===0&&!kt.ctrlKey});return new Co({clickTolerance:ot,move:(kt,Ct)=>({around:Ct,panDelta:Ct.sub(kt)}),activateOnStart:!0,moveStateManager:_t,enable:gt,assignEvents:Ps})})(n),X=new $u(n,u);u.dragPan=new Gu(f,Z,X),this._add("mousePan",Z),this._add("touchPan",X,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&u.dragPan.enable(n.dragPan);const tt=new ju,lt=new mc;u.touchZoomRotate=new Wu(f,lt,tt,E),this._add("touchRotate",tt,["touchPan","touchZoom"]),this._add("touchZoom",lt,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&u.touchZoomRotate.enable(n.touchZoomRotate);const et=u.scrollZoom=new Zu(u,()=>this._triggerRenderFrame());this._add("scrollZoom",et,["mousePan"]),n.interactive&&n.scrollZoom&&u.scrollZoom.enable(n.scrollZoom);const ut=u.keyboard=new io(u);this._add("keyboard",ut),n.interactive&&n.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new yg(u))}_add(n,u,f){this._handlers.push({handlerName:n,handler:u,allowed:f}),this._handlersById[n]=u}stop(n){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!xn(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,u,f){for(const g in n)if(g!==f&&(!u||u.indexOf(g)<0))return!0;return!1}_getMapTouches(n){const u=[];for(const f of n)this._el.contains(f.target)&&u.push(f);return u}mergeHandlerResult(n,u,f,g,v){if(!f)return;c.e(n,f);const k={handlerName:g,originalEvent:f.originalEvent||v};f.zoomDelta!==void 0&&(u.zoom=k),f.panDelta!==void 0&&(u.drag=k),f.pitchDelta!==void 0&&(u.pitch=k),f.bearingDelta!==void 0&&(u.rotate=k)}_applyChanges(){const n={},u={},f={};for(const[g,v,k]of this._changes)g.panDelta&&(n.panDelta=(n.panDelta||new c.P(0,0))._add(g.panDelta)),g.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+g.pitchDelta),g.around!==void 0&&(n.around=g.around),g.pinchAround!==void 0&&(n.pinchAround=g.pinchAround),g.noInertia&&(n.noInertia=g.noInertia),c.e(u,v),c.e(f,k);this._updateMapTransform(n,u,f),this._changes=[]}_updateMapTransform(n,u,f){const g=this._map,v=g._getTransformForUpdate(),k=g.terrain;if(!(Dn(n)||k&&this._terrainMovement))return this._fireEvents(u,f,!0);let{panDelta:M,zoomDelta:E,bearingDelta:z,pitchDelta:F,around:R,pinchAround:Z}=n;Z!==void 0&&(R=Z),g._stop(!0),R=R||g.transform.centerPoint;const X=v.pointLocation(M?R.sub(M):R);z&&(v.bearing+=z),F&&(v.pitch+=F),E&&(v.zoom+=E),k?this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?v.center=v.pointLocation(v.centerPoint.sub(M)):v.setLocationAtPoint(X,R):(this._terrainMovement=!0,this._map._elevationFreeze=!0,v.setLocationAtPoint(X,R)):v.setLocationAtPoint(X,R),g._applyUpdatedTransform(v),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(u,f,!0)}_fireEvents(n,u,f){const g=xn(this._eventsInProgress),v=xn(n),k={};for(const R in n){const{originalEvent:Z}=n[R];this._eventsInProgress[R]||(k[`${R}start`]=Z),this._eventsInProgress[R]=n[R]}!g&&v&&this._fireEvent("movestart",v.originalEvent);for(const R in k)this._fireEvent(R,k[R]);v&&this._fireEvent("move",v.originalEvent);for(const R in n){const{originalEvent:Z}=n[R];this._fireEvent(R,Z)}const M={};let E;for(const R in this._eventsInProgress){const{handlerName:Z,originalEvent:X}=this._eventsInProgress[R];this._handlersById[Z].isActive()||(delete this._eventsInProgress[R],E=u[Z]||X,M[`${R}end`]=E)}for(const R in M)this._fireEvent(R,M[R]);const z=xn(this._eventsInProgress),F=(g||v)&&!z;if(F&&this._terrainMovement&&(this._map._elevationFreeze=!1,this._terrainMovement=!1,this._map.transform.recalculateZoom(this._map.terrain)),f&&F){this._updatingCamera=!0;const R=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Z=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;!R||!R.essential&&P.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:E})),Z(this._map.getBearing())&&this._map.resetNorth()):(Z(R.bearing||this._map.getBearing())&&(R.bearing=0),R.freezeElevation=!0,this._map.easeTo(R,{originalEvent:E})),this._updatingCamera=!1}}_fireEvent(n,u){this._map.fire(new c.k(n,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new _p("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class vg extends c.E{constructor(n,u){super(),this._renderFrameCallback=()=>{const f=Math.min((P.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=u.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.M(this.transform.center.lng,this.transform.center.lat)}setCenter(n,u){return this.jumpTo({center:n},u)}panBy(n,u,f){return n=c.P.convert(n).mult(-1),this.panTo(this.transform.center,c.e({offset:n},u),f)}panTo(n,u,f){return this.easeTo(c.e({center:n},u),f)}getZoom(){return this.transform.zoom}setZoom(n,u){return this.jumpTo({zoom:n},u),this}zoomTo(n,u,f){return this.easeTo(c.e({zoom:n},u),f)}zoomIn(n,u){return this.zoomTo(this.getZoom()+1,n,u),this}zoomOut(n,u){return this.zoomTo(this.getZoom()-1,n,u),this}getBearing(){return this.transform.bearing}setBearing(n,u){return this.jumpTo({bearing:n},u),this}getPadding(){return this.transform.padding}setPadding(n,u){return this.jumpTo({padding:n},u),this}rotateTo(n,u,f){return this.easeTo(c.e({bearing:n},u),f)}resetNorth(n,u){return this.rotateTo(0,c.e({duration:1e3},n),u),this}resetNorthPitch(n,u){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},n),u),this}snapToNorth(n,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,u):this}getPitch(){return this.transform.pitch}setPitch(n,u){return this.jumpTo({pitch:n},u),this}cameraForBounds(n,u){n=ci.convert(n);const f=u&&u.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),f,u)}_cameraForBoxAndBearing(n,u,f,g){const v={top:0,bottom:0,right:0,left:0};if(typeof(g=c.e({padding:v,offset:[0,0],maxZoom:this.transform.maxZoom},g)).padding=="number"){const Ut=g.padding;g.padding={top:Ut,bottom:Ut,right:Ut,left:Ut}}g.padding=c.e(v,g.padding);const k=this.transform,M=k.padding,E=new ci(n,u),z=k.project(E.getNorthWest()),F=k.project(E.getNorthEast()),R=k.project(E.getSouthEast()),Z=k.project(E.getSouthWest()),X=c.b9(-f),tt=z.rotate(X),lt=F.rotate(X),et=R.rotate(X),ut=Z.rotate(X),gt=new c.P(Math.max(tt.x,lt.x,ut.x,et.x),Math.max(tt.y,lt.y,ut.y,et.y)),ot=new c.P(Math.min(tt.x,lt.x,ut.x,et.x),Math.min(tt.y,lt.y,ut.y,et.y)),_t=gt.sub(ot),kt=(k.width-(M.left+M.right+g.padding.left+g.padding.right))/_t.x,Ct=(k.height-(M.top+M.bottom+g.padding.top+g.padding.bottom))/_t.y;if(Ct<0||kt<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Dt=Math.min(k.scaleZoom(k.scale*Math.min(kt,Ct)),g.maxZoom),jt=c.P.convert(g.offset),ie=new c.P((g.padding.left-g.padding.right)/2,(g.padding.top-g.padding.bottom)/2).rotate(c.b9(f)),ne=jt.add(ie).mult(k.scale/k.zoomScale(Dt));return{center:k.unproject(z.add(R).div(2).sub(ne)),zoom:Dt,bearing:f}}fitBounds(n,u,f){return this._fitInternal(this.cameraForBounds(n,u),u,f)}fitScreenCoordinates(n,u,f,g,v){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(n)),this.transform.pointLocation(c.P.convert(u)),f,g),g,v)}_fitInternal(n,u,f){return n?(delete(u=c.e(n,u)).padding,u.linear?this.easeTo(u,f):this.flyTo(u,f)):this}jumpTo(n,u){this.stop();const f=this._getTransformForUpdate();let g=!1,v=!1,k=!1;return"zoom"in n&&f.zoom!==+n.zoom&&(g=!0,f.zoom=+n.zoom),n.center!==void 0&&(f.center=c.M.convert(n.center)),"bearing"in n&&f.bearing!==+n.bearing&&(v=!0,f.bearing=+n.bearing),"pitch"in n&&f.pitch!==+n.pitch&&(k=!0,f.pitch=+n.pitch),n.padding==null||f.isPaddingEqual(n.padding)||(f.padding=n.padding),this._applyUpdatedTransform(f),this.fire(new c.k("movestart",u)).fire(new c.k("move",u)),g&&this.fire(new c.k("zoomstart",u)).fire(new c.k("zoom",u)).fire(new c.k("zoomend",u)),v&&this.fire(new c.k("rotatestart",u)).fire(new c.k("rotate",u)).fire(new c.k("rotateend",u)),k&&this.fire(new c.k("pitchstart",u)).fire(new c.k("pitch",u)).fire(new c.k("pitchend",u)),this.fire(new c.k("moveend",u))}calculateCameraOptionsFromTo(n,u,f,g=0){const v=c.Y.fromLngLat(n,u),k=c.Y.fromLngLat(f,g),M=k.x-v.x,E=k.y-v.y,z=k.z-v.z,F=Math.hypot(M,E,z);if(F===0)throw new Error("Can't calculate camera options with same From and To");const R=Math.hypot(M,E),Z=this.transform.scaleZoom(this.transform.cameraToCenterDistance/F/this.transform.tileSize),X=180*Math.atan2(M,-E)/Math.PI;let tt=180*Math.acos(R/F)/Math.PI;return tt=z<0?90-tt:90+tt,{center:k.toLngLat(),zoom:Z,pitch:tt,bearing:X}}easeTo(n,u){var f;this._stop(!1,n.easeId),((n=c.e({offset:[0,0],duration:500,easing:c.b8},n)).animate===!1||!n.essential&&P.prefersReducedMotion)&&(n.duration=0);const g=this._getTransformForUpdate(),v=this.getZoom(),k=this.getBearing(),M=this.getPitch(),E=this.getPadding(),z="bearing"in n?this._normalizeBearing(n.bearing,k):k,F="pitch"in n?+n.pitch:M,R="padding"in n?n.padding:g.padding,Z=c.P.convert(n.offset);let X=g.centerPoint.add(Z);const tt=g.pointLocation(X),{center:lt,zoom:et}=g.getConstrained(c.M.convert(n.center||tt),(f=n.zoom)!==null&&f!==void 0?f:v);this._normalizeCenter(lt);const ut=g.project(tt),gt=g.project(lt).sub(ut),ot=g.zoomScale(et-v);let _t,kt;n.around&&(_t=c.M.convert(n.around),kt=g.locationPoint(_t));const Ct={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||et!==v,this._rotating=this._rotating||k!==z,this._pitching=this._pitching||F!==M,this._padding=!g.isPaddingEqual(R),this._easeId=n.easeId,this._prepareEase(u,n.noMoveStart,Ct),this.terrain&&this._prepareElevation(lt),this._ease(Dt=>{if(this._zooming&&(g.zoom=c.z.number(v,et,Dt)),this._rotating&&(g.bearing=c.z.number(k,z,Dt)),this._pitching&&(g.pitch=c.z.number(M,F,Dt)),this._padding&&(g.interpolatePadding(E,R,Dt),X=g.centerPoint.add(Z)),this.terrain&&!n.freezeElevation&&this._updateElevation(Dt),_t)g.setLocationAtPoint(_t,kt);else{const jt=g.zoomScale(g.zoom-v),ie=et>v?Math.min(2,ot):Math.max(.5,ot),ne=Math.pow(ie,1-Dt),Ut=g.unproject(ut.add(gt.mult(Dt*ne)).mult(jt));g.setLocationAtPoint(g.renderWorldCopies?Ut.wrap():Ut,X)}this._applyUpdatedTransform(g),this._fireMoveEvents(u)},Dt=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(u,Dt)},n),this}_prepareEase(n,u,f={}){this._moving=!0,u||f.moving||this.fire(new c.k("movestart",n)),this._zooming&&!f.zooming&&this.fire(new c.k("zoomstart",n)),this._rotating&&!f.rotating&&this.fire(new c.k("rotatestart",n)),this._pitching&&!f.pitching&&this.fire(new c.k("pitchstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&u!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(f-(u-(f*n+this._elevationStart))/(1-n)),this._elevationTarget=u}this.transform.elevation=c.z.number(this._elevationStart,this._elevationTarget,n)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(n){if(!this.transformCameraUpdate)return;const u=n.clone(),{center:f,zoom:g,pitch:v,bearing:k,elevation:M}=this.transformCameraUpdate(u);f&&(u.center=f),g!==void 0&&(u.zoom=g),v!==void 0&&(u.pitch=v),k!==void 0&&(u.bearing=k),M!==void 0&&(u.elevation=M),this.transform.apply(u)}_fireMoveEvents(n){this.fire(new c.k("move",n)),this._zooming&&this.fire(new c.k("zoom",n)),this._rotating&&this.fire(new c.k("rotate",n)),this._pitching&&this.fire(new c.k("pitch",n))}_afterEase(n,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const f=this._zooming,g=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new c.k("zoomend",n)),g&&this.fire(new c.k("rotateend",n)),v&&this.fire(new c.k("pitchend",n)),this.fire(new c.k("moveend",n))}flyTo(n,u){var f;if(!n.essential&&P.prefersReducedMotion){const Xt=c.L(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Xt,u)}this.stop(),n=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.b8},n);const g=this._getTransformForUpdate(),v=this.getZoom(),k=this.getBearing(),M=this.getPitch(),E=this.getPadding(),z="bearing"in n?this._normalizeBearing(n.bearing,k):k,F="pitch"in n?+n.pitch:M,R="padding"in n?n.padding:g.padding,Z=c.P.convert(n.offset);let X=g.centerPoint.add(Z);const tt=g.pointLocation(X),{center:lt,zoom:et}=g.getConstrained(c.M.convert(n.center||tt),(f=n.zoom)!==null&&f!==void 0?f:v);this._normalizeCenter(lt);const ut=g.zoomScale(et-v),gt=g.project(tt),ot=g.project(lt).sub(gt);let _t=n.curve;const kt=Math.max(g.width,g.height),Ct=kt/ut,Dt=ot.mag();if("minZoom"in n){const Xt=c.ac(Math.min(n.minZoom,v,et),g.minZoom,g.maxZoom),Te=kt/g.zoomScale(Xt-v);_t=Math.sqrt(Te/Dt*2)}const jt=_t*_t;function ie(Xt){const Te=(Ct*Ct-kt*kt+(Xt?-1:1)*jt*jt*Dt*Dt)/(2*(Xt?Ct:kt)*jt*Dt);return Math.log(Math.sqrt(Te*Te+1)-Te)}function ne(Xt){return(Math.exp(Xt)-Math.exp(-Xt))/2}function Ut(Xt){return(Math.exp(Xt)+Math.exp(-Xt))/2}const qt=ie(!1);let ce=function(Xt){return Ut(qt)/Ut(qt+_t*Xt)},Ce=function(Xt){return kt*((Ut(qt)*(ne(Te=qt+_t*Xt)/Ut(Te))-ne(qt))/jt)/Dt;var Te},Wt=(ie(!0)-qt)/_t;if(Math.abs(Dt)<1e-6||!isFinite(Wt)){if(Math.abs(kt-Ct)<1e-6)return this.easeTo(n,u);const Xt=Ct<kt?-1:1;Wt=Math.abs(Math.log(Ct/kt))/_t,Ce=()=>0,ce=Te=>Math.exp(Xt*_t*Te)}return n.duration="duration"in n?+n.duration:1e3*Wt/("screenSpeed"in n?+n.screenSpeed/_t:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=k!==z,this._pitching=F!==M,this._padding=!g.isPaddingEqual(R),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(lt),this._ease(Xt=>{const Te=Xt*Wt,_i=1/ce(Te);g.zoom=Xt===1?et:v+g.scaleZoom(_i),this._rotating&&(g.bearing=c.z.number(k,z,Xt)),this._pitching&&(g.pitch=c.z.number(M,F,Xt)),this._padding&&(g.interpolatePadding(E,R,Xt),X=g.centerPoint.add(Z)),this.terrain&&!n.freezeElevation&&this._updateElevation(Xt);const Re=Xt===1?lt:g.unproject(gt.add(ot.mult(Ce(Te))).mult(_i));g.setLocationAtPoint(g.renderWorldCopies?Re.wrap():Re,X),this._applyUpdatedTransform(g),this._fireMoveEvents(u)},()=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(u)},n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,u){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,u)}return n||(f=this.handlers)===null||f===void 0||f.stop(!1),this}_ease(n,u,f){f.animate===!1||f.duration===0?(n(1),u()):(this._easeStart=P.now(),this._easeOptions=f,this._onEaseFrame=n,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,u){n=c.b2(n,-180,180);const f=Math.abs(n-u);return Math.abs(n-360-u)<f&&(n-=360),Math.abs(n+360-u)<f&&(n+=360),n}_normalizeCenter(n){const u=this.transform;if(!u.renderWorldCopies||u.lngRange)return;const f=n.lng-u.center.lng;n.lng+=f>180?-360:f<-180?360:0}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLatZoom(c.M.convert(n),this.transform.tileZoom)-this.transform.elevation:null}}const vp={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class xp{constructor(n=vp){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options.compact,this._container=A.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=A.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,u){const f=this._map._getUIString(`AttributionControl.${u}`);n.title=f,n.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(g=>typeof g!="string"?"":g)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const u=this._map.style.sourceCaches;for(const g in u){const v=u[g];if(v.used||v.usedForTerrain){const k=v.getSource();k.attribution&&n.indexOf(k.attribution)<0&&n.push(k.attribution)}}n=n.filter(g=>String(g).trim()),n.sort((g,v)=>g.length-v.length),n=n.filter((g,v)=>{for(let k=v+1;k<n.length;k++)if(n[k].indexOf(g)>=0)return!1;return!0});const f=n.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,n.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Yu{constructor(n={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const f=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=A.create("div","maplibregl-ctrl");const u=A.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){A.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class hl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const u=++this._id;return this._queue.push({callback:n,id:u,cancelled:!1}),u}remove(n){const u=this._currentlyRunning,f=u?this._queue.concat(u):this._queue;for(const g of f)if(g.id===n)return void(g.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const f of u)if(!f.cancelled&&(f.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var ro=c.X([{name:"a_pos3d",type:"Int16",components:3}]);class oe extends c.E{constructor(n){super(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,n.usedForTerrain=!0,n.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,u){this.sourceCache.update(n,u),this._renderableTilesKeys=[];const f={};for(const g of n.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u}))f[g.key]=!0,this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.posMatrix=new Float64Array(16),c.aO(g.posMatrix,0,c.W,0,c.W,0,1),this._tiles[g.key]=new br(g,this.tileSize));for(const g in this._tiles)f[g]||delete this._tiles[g]}freeRtt(n){for(const u in this._tiles){const f=this._tiles[u];(!n||f.tileID.equals(n)||f.tileID.isChildOf(n)||n.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n){const u={};for(const f of this._renderableTilesKeys){const g=this._tiles[f].tileID;if(g.canonical.equals(n.canonical)){const v=n.clone();v.posMatrix=new Float64Array(16),c.aO(v.posMatrix,0,c.W,0,c.W,0,1),u[f]=v}else if(g.canonical.isChildOf(n.canonical)){const v=n.clone();v.posMatrix=new Float64Array(16);const k=g.canonical.z-n.canonical.z,M=g.canonical.x-(g.canonical.x>>k<<k),E=g.canonical.y-(g.canonical.y>>k<<k),z=c.W>>k;c.aO(v.posMatrix,0,z,0,z,0,1),c.H(v.posMatrix,v.posMatrix,[-M*z,-E*z,0]),u[f]=v}else if(n.canonical.isChildOf(g.canonical)){const v=n.clone();v.posMatrix=new Float64Array(16);const k=n.canonical.z-g.canonical.z,M=n.canonical.x-(n.canonical.x>>k<<k),E=n.canonical.y-(n.canonical.y>>k<<k),z=c.W>>k;c.aO(v.posMatrix,0,c.W,0,c.W,0,1),c.H(v.posMatrix,v.posMatrix,[M*z,E*z,0]),c.J(v.posMatrix,v.posMatrix,[1/2**k,1/2**k,0]),u[f]=v}}return u}getSourceTile(n,u){const f=this.sourceCache._source;let g=n.overscaledZ-this.deltaZoom;if(g>f.maxzoom&&(g=f.maxzoom),g<f.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(g).key);let v=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!v||!v.dem)&&u)for(;g>=f.minzoom&&(!v||!v.dem);)v=this.sourceCache.getTileByID(n.scaledTo(g--).key);return v}tilesAfterTime(n=Date.now()){return Object.values(this._tiles).filter(u=>u.timeAdded>=n)}}class bp{constructor(n,u,f){this.painter=n,this.sourceCache=new oe(u),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,u,f,g=c.W){var v;if(!(u>=0&&u<g&&f>=0&&f<g))return 0;const k=this.getTerrainData(n),M=(v=k.tile)===null||v===void 0?void 0:v.dem;if(!M)return 0;const E=function(tt,lt,et){var ut=lt[0],gt=lt[1];return tt[0]=et[0]*ut+et[4]*gt+et[12],tt[1]=et[1]*ut+et[5]*gt+et[13],tt}([],[u/g*c.W,f/g*c.W],k.u_terrain_matrix),z=[E[0]*M.dim,E[1]*M.dim],F=Math.floor(z[0]),R=Math.floor(z[1]),Z=z[0]-F,X=z[1]-R;return M.get(F,R)*(1-Z)*(1-X)+M.get(F+1,R)*Z*(1-X)+M.get(F,R+1)*(1-Z)*X+M.get(F+1,R+1)*Z*X}getElevationForLngLatZoom(n,u){const{tileID:f,mercatorX:g,mercatorY:v}=this._getOverscaledTileIDFromLngLatZoom(n,u);return this.getElevation(f,g%c.W,v%c.W,c.W)}getElevation(n,u,f,g=c.W){return this.getDEMElevation(n,u,f,g)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const g=this.painter.context,v=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Ot(g,v,g.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Ot(g,new c.R({width:1,height:1}),g.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.an([])}const u=this.sourceCache.getSourceTile(n,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const g=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new Ot(g,u.dem.getPixels(),g.gl.RGBA,{premultiply:!1}),u.demTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const f=u&&u+u.tileID.key+n.key;if(f&&!this._demMatrixCache[f]){const g=this.sourceCache.sourceCache._source.maxzoom;let v=n.canonical.z-u.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=g?v=n.canonical.z-g:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const k=n.canonical.x-(n.canonical.x>>v<<v),M=n.canonical.y-(n.canonical.y>>v<<v),E=c.ba(new Float64Array(16),[1/(c.W<<v),1/(c.W<<v),0]);c.H(E,E,[k*c.W,M*c.W,0]),this._demMatrixCache[n.key]={matrix:E,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(n){const u=this.painter,f=u.width/devicePixelRatio,g=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===g||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Ot(u.context,{width:f,height:g,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Ot(u.context,{width:f,height:g,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(f,g,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,f,g))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let v=0,k=0;v<this._coordsTextureSize;v++)for(let M=0;M<this._coordsTextureSize;M++,k+=4)u[k+0]=255&M,u[k+1]=255&v,u[k+2]=M>>8<<4|v>>8,u[k+3]=0;const f=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),g=new Ot(n,f,n.gl.RGBA,{premultiply:!1});return g.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=g,g}pointCoordinate(n){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),f=this.painter.context,g=f.gl,v=Math.round(n.x*this.painter.pixelRatio/devicePixelRatio),k=Math.round(n.y*this.painter.pixelRatio/devicePixelRatio),M=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(v,M-k-1,1,1,g.RGBA,g.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null);const E=u[0]+(u[2]>>4<<8),z=u[1]+((15&u[2])<<8),F=this.coordsIndex[255-u[3]],R=F&&this.sourceCache.getTileByID(F);if(!R)return null;const Z=this._coordsTextureSize,X=(1<<R.tileID.canonical.z)*Z;return new c.Y((R.tileID.canonical.x*Z+E)/X+R.tileID.wrap,(R.tileID.canonical.y*Z+z)/X,this.getElevation(R.tileID,E,z,Z))}depthAtPoint(n){const u=new Uint8Array(4),f=this.painter.context,g=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),g.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const n=this.painter.context,u=new c.bb,f=new c.aY,g=this.meshSize,v=c.W/g,k=g*g;for(let R=0;R<=g;R++)for(let Z=0;Z<=g;Z++)u.emplaceBack(Z*v,R*v,0);for(let R=0;R<k;R+=g+1)for(let Z=0;Z<g;Z++)f.emplaceBack(Z+R,g+Z+R+1,g+Z+R+2),f.emplaceBack(Z+R,g+Z+R+2,Z+R+1);const M=u.length,E=M+2*(g+1);for(const R of[0,1])for(let Z=0;Z<=g;Z++)for(const X of[0,1])u.emplaceBack(Z*v,R*c.W,X);for(let R=0;R<2*g;R+=2)f.emplaceBack(E+R,E+R+1,E+R+3),f.emplaceBack(E+R,E+R+3,E+R+2),f.emplaceBack(M+R,M+R+3,M+R+1),f.emplaceBack(M+R,M+R+2,M+R+3);const z=u.length,F=z+2*(g+1);for(const R of[0,1])for(let Z=0;Z<=g;Z++)for(const X of[0,1])u.emplaceBack(R*c.W,Z*v,X);for(let R=0;R<2*g;R+=2)f.emplaceBack(z+R,z+R+1,z+R+3),f.emplaceBack(z+R,z+R+3,z+R+2),f.emplaceBack(F+R,F+R+3,F+R+1),f.emplaceBack(F+R,F+R+2,F+R+3);return this._mesh={indexBuffer:n.createIndexBuffer(f),vertexBuffer:n.createVertexBuffer(u,ro.members),segments:c.$.simpleSegment(0,0,u.length,f.length)},this._mesh}getMeshFrameDelta(n){return 2*Math.PI*c.bc/Math.pow(2,n)/5}getMinTileElevationForLngLatZoom(n,u){var f;const{tileID:g}=this._getOverscaledTileIDFromLngLatZoom(n,u);return(f=this.getMinMaxElevation(g).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(n){const u=this.getTerrainData(n).tile,f={minElevation:null,maxElevation:null};return u&&u.dem&&(f.minElevation=u.dem.min*this.exaggeration,f.maxElevation=u.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(n,u){const f=c.Y.fromLngLat(n.wrap()),g=(1<<u)*c.W,v=f.x*g,k=f.y*g,M=Math.floor(v/c.W),E=Math.floor(k/c.W);return{tileID:new c.Q(u,0,u,M,E),mercatorX:v,mercatorY:k}}}class dl{constructor(n,u,f){this._context=n,this._size=u,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new Ot(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(f.texture),{id:n,fbo:u,texture:f,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>n.id!==u),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(n=>!n.inUse)===!1}}const ps={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class wp{constructor(n,u){this.painter=n,this.terrain=u,this.pool=new dl(n.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter(f=>!n._layers[f].isHidden(u)),this._coordsDescendingInv={};for(const f in n.sourceCaches){this._coordsDescendingInv[f]={};const g=n.sourceCaches[f].getVisibleCoordinates();for(const v of g){const k=this.terrain.sourceCache.getTerrainCoords(v);for(const M in k)this._coordsDescendingInv[f][M]||(this._coordsDescendingInv[f][M]=[]),this._coordsDescendingInv[f][M].push(k[M])}}this._coordsDescendingInvStr={};for(const f of n._order){const g=n._layers[f],v=g.source;if(ps[g.type]&&!this._coordsDescendingInvStr[v]){this._coordsDescendingInvStr[v]={};for(const k in this._coordsDescendingInv[v])this._coordsDescendingInvStr[v][k]=this._coordsDescendingInv[v][k].map(M=>M.key).sort().join()}}for(const f of this._renderableTiles)for(const g in this._coordsDescendingInvStr){const v=this._coordsDescendingInvStr[g][f.tileID.key];v&&v!==f.rttCoords[g]&&(f.rtt=[])}}renderLayer(n){if(n.isHidden(this.painter.transform.zoom))return!1;const u=n.type,f=this.painter,g=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(ps[u]&&(this._prevType&&ps[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(n.id),!g))return!0;if(ps[this._prevType]||ps[u]&&g){this._prevType=u;const v=this._stacks.length-1,k=this._stacks[v]||[];for(const M of this._renderableTiles){if(this.pool.isFull()&&(sc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(M),M.rtt[v]){const z=this.pool.getObjectForId(M.rtt[v].id);if(z.stamp===M.rtt[v].stamp){this.pool.useObject(z);continue}}const E=this.pool.getOrCreateFreeObject();this.pool.useObject(E),this.pool.stampObject(E),M.rtt[v]={id:E.id,stamp:E.stamp},f.context.bindFramebuffer.set(E.fbo.framebuffer),f.context.clear({color:c.aP.transparent,stencil:0}),f.currentStencilSource=void 0;for(let z=0;z<k.length;z++){const F=f.style._layers[k[z]],R=F.source?this._coordsDescendingInv[F.source][M.tileID.key]:[M.tileID];f.context.viewport.set([0,0,E.fbo.width,E.fbo.height]),f._renderTileClippingMasks(F,R),f.renderLayer(f,f.style.sourceCaches[F.source],F,R),F.source&&(M.rttCoords[F.source]=this._coordsDescendingInvStr[F.source][M.tileID.key])}}return sc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ps[u]}return!1}}const te={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ku=b,xg={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:vp,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Sp=y=>{y.touchstart=y.dragStart,y.touchmoveWindow=y.dragMove,y.touchend=y.dragEnd},Xu={showCompass:!0,showZoom:!0,visualizePitch:!1};class kp{constructor(n,u,f=!1){this.mousedown=k=>{this.startMouse(c.e({},k,{ctrlKey:!0,preventDefault:()=>k.preventDefault()}),A.mousePos(this.element,k)),A.addEventListener(window,"mousemove",this.mousemove),A.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=k=>{this.moveMouse(k,A.mousePos(this.element,k))},this.mouseup=k=>{this.mouseRotate.dragEnd(k),this.mousePitch&&this.mousePitch.dragEnd(k),this.offTemp()},this.touchstart=k=>{k.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=A.touchPos(this.element,k.targetTouches)[0],this.startTouch(k,this._startPos),A.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.addEventListener(window,"touchend",this.touchend))},this.touchmove=k=>{k.targetTouches.length!==1?this.reset():(this._lastPos=A.touchPos(this.element,k.targetTouches)[0],this.moveTouch(k,this._lastPos))},this.touchend=k=>{k.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const g=n.dragRotate._mouseRotate.getClickTolerance(),v=n.dragRotate._mousePitch.getClickTolerance();this.element=u,this.mouseRotate=vn({clickTolerance:g,enable:!0}),this.touchRotate=(({enable:k,clickTolerance:M,bearingDegreesPerPixelMoved:E=.8})=>{const z=new Di;return new Co({clickTolerance:M,move:(F,R)=>({bearingDelta:(R.x-F.x)*E}),moveStateManager:z,enable:k,assignEvents:Sp})})({clickTolerance:g,enable:!0}),this.map=n,f&&(this.mousePitch=pc({clickTolerance:v,enable:!0}),this.touchPitch=(({enable:k,clickTolerance:M,pitchDegreesPerPixelMoved:E=-.5})=>{const z=new Di;return new Co({clickTolerance:M,move:(F,R)=>({pitchDelta:(R.y-F.y)*E}),moveStateManager:z,enable:k,assignEvents:Sp})})({clickTolerance:v,enable:!0})),A.addEventListener(u,"mousedown",this.mousedown),A.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),A.addEventListener(u,"touchcancel",this.reset)}startMouse(n,u){this.mouseRotate.dragStart(n,u),this.mousePitch&&this.mousePitch.dragStart(n,u),A.disableDrag()}startTouch(n,u){this.touchRotate.dragStart(n,u),this.touchPitch&&this.touchPitch.dragStart(n,u),A.disableDrag()}moveMouse(n,u){const f=this.map,{bearingDelta:g}=this.mouseRotate.dragMove(n,u)||{};if(g&&f.setBearing(f.getBearing()+g),this.mousePitch){const{pitchDelta:v}=this.mousePitch.dragMove(n,u)||{};v&&f.setPitch(f.getPitch()+v)}}moveTouch(n,u){const f=this.map,{bearingDelta:g}=this.touchRotate.dragMove(n,u)||{};if(g&&f.setBearing(f.getBearing()+g),this.touchPitch){const{pitchDelta:v}=this.touchPitch.dragMove(n,u)||{};v&&f.setPitch(f.getPitch()+v)}}off(){const n=this.element;A.removeEventListener(n,"mousedown",this.mousedown),A.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend),A.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){A.enableDrag(),A.removeEventListener(window,"mousemove",this.mousemove),A.removeEventListener(window,"mouseup",this.mouseup),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend)}}let no;function Tp(y,n,u){const f=new c.M(y.lng,y.lat);if(y=new c.M(y.lng,y.lat),n){const g=new c.M(y.lng-360,y.lat),v=new c.M(y.lng+360,y.lat),k=u.locationPoint(y).distSqr(n);u.locationPoint(g).distSqr(n)<k?y=g:u.locationPoint(v).distSqr(n)<k&&(y=v)}for(;Math.abs(y.lng-u.center.lng)>180;){const g=u.locationPoint(y);if(g.x>=0&&g.y>=0&&g.x<=u.width&&g.y<=u.height)break;y.lng>u.center.lng?y.lng-=360:y.lng+=360}return y.lng!==f.lng&&u.locationPoint(y).y>u.height/2-u.getHorizon()?y:f}const Ju={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function so(y,n,u){const f=y.classList;for(const g in Ju)f.remove(`maplibregl-${u}-anchor-${g}`);f.add(`maplibregl-${u}-anchor-${n}`)}class mi extends c.E{constructor(n){if(super(),this._onKeyPress=u=>{const f=u.code,g=u.charCode||u.keyCode;f!=="Space"&&f!=="Enter"&&g!==32&&g!==13||this.togglePopup()},this._onMapClick=u=>{const f=u.originalEvent.target,g=this._element;this._popup&&(f===g||g.contains(f))&&this.togglePopup()},this._update=u=>{var f;if(!this._map)return;const g=this._map.loaded()&&!this._map.isMoving();((u==null?void 0:u.type)==="terrain"||(u==null?void 0:u.type)==="render"&&!g)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Tp(this._lngLat,this._flatPos,this._map.transform):(f=this._lngLat)===null||f===void 0?void 0:f.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let k="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?k="rotateX(0deg)":this._pitchAlignment==="map"&&(k=`rotateX(${this._map.getPitch()}deg)`),u&&u.type!=="moveend"||(this._pos=this._pos.round()),A.setTransform(this._element,`${Ju[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${k} ${v}`),P.frameAsync(new AbortController).then(()=>{this._updateOpacity(u&&u.type==="moveend")}).catch(()=>{})},this._onMove=u=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(n==null?void 0:n.opacity,n==null?void 0:n.opacityWhenCovered),n&&n.element)this._element=n.element,this._offset=c.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=A.create("div"),this._element.setAttribute("aria-label","Map marker");const u=A.createNS("http://www.w3.org/2000/svg","svg"),f=41,g=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${f}px`),u.setAttributeNS(null,"width",`${g}px`),u.setAttributeNS(null,"viewBox",`0 0 ${g} ${f}`);const v=A.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"stroke","none"),v.setAttributeNS(null,"stroke-width","1"),v.setAttributeNS(null,"fill","none"),v.setAttributeNS(null,"fill-rule","evenodd");const k=A.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill-rule","nonzero");const M=A.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"transform","translate(3.0, 29.0)"),M.setAttributeNS(null,"fill","#000000");const E=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ut of E){const gt=A.createNS("http://www.w3.org/2000/svg","ellipse");gt.setAttributeNS(null,"opacity","0.04"),gt.setAttributeNS(null,"cx","10.5"),gt.setAttributeNS(null,"cy","5.80029008"),gt.setAttributeNS(null,"rx",ut.rx),gt.setAttributeNS(null,"ry",ut.ry),M.appendChild(gt)}const z=A.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const F=A.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(F);const R=A.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"opacity","0.25"),R.setAttributeNS(null,"fill","#000000");const Z=A.createNS("http://www.w3.org/2000/svg","path");Z.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),R.appendChild(Z);const X=A.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(6.0, 7.0)"),X.setAttributeNS(null,"fill","#FFFFFF");const tt=A.createNS("http://www.w3.org/2000/svg","g");tt.setAttributeNS(null,"transform","translate(8.0, 8.0)");const lt=A.createNS("http://www.w3.org/2000/svg","circle");lt.setAttributeNS(null,"fill","#000000"),lt.setAttributeNS(null,"opacity","0.25"),lt.setAttributeNS(null,"cx","5.5"),lt.setAttributeNS(null,"cy","5.5"),lt.setAttributeNS(null,"r","5.4999962");const et=A.createNS("http://www.w3.org/2000/svg","circle");et.setAttributeNS(null,"fill","#FFFFFF"),et.setAttributeNS(null,"cx","5.5"),et.setAttributeNS(null,"cy","5.5"),et.setAttributeNS(null,"r","5.4999962"),tt.appendChild(lt),tt.appendChild(et),k.appendChild(M),k.appendChild(z),k.appendChild(R),k.appendChild(X),k.appendChild(tt),u.appendChild(k),u.setAttributeNS(null,"height",f*this._scale+"px"),u.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(u),this._offset=c.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),so(this._element,this._anchor,"marker"),n&&n.className)for(const u of n.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),A.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=c.M.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const u=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(38.1-13.5+u)],"bottom-right":[-u,-1*(38.1-13.5+u)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const n=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:n?(n.isOpen()?n.remove():(n.setLngLat(this._lngLat),n.addTo(this._map)),this):this}_updateOpacity(n=!1){var u,f;if(!(!((u=this._map)===null||u===void 0)&&u.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(n)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const g=this._map,v=g.terrain.depthAtPoint(this._pos),k=g.terrain.getElevationForLngLatZoom(this._lngLat,g.transform.tileZoom);if(g.transform.lngLatToCameraDepth(this._lngLat,k)-v<.006)return void(this._element.style.opacity=this._opacity);const M=-this._offset.y/g.transform._pixelPerMeter,E=Math.sin(g.getPitch()*Math.PI/180)*M,z=g.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),F=g.transform.lngLatToCameraDepth(this._lngLat,k+E)-z>.006;!((f=this._popup)===null||f===void 0)&&f.isOpen()&&F&&this._popup.remove(),this._element.style.opacity=F?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(n){return this._offset=c.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(n,u){return n===void 0&&u===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),n!==void 0&&(this._opacity=n),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const yc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let la=0,ca=!1;const Mp={maxWidth:100,unit:"metric"};function Qu(y,n,u){const f=u&&u.maxWidth||100,g=y._container.clientHeight/2,v=y.unproject([0,g]),k=y.unproject([f,g]),M=v.distanceTo(k);if(u&&u.unit==="imperial"){const E=3.2808*M;E>5280?pl(n,f,E/5280,y._getUIString("ScaleControl.Miles")):pl(n,f,E,y._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?pl(n,f,M/1852,y._getUIString("ScaleControl.NauticalMiles")):M>=1e3?pl(n,f,M/1e3,y._getUIString("ScaleControl.Kilometers")):pl(n,f,M,y._getUIString("ScaleControl.Meters"))}function pl(y,n,u,f){const g=function(v){const k=Math.pow(10,`${Math.floor(v)}`.length-1);let M=v/k;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:M>=1?1:function(E){const z=Math.pow(10,Math.ceil(-Math.log(E)/Math.LN10));return Math.round(E*z)/z}(M),k*M}(u);y.style.width=n*(g/u)+"px",y.innerHTML=`${g}&nbsp;${f}`}const fs={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},_c=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function pe(y){if(y){if(typeof y=="number"){const n=Math.round(Math.abs(y)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,y),"top-left":new c.P(n,n),"top-right":new c.P(-n,n),bottom:new c.P(0,-y),"bottom-left":new c.P(n,-n),"bottom-right":new c.P(-n,-n),left:new c.P(y,0),right:new c.P(-y,0)}}if(y instanceof c.P||Array.isArray(y)){const n=c.P.convert(y);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:c.P.convert(y.center||[0,0]),top:c.P.convert(y.top||[0,0]),"top-left":c.P.convert(y["top-left"]||[0,0]),"top-right":c.P.convert(y["top-right"]||[0,0]),bottom:c.P.convert(y.bottom||[0,0]),"bottom-left":c.P.convert(y["bottom-left"]||[0,0]),"bottom-right":c.P.convert(y["bottom-right"]||[0,0]),left:c.P.convert(y.left||[0,0]),right:c.P.convert(y.right||[0,0])}}return pe(new c.P(0,0))}const be=b;d.AJAXError=c.bf,d.Evented=c.E,d.LngLat=c.M,d.MercatorCoordinate=c.Y,d.Point=c.P,d.addProtocol=c.bg,d.config=c.a,d.removeProtocol=c.bh,d.AttributionControl=xp,d.BoxZoomHandler=ll,d.CanvasSource=vo,d.CooperativeGesturesHandler=zn,d.DoubleClickZoomHandler=qu,d.DragPanHandler=Gu,d.DragRotateHandler=aa,d.EdgeInsets=ol,d.FullscreenControl=class extends c.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var n;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((n=u==null?void 0:u.shadowRoot)===null||n===void 0)&&n.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){A.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=A.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);A.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},d.GeoJSONSource=Ke,d.GeolocateControl=class extends c.E{constructor(y){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",n)),this._finish()}},this._updateCamera=n=>{const u=new c.M(n.coords.longitude,n.coords.latitude),f=n.coords.accuracy,g=this._map.getBearing(),v=c.e({bearing:g},this.options.fitBoundsOptions),k=ci.fromLngLat(u,f);this._map.fitBounds(k,v,{geolocateSource:!0})},this._updateMarker=n=>{if(n){const u=new c.M(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=n=>{if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&ca)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=n=>{if(this._map){if(this._container.addEventListener("contextmenu",u=>u.preventDefault()),this._geolocateButton=A.create("button","maplibregl-ctrl-geolocate",this._container),A.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",n===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new mi({element:this._dotElement}),this._circleElement=A.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new mi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||u.originalEvent&&u.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")))})}},this.options=c.e({},yc,y)}onAdd(y){return this._map=y,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return c._(this,arguments,void 0,function*(n=!1){if(no!==void 0&&!n)return no;if(window.navigator.permissions===void 0)return no=!!window.navigator.geolocation,no;try{no=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{no=!!window.navigator.geolocation}return no})}().then(n=>this._setupUI(n)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),A.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,la=0,ca=!1}_isOutOfMapMaxBounds(y){const n=this._map.getMaxBounds(),u=y.coords;return n&&(u.longitude<n.getWest()||u.longitude>n.getEast()||u.latitude<n.getSouth()||u.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const y=this._map.getBounds(),n=y.getSouthEast(),u=y.getNorthEast(),f=n.distanceTo(u),g=Math.ceil(this._accuracy/(f/this._map._container.clientHeight)*2);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":la--,ca=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),la++,la>1?(y={maximumAge:6e5,timeout:0},ca=!0):(y=this.options.positionOptions,ca=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},d.Hash=Ru,d.ImageSource=Vi,d.KeyboardHandler=io,d.LngLatBounds=ci,d.LogoControl=Yu,d.Map=class extends vg{constructor(y){if(c.bd.mark(c.be.create),(y=c.e({},xg,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Lu(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),{bearingSnap:y.bearingSnap}),this._contextLost=n=>{n.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:n}))},this._contextRestored=n=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:n}))},this._onMapScroll=n=>{if(n.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=y.interactive,this._maxTileCacheSize=y.maxTileCacheSize,this._maxTileCacheZoomLevels=y.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._crossSourceCollisions=y.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=y.collectResourceTiming,this._renderTaskQueue=new hl,this._controls=[],this._mapId=c.a3(),this._locale=c.e({},te,y.locale),this._clickTolerance=y.clickTolerance,this._overridePixelRatio=y.pixelRatio,this._maxCanvasSize=y.maxCanvasSize,this.transformCameraUpdate=y.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=y.cancelPendingTileRequestsWhileZooming,this._imageQueueHandle=K.addThrottleControl(()=>this.isMoving()),this._requestManager=new at(y.transformRequest),typeof y.container=="string"){if(this._container=document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(y.maxBounds&&this.setMaxBounds(y.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let n=!1;const u=hp(f=>{this._trackResize&&!this._removed&&this.resize(f)._update()},50);this._resizeObserver=new ResizeObserver(f=>{n?u(f):n=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ul(this,y),this._hash=y.hash&&new Ru(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,c.e({},y.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=y.localIdeographFontFamily,this._validateStyle=y.validateStyle,y.style&&this.setStyle(y.style,{localIdeographFontFamily:y.localIdeographFontFamily}),y.attributionControl&&this.addControl(new xp(typeof y.attributionControl=="boolean"?void 0:y.attributionControl)),y.maplibreLogo&&this.addControl(new Yu,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update(n.dataType==="style"),this.fire(new c.k(`${n.dataType}data`,n))}),this.on("dataloading",n=>{this.fire(new c.k(`${n.dataType}dataloading`,n))}),this.on("dataabort",n=>{this.fire(new c.k("sourcedataabort",n))})}_getMapId(){return this._mapId}addControl(y,n){if(n===void 0&&(n=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=y.onAdd(this);this._controls.push(y);const f=this._controlPositions[n];return n.indexOf("bottom")!==-1?f.insertBefore(u,f.firstChild):f.appendChild(u),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(y);return n>-1&&this._controls.splice(n,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,n,u,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,n,u,f)}resize(y){var n;const u=this._containerDimensions(),f=u[0],g=u[1],v=this._getClampedPixelRatio(f,g);if(this._resizeCanvas(f,g,v),this.painter.resize(f,g,v),this.painter.overLimit()){const M=this.painter.context.gl;this._maxCanvasSize=[M.drawingBufferWidth,M.drawingBufferHeight];const E=this._getClampedPixelRatio(f,g);this._resizeCanvas(f,g,E),this.painter.resize(f,g,E)}this.transform.resize(f,g),(n=this._requestedCameraState)===null||n===void 0||n.resize(f,g);const k=!this._moving;return k&&(this.stop(),this.fire(new c.k("movestart",y)).fire(new c.k("move",y))),this.fire(new c.k("resize",y)),k&&this.fire(new c.k("moveend",y)),this}_getClampedPixelRatio(y,n){const{0:u,1:f}=this._maxCanvasSize,g=this.getPixelRatio(),v=y*g,k=n*g;return Math.min(v>u?u/v:1,k>f?f/k:1)*g}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(ci.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this._update()}project(y){return this.transform.locationPoint(c.M.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.pointLocation(c.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,n,u){if(y==="mouseenter"||y==="mouseover"){let f=!1;return{layer:n,listener:u,delegates:{mousemove:g=>{const v=this.getLayer(n)?this.queryRenderedFeatures(g.point,{layers:[n]}):[];v.length?f||(f=!0,u.call(this,new zr(y,this,g.originalEvent,{features:v}))):f=!1},mouseout:()=>{f=!1}}}}if(y==="mouseleave"||y==="mouseout"){let f=!1;return{layer:n,listener:u,delegates:{mousemove:g=>{(this.getLayer(n)?this.queryRenderedFeatures(g.point,{layers:[n]}):[]).length?f=!0:f&&(f=!1,u.call(this,new zr(y,this,g.originalEvent)))},mouseout:g=>{f&&(f=!1,u.call(this,new zr(y,this,g.originalEvent)))}}}}{const f=g=>{const v=this.getLayer(n)?this.queryRenderedFeatures(g.point,{layers:[n]}):[];v.length&&(g.features=v,u.call(this,g),delete g.features)};return{layer:n,listener:u,delegates:{[y]:f}}}}on(y,n,u){if(u===void 0)return super.on(y,n);const f=this._createDelegatedListener(y,n,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(f);for(const g in f.delegates)this.on(g,f.delegates[g]);return this}once(y,n,u){if(u===void 0)return super.once(y,n);const f=this._createDelegatedListener(y,n,u);for(const g in f.delegates)this.once(g,f.delegates[g]);return this}off(y,n,u){return u===void 0?super.off(y,n):(this._delegatedListeners&&this._delegatedListeners[y]&&(f=>{const g=this._delegatedListeners[y];for(let v=0;v<g.length;v++){const k=g[v];if(k.layer===n&&k.listener===u){for(const M in k.delegates)this.off(M,k.delegates[M]);return g.splice(v,1),this}}})(),this)}queryRenderedFeatures(y,n){if(!this.style)return[];let u;const f=y instanceof c.P||Array.isArray(y),g=f?y:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(f?{}:y)||{},g instanceof c.P||typeof g[0]=="number")u=[c.P.convert(g)];else{const v=c.P.convert(g[0]),k=c.P.convert(g[1]);u=[v,new c.P(k.x,v.y),k,new c.P(v.x,k.y),v]}return this.style.queryRenderedFeatures(u,n,this.transform)}querySourceFeatures(y,n){return this.style.querySourceFeatures(y,n)}setStyle(y,n){return(n=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(y,n))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const n=this._locale[y];if(n==null)throw new Error(`Missing UI string '${y}'`);return n}_updateStyle(y,n){if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,n));const u=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new Js(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,n,u):this.style.loadJSON(y,n,u),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Js(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,n){if(typeof y=="string"){const u=this._requestManager.transformRequest(y,"Style");c.h(u,new AbortController).then(f=>{this._updateDiff(f.data,n)}).catch(f=>{f&&this.fire(new c.j(f))})}else typeof y=="object"&&this._updateDiff(y,n)}_updateDiff(y,n){try{this.style.setState(y,n)&&this._update(!0)}catch(u){c.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(y,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(y,n){return this._lazyInitEmptyStyle(),this.style.addSource(y,n),this._update(!0)}isSourceLoaded(y){const n=this.style&&this.style.sourceCaches[y];if(n!==void 0)return n.loaded();this.fire(new c.j(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const n=this.style.sourceCaches[y.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&n.reload();for(const u in this.style._layers){const f=this.style._layers[u];f.type==="hillshade"&&f.source===y.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new bp(this.painter,n,y),this.painter.renderToTexture=new wp(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=u=>{u.dataType==="style"?this.terrain.sourceCache.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==y.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:y})),this}getTerrain(){var y,n;return(n=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&n!==void 0?n:null}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const n in y){const u=y[n]._tiles;for(const f in u){const g=u[f];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,n,u={}){const{pixelRatio:f=1,sdf:g=!1,stretchX:v,stretchY:k,content:M,textFitWidth:E,textFitHeight:z}=u;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||c.b(n))){if(n.width===void 0||n.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:F,height:R,data:Z}=n,X=n;return this.style.addImage(y,{data:new c.R({width:F,height:R},new Uint8Array(Z)),pixelRatio:f,stretchX:v,stretchY:k,content:M,textFitWidth:E,textFitHeight:z,sdf:g,version:0,userImage:X}),X.onAdd&&X.onAdd(this,y),this}}{const{width:F,height:R,data:Z}=P.getImageData(n);this.style.addImage(y,{data:new c.R({width:F,height:R},Z),pixelRatio:f,stretchX:v,stretchY:k,content:M,textFitWidth:E,textFitHeight:z,sdf:g,version:0})}}updateImage(y,n){const u=this.style.getImage(y);if(!u)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=n instanceof HTMLImageElement||c.b(n)?P.getImageData(n):n,{width:g,height:v,data:k}=f;if(g===void 0||v===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(g!==u.data.width||v!==u.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const M=!(n instanceof HTMLImageElement||c.b(n));return u.data.replace(k,M),this.style.updateImage(y,u),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return K.getImage(this._requestManager.transformRequest(y,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,n){return this._lazyInitEmptyStyle(),this.style.addLayer(y,n),this._update(!0)}moveLayer(y,n){return this.style.moveLayer(y,n),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,n,u){return this.style.setLayerZoomRange(y,n,u),this._update(!0)}setFilter(y,n,u={}){return this.style.setFilter(y,n,u),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,n,u,f={}){return this.style.setPaintProperty(y,n,u,f),this._update(!0)}getPaintProperty(y,n){return this.style.getPaintProperty(y,n)}setLayoutProperty(y,n,u,f={}){return this.style.setLayoutProperty(y,n,u,f),this._update(!0)}getLayoutProperty(y,n){return this.style.getLayoutProperty(y,n)}setGlyphs(y,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,n,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,n,u,f=>{f||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,n,u=>{u||this._update(!0)}),this}setLight(y,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,n),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(y,n){return this.style.setFeatureState(y,n),this._update()}removeFeatureState(y,n){return this.style.removeFeatureState(y,n),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,n=0;return this._container&&(y=this._container.clientWidth||400,n=this._container.clientHeight||300),[y,n]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const n=this._canvasContainer=A.create("div","maplibregl-canvas-container",y);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=A.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),f=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],f);const g=this._controlContainer=A.create("div","maplibregl-control-container",y),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(k=>{v[k]=A.create("div",`maplibregl-ctrl-${k} `,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,n,u){this._canvas.width=Math.floor(u*y),this._canvas.height=Math.floor(u*n),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const y={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let n=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{n={requestedAttributes:y},f&&(n.statusMessage=f.statusMessage,n.type=f.type)},{once:!0});const u=this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y);if(!u){const f="Failed to initialize WebGL";throw n?(n.message=f,new Error(JSON.stringify(n))):new Error(f)}this.painter=new Je(u,this.transform),V.testSupport(u)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){const n=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let u=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const g=this.transform.zoom,v=P.now();this.style.zoomHistory.update(g,v);const k=new c.a8(g,{now:v,fadeDuration:n,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),M=k.crossFadingFactor();M===1&&M===this._crossFadingFactor||(u=!0,this._crossFadingFactor=M),this.style.update(k)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,n,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:n,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bd.mark(c.be.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||u)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const f=this._sourcesDirty||this._styleDirty||this._placementDirty;return f||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||f||(this._fullyLoaded=!0,c.bd.mark(c.be.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),K.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),A.remove(this._canvasContainer),A.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),c.bd.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,P.frameAsync(this._frameRequest).then(y=>{c.bd.frame(y),this._frameRequest=null,this._render(y)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return Ku}getCameraTargetElevation(){return this.transform.elevation}},d.MapMouseEvent=zr,d.MapTouchEvent=Mo,d.MapWheelEvent=dp,d.Marker=mi,d.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const n=this._map.getZoom(),u=n===this._map.getMaxZoom(),f=n===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=n},this._setButtonTitle=(n,u)=>{const f=this._map._getUIString(`NavigationControl.${u}`);n.title=f,n.setAttribute("aria-label",f)},this.options=c.e({},Xu,y),this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),A.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),A.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=A.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new kp(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){A.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,n){const u=A.create("button",y,this._container);return u.type="button",u.addEventListener("click",n),u}},d.Popup=class extends c.E{constructor(y){super(),this.remove=()=>(this._content&&A.remove(this._content),this._container&&(A.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.k("close"))),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{var u;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=A.create("div","maplibregl-popup",this._map.getContainer()),this._tip=A.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const M of this.options.className.split(" "))this._container.classList.add(M);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Tp(this._lngLat,this._flatPos,this._map.transform):(u=this._lngLat)===null||u===void 0?void 0:u.wrap(),this._trackPointer&&!n)return;const f=this._flatPos=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&n?n:this._map.transform.locationPoint(this._lngLat));let g=this.options.anchor;const v=pe(this.options.offset);if(!g){const M=this._container.offsetWidth,E=this._container.offsetHeight;let z;z=f.y+v.bottom.y<E?["top"]:f.y>this._map.transform.height-E?["bottom"]:[],f.x<M/2?z.push("left"):f.x>this._map.transform.width-M/2&&z.push("right"),g=z.length===0?"bottom":z.join("-")}let k=f.add(v[g]);this.options.subpixelPositioning||(k=k.round()),A.setTransform(this._container,`${Ju[g]} translate(${k.x}px,${k.y}px)`),so(this._container,g,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(fs),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=c.M.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const n=document.createDocumentFragment(),u=document.createElement("body");let f;for(u.innerHTML=y;f=u.firstChild,f;)n.appendChild(f);return this.setDOMContent(n)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=A.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){return this._container&&this._container.classList.add(y),this}removeClassName(y){return this._container&&this._container.classList.remove(y),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}_createCloseButton(){this.options.closeButton&&(this._closeButton=A.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(_c);y&&y.focus()}},d.RasterDEMTileSource=nn,d.RasterTileSource=Bi,d.ScaleControl=class{constructor(y){this._onMove=()=>{Qu(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,Qu(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Mp),y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){A.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},d.ScrollZoomHandler=Zu,d.Style=Js,d.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=A.create("button","maplibregl-ctrl-terrain",this._container),A.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){A.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},d.TwoFingersTouchPitchHandler=Uu,d.TwoFingersTouchRotateHandler=ju,d.TwoFingersTouchZoomHandler=mc,d.TwoFingersTouchZoomRotateHandler=Wu,d.VectorTileSource=Et,d.VideoSource=Ws,d.addSourceType=(y,n)=>c._(void 0,void 0,void 0,function*(){if(jn(y))throw new Error(`A source type called "${y}" already exists.`);((u,f)=>{Ys[u]=f})(y,n)}),d.clearPrewarmedResources=function(){const y=fi;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(Se),fi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},d.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},d.getRTLTextPluginStatus=function(){return xr().getRTLTextPluginStatus()},d.getVersion=function(){return be},d.getWorkerCount=function(){return ai.workerCount},d.getWorkerUrl=function(){return c.a.WORKER_URL},d.importScriptInWorkers=function(y){return Ze().broadcast("IS",y)},d.prewarm=function(){Ue().acquire(Se)},d.setMaxParallelImageRequests=function(y){c.a.MAX_PARALLEL_IMAGE_REQUESTS=y},d.setRTLTextPlugin=function(y,n){return xr().setRTLTextPlugin(y,n)},d.setWorkerCount=function(y){ai.workerCount=y},d.setWorkerUrl=function(y){c.a.WORKER_URL=y}});var h=i;return h})})(J9);var h8=J9.exports;let Os,Od,Jf;function d8({trailDataUrl:t,trailAlertsUrl:e="https://central.nps.gov/data/api/v1/trdx/feeds?apikey=KXuXrDdge2Csv0xbC01JhhNNaDGcmICX&format=geoJson",featurePopupToShow:i,elementClicked:s,mapCssHeight:l,mapCssWidth:h,enableTrailAlerts:d=!0,enableTrailAlertsToggle:c=!0,enableElevationProfile:b=!0,elevationProfileOptions:S=new g_}){let C=(t==null?void 0:t.trailDataUrl)??(t==null?void 0:t.value)??t;C=(C==null?void 0:C.trim())??C,C=typeof C=="string"&&!(C!=null&&C.startsWith("http"))&&Ab(C)?JSON.parse(C):C;let P=d?(e==null?void 0:e.trailAlertsUrl)??(e==null?void 0:e.value)??e:"";P=(P==null?void 0:P.trim())??P,P=typeof P=="string"&&!(P!=null&&P.startsWith("http"))&&Ab(P)?JSON.parse(P):P;let A=l||"98vh",V=h||"100%";const W=CM.NPMap;pu.useEffect(()=>{H(i)},[i]);const $=async K=>{var at,mt,xt,Tt,Mt,$t;if(Os=await K.target,Od=await Os.getContainer(),uC(),lC(JM),Jf=await rC(C||P,Os,GM),b){const Ft=(at=Jf==null?void 0:Jf.features)==null?void 0:at.filter(Ot=>{var ge,_e;return((ge=Ot==null?void 0:Ot.geometry)==null?void 0:ge.type)===Xm||((_e=Ot==null?void 0:Ot.geometry)==null?void 0:_e.type)===hv});if((Ft==null?void 0:Ft.length)===1&&(Tt=(xt=(mt=Ft[0])==null?void 0:mt.geometry)==null?void 0:xt.coordinates)!=null&&Tt.some(Ot=>Ot==null?void 0:Ot.some(ge=>(Ot==null?void 0:Ot.length)===3))){if(!(S!=null&&S.onMove)&&(S==null?void 0:S.displayMarker)!==!1){S??(S=new g_);const Ot=document.createElement("div");Ot.id=CS,Ot.className=$S,(Mt=S==null?void 0:S.mapMarkerColor)!=null&&Mt.length&&(Ot.style.backgroundColor=S==null?void 0:S.mapMarkerColor),($t=S==null?void 0:S.mapMarkerSize)!=null&&$t.length&&(Ot.style.height=S==null?void 0:S.mapMarkerSize,Ot.style.width=S==null?void 0:S.mapMarkerSize);const ge=new h8.Marker({element:Ot}).setLngLat([0,0]).addTo(Os);S.onMove=_e=>{ge.setLngLat(_e.position)}}Os.addControl(new u8(S))}}P&&c&&Os.addControl(new c8)},nt=async K=>{},H=K=>{oC(Os,K)},Y={version:"NPMap5",basemap:["mapbox://styles/atlas-user/ck58pyquo009v01p99xebegr9"],sources:{selectedTrail:{type:Cb,data:C},selectedTrailAlerts:{type:Cb,data:P}},layers:[{id:LM,type:"line",beforeLayer:"pt trail unpaved",source:"selectedTrail",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#ffff99","line-width":["interpolate",["linear"],["zoom"],5,3,12,4,22,20],"line-opacity":1},popup:{options:{primaryKeys:[$h],formatter:K=>(s&&s(K),V0(K,Os,PS))}},filter:["!=","$type","Point"]},{id:ES,type:"line",beforeLayer:"pt trail unpaved",source:"selectedTrailAlerts",layout:{visibility:d&&km?"visible":"none","line-join":"round","line-cap":"round"},paint:{"line-color":"#720f04","line-width":["interpolate",["linear"],["zoom"],5,3,12,4,22,20],"line-opacity":1},popup:{options:{primaryKeys:["siteId"],formatter:K=>(s&&s(K),V0(K,Os,$a,`${$a+Cd+$h}`,void 0,`${$a+Cd+IS}`))}}},{id:RM,type:"symbol",source:"selectedTrail",layout:{"icon-image":"{icon}","icon-allow-overlap":!0,"icon-symbol-library":"nps","icon-height":21,"icon-width":21,"icon-shielded":!0,"text-field":["get",$h],"text-justify":"auto","text-radial-offset":1,"text-variable-anchor-offset":["right",[-1,0],"left",[1,0],"top",[0,1],"bottom",[0,-1]],"text-font":["Open Sans SemiBold","Arial Unicode MS Regular"],"text-size":11,"text-letter-spacing":.05},paint:{"icon-color":"white","icon-shield-color":"#717f5c","text-color":"#1e4700","text-halo-color":"#e6e1db","text-halo-width":2,"text-halo-blur":1},popup:{options:{primaryKeys:[$h],formatter:K=>(s&&s(K),V0(K,Os,VM))}},filter:["==","$type","Point"]}]};return O0.jsx(O0.Fragment,{children:O0.jsx(W,{height:A,width:V,style:Y,center:[-97,38],zoom:4.4,controls:qM,mapLibrary:"5.0.4-d",onEvents:[{type:"load",listener:$},{type:"idle",listener:nt}]})})}const t3=`{
    "type": "LineString",
    "coordinates": [
        [
            -107.68701557663165,
            38.55495455420636, 
            2471.8295000000071
        ],
        [
            -107.68705354363237,
            38.554886106194665,
            2472.5437999999995
        ],
        [
            -107.68712294464392,
            38.5548529771855,
            2473.2289000000019
        ],
        [
            -107.68721615866107,
            38.554823805175296,
            2474.2534000000014
        ],
        [
            -107.68728279267545,
            38.554822274170576,
            2475.7691999999952
        ],
        [
            -107.68736387969538,
            38.55484293616785,
            2476.3236000000034
        ],
        [
            -107.68744842571368,
            38.554840993161875,
            2476.6754999999976
        ],
        [
            -107.68751288872859,
            38.55484852115849,
            2476.386599999998
        ],
        [
            -107.68762377675202,
            38.55484146915004,
            2477.2829000000056
        ],
        [
            -107.6877024467675,
            38.55482614614265,
            2478.0608000000066
        ],
        [
            -107.68778436478269,
            38.55480173813385,
            2478.4597999999969
        ],
        [
            -107.68786286579767,
            38.55478191412587,
            2478.8815000000031
        ],
        [
            -107.68794927281337,
            38.554752899116146,
            2480.1064000000042
        ],
        [
            -107.68801762182368,
            38.55471078210592,
            2481.3871999999974
        ],
        [
            -107.68806949183042,
            38.55466904509682,
            2483.8221000000049
        ],
        [
            -107.68814104284236,
            38.55463586608753,
            2485.4909000000043
        ],
        [
            -107.68823459086057,
            38.55461569607847,
            2487.0789999999979
        ],
        [
            -107.68829857187293,
            38.55460071007215,
            2488.459400000007
        ],
        [
            -107.68836940588473,
            38.55456754706289,
            2489.0932999999932
        ],
        [
            -107.68844238889703,
            38.55453433405352,
            2489.4514000000054
        ],
        [
            -107.68850428990591,
            38.55449236604371,
            2490.7256000000052
        ],
        [
            -107.68859339292173,
            38.55445878303324,
            2491.602899999998
        ],
        [
            -107.68866441693307,
            38.554421110023384,
            2491.9771000000037
        ],
        [
            -107.68873493794284,
            38.55436993401175,
            2491.7234999999928
        ],
        [
            -107.68878699694912,
            38.554323687002054,
            2490.7232999999978
        ],
        [
            -107.68885608495862,
            38.55427254399053,
            2489.6347999999998
        ],
        [
            -107.68893104997085,
            38.554234780980366,
            2489.5218000000023
        ],
        [
            -107.68895867997482,
            38.55421612597603,
            2489.7654000000039
        ],
        [
            -107.68897088297643,
            38.55420683497395,
            2490.417100000006
        ],
        [
            -107.68898019697846,
            38.55420662097328,
            2491.591499999995
        ],
        [
            -107.68904544399057,
            38.55418709996625,
            2492.4587000000029
        ],
        [
            -107.68913173501117,
            38.554203135962574,
            2492.7627999999968
        ],
        [
            -107.68917766702552,
            38.554242625964754,
            2493.2436000000016
        ],
        [
            -107.68920891203672,
            38.55428245196794,
            2493.2578000000067
        ],
        [
            -107.68923296804738,
            38.5543314529729,
            2493.1349999999948
        ],
        [
            -107.68924793206199,
            38.554434724985676,
            2492.5936999999976
        ],
        [
            -107.68926587607227,
            38.554492876992256,
            2491.886599999998
        ],
        [
            -107.68931109308652,
            38.554532382994424,
            2490.2801999999938
        ],
        [
            -107.68937409810205,
            38.554548953992374,
            2488.2260999999999
        ],
        [
            -107.68954816014164,
            38.554562969982484,
            2485.9637999999977
        ],
        [
            -107.68972898518462,
            38.55459485197447,
            2484.9058999999979
        ],
        [
            -107.68970223918132,
            38.55461799197938,
            2486.9033000000054
        ],
        [
            -107.68966190217411,
            38.55463243398406,
            2489.027700000006
        ],
        [
            -107.68964504217145,
            38.55464183298647,
            2491.6322999999975
        ],
        [
            -107.68965629317536,
            38.55465508898747,
            2492.3790000000008
        ],
        [
            -107.68968870318285,
            38.554658848985795,
            2493.4456000000064
        ],
        [
            -107.68970355818657,
            38.55466301098534,
            2494.444399999993
        ],
        [
            -107.68972077718928,
            38.5546536049829,
            2496.4147999999986
        ],
        [
            -107.68978127620434,
            38.55467023498103,
            2497.117499999993
        ],
        [
            -107.68980721521137,
            38.55468315298098,
            2497.2422999999981
        ],
        [
            -107.6898526902222,
            38.55469111697901,
            2497.0528000000049
        ],
        [
            -107.68989205223268,
            38.55470823197861,
            2496.5669999999955
        ],
        [
            -107.6899589992491,
            38.5547247109763,
            2496.0390000000043
        ],
        [
            -107.69001768326474,
            38.554750391975766,
            2495.7541999999958
        ],
        [
            -107.68997753725708,
            38.5547603249798,
            2495.0956000000006
        ],
        [
            -107.68993918224977,
            38.55477021798369,
            2494.5777999999991
        ],
        [
            -107.68991207724638,
            38.55479336598865,
            2494.991399999999
        ],
        [
            -107.68986779923834,
            38.554807898993616,
            2494.4232000000047
        ],
        [
            -107.68981241622785,
            38.55482268699931,
            2493.3479999999981
        ],
        [
            -107.68973623221386,
            38.554846965007755,
            2492.0917999999947
        ],
        [
            -107.68968930220373,
            38.554848044011024,
            2491.4616999999998
        ],
        [
            -107.68964089319527,
            38.55486717801687,
            2491.1745999999985
        ],
        [
            -107.68957294818307,
            38.55489126602473,
            2491.1704999999929
        ],
        [
            -107.68951825817373,
            38.55491504803159,
            2491.2851999999984
        ],
        [
            -107.68944553515809,
            38.55491672003672,
            2491.3292999999976
        ],
        [
            -107.68938604214618,
            38.55492709904215,
            2490.9159000000072
        ],
        [
            -107.68933495813671,
            38.554941788047586,
            2490.7287000000069
        ],
        [
            -107.6892759701264,
            38.55496566905477,
            2490.7192000000068
        ],
        [
            -107.68929940013295,
            38.554978645054916,
            2489.5264000000025
        ],
        [
            -107.68933861614192,
            38.55498224905272,
            2488.6679000000004
        ],
        [
            -107.68939517515612,
            38.554998968051144,
            2488.122000000003
        ],
        [
            -107.68943219716655,
            38.55502064105153,
            2487.4663
        ],
        [
            -107.68950310818288,
            38.55502802104771,
            2486.8132999999943
        ],
        [
            -107.68950428318661,
            38.55505952805187,
            2486.7584999999963
        ],
        [
            -107.68953074719428,
            38.555076940052366,
            2487.1861999999965
        ],
        [
            -107.6895694162036,
            38.555085061050846,
            2489.0703999999969
        ],
        [
            -107.68960894621459,
            38.55510667705109,
            2490.8810999999987
        ],
        [
            -107.68965012222449,
            38.555114740049376,
            2491.6569000000018
        ],
        [
            -107.68968697623446,
            38.55513191204913,
            2490.6162999999942
        ],
        [
            -107.68971146024221,
            38.55515387505045,
            2490.6076999999932
        ],
        [
            -107.68975956425602,
            38.55518430305121,
            2490.4363000000012
        ],
        [
            -107.68976957325916,
            38.55519308305174,
            2492.0706999999966
        ],
        [
            -107.68974915425474,
            38.55519355205318,
            2493.4655000000057
        ],
        [
            -107.68969248124553,
            38.555221886060835,
            2494.6322999999975
        ],
        [
            -107.68962042823198,
            38.55524156306832,
            2495.1619999999966
        ],
        [
            -107.68955714022074,
            38.55526554307584,
            2495.1199999999953
        ],
        [
            -107.68947947720842,
            38.55530787508671,
            2494.2537000000011
        ],
        [
            -107.68945468920607,
            38.55533547409211,
            2493.8035999999993
        ],
        [
            -107.68943205120414,
            38.55536302509734,
            2493.0570000000007
        ],
        [
            -107.6894416782082,
            38.55538082409907,
            2492.3163999999961
        ],
        [
            -107.68950941122186,
            38.55537025609306,
            2491.101800000004
        ],
        [
            -107.68955770723524,
            38.55539617509325,
            2489.2519000000029
        ],
        [
            -107.68963704825285,
            38.555398856088246,
            2487.0825000000041
        ],
        [
            -107.68970315626663,
            38.55539283008297,
            2484.6820000000007
        ],
        [
            -107.68976315228008,
            38.555395955079305,
            2483.2850000000035
        ],
        [
            -107.68984232629718,
            38.55539413407368,
            2480.0840000000026
        ],
        [
            -107.68991755931337,
            38.55539240506838,
            2477.4162999999971
        ],
        [
            -107.689968957325,
            38.55539572706536,
            2475.8464999999997
        ],
        [
            -107.69007724835178,
            38.55542477106186,
            2474.3604999999952
        ],
        [
            -107.69015709337101,
            38.55544095405864,
            2473.0470999999961
        ],
        [
            -107.69023693839023,
            38.555457138055395,
            2473.4590999999928
        ],
        [
            -107.69031993941311,
            38.555500279055536,
            2474.3031999999948
        ],
        [
            -107.69037714743038,
            38.55554401305754,
            2474.8041999999987
        ],
        [
            -107.69029814041383,
            38.55555033506373,
            2476.8059999999969
        ],
        [
            -107.69024939640433,
            38.55556046606839,
            2479.4217999999964
        ],
        [
            -107.69015947438488,
            38.5555625350747,
            2477.8919000000024
        ],
        [
            -107.69010986837368,
            38.555559171077675,
            2476.011599999998
        ],
        [
            -107.69001598435445,
            38.55557034008554,
            2475.676999999996
        ],
        [
            -107.68994376234032,
            38.555585516092435,
            2475.7810999999929
        ],
        [
            -107.68992707033821,
            38.555599415095415,
            2474.0601000000024
        ],
        [
            -107.69003207036728,
            38.55565556409581,
            2472.360400000005
        ],
        [
            -107.69008084638327,
            38.55570399909897,
            2470.8398000000016
        ],
        [
            -107.69016340041001,
            38.555783188103995,
            2470.8620999999985
        ],
        [
            -107.69020028742635,
            38.55585892511159,
            2470.5277999999962
        ],
        [
            -107.69023239443922,
            38.55591224711653,
            2469.6500999999989
        ],
        [
            -107.69025110044775,
            38.555952362120685,
            2464.4600999999966
        ],
        [
            -107.69031704146099,
            38.55594183411478,
            2460.7332000000024
        ],
        [
            -107.69037106146818,
            38.55590004710555,
            2456.8856999999989
        ],
        [
            -107.69041848647248,
            38.55584489609494,
            2451.1723000000056
        ],
        [
            -107.69048131448011,
            38.55578939108327,
            2445.9811000000045
        ],
        [
            -107.6905167034833,
            38.555748031075346,
            2442.7222000000038
        ],
        [
            -107.69058073249363,
            38.55571502306661,
            2438.6024999999936
        ],
        [
            -107.69065708350816,
            38.55569524805878,
            2436.4456000000064
        ],
        [
            -107.69073360552316,
            38.55567997205156,
            2439.1906000000017
        ],
        [
            -107.69079603153267,
            38.55564249604234,
            2444.8525999999983
        ],
        [
            -107.69084381353707,
            38.55558733603174,
            2446.4628999999986
        ],
        [
            -107.69091271054694,
            38.55554070202082,
            2448.1573000000062
        ],
        [
            -107.69096598955501,
            38.555507940012774,
            2447.8975999999966
        ],
        [
            -107.69104819757325,
            38.55551055400761,
            2447.4440999999933
        ],
        [
            -107.69111810058634,
            38.55549092500026,
            2445.4621000000043
        ],
        [
            -107.69118905660065,
            38.55548028199401,
            2442.3537000000069
        ],
        [
            -107.69126610261631,
            38.55546949998735,
            2436.3993000000046
        ],
        [
            -107.69134744863287,
            38.55545861798037,
            2432.0893000000069
        ],
        [
            -107.69141644464625,
            38.55544351497367,
            2428.2115999999951
        ],
        [
            -107.6914852066621,
            38.555450942970005,
            2426.4054999999935
        ],
        [
            -107.69163319870047,
            38.55550610196736,
            2426.2200000000012
        ],
        [
            -107.69177343073967,
            38.55558396396828,
            2427.866200000004
        ],
        [
            -107.69189127376609,
            38.55559026096116,
            2431.2838999999949
        ],
        [
            -107.69196913778538,
            38.55561099495865,
            2433.3273000000045
        ],
        [
            -107.69205821880212,
            38.55558641894933,
            2434.1543999999994
        ],
        [
            -107.69215640182229,
            38.55557514994115,
            2434.4657000000007
        ],
        [
            -107.69225226784152,
            38.55555942793255,
            2434.8117000000057
        ],
        [
            -107.69229916484524,
            38.555499782921444,
            2437.107799999998
        ],
        [
            -107.6923465868495,
            38.55544463091085,
            2436.6171000000031
        ],
        [
            -107.69233177484381,
            38.555422446908885,
            2436.5669000000053
        ],
        [
            -107.69229137183959,
            38.55546392191716,
            2435.0473999999958
        ],
        [
            -107.69220332182498,
            38.55550649492884,
            2434.1386000000057
        ],
        [
            -107.69213420080911,
            38.5554990749325,
            2433.7483999999968
        ],
        [
            -107.69205072779108,
            38.55550099693844,
            2433.6266999999934
        ],
        [
            -107.69199667777742,
            38.55548422093986,
            2433.0326999999961
        ],
        [
            -107.69187657373966,
            38.55537886593388,
            2431.3554000000004
        ],
        [
            -107.69183258771874,
            38.55527626292313,
            2429.1346999999951
        ],
        [
            -107.69178110069532,
            38.55516482391175,
            2424.7253999999957
        ],
        [
            -107.69171045766718,
            38.55504931990109,
            2418.1227000000072
        ],
        [
            -107.69160310663067,
            38.554930155892414,
            2412.7002000000066
        ],
        [
            -107.69156591561968,
            38.554903981891414,
            2407.3282999999938
        ],
        [
            -107.69151546960578,
            38.55487811189137,
            2401.4553000000014
        ],
        [
            -107.69146141959216,
            38.55486133589279,
            2395.6589999999997
        ],
        [
            -107.6914215985781,
            38.55481269688898,
            2391.0994000000064
        ],
        [
            -107.69146602158771,
            38.55481167488584,
            2388.5497999999934
        ],
        [
            -107.69151973460028,
            38.55481944888322,
            2382.7758999999933
        ],
        [
            -107.69154835060846,
            38.554836810883664,
            2380.8896999999997
        ],
        [
            -107.69158986261938,
            38.55485387588307,
            2379.2050000000017
        ],
        [
            -107.69162936963137,
            38.55488450088453,
            2379.2930000000051
        ],
        [
            -107.69171153365157,
            38.55490513488172,
            2378.9899000000005
        ],
        [
            -107.69177220066715,
            38.554926263880446,
            2375.3944999999949
        ],
        [
            -107.691824963682,
            38.55495658388093,
            2375.1567000000068
        ],
        [
            -107.6918811626961,
            38.55497331087936,
            2375.8987000000052
        ],
        [
            -107.6919355487108,
            38.55499908887908,
            2376.5647000000026
        ],
        [
            -107.69198888372426,
            38.55501588087776,
            2377.1826000000001
        ],
        [
            -107.69202201073196,
            38.555019623876,
            2381.0742000000027
        ],
        [
            -107.69205441973942,
            38.555023382874296,
            2383.3206000000064
        ],
        [
            -107.69209626875144,
            38.55504944987497,
            2384.3990000000049
        ],
        [
            -107.69215660076593,
            38.5550615758725,
            2384.6484999999957
        ],
        [
            -107.69226072778595,
            38.55503665386209,
            2387.8445000000065
        ],
        [
            -107.69230517279452,
            38.55502662085778,
            2391.620299999995
        ],
        [
            -107.69233906080038,
            38.55501232485354,
            2393.2761000000028
        ],
        [
            -107.69235360280199,
            38.554998475850695,
            2393.8782999999967
        ],
        [
            -107.69240399281041,
            38.55497479084414,
            2394.0868999999948
        ],
        [
            -107.69245737182193,
            38.554973561840335,
            2391.2911000000022
        ],
        [
            -107.6925205128316,
            38.55493606883107,
            2388.4787000000069
        ],
        [
            -107.69255088483374,
            38.554894823823524,
            2385.9496000000072
        ],
        [
            -107.69262112384787,
            38.55488419781732,
            2384.372000000003
        ],
        [
            -107.69266344185502,
            38.55486520281192,
            2382.1261999999988
        ],
        [
            -107.69272377186951,
            38.55487732880946,
            2379.7250000000058
        ],
        [
            -107.69277025488353,
            38.55491229781094,
            2378.915599999993
        ],
        [
            -107.6928203438973,
            38.55493817581104,
            2378.5810999999958
        ],
        [
            -107.69283837890367,
            38.55496028481276,
            2377.6781999999948
        ],
        [
            -107.69306185895485,
            38.554982168800585,
            2377.1983000000037
        ],
        [
            -107.69309725896544,
            38.55500838380167,
            2377.2262999999948
        ],
        [
            -107.69314254497675,
            38.555020855800265,
            2377.9804000000004
        ],
        [
            -107.69318570198655,
            38.555024366797795,
            2378.329700000002
        ],
        [
            -107.69329722800569,
            38.55497674978386,
            2378.0402000000031
        ],
        [
            -107.69341260602958,
            38.554965082774544,
            2380.2286000000022
        ],
        [
            -107.69349376004658,
            38.554958707768186,
            2382.9441999999981
        ],
        [
            -107.6935554450569,
            38.55493025776019,
            2385.0341999999946
        ],
        [
            -107.69361773607233,
            38.55494684275816,
            2385.6392999999953
        ],
        [
            -107.6936636580793,
            38.55491875575133,
            2385.5516000000061
        ],
        [
            -107.69374165509267,
            38.554885423741595,
            2386.8225999999995
        ],
        [
            -107.69379721911109,
            38.554942709745454,
            2387.6181999999972
        ],
        [
            -107.69394148214714,
            38.554984436741314,
            2387.9293000000034
        ],
        [
            -107.69396082715132,
            38.55498399073995,
            2388.7234999999928
        ],
        [
            -107.69397064615492,
            38.55499727874105,
            2389.5987000000023
        ],
        [
            -107.69402737216969,
            38.55501849774001,
            2390.2948000000033
        ],
        [
            -107.69406224617967,
            38.55504021974059,
            2390.3981000000058
        ],
        [
            -107.69409647018655,
            38.55503492573756,
            2390.5209000000032
        ],
        [
            -107.6940561211719,
            38.55498179573316,
            2390.8779000000068
        ],
        [
            -107.69402700116217,
            38.55495093173099,
            2391.6771000000008
        ],
        [
            -107.69397141614469,
            38.55490265672834,
            2393.3300000000017
        ],
        [
            -107.69392132713097,
            38.55487677972828,
            2395.4618000000046
        ],
        [
            -107.69388938511861,
            38.554827961723866,
            2397.940499999997
        ],
        [
            -107.69383881510227,
            38.55477957172087,
            2399.582699999999
        ],
        [
            -107.69380769309358,
            38.55476226872063,
            2401.2966000000015
        ],
        [
            -107.69376257508283,
            38.55475429772261,
            2403.1349999999948
        ],
        [
            -107.69370434907076,
            38.554760142727375,
            2405.578800000003
        ],
        [
            -107.69359393004245,
            38.554722141729755,
            2408.2486000000063
        ],
        [
            -107.69358286803809,
            38.55470437672813,
            2411.0764000000054
        ],
        [
            -107.69367013405548,
            38.554688851720165,
            2413.0574999999953
        ],
        [
            -107.69375339407492,
            38.55470044871605,
            2413.3830000000016
        ],
        [
            -107.69380517108561,
            38.554694751711764,
            2415.5831000000035
        ],
        [
            -107.69385427309521,
            38.55468461070712,
            2417.8163999999961
        ],
        [
            -107.69390056610963,
            38.55472408970923,
            2419.8041999999987
        ],
        [
            -107.69397876612999,
            38.554753822707916,
            2421.8555000000051
        ],
        [
            -107.69404356514593,
            38.554770349705755,
            2423.8132000000041
        ],
        [
            -107.69409599215972,
            38.554791666705064,
            2426.1364999999932
        ],
        [
            -107.69415451017481,
            38.55481284470392,
            2428.5139000000054
        ],
        [
            -107.69420744219023,
            38.554847664705,
            2430.4431000000041
        ],
        [
            -107.6942681102058,
            38.55486879170368,
            2432.2719999999972
        ],
        [
            -107.69431621621965,
            38.55489921870449,
            2432.9590999999928
        ],
        [
            -107.69435954222996,
            38.55490723070265,
            2433.6511000000028
        ],
        [
            -107.6944309132498,
            38.55494613170301,
            2439.4642000000022
        ],
        [
            -107.6944899582655,
            38.55497180070247,
            2441.4952000000048
        ],
        [
            -107.69452289427363,
            38.55498005170134,
            2443.2666999999929
        ],
        [
            -107.69454852027864,
            38.55497495669891,
            2443.8291999999929
        ],
        [
            -107.6945259260424,
            38.554952690397656,
            2446.5534000000043
        ],
        [
            -107.69452171826993,
            38.55494854369721,
            2448.7332000000024
        ],
        [
            -107.69447093525498,
            38.55491367469598,
            2449.9812999999995
        ],
        [
            -107.69443522124236,
            38.554869446692464,
            2452.3986000000004
        ],
        [
            -107.69439699922916,
            38.554825277689176,
            2454.8083000000042
        ],
        [
            -107.6943453982106,
            38.554758892683765,
            2456.0048999999999
        ],
        [
            -107.69428818919327,
            38.55471516068179,
            2457.3126000000047
        ],
        [
            -107.69425822918086,
            38.55466179067669,
            2458.5356000000029
        ],
        [
            -107.69424529717169,
            38.55460352366979,
            2459.5699000000022
        ],
        [
            -107.69426477316993,
            38.554549014661205,
            2461.2002999999968
        ],
        [
            -107.694269541166,
            38.55450385465482,
            2463.5411000000022
        ],
        [
            -107.69424438515613,
            38.5544638896512,
            2465.2461000000039
        ],
        [
            -107.69421543314688,
            38.55443752664963,
            2465.6199999999953
        ],
        [
            -107.69416204112794,
            38.55437118164436,
            2468.2390000000014
        ],
        [
            -107.69409726511103,
            38.55434564364535,
            2469.5188999999955
        ],
        [
            -107.69401902209263,
            38.55433393164908,
            2470.2329000000027
        ],
        [
            -107.6939395130745,
            38.55432675365346,
            2469.8260000000009
        ],
        [
            -107.69385107205342,
            38.55431076965736,
            2470.5384000000049
        ],
        [
            -107.69377853803731,
            38.55430793566186,
            2471.8821000000025
        ],
        [
            -107.69369833601797,
            38.554291762665116,
            2472.2163
        ],
        [
            -107.69361522400007,
            38.55429367767104,
            2472.6978999999992
        ],
        [
            -107.69352905498197,
            38.554300167677724,
            2473.7544000000053
        ],
        [
            -107.69345021896595,
            38.55431099168453,
            2474.1002000000008
        ],
        [
            -107.6933690649489,
            38.554317366690874,
            2474.8656999999948
        ],
        [
            -107.69329650993376,
            38.55432354169663,
            2475.4100999999937
        ],
        [
            -107.69322445692018,
            38.554343220704126,
            2475.9906000000046
        ],
        [
            -107.69317423691233,
            38.55437140771129,
            2476.6080999999976
        ],
        [
            -107.69311206989941,
            38.55437734471627,
            2477.0130999999965
        ],
        [
            -107.69305439288694,
            38.55437867272041,
            2477.344299999997
        ],
        [
            -107.69301140287766,
            38.554379662723434,
            2478.2838999999949
        ],
        [
            -107.69294677486225,
            38.55436763572619,
            2478.2774999999965
        ],
        [
            -107.69286115284373,
            38.554369606732266,
            2478.2600999999995
        ],
        [
            -107.69276545782509,
            38.55438982974141,
            2478.1793000000034
        ],
        [
            -107.69269225080681,
            38.5543689907436,
            2478.6549999999988
        ],
        [
            -107.69262996179137,
            38.554352404745636,
            2479.055600000007
        ],
        [
            -107.69254894176846,
            38.55430471474472,
            2479.9556000000011
        ],
        [
            -107.69249037975534,
            38.55430155774828,
            2480.796199999997
        ],
        [
            -107.69241860673736,
            38.55428068475032,
            2482.1554000000033
        ],
        [
            -107.69227050670392,
            38.554270579758985,
            2483.2437999999966
        ],
        [
            -107.69217511267986,
            38.55424124076154,
            2484.054999999993
        ],
        [
            -107.69212868767134,
            38.55425582476662,
            2484.3877999999968
        ],
        [
            -107.69206009365605,
            38.5542528987709,
            2484.6919999999955
        ],
        [
            -107.69199628164425,
            38.55427238677785,
            2484.4478999999992
        ],
        [
            -107.6919363876343,
            38.554300795785686,
            2484.1904000000068
        ],
        [
            -107.69189667763115,
            38.55435126379511,
            2483.8319000000047
        ],
        [
            -107.6918785096307,
            38.554383217800606,
            2484.1904000000068
        ],
        [
            -107.69180067961786,
            38.55442104981098,
            2485.6322999999975
        ],
        [
            -107.69171542860691,
            38.554490586826056,
            2487.027700000006
        ],
        [
            -107.69165378859459,
            38.554501014831615,
            2486.9033000000054
        ],
        [
            -107.69156949857292,
            38.554471419833376,
            2484.9058999999979
        ],
        [
            -107.69153572356218,
            38.55444066083151,
            2485.9637999999977
        ],
        [
            -107.69147042254464,
            38.55441062983193,
            2488.2260999999999
        ],
        [
            -107.69135773251335,
            38.55435015283149,
            2490.2801999999938
        ],
        [
            -107.691272514493,
            38.55433409383511,
            2491.886599999998
        ],
        [
            -107.69118424147244,
            38.554322609839524,
            2492.5936999999976
        ],
        [
            -107.69110026645284,
            38.55431102684365,
            2493.1349999999948
        ],
        [
            -107.69101679643484,
            38.5543129478496,
            2493.2578000000067
        ],
        [
            -107.69092959641453,
            38.55430143985397,
            2493.2436000000016
        ],
        [
            -107.69084918139667,
            38.55429878485906,
            2492.7627999999968
        ],
        [
            -107.69060405134773,
            38.55434046388121,
            2492.4587000000029
        ],
        [
            -107.69052755533176,
            38.55434672888727,
            2491.591499999995
        ],
        [
            -107.69044890831526,
            38.554353042893396,
            2490.417100000006
        ],
        [
            -107.69036094829674,
            38.55435957190024,
            2489.7654000000039
        ],
        [
            -107.69028110427756,
            38.55434338790348,
            2488.5218000000023
        ],
        [
            -107.69018836325556,
            38.554327501907615,
            2489.6347999999998
        ],
        [
            -107.6900481672228,
            38.55430820191456,
            2490.7232999999978
        ],
        [
            -107.6900481672228,
            38.55430820191452,
            2491.7234999999928
        ],
        [
            -107.69001637072904,
            38.55430512369135,
            2491.9771000000037
        ],
        [
            -107.6899729582056,
            38.55430092091866,
            2491.602899999998
        ],
        [
            -107.68992122519293,
            38.554288595920525,
            2490.7256000000052
        ],
        [
            -107.68990118718762,
            38.55428004792075,
            2489.4514000000054
        ],
        [
            -107.68987524818051,
            38.55426712892074,
            2489.0932999999932
        ],
        [
            -107.68985678717706,
            38.55427205892271,
            2488.459400000007
        ],
        [
            -107.68980715816686,
            38.5542777049268,
            2487.0789999999979
        ],
        [
            -107.68970188014211,
            38.55426210593185,
            2485.4909000000043
        ],
        [
            -107.68961955112137,
            38.55423696893404,
            2483.8221000000049
        ],
        [
            -107.68957223110476,
            38.55417949292956,
            2481.3871999999974
        ],
        [
            -107.68953532208937,
            38.55411276692315,
            2480.1064000000042
        ],
        [
            -107.6894951900733,
            38.55404611491695,
            2478.8815000000031
        ],
        [
            -107.6894347830543,
            38.55399344391402,
            2478.4597999999969
        ],
        [
            -107.68937026803397,
            38.55393636191074,
            2478.0608000000066
        ],
        [
            -107.68930315401704,
            38.55391538091251,
            2477.2829000000056
        ],
        [
            -107.68921263999994,
            38.553939986921876,
            2476.386599999998
        ],
        [
            -107.68913910998802,
            38.55397771693193,
            2476.6754999999976
        ],
        [
            -107.68909048798099,
            38.55401036993958,
            2476.3236000000034
        ],
        [
            -107.68906455798134,
            38.55406502694863,
            2475.7691999999952
        ],
        [
            -107.68899931997666,
            38.55415212096472,
            2474.2534000000014
        ],
        [
            -107.6889549753036,
            38.55421862726621,
            2473.2289000000019
        ],
        [
            -107.6886644169331,
            38.55442111002341,
            2472.5437999999995
        ],
        [
            -107.68848810035273,
            38.554503342332126,
            2471.8295000000071
        ]
    ]
}`,p8=`{
    "type": "Feature",
    "id": "d0e3dc08-9a33-ea37-8c00-4d4cf9fa7d4c",
    "geometry": ${t3},
    "properties": {
        "trailInfo": {
            "routeType": "Loop",
            "surface": "Natural trail",
            "dogs": "Dogs on Leash",
            "difficulty": "Easy",
            "usage": "Heavy",
            "accessibility": "",
            "kid": "Kid friendly",
            "class": "",
            "activities": [
                "Walking",
                "Hiking",
                "Bird watching"
            ],
            "features": [
                "Forest",
                "Wildlife",
                "Wildflowers"
            ],
            "obstacles": [
                "Fee",
                "Off trail"
            ],
            "url": "/trails/view.htm?id=d0e3dc08-9a33-ea37-8c00-4d4cf9fa7d4c",
            "openDate": "2024-05-01T11:25:00",
            "closeDate": "2024-11-30T11:26:00",
            "description": "The Oak Flat Trail is an enjoyable mountain trail full of trees and easy grades.",
            "elevationGain": 500.0,
            "lengthInMiles": 1.2,
            "hikeTime": "60",
            "reservationRequired": true,
            "reservationFee": 15.0,
            "reservationUrl": "https://youtu.be/dQw4w9WgXcQ?feature=shared"
        },
        "geom_id": "d0e3dc08-9a33-ea37-8c00-4d4cf9fa7d4c",
        "color": "#465724",
        "icon": "trail",
        "name": "Oak Flat Trail",
        "description": "The Oak Flat Trail is an enjoyable mountain trail full of trees and easy grades."
    }
}`,e3=`{
    "type": "Feature",
    "id": "2ea1dc08-9d61-8eb6-ac0d-01f600670a05",
    "geometry": {
        "type": "Point",
        "coordinates": [
            -107.68658381654139,
            38.554991502240554
        ]
    },
    "properties": {
        "ordinal": 0,
        "significance": "South Rim Visitor Center",
        "amenities": [
            {
                "name": "Automated External Defibrillator (AED)",
                "icon": "aed"
            },
            {
                "name": "Information",
                "icon": "information"
            },
            {
                "name": "Junior Ranger Booklet Available",
                "icon": "junior-ranger-program"
            },
            {
                "name": "Benches/Seating",
                "icon": "benches-seating"
            },
            {
                "name": "Historical/Interpretive Information/Exhibits",
                "icon": "interpretive-exhibit"
            },
            {
                "name": "Gifts/Souvenirs/Books",
                "icon": "book-and-souvenir-shop"
            },
            {
                "name": "Trailhead",
                "icon": "trailhead"
            },
            {
                "name": "Scenic View/Photo Spot",
                "icon": "scenic-viewpoint"
            },
            {
                "name": "Audio Description",
                "icon": "audio-description"
            },
            {
                "name": "Information - Maps Available",
                "icon": "maps"
            },
            {
                "name": "Fire Extinguisher",
                "icon": "fire-extinguisher"
            },
            {
                "name": "Information Kiosk/Bulletin Board",
                "icon": "information"
            },
            {
                "name": "Information - Ranger/Staff Member Present",
                "icon": "ranger-led-events"
            },
            {
                "name": "Internet/WiFi Available",
                "icon": "wi-fi"
            },
            {
                "name": "Amphitheater",
                "icon": "amphitheater"
            },
            {
                "name": "Parking - Auto",
                "icon": "parking"
            },
            {
                "name": "Wheelchair Accessible",
                "icon": "wheelchair-accessible"
            },
            {
                "name": "Toilet - Vault/Composting",
                "icon": "pit-toilet"
            }
        ],
        "color": "#465724",
        "icon": "visitor-center",
        "images": [
            {
                "description": "",
                "url": "https://www.nps.gov/common/uploads/passport_stamps/EB1A3545-C2AD-CE62-BE96D47E3B3FE825.jpg",
                "credit": "",
                "altText": "Passport Stamp",
                "caption": "",
                "crops": [
                    {
                        "aspectRatio": 1.0,
                        "url": "https://www.nps.gov/common/uploads/passport_stamps/primary/EB1A3545-C2AD-CE62-BE96D47E3B3FE825.jpg"
                    }
                ],
                "type": "Passport",
                "id": "c6d2dc08-0774-83c7-9383-52fabc423b6d"
            },
            {
                "url": "https://www.nps.gov/common/uploads/structured_data/E8909275-C865-AA27-5368DFE1841F3383.jpg",
                "credit": "NPS photo",
                "altText": "South Rim Visitor Center",
                "caption": "South Rim Visitor Center at Gunnison Point",
                "type": "Images",
                "id": "c6d2dc08-c573-15ef-b0a3-a5e9ecb76e49"
            },
            {
                "url": "https://www.nps.gov/common/uploads/structured_data/59CB42C2-09B7-54B8-E45AF60DDB7995BE.jpg",
                "credit": "NPS Photo",
                "altText": "View from the wooden porch around the building with a wayside exhibit",
                "caption": "View from the porch around the building",
                "type": "Images",
                "id": "c6d2dc08-c773-a55a-a288-7520ca0c3d18"
            },
            {
                "url": "https://www.nps.gov/common/uploads/structured_data/59DBE947-B36A-9B75-564E0AD481352AC2.jpg",
                "credit": "NPS Photo",
                "altText": "Interior view of a visitor center with people, exhibits, and a front desk",
                "caption": "The visitor center is open year-round",
                "type": "Images",
                "id": "c6d2dc08-c973-ad46-a1d7-2c53c2ba84dc"
            },
            {
                "url": "https://www.nps.gov/common/uploads/structured_data/5BDA6D09-093A-9A36-26E0BE8F2CC1522C.jpg",
                "credit": "NPS Photo",
                "altText": "A wooden building with A frame style windows with vegetation in the foreground",
                "caption": "A view of the visitor center from below",
                "type": "Images",
                "id": "c6d2dc08-cb73-3b3e-b1ce-b0cd8bb1e10b"
            }
        ],
        "name": "South Rim Visitor Center",
        "description": "This visitor center has exhibits, information, book and map sales, water (available seasonally), vault toilets, and hiking trailheads. It is open year-round with the exception of Thanksgiving Day, Christmas Day, and New Years Day."
    }
}`,f8=`{
    "type": "FeatureCollection",
    "features": [
        ${e3},
        ${p8}
    ]
}`,m8=`{
"type": "FeatureCollection",    
"features": [
        {
            "type": "Feature",
            "id": "d4e3dc08-a730-d77b-87c0-2c9cb0c8af31",
            "geometry": ${t3},
            "properties": {
                "parkId": "d45494ce-5b26-426d-2c07-08d4c7ad36e2",
                "siteId": "d0e3dc08-9a33-ea37-8c00-4d4cf9fa7d4c",
                "core_details": {
                    "name": "Halloween in the Hills",
                    "data_source_id": "d45494ce-5b26-426d-2c07-08d4c7ad36e2",
                    "event_type": "Incident",
                    "trail_names": [
                        "Oak Flat Trail"
                    ],
                    "trail_ids": [
                        "d0e3dc08-9a33-ea37-8c00-4d4cf9fa7d4c"
                    ],
                    "description": "It's that time of year again! Oak Flat Trail will be closed to the public for our sixth annual 'Halloween in the Hills' event.",
                    "creation_date": "2024-10-03T17:52:46.862339",
                    "id": "d4e3dc08-a730-d77b-87c0-2c9cb0c8af31"
                },
                "start_date": "2024-10-01T06:00:00",
                "end_date": "2024-10-31T06:00:00",
                "trail_status": "closed",
                "type_of_incidents": [
                    {
                        "incident_category": "specialevent",
                        "incident_type": "A festival interrupts normal operations."
                    }
                ]
            }
        }
    ]
}`;function g8(){const[t,e]=pu.useState(null),i=l=>{console.log("Received clicked feature: ",l)},s=l=>{e(l)};return Bs.jsxs(Bs.Fragment,{children:[Bs.jsx("p",{className:"header-text",children:"The Trail Map"}),Bs.jsxs("div",{className:"map-container",children:[Bs.jsxs("div",{className:"left-side",children:[Bs.jsx("div",{style:{display:"flex",flexDirection:"row"},children:Bs.jsx("img",{src:wM,className:"logo",alt:"Vite logo"})}),Bs.jsx("button",{onClick:()=>s(e3),style:{padding:"20px",marginRight:"10px"},children:"Force Feature Popup"})]}),Bs.jsx(d8,{trailDataUrl:f8,trailAlertsUrl:m8,featurePopupToShow:t,elementClicked:i,mapCssHeight:"100%",mapCssWidth:"100%",enableTrailAlerts:!0,enableTrailAlertsToggle:!0,enableElevationProfile:!0,elevationProfileOptions:{mapMarkerColor:"goldenrod"}})]})]})}wS(document.getElementById("root")).render(Bs.jsx(pu.StrictMode,{children:Bs.jsx(g8,{})}));
